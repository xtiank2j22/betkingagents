function ItpOverlay(a){this.id=a,this.show=function(a){a&&(this.id=a);var b=document.getElementById(this.id),c=document.createElement("div");c.setAttribute("id","itp_overlay"),c.setAttribute("class","itp_overlay"),c.style.display="block",b.appendChild(c)},this.hide=function(a){a&&(this.id=a);var b=document.getElementById(this.id),c=document.getElementById("itp_overlay");void 0!=c&&b.removeChild(c)}}function toggleActive(a){$(a).toggleClass("active")}function createCookie(a,b,c){var d;if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d="; expires="+e.toGMTString()}else d="";document.cookie=a+"="+b+d+"; path=/"}function readCookie(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return null}function eraseCookie(a){createCookie(a,"",-1)}function areCookiesEnabled(){var a=!1;return createCookie("testing","Hello",1),null!=readCookie("testing")&&(a=!0,eraseCookie("testing")),a}function DisplayCookiePolicy(a){var b=new Date;b.setYear(b.getFullYear()+1),a?($.cookie("cookiePolicy","True",{expires:b,path:"/"}),$("#cookieBox").animate({bottom:"-1px"},500)):($.cookie("cookiePolicy","False",{expires:b,path:"/"}),$("#cookieBox").animate({bottom:"-200px"},500))}function DisplayCookieDisabled(){areCookiesEnabled()?$("#cookiesDisabledBox").animate({bottom:"-200px"},500):$("#cookiesDisabledBox").animate({bottom:"-1px"},500)}function displayCookiePolicy(){var a=!1;return localStorage.cookiePolicy&&"false"!=localStorage.cookiePolicy?a=!1:(a=!0,localStorage.cookiePolicy="false"),a}function disableCookiePopup(){localStorage.cookiePolicy="true"}function detectmob(){if(globalSettings.LayoutSelection_Enable&&(null==$.cookie("mobileDetected")||"false"==$.cookie("mobileDetected"))&&(void 0==$.cookie("viewMobileVersion")||"true"==$.cookie("viewMobileVersion"))&&(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))){var a=new Date;a.setYear(a.getFullYear()+1),$.cookie("mobileDetected","true",{expires:a,path:"/"}),window.location.href="/choose-device"}}function movePanelLTR(a,b){$("#"+a).removeClass().addClass("fadeOutLeft animated"),setTimeout(function(){$("#"+a).addClass("hidden"),$("#"+b).removeClass().addClass("fadeInRight animated")},500)}function movePanelRTL(a,b){$("#"+a).removeClass().addClass("fadeOutRight animated"),setTimeout(function(){$("#"+a).addClass("hidden"),$("#"+b).removeClass().addClass("fadeInLeft animated")},500)}!function(){getAgentType=function(a,b){var c=null;switch(a){case"J_MASTER":c=b.masterAgent;break;case"J_SUPER_AG":c=b.superAgent;break;case"J_SHOP_OWN":c=b.agent;break;case"J_CASHIER":c=b.cashier;break;case"PLYSUB":c=b.subAccountPlayer}return c},onLoginSuccess=function(a){}}(),function(){sortCouponOdds=function(a){if(null!=a&&""!=a&&0!=a.Odds.length){a.Odds.sort(firstBy("IDSport").thenBy(function(a,b){return stringSort(a.EventName,b.EventName)}).thenBy(function(a,b){return stringSort(a.TournamentName,b.TournamentName)}).thenBy(function(a,b){return stringSort(a.MatchName,b.MatchName)}));var b="",c="",d="";return angular.forEach(a.Odds,function(a){a.IsPreviousSport=!1,b!=a.SportName&&(b=a.SportName,a.IsPreviousSport=!0),a.IsPreviousTournament=!1,c!=a.SportName+" - "+a.EventName+" - "+a.TournamentName&&(c=a.SportName+" - "+a.EventName+" - "+a.TournamentName,a.IsPreviousTournament=!0),a.IsPreviousMatchName=!1,d!=a.MatchName&&(d=a.MatchName,a.IsPreviousMatchName=!0)}),a}},stringSort=function(a,b){return a.trim()<b.trim()?-1:a.trim()>b.trim()?1:0}}(),function(){angular.module("liveChat.service",[]).factory("liveChatService",["$rootScope",function(a){var b={zoho:{isInitialized:!1,initialize:function(){if(!this.isInitialized){$zoho={salesiq:{widgetcode:"b8338f31343138792845788b3270f9ae489768b09249ac6d8eb22e9a0adf7ec95d5fe629768af6d9a03793700d9418c2",values:{},ready:function(){}}};var a=document;s=a.createElement("script"),s.type="text/javascript",s.id="zsiqscript",s.src="https://salesiq.zoho.com/widget",t=a.getElementsByTagName("script")[0],t.parentNode.insertBefore(s,t)}},openChat:function(){this.isInitialized?$zoho.livedesk.floatwindow.visible("show"):this.initialize()}},sfk:{openChat:function(){$(".sfk-frame-container").fadeIn(),liveagent.startChatWithWindow(globalSettings.LiveChat_SFK_ButtonID,"sfkFrame")},closeChat:function(){$(".sfk-frame-container").fadeOut()}}},c=function(){var a=null;switch(globalSettings.LiveChatIntegration.toLowerCase()){case"zoho":a=b.zoho;break;case"sfk":a=b.sfk}return a},d=function(){var a=c();null!=a&&a.openChat()},e=function(){var a=c();null!==a&&void 0!==a.closeChat&&a.closeChat()};return{openChat:d,closeChat:e}}])}(),function(){localeSettings={accountLimitEmail:"info@betking.com",brandName:"BetKing",brandUrl:"betking.com",companyName:"SV Gaming Limited",companyInterswitchAtmCode:"04314801",companyAddress:"197, Adeleke Adedoyin Street, VI, Lagos, Nigeria",companyTelephoneNo:"01 2777 247",copyrightYear:(new Date).getFullYear(),licenseNumbers:"",licenseEffectiveDate:"",licenseEffectiveDateES:"",licenseEffectiveDateIT:"",licensingCompany:"",infoEmail:"info@betking.com",securityEmail:"info@betking.com",documentsEmail:"info@betking.com",hrEmail:"info@betking.com",pressEmail:"info@betking.com",assistanceEmail:"info@betking.com",bankName:"",bankAddress:"",bankCity:"",bankAccountName:"",bankAccountNumber:"",bankSwiftBic:"",bankIban:""}}();var betRadarWidgetsOptions={colorBrand:"#3558bd",colorBrandDarker:"#001041"},lineGraphOptions={fillColorArray:["#ffbd00","#3558bd","#b68521"],colorArray:["#ffbd00","#3558bd","#b68521"],gridColor:"#000",gridBorderColor:"#0000004d",gridTickColor:"#0000001a",gridShadowColor:"transparent",gridBorderWidth:1},pieGraphOptions={colorGradients:[{colors:["#9faac6","#9faac6"]},{colors:["#4a6097","#4a6097"]}],strokeColor:"#496973",radius:65},eventOddsOptions={removeMiddleTablesSpace:0},searchAutoComplete={backgroundColor:"#454545",borderColor:"#454545",color:"#bcbcbc",hintColor:"#aaa"},supportedLanguages={en:{name:"English",code:"en"}},supportedThemes=[{name:"Default",value:"default",order:0}];if(HTMLFormElement.prototype.reportValidity||(HTMLFormElement.prototype.reportValidity=function(){for(var a=this.querySelectorAll("button, input[type=submit]"),b=0;b<a.length;b++)if("submit"===a[b].type)return void a[b].click()}),"undefined"!=typeof $&&($.cookie=function(a,b,c){if("undefined"==typeof b){var d=null;if(document.cookie&&""!=document.cookie)for(var e=document.cookie.split(";"),f=0;f<e.length;f++){var g=jQuery.trim(e[f]);if(g.substring(0,a.length+1)==a+"="){d=decodeURIComponent(g.substring(a.length+1));break}}return d}c=c||{},null===b&&(b="",c.expires=-1);var h="";if(c.expires&&("number"==typeof c.expires||c.expires.toUTCString)){var i;"number"==typeof c.expires?(i=new Date,i.setTime(i.getTime()+24*c.expires*60*60*1e3)):i=c.expires,h="; expires="+i.toUTCString()}var j=c.path?"; path="+c.path:"",k=c.domain?"; domain="+c.domain:"",l=c.secure?"; secure":"";document.cookie=[a,"=",encodeURIComponent(b),h,j,k,l].join("")}),$(window).on("resize",function(){var a=$("body").find(".ui-select-trackresizing");if(0!=a.length){var b=$(".ui-select-container.open"),c=a.offset();b.css("left",c.left)}}),$(document).ready(function(){$("#divLanguage, #divLanguageS").on("click",function(){var a=$(this).width();$("body").find(".ui-select-choices").css("width",a)});var a=displayCookiePolicy();a||$("#cookieBox").animate({bottom:"-200px"},500),$(".cms-accordion-menu > li > a").click(function(){return"active"==$(this).attr("class")?($(".cms-accordion-menu li ul").slideUp(),void $(".cms-accordion-menu li a").removeClass("active")):void("active"!=$(this).attr("class")&&($(".cms-accordion-menu li ul").slideUp(),$(this).next().slideToggle(),$(".cms-accordion-menu li a").removeClass("active"),$(this).addClass("active")))}),$(".cms-accordion-sub-menu > li > a").click(function(){return"active"==$(this).attr("class")?($(".cms-accordion-sub-menu li ul").slideUp(),void $(".cms-accordion-sub-menu li a").removeClass("active")):void("active"!=$(this).attr("class")&&($(".cms-accordion-sub-menu li ul").slideUp(),$(this).next().slideToggle(),$(".cms-accordion-sub-menu li a").removeClass("active"),$(this).addClass("active")))}),$("#cookieBoxClose, #cookieLink").click(function(){disableCookiePopup(),$("#cookieBox").animate({bottom:"-200px"},500)}),detectmob(),$("#sportsSidebarNav")&&setInterval(function(){var a=$("#sportsSidebarNav").height(),b=$("#sports-sidebar-maincontent-container").css("min-height",a);$("#searchDataContainer_popup").is(":visible")&&$("#searchDataContainer_popup").height()>a?b.height($("#searchDataContainer_popup").height()):b.css("height","auto")},1e3)}),function(){angular.module("accountPaymentDepositWithdrawal",[]).controller("DepositWithdrawalsBalancePartialController",["$filter","$scope","$window","platformApiService","helperService","authService","currencyService","websiteApiService","$location","umbracoApiService",function(a,b,c,d,e,f,g,h,i,j){var k=this;this.isAgent=f.isAgent(),this.checkWithdrawalOfDeposit=!0,this.isUserAboveThreshold=!1,this.formatCurrency=function(a){return k.isDesktop?g.smartFormatNumber(f.getUserData().currency.Currency,"string"==typeof a?parseFloat(a):a,2):g.currencyFormat("string"==typeof a?parseFloat(a).toFixed(2):a.toFixed(2),f.getUserData().currency.Currency)},this.getDepositPaymentMethodCallBack=function(){return h.paymentVendors.getAllDepositPaymentMethods()},this.getUnavailablePaymentMethodMessage=function(a){return locale.account.paymentMethods.deposit.depositDisablePaymentMethod.replace("{method}",a)},this.getDepositRatio=function(){d.finance.getUserWithdrawalConfiguration(c.location.pathname.split("/").pop()).then(function(b){b.success?(k.checkWithdrawalOfDeposit=b.data.CheckWithdrawalOfDeposit,k.depositRatio=a("number")(100*b.data.Ratio,2),k.withdrawalWin=b.data.WithdrawalWin,k.isUserAboveThreshold=b.data.UserAboveThreshold):(k.depositRatio=0,k.withdrawalWin=0)})},this.showPopup=function(){k.getDepositPaymentMethodCallBack().then(function(a){k.isDesktop?j.desktop.getDepositMethodList().then(function(b){var d=_.find(a.data,{Identifier:c.location.pathname.split("/").pop()}),f=_.find(b.data,{PaymentId:c.location.pathname.split("/").pop()});if(d.IsEnabled&&"offline"!=f.Status&&"disabled"!=f.Status)if(k.checkWithdrawalOfDeposit&&k.isUserAboveThreshold&&!k.isAgent){var g=locale.account.paymentMethods.deposit.autoDepositDisc.replace("{amount}",k.formatCurrency(k.userBalance));e.showInfoMessage(g).done().then(function(){k.action(k.param)})}else k.action(k.param);else{k.isDepositProcessing=!0;var h=k.getUnavailablePaymentMethodMessage(f.PaymentTitle||d.Name);e.showInfoMessage(h).done().then(function(){i.path("/ac/deposit")})}}):j.mobile.getDepositMethodList().then(function(b){var d=_.find(a.data,{Identifier:c.location.pathname.split("/").pop()}),f=_.find(b.data,{PaymentId:c.location.pathname.split("/").pop()});if(d.IsEnabled&&"offline"!=f.Status&&"disabled"!=f.Status)if(k.checkWithdrawalOfDeposit&&k.isUserAboveThreshold&&!k.isAgent){var g=locale.account.paymentMethods.deposit.autoDepositDisc.replace("{amount}",k.formatCurrency(k.userBalance));e.showConfirmMessage(g,null,function(){k.action(k.param)},null,null,null,!0)}else k.action(k.param);else{k.isDepositProcessing=!0;var h=k.getUnavailablePaymentMethodMessage(f.PaymentTitle||d.Name);e.showConfirmMessage(h,null,function(){window.location.href="/account/deposit"},null,null,null,!0)}})})},this.init=function(){globalSettings.Account_EnableWithdrawalNudge&&k.getDepositRatio()},k.init()}])}(),function(){angular.module("accountPaymentDepositWithdrawalOffline",[]).controller("DepositWithdrawalsBalancePartialOfflineController",["$filter","$scope","$window","platformApiService","helperService","authService","currencyService",function(a,b,c,d,e,f,g){var h=this;this.isAgent=f.isAgent(),this.checkWithdrawalOfDeposit=!0,this.isUserAboveThreshold=!1,this.formatCurrency=function(a){return h.isDesktop?g.smartFormatNumber(f.getUserData().currency.Currency,"string"==typeof a?parseFloat(a):a,2):g.currencyFormat("string"==typeof a?parseFloat(a).toFixed(2):a.toFixed(2),f.getUserData().currency.Currency)},this.getDepositRatio=function(){d.finance.getUserWithdrawalConfiguration(c.location.pathname.split("/").pop()).then(function(b){b.success?(h.checkWithdrawalOfDeposit=b.data.CheckWithdrawalOfDeposit,h.depositRatio=a("number")(100*b.data.Ratio,2),h.withdrawalWin=b.data.WithdrawalWin,h.isUserAboveThreshold=b.data.UserAboveThreshold):(h.depositRatio=0,h.withdrawalWin=0),h.htmlTextWithDepRto=locale.account.paymentMethods.deposit.autoDepositDisc.replace("{amount}",h.formatCurrency(h.userBalance))})},this.init=function(){globalSettings.Account_EnableWithdrawalNudge&&h.getDepositRatio()},h.init()}])}(),function(){angular.module("apco",[]).controller("ApcoController",["platformApiService","$location","$scope","helperService","$anchorScroll","loggingService","moneyTransferService","authService",function(a,b,c,d,e,f,g,h){var i=this,j=a.paymentVendors.apco,k=a.user;this.nationalIdShow=!1,this.Amount="",this.email="",this.astroPayNationalId="",this.ApcoApi=c.selectedApi,this.ImagePath=c.ImagePath,this.showing=!1,this.isWithdrawal="Withdraw"===c.transferType,this.title="",this.instruction="",this.userDepositLimit=null;var l=globalSettings.Deposit_QuickCashDelimiters.split(",").map(function(a){return parseFloat(a,10)});switch(this.quickValues=_.uniq(_.remove(l,function(a){return!isNaN(a)})),this.setAmount=function(a){this.Amount=a},this.getUserEmail=function(){k.getCurrentUserProfile().then(function(a){return a.success?void(i.email=a.data.UserDetails.Email):void f.logError("Unable to get user emial : "+a.error)})},this.ApcoApi.Identifier){case"ApcoCC":this.title=locale.account.paymentMethods.apco.apcoCC,this.instruction=locale.account.paymentMethods.apco.averyCDCardInstructionsDeposit.partOne+"<br/><br/>"+locale.account.paymentMethods.apco.averyCDCardInstructionsDeposit.partTwo+"<br/><br/>"+locale.account.paymentMethods.apco.averyCDCardInstructionsDeposit.partThree+"<br/><br/>"+locale.account.paymentMethods.apco.averyCDCardInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averyCDCardInstructionsDeposit.partFive+locale.account.paymentMethods.apco.averyCDCardInstructionsDeposit.partSix+locale.account.paymentMethods.apco.averyCDCardInstructionsDeposit.partSeven+"<br/><br/>"+locale.account.paymentMethods.apco.averyCDCardInstructionsDeposit.partEight,i.cardDetails=1,i.nationalIdShow=!1,i.OkUrl=g.getDepositRedirectionURL(),i.NokUrl=g.getDepositRedirectionURL(),this.ApcoApi.image=i.ImagePath.PayPointImage;break;case"ApcoNT":this.title=locale.account.paymentMethods.neteller.title,this.instruction=locale.account.paymentMethods.apco.averyNetellerInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averyNetellerInstructionsDeposit.partTwo+'<a href="http://www.neteller.com" target="_blank">'+locale.account.paymentMethods.apco.averyNetellerInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averyNetellerInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averyNetellerInstructionsDeposit.partFive,i.cardDetails=2,i.nationalIdShow=!1,i.OkUrl=g.getDepositRedirectionURL(),i.NokUrl=g.getDepositRedirectionURL(),this.ApcoApi.image=i.ImagePath.NetellerImage;break;case"ApcoMBKR":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.Skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,i.cardDetails=3,i.nationalIdShow=!1,i.OkUrl=g.getDepositRedirectionURL(),i.NokUrl=g.getDepositRedirectionURL(),this.ApcoApi.image=i.ImagePath.skrillImage;break;case"ApcoAstropayAPCP":this.title=locale.account.paymentMethods.apco.astroPayWithdrawalTitle,this.instruction=locale.account.paymentMethods.apco.astroPayCashPaymentInstructionsDeposit,i.cardDetails=5,i.nationalIdShow=!0,i.OkUrl=g.getDepositRedirectionURL(),i.NokUrl=g.getDepositRedirectionURL(),this.ApcoApi.image=i.ImagePath.AstroPayLogo;break;case"ApcoAstropayAPBO":this.title=locale.account.paymentMethods.apco.astroPayBoletoBancarioTitle,this.instruction=locale.account.paymentMethods.apco.astroPayBoletoBancarioInstructionsDeposit,i.cardDetails=5,i.nationalIdShow=!0,i.OkUrl=g.getDepositRedirectionURL(),i.NokUrl=g.getDepositRedirectionURL(),this.ApcoApi.image=i.ImagePath.AstroPayLogo;break;case"ApcoAstropayAPBT":this.title=locale.account.paymentMethods.apco.astroPayBankTransferTitle,this.instruction=locale.account.paymentMethods.apco.astroPayBankTransferInstructionsDeposit,i.cardDetails=5,i.nationalIdShow=!0,i.OkUrl=g.getDepositRedirectionURL(),i.NokUrl=g.getDepositRedirectionURL(),this.ApcoApi.image=i.ImagePath.AstroPayLogo;break;case"ApcoAstropayASTROPAYCARD":this.title=locale.account.paymentMethods.apco.astroPayWithdrawalTitle,this.instruction=locale.account.paymentMethods.apco.astroPayCardInstructionsDeposit,i.cardDetails=5,i.nationalIdShow=!1,i.OkUrl=g.getDepositRedirectionURL(),i.NokUrl=g.getDepositRedirectionURL(),this.ApcoApi.image=i.ImagePath.AstroPayLogo}this.checkIfDepositIsEnabled=function(){j.isDepositEnabled(i.cardDetails).then(function(a){a.success||(f.logError(a.error),c.canceled(a.userMsg))})},this.checkWithdraw=function(){j.isWithdrawalEnabled(i.cardDetails).then(function(a){a.success||(f.logError(a.error),c.canceled(a.userMsg))})},this.ApcoDepositRequestBindingModel=new gamingAppModels.ApcoDepositRequestBindingModel,this.ApcoRegisterWithdrawRequestBindingModel=new gamingAppModels.ApcoRegisterWithdrawRequestBindingModel,this.LoadApcoFrame=function(){i.ApcoDepositRequestBindingModel.Amount=i.Amount,i.ApcoDepositRequestBindingModel.NationalID=i.astroPayNationalId,i.ApcoDepositRequestBindingModel.PaymentCode=i.cardDetails,i.ApcoDepositRequestBindingModel.OkUrl=i.OkUrl,i.ApcoDepositRequestBindingModel.NokUrl=i.NokUrl,j.getDepositRequestInfo(i.ApcoDepositRequestBindingModel).then(function(a){if(!a.success)return f.logError(a.error,a.userMsg),void d.showErrorMessage(a.Result[0]+"<br/>"+a.userMsg).done();var c=($("#iFrameApco"),$('<form name="apcoForm" id="apcoForm" action="'+a.data.PostUrl+'" method="post" target="output_frame" ></form>'));c.append($("<input>").attr({type:"hidden",name:"params",value:a.data.Payload})),c.appendTo("#divIFrame"),c.submit(),i.showing=!0,$("#output_frame").load(function(){var a=$("#output_frame").contents().get(0).location.href;a.indexOf("OK")!=-1|a.indexOf("accepted")!=-1?(window.location.href=this.contentWindow.location.href,b.path("/accepted")):a.indexOf("DECLINED")!=-1|a.indexOf("canceled")!=-1?(window.location.href=this.contentWindow.location.href,b.path("/canceled")):a.indexOf("#/account/deposit")!=-1&&(window.location.href=this.contentWindow.location.href)}),i.showing=!0})},this.RegisteringWithdrawals=function(){i.ApcoRegisterWithdrawRequestBindingModel.Amount=i.Amount,i.ApcoRegisterWithdrawRequestBindingModel.PaymentCode=i.cardDetails,i.ApcoRegisterWithdrawRequestBindingModel.PaymentCardId=i.PaymentCardId,j.registerWithdraw(i.ApcoRegisterWithdrawRequestBindingModel).then(function(a){if(!a.success||0==a.data){a.error&&f.logError(a.error||a.userMsg,a.error&&a.userMsg);var b=d.handlePlatformError(a);return void(b||d.showErrorMessage(a.Result[0]+"<br/>"+a.userMsg).done())}f.logError(a.error||a.userMsg,a.error&&a.userMsg),d.showSuccessMessage(locale.account.paymentMethods.transactionIsBeingProcessed).done(),c.accepted(a.userMsg,a.error)})},"Deposit"===c.transferType?(i.getUserEmail(),i.checkIfDepositIsEnabled()):"Withdraw"===c.transferType&&i.getUserEmail(),i.checkWithdraw()}])}(),function(){angular.module("bankTransfer",[]).controller("BankTransferController",["platformApiService","$sce","$location","$scope","helperService","$anchorScroll","loggingService",function(a,b,c,d,e,f,g){var h=this,i=a.paymentVendors.bankTransfer;this.bankTransferApi=d.selectedApi,this.ImagePath=d.ImagePath,this.bankTransferApi.image=this.ImagePath.BnkTrsImg,this.Amount=null,this.Bank="",this.AccNum="",this.Name="",this.SortCode="",this.RoutingNo="",this.Swift="",this.IBAN="",this.BankTransferWithdrawRequestBindingModel=new gamingAppModels.BankTransferWithdrawRequestBindingModel,this.BankTransferWithdrawals=function(){h.BankTransferWithdrawRequestBindingModel.Amount=h.Amount,h.BankTransferWithdrawRequestBindingModel.Bank=h.Bank,h.BankTransferWithdrawRequestBindingModel.AccountNumber=h.AccNum,h.BankTransferWithdrawRequestBindingModel.AccountHolder=h.Name,h.BankTransferWithdrawRequestBindingModel.SortCode=h.SortCode,h.BankTransferWithdrawRequestBindingModel.SwiftCode=h.Swift,h.BankTransferWithdrawRequestBindingModel.RoutingNo=h.RoutingNo,h.BankTransferWithdrawRequestBindingModel.IBANCode=h.IBAN,i.registerWithdraw(h.BankTransferWithdrawRequestBindingModel).then(function(a){return a.success&&0!=a.data?void d.onTransferComplete(locale.account.paymentMethods.interswitch.newSuccessfullMessage,a.error||a.userMsg,globalSettings.WithdrawalRedirection,"success"):void(a.error&&d.onTransferComplete(a.error||a.userMsg,a.error||a.userMsg,null,"error"))})},f()}])}(),function(){angular.module("detailsBanking",[]).controller("detailsBankController",["platformApiService","$sce","$location","$scope","helperService","$anchorScroll","loggingService",function(a,b,c,d,e,f,g){var h=this,i=a.user;switch(this.detailsArray=[],this.email="",this.detailsBankApi=d.selectedApi,this.getUserEmail=function(){i.getCurrentUserProfile().then(function(a){return a.success?void(h.email=a.data.UserDetails.Email):void g.logError("Unable to get user emial : "+a.error)})},h.detailsBankApi.Identifier){case"ZenithBankXPathDeposit":this.detailsBankApi.image=globalSettings.SharedResourceURL+"images/paymentMethods/ZenithBankXPathDeposit.png",this.detailsBankApi.title=locale.account.paymentMethods.zenithBank.title,this.detailsBankApi.details=locale.account.paymentMethods.zenithBank.shortDescription,h.detailsArray=[],h.detailsArray=_.values(locale.account.paymentMethods.zenithBank.depositInstructions),h.detailsArray=h.detailsArray.filter(function(a){return" "!=a});break;case"UBADeposit":this.detailsBankApi.image=globalSettings.SharedResourceURL+"images/paymentMethods/UBADeposit.png",this.detailsBankApi.title=locale.account.paymentMethods.uBABank.title,this.detailsBankApi.details=locale.account.paymentMethods.uBABank.shortDescription,h.detailsArray=[],h.detailsArray=_.values(locale.account.paymentMethods.uBABank.depositInstructions),h.detailsArray=h.detailsArray.filter(function(a){return" "!=a});break;case"UBAInternetBanking":this.detailsBankApi.image=globalSettings.SharedResourceURL+"images/paymentMethods/UBAInternetBanking.png",this.detailsBankApi.title=locale.account.paymentMethods.uBAInternetBanking.title,this.detailsBankApi.details=locale.account.paymentMethods.uBAInternetBanking.shortDescription,h.detailsArray=[],h.detailsArray=_.values(locale.account.paymentMethods.uBAInternetBanking.depositInstructions),h.detailsArray=h.detailsArray.filter(function(a){return" "!=a});break;case"GTBUSSD":this.detailsBankApi.image=globalSettings.SharedResourceURL+"images/paymentMethods/GTBUSSD.png",this.detailsBankApi.title=locale.account.paymentMethods.gTBUSSD.title,this.detailsBankApi.details=locale.account.paymentMethods.gTBUSSD.shortDescription,h.detailsArray=[],h.detailsArray=_.values(locale.account.paymentMethods.gTBUSSD.depositInstructions),h.detailsArray=h.detailsArray.filter(function(a){return" "!=a});break;case"SkyeDeposit":this.detailsBankApi.image=globalSettings.SharedResourceURL+"images/paymentMethods/SkyeDeposit.png",this.detailsBankApi.title=locale.account.paymentMethods.skyeDeposit.title,this.detailsBankApi.details=locale.account.paymentMethods.skyeDeposit.shortDescription,h.detailsArray=[],h.detailsArray=_.values(locale.account.paymentMethods.skyeDeposit.depositInstructions),h.detailsArray=h.detailsArray.filter(function(a){return" "!=a});break;case"GTCollections":this.detailsBankApi.image=globalSettings.SharedResourceURL+"images/paymentMethods/GTCollections.png",this.detailsBankApi.title=locale.account.paymentMethods.gTCollections.title,this.detailsBankApi.details=locale.account.paymentMethods.gTCollections.shortDescription,h.detailsArray=[],h.detailsArray=_.values(locale.account.paymentMethods.gTCollections.depositInstructions),h.detailsArray=h.detailsArray.filter(function(a){return" "!=a});break;case"BanksInstantDeposit":this.detailsBankApi.image=globalSettings.SharedResourceURL+"images/paymentMethods/BanksInstantDeposit.png",this.detailsBankApi.title=locale.account.paymentMethods.banksInstantDeposit.title,this.detailsBankApi.details=locale.account.paymentMethods.banksInstantDeposit.shortDescription,h.detailsArray=[],h.detailsArray=_.values(locale.account.paymentMethods.banksInstantDeposit.depositInstructions),h.detailsArray=h.detailsArray.filter(function(a){return" "!=a})}h.getUserEmail(),f()}])}(),function(){angular.module("dummyDeposit",[]).controller("dummyDepositController",["platformApiService","$scope","$rootScope","$location","$sce","helperService","$anchorScroll","loggingService",function(a,b,c,d,e,f,g,h){var i=this,j=a.paymentVendors.dummyDeposit;this.dummyDepositApi=b.selectedApi,this.Amount=null,this.title=locale.account.paymentMethods.dummyDeposit.title,this.instruction="Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.",this.loadDummyDeposit=function(){j.performDeposit(i.Amount).then(function(a){return a.success?void b.onTransferComplete(a.userMsg,a.success||a.userMsg,null,"success"):void b.onTransferComplete(a.userMsg,a.error||a.userMsg,null,"error")})}}])}(),function(){angular.module("ecopayz",[]).controller("ecopayzController",["platformApiService","$scope","$rootScope","$location","$sce","helperService","$anchorScroll","loggingService","moneyTransferService",function(a,b,c,d,e,f,g,h,i){var j=this,k=a.paymentVendors.ecopayz;switch(this.ecopayApi=b.selectedApi,this.iFreamPath="",this.ecopayzAcc=j.ecopayzAcc,this.ImagePath=b.ImagePath,this.Amount=null,this.showing=j.showing,j.showing=!1,this.userDepositLimit=null,this.title="",this.instruction="",this.ecopayApi.Identifier){case"EcoPayzRegularDeposit":this.title=locale.account.paymentMethods.ecopayz.title,this.instruction=locale.account.paymentMethods.ecopayz.ecopayzInstructionsDeposit.partOne,this.ecopayApi.image=j.ImagePath.ecopayzImage;break;case"EcoPayzRegularWithdrawal":this.title=locale.account.paymentMethods.ecopayz.title,this.ecopayApi.image=j.ImagePath.ecopayzImage}this.checkIfDepositIsEnabled=function(){k.isDepositEnabled().then(function(a){a.success||(h.logError(a.error),b.canceled(a.userMsg))})},this.checkWithdraw=function(){k.isWithdrawalEnabled().then(function(a){a.success||b.onTransferComplete(a.userMsg,a.error,globalSettings.WithdrawalRedirection,"error")}),k.getEcopayzAcc().then(function(a){return a.success?(j.ecopayzAcc=a.data,null==j.ecopayzAcc?void b.onTransferComplete(locale.account.paymentMethods.neteller.netellerNotRegistered,locale.account.paymentMethods.neteller.netellerNotRegistered,globalSettings.WithdrawalRedirection,"info"):void 0):void b.onTransferComplete(a.userMsg,a.error,globalSettings.WithdrawalRedirection,"error")})},this.EcoPayzDepositRequestBindingModel=new gamingAppModels.EcoPayzRequestBindingModel,this.EcoPayzWithdrawRequestBindingModel=new gamingAppModels.EcoPayzRequestBindingModel,this.loadecopayzIFrame=function(){j.EcoPayzDepositRequestBindingModel.Amount=j.Amount,j.EcoPayzDepositRequestBindingModel.PaymentMethod=j.ecopayApi.Identifier,j.EcoPayzDepositRequestBindingModel.OnSuccessUrl=i.getDepositRedirectionURL(),j.EcoPayzDepositRequestBindingModel.OnFailureUrl=i.getDepositRedirectionURL(),j.EcoPayzDepositRequestBindingModel.CancellationUrl=i.getDepositRedirectionURL(),j.EcoPayzDepositRequestBindingModel.CallbackUrl=i.getDepositRedirectionURL(),j.iFramePath=e.trustAsResourceUrl(encodeURI("")),k.getDepositRequestInfo(j.EcoPayzDepositRequestBindingModel).then(function(a){return a.success?void(window.location.href=a.data):void b.onTransferComplete(a.Result[0]+"<br/>"+a.userMsg,a.error||a.userMsg,null,"error")})},this.RegisteringWithdrawals=function(){j.EcoPayzWithdrawRequestBindingModel.Amount=j.Amount,j.EcoPayzWithdrawRequestBindingModel.PaymentMethod=j.ecopayApi.Identifier,j.EcoPayzWithdrawRequestBindingModel.OnSuccessUrl="",j.EcoPayzWithdrawRequestBindingModel.OnFailureUrl="",j.EcoPayzWithdrawRequestBindingModel.CancellationUrl="",j.EcoPayzWithdrawRequestBindingModel.CallbackUrl="",k.registerWithdraw(j.EcoPayzWithdrawRequestBindingModel).then(function(a){return a.success&&0!=a.data?void b.onTransferComplete(locale.account.paymentMethods.transactionIsBeingProcessed,a.error||a.userMsg,globalSettings.WithdrawalRedirection,"success"):void(a.error&&b.onTransferComplete(a.Result[0]+"<br/>"+a.userMsg,a.error||a.userMsg,globalSettings.WithdrawalRedirection,"error"))})},"Deposit"===b.transferType?j.checkIfDepositIsEnabled():"Withdraw"===b.transferType&&j.checkWithdraw()}])}(),function(){angular.module("epg",[]).controller("epgController",["platformApiService","$scope","$rootScope","$location","$sce","helperService","$anchorScroll","loggingService","$timeout","moneyTransferService",function(a,b,c,d,e,f,g,h,i,j){var k=this,l=a.paymentVendors.epg;this.epgApi=b.selectedApi,this.Amount=null,this.userDepositLimit=null,this.showing=k.showing,this.ImagePath=b.ImagePath,this.CADAmountConvertedValue,this.ReturnURL=d.absUrl().split("?")[0];var m=d.search().return,n="";if(m){switch(m){case"Success":m="success",n='<style type="text/css">a.contentMessagePrintBtn{float:right;margin-top:-40px;background:#59a544;color:#fff;padding:5px;text-decoration:none;}div.contentMessageText{margin-left: 40px;text-align: left;}@media print{#divMainContainer,a.contentMessagePrintBtn{display:none}.message-box{visibility:visible;border:1px solid #000}}</style>',n+='The transaction was successful. <br><br><div class="contentMessageText">',n=n+"Confirmation No:&nbsp<strong>"+d.search().issconf+"</strong><br>",n=n+"Transaction ID:&nbsp<strong>"+d.search().referralTransactionID+"</strong><br>",n=n+"Interac Transaction ID:&nbsp<strong>"+d.search().transactionId+"</strong><br>",n=n+"Financial Institution:&nbsp<strong>"+d.search().issname+"</strong><br>",n=n+"Currency:&nbsp<strong>"+d.search().currency+"</strong><br>",n=n+"Amount:&nbsp<strong>"+d.search().amount+"</strong><br>",n=n+"Date:&nbsp<strong>"+moment(d.search().datetime).format("YYYY-MM-DD")+"</strong><br>",n=n+"Time:&nbsp<strong>"+moment(d.search().datetime).format("HH:mm:ss")+"</strong><br></div>",n+='<br> <a class="contentMessagePrintBtn" href="javascript:window.print();" ><i class="fa fa-print"></i> Print </a>';break;default:m="error",n="Your Transaction was not completed."}d.url(k.ReturnURL),j.onTransferComplete(n,n,null,m)}switch(k.showing=!1,this.EPGRequestBindingModel=new gamingAppModels.EPGRequestBindingModel,this.epgApi.Identifier){case"EPGDeposit":this.title=locale.account.paymentMethods.epg.title+" "+locale.account.paymentMethods.deposit.menuTitle,this.instruction=locale.account.paymentMethods.epg.epgInstructionsDeposit.partOne+"<br/><br/>"+locale.account.paymentMethods.epg.epgInstructionsDeposit.partTwo+"<br/>",this.epgApi.image=k.ImagePath.epgImage,this.epgApi.isInterac=!1;break;case"EPGWithdrawal":this.title=locale.account.paymentMethods.epg.title+" "+locale.account.paymentMethods.withdrawal.title,
this.epgApi.image=k.ImagePath.epgImage,this.epgApi.isInterac=!1;break;case"InteracDepositByEPG":this.title=locale.account.paymentMethods.epg.interac.titleDeposit,this.instruction=locale.account.paymentMethods.epg.interac.epgInstructionsDeposit.partOne+"<br/><br/>"+locale.account.paymentMethods.epg.interac.epgInstructionsDeposit.partTwo+"<br/>",this.epgApi.isInterac=!0,this.epgApi.image=k.ImagePath.interacEpgImage;break;case"InteracWithdrawalByEPG":this.title=locale.account.paymentMethods.epg.interac.titleWithdrawal,this.instruction=locale.account.paymentMethods.epg.interac.epgInstructionsDeposit.partOne+"<br/><br/>"+locale.account.paymentMethods.epg.interac.epgInstructionsDeposit.partTwo+"<br/>",this.epgApi.isInterac=!0,this.epgApi.image=k.ImagePath.interacEpgImage}this.depositEnabled=function(){l.isDepositEnabled().then(function(a){a.success&&0!=a.data||(a.error||h.logError(a.error),b.canceled(a.userMsg))})},this.withdrawalEnabled=function(){l.isWithdrawalEnabled().then(function(a){a.success&&0!=a.data||(a.error||h.logError(a.error),b.canceled(a.userMsg))})},this.performAmountCadConversion=function(){l.interacDepositExchange(k.Amount).then(function(a){if(!a.success){h.logError(a.error),b.canceled(a.userMsg);var c=f.handlePlatformError(a);return void(c||f.showErrorMessage(a.userMsg).done())}k.CADAmountConvertedValue=a.data.AmountInInteracCurrency})},this.performAmountCadConversionWithdrawal=function(){l.interacWithdrawalExchange(k.Amount).then(function(a){if(!a.success){h.logError(a.error),b.canceled(a.userMsg);var c=f.handlePlatformError(a);return void(c||f.showErrorMessage(a.userMsg).done())}k.CADAmountConvertedValue=a.data.AmountInInteracCurrency})},this.performEPGDeposit=function(){k.iFramePath=e.trustAsResourceUrl(encodeURI("")),k.EPGRequestBindingModel.Amount=k.Amount,k.EPGRequestBindingModel.SuccessUrl=j.getDepositRedirectionURL()+"?return=Success",k.EPGRequestBindingModel.ErrorUrl=j.getDepositRedirectionURL()+"?return=Error",k.EPGRequestBindingModel.CancelledUrl=j.getDepositRedirectionURL()+"?return=Cancelled",l.getDepositURL(k.EPGRequestBindingModel).then(function(a){if(!a.success){h.logError(a.error),b.canceled(a.userMsg);var c=f.handlePlatformError(a);return void(c||f.showErrorMessage(a.userMsg).done())}var d=($("#iFrameDeposit"),$('<form name="paymentForm" id="paymentForm" action="'+a.data+'" method="post" target="output_frame" ></form>'));d.appendTo("#divIFrame"),d.submit(),k.Amount=null,k.showing=!0,$("#output_frame").on("load",function(){var c=$("#output_frame").contents().get(0).location.href;c.indexOf("?return=Success")!=-1?(k.showing=!1,b.onTransferComplete(locale.account.paymentMethods.deposit.acceptInformationNote,a.error||a.userMsg,globalSettings.DepositRedirection,"success")):c.indexOf("?return=Error")!=-1|c.indexOf("?return=Cancelled")!=-1&&(k.showing=!1,b.onTransferComplete(locale.account.paymentMethods.deposit.canceledInformationNote,a.error||a.userMsg,null,"error"))})})},this.performInteracDeposit=function(){return k.userDepositLimit!=-1&&k.userDepositLimit<k.Amount?(f.showErrorMessage(locale.account.paymentMethods.depositLimitRemaining+k.userDepositLimit).done(),void(k.Amount=k.userDepositLimit)):(k.iFramePath=e.trustAsResourceUrl(encodeURI("")),k.EPGRequestBindingModel.Amount=k.Amount,k.EPGRequestBindingModel.SuccessUrl=d.absUrl()+"?return=Success",k.EPGRequestBindingModel.ErrorUrl=d.absUrl()+"?return=Error",k.EPGRequestBindingModel.CancelledUrl=d.absUrl()+"?return=Cancelled",void l.getInteracDepositUrl(k.EPGRequestBindingModel).then(function(a){if(!a.success){h.logError(a.error),b.canceled(a.userMsg);var c=f.handlePlatformError(a);return void(c||f.showErrorMessage(a.userMsg).done())}var d=($("#iFrameDeposit"),$('<form name="paymentForm" id="paymentForm" action="'+a.data+'" method="post" target="output_frame" ></form>'));d.appendTo("#divIFrame"),d.submit(),k.Amount=null,k.showing=!0,$("#output_frame").on("load",function(){var c=$("#output_frame").contents().get(0).location.href;c.indexOf("?return=Success")!=-1?(k.showing=!1,b.onTransferComplete(locale.account.paymentMethods.deposit.acceptInformationNote,a.error||a.userMsg,globalSettings.DepositRedirection,"success")):c.indexOf("?return=Error")!=-1|c.indexOf("?return=Cancelled")!=-1&&(k.showing=!1,b.onTransferComplete(locale.account.paymentMethods.deposit.canceledInformationNote,a.error||a.userMsg,null,"error"))})}))},this.performEPGWithdraw=function(){k.EPGRequestBindingModel.Amount=k.Amount,k.EPGRequestBindingModel.SuccessUrl=d.absUrl()+"?return=Success",k.EPGRequestBindingModel.ErrorUrl=d.absUrl()+"?return=Error",k.EPGRequestBindingModel.CancelledUrl=d.absUrl()+"?return=Cancelled",l.registerWithdraw(k.EPGRequestBindingModel).then(function(a){if(!a.success){h.logError(a.error),b.canceled(a.userMsg);var c=f.handlePlatformError(a);return void(c||f.showErrorMessage(a.userMsg).done())}var d=($("#iFrameWithdraw"),$('<form name="paymentForm" id="paymentForm" action="'+a.data+'" method="post" target="output_frame" ></form>'));d.appendTo("#divIFrame"),d.submit(),k.Amount=null,k.showing=!0,$("#output_frame").on("load",function(){var c=$("#output_frame").contents().get(0).location.href;c.indexOf("?return=Success")!=-1?(k.showing=!1,b.onTransferComplete(locale.account.paymentMethods.epg.successWithdrawalMessage,a.error||a.userMsg,null,"success")):c.indexOf("?return=Error")!=-1|c.indexOf("?return=Cancelled")!=-1&&(k.showing=!1,b.onTransferComplete(locale.account.paymentMethods.deposit.canceledInformationNote,a.error||a.userMsg,null,"error"))}),k.showing=!0})},this.performInteracWithdraw=function(){k.EPGRequestBindingModel.Amount=k.Amount,k.EPGRequestBindingModel.SuccessUrl=j.getWithdrawalRedirectionURL()+"?return=Success",k.EPGRequestBindingModel.ErrorUrl=j.getWithdrawalRedirectionURL()+"?return=Error",k.EPGRequestBindingModel.CancelledUrl=j.getWithdrawalRedirectionURL()+"?return=Cancelled",l.getInteracWithdrawUrl(k.EPGRequestBindingModel).then(function(a){if(!a.success){h.logError(a.error),b.canceled(a.userMsg);var c=f.handlePlatformError(a);return void(c||f.showErrorMessage(a.userMsg).done())}var d=($("#iFrameWithdraw"),$('<form name="paymentForm" id="paymentForm" action="'+a.data+'" method="post" target="output_frame" ></form>'));d.appendTo("#divIFrame"),d.submit(),k.Amount=null,k.showing=!0,$("#output_frame").on("load",function(){var c=$("#output_frame").contents().get(0).location.href;c.indexOf("?return=Success")!=-1?(k.showing=!1,b.onTransferComplete(locale.account.paymentMethods.epg.successWithdrawalMessage,a.error||a.userMsg,null,"success")):c.indexOf("?return=Error")!=-1|c.indexOf("?return=Cancelled")!=-1&&(k.showing=!1,b.onTransferComplete(locale.account.paymentMethods.deposit.canceledInformationNote,a.error||a.userMsg,null,"error"))}),k.showing=!0})},g()}])}(),function(){angular.module("gtPay",[]).controller("GTPayController",["$scope","$location","platformApiService","helperService","$anchorScroll","loggingService",function(a,b,c,d,e,f){var g=this,h=c.paymentVendors.gtPay,i=c.user;this.gtPayApi=a.selectedApi,this.gtPayApi.image=a.ImagePath.GTBank,this.userDepositLimit=null,this.Amount="",this.email="",this.showing=!1,this.ReturnURL=b.absUrl().split("?")[0];var j=b.search().txStatusCode,k=b.search().txStatusMessage,l="",m=globalSettings.Deposit_QuickCashDelimiters.split(",").map(function(a){return parseFloat(a,10)});if(this.quickValues=_.uniq(_.remove(m,function(a){return!isNaN(a)})),this.setAmount=function(a){this.Amount=a},this.getUserEmail=function(){i.getCurrentUserProfile().then(function(a){return a.success?void(g.email=a.data.UserDetails.Email):void f.logError("Unable to get user emial : "+a.error)})},j){switch(j){case"00":case"0":j="success",l="Your Transaction was successful. <br>Reason : "+(k?k:"unknown")+"<br>";break;case"-99":j="info",l="Your Transaction is in process. <br>Reason : "+(k?k:"unknown")+"<br>";break;default:j="error",l="Your Transaction was not successful. <br>Reason : "+(k?k:"unknown")+"<br>"}a.onTransferComplete(l,k,null,j)}switch(this.gtPayApi.Identifier){case"GTPay":this.title=locale.account.paymentMethods.gTBank.accountInstructions.gTPay.title,this.gtPayApi.details=locale.account.paymentMethods.gTBank.accountInstructions.gTPay.details,this.gtPayApi.image=globalSettings.SharedResourceURL+"images/paymentMethods/GTPay.png"}this.GTPayRegisterDepositRequestModel=new gamingAppModels.GTPayRegisterDepositRequestModel,this.depositEnabled=function(){h.isDepositEnabled().then(function(b){if(!b.success||0==b.data){b.error||f.logError(b.error);var c=d.handlePlatformError(b);c||d.showErrorMessage(b.userMsg).done(),a.canceled(b.userMsg)}})},this.registerGTPayDirect=function(){g.GTPayRegisterDepositRequestModel.Amount=g.Amount,g.GTPayRegisterDepositRequestModel.ReturnURL=g.ReturnURL,h.registerDeposit(g.GTPayRegisterDepositRequestModel).then(function(a){if(!a.success||0==a.data){a.error&&f.logError(a.error||a.userMsg,a.error&&a.userMsg);var b=d.handlePlatformError(a);return void(b||d.showErrorMessage(a.userMsg).done())}var c=($("#iFrameGTPay"),$('<form name="iFrameGTPay" id="iFrameGTPay" action="'+globalSettings.Deposit_GTBankURL+'" method="post" target="_self"></form>'));for(property in a.data)c.append($("<input>").attr({type:"hidden",name:property,value:a.data[property]}));c.appendTo("#divIFrame"),c.submit()})},g.getUserEmail(),e()}])}(),function(){angular.module("interswitch",[]).controller("interswitchController",["platformApiService","$sce","$location","$timeout","$scope","helperService","$anchorScroll","loggingService",function(a,b,c,d,e,f,g,h){var i=this,j=a.paymentVendors.interswitch;this.interSwitchApi=e.selectedApi;var k=a.user;this.email="",this.Amount=null,this.ImagePath=e.ImagePath,this.showing=!1,this.showingAmount=!1,this.showingbankDetails=!1,this.paymentMethod="",this.siteRedirectUrl="",this.isWithdrawal="Withdraw"===e.transferType,this.title="",this.successMessage="",this.instruction={},this.userDepositLimit=null,this.nubanNumber="",this.bankDetails={},this.selectedBank=i.selectedBank;var l=globalSettings.Deposit_QuickCashDelimiters.split(",").map(function(a){return parseFloat(a,10)});this.quickValues=_.uniq(_.remove(l,function(a){return!isNaN(a)})),this.setAmount=function(a){this.Amount=a},this.getUserEmail=function(){k.getCurrentUserProfile().then(function(a){return a.success?void(i.email=a.data.UserDetails.Email):void h.logError("Unable to get user emial : "+a.error)})},console.log(c.search());var m=c.search().interswitchwebpayresp,n=c.search().txReference,o=c.search().message,p="";if(m){switch(m){case"1":m="success",p="Your Transaction was successful. <br>Reason : "+o+"<br>Transaction Reference : "+n;break;case"0":m="info",p="Your Transaction is in process. <br>Reason : "+o+"<br>Transaction Reference : "+n;break;case"-1":m="error",p="Your Transaction was not successful. <br>Reason : "+o+"<br>Transaction Reference : "+n}e.onTransferComplete(p,o,null,m)}switch(i.interSwitchApi.Identifier){case"InterswitchWebpayDirectDeposit":this.title=locale.account.paymentMethods.interswitch.title,this.instruction.partOne=locale.account.paymentMethods.interswitch.accountInstructions.webPay.partOne,this.instruction.partTwo=locale.account.paymentMethods.interswitch.accountInstructions.webPay.partTwo,this.instruction.partThree=locale.account.paymentMethods.interswitch.accountInstructions.webPay.partThree,this.instruction.partFour=locale.account.paymentMethods.interswitch.accountInstructions.webPay.partFour,this.instruction.partFive=locale.account.paymentMethods.interswitch.accountInstructions.webPay.partFive,this.instruction.partSix=locale.account.paymentMethods.interswitch.accountInstructions.webPay.partSix,this.interSwitchApi.subTitle=locale.account.paymentMethods.interswitch.accountInstructions.webPay.subTitle,this.interSwitchApi.image=i.ImagePath.InterswitchApiWebpay,this.showingAmount=!0,i.siteRedirectUrl=c.absUrl().split("?")[0];break;case"InterswitchBankDeposit":this.title=locale.account.paymentMethods.interswitch.title,this.instruction.partOne=locale.account.paymentMethods.interswitch.accountInstructions.bankDeposit.partOne,this.instruction.partTwo=locale.account.paymentMethods.interswitch.accountInstructions.bankDeposit.partTwo,this.instruction.partThree=locale.account.paymentMethods.interswitch.accountInstructions.bankDeposit.partThree,this.instruction.partFour=locale.account.paymentMethods.interswitch.accountInstructions.bankDeposit.partFour,this.instruction.partFive=locale.account.paymentMethods.interswitch.accountInstructions.bankDeposit.partFive,this.instruction.partSix=locale.account.paymentMethods.interswitch.accountInstructions.bankDeposit.partSix,this.instruction.partSeven=locale.account.paymentMethods.interswitch.accountInstructions.bankDeposit.partSeven,this.instruction.partEight=locale.account.paymentMethods.interswitch.accountInstructions.bankDeposit.partEight,this.instruction.partNine=locale.account.paymentMethods.interswitch.accountInstructions.bankDeposit.partNine,this.instruction.partTen=locale.account.paymentMethods.interswitch.accountInstructions.bankDeposit.partTen,this.instruction.partEleven=locale.account.paymentMethods.interswitch.accountInstructions.bankDeposit.partEleven,this.instruction.partTwelve=locale.account.paymentMethods.interswitch.accountInstructions.bankDeposit.partTwelve,this.instruction.partThirteen=locale.account.paymentMethods.interswitch.accountInstructions.bankDeposit.partThirteen,this.interSwitchApi.subTitle=locale.account.paymentMethods.interswitch.accountInstructions.bankDeposit.subTitle,this.interSwitchApi.image=i.ImagePath.InterswitchApiBankTransfer,this.showingAmount=!1;break;case"InterswitchATMTransferDeposit":this.title=locale.account.paymentMethods.interswitch.title,this.instruction.partOne=locale.account.paymentMethods.interswitch.accountInstructions.ATMTransfer.partOne,this.instruction.partTwo=locale.account.paymentMethods.interswitch.accountInstructions.ATMTransfer.partTwo,this.instruction.partThree=locale.account.paymentMethods.interswitch.accountInstructions.ATMTransfer.partThree,this.instruction.partFour=locale.account.paymentMethods.interswitch.accountInstructions.ATMTransfer.partFour,this.instruction.partFive=locale.account.paymentMethods.interswitch.accountInstructions.ATMTransfer.partFive,this.instruction.partSix=locale.account.paymentMethods.interswitch.accountInstructions.ATMTransfer.partSix,this.instruction.partSeven=locale.account.paymentMethods.interswitch.accountInstructions.ATMTransfer.partSeven,this.instruction.partEight=locale.account.paymentMethods.interswitch.accountInstructions.ATMTransfer.partEight,this.instruction.partNine=locale.account.paymentMethods.interswitch.accountInstructions.ATMTransfer.partNine,this.interSwitchApi.subTitle=locale.account.paymentMethods.interswitch.accountInstructions.ATMTransfer.subTitle,this.interSwitchApi.image=i.ImagePath.InterswitchApiAtm,this.showingAmount=!1;break;case"InterswitchQuickTellerWeb":this.title=locale.account.paymentMethods.interswitch.title,this.instruction.partOne=locale.account.paymentMethods.interswitch.accountInstructions.quicktellerWeb.partOne,this.instruction.partTwo=locale.account.paymentMethods.interswitch.accountInstructions.quicktellerWeb.partTwo,this.instruction.partThree=locale.account.paymentMethods.interswitch.accountInstructions.quicktellerWeb.partThree,this.instruction.partFour=locale.account.paymentMethods.interswitch.accountInstructions.quicktellerWeb.partFour,this.instruction.partFive=locale.account.paymentMethods.interswitch.accountInstructions.quicktellerWeb.partFive,this.instruction.partSix=locale.account.paymentMethods.interswitch.accountInstructions.quicktellerWeb.partSix,this.instruction.partSeven=locale.account.paymentMethods.interswitch.accountInstructions.quicktellerWeb.partSeven,this.instruction.partEight=locale.account.paymentMethods.interswitch.accountInstructions.quicktellerWeb.partEight,this.instruction.partNine=locale.account.paymentMethods.interswitch.accountInstructions.quicktellerWeb.partNine,this.interSwitchApi.subTitle=locale.account.paymentMethods.interswitch.accountInstructions.quicktellerWeb.subTitle,this.interSwitchApi.image=i.ImagePath.InterswitchApiQuickteller,this.showingAmount=!1;break;case"InterswitchQuickTellerWithdrawal":this.title=locale.account.paymentMethods.withdrawal.title,this.interSwitchApi.subTitle=locale.account.paymentMethods.interswitch.accountInstructions.quickteller.subTitle,this.interSwitchApi.image=i.ImagePath.InterswitchApiQuickteller,this.paymentMethod="InterswitchQuickTellerWithdrawal",this.showingbankDetails=!0,this.showingAmount=!0,i.successMessage=locale.account.paymentMethods.interswitch.newSuccessfullMessage;break;case"InterswitchCardLessATMCashWithdrawal":this.title=locale.account.paymentMethods.withdrawal.title,this.interSwitchApi.subTitle=locale.account.paymentMethods.interswitch.accountInstructions.ATMCashWithdrawal.subTitle,this.interSwitchApi.image=i.ImagePath.InterswitchApiAtm,this.paymentMethod="InterswitchCardLessATMCashWithdrawal",this.showingbankDetails=!1,this.showingAmount=!0,i.successMessage=locale.account.paymentMethods.interswitch.successAtmMessage}this.InterswitchWithdrawRequestBindingModel=new gamingAppModels.InterswitchWithdrawRequestBindingModel,this.InterswitchWebPayDirectDepositRequestBindingModel=new gamingAppModels.InterswitchWebPayDirectDepositRequestBindingModel,this.InterswitchWebPayDirectDepositConfirmationBindingModel=new gamingAppModels.InterswitchWebPayDirectDepositConfirmationBindingModel,this.depositEnabled=function(){j.depositEnabled().then(function(a){if(!a.success||0==a.data){a.error||h.logError(a.error);var b=f.handlePlatformError(a);b||f.showErrorMessage(a.userMsg).done(),e.canceled(a.userMsg)}})},this.withdrawalEnabled=function(){j.withdrawalEnabled().then(function(a){if(!a.success||0==a.data){a.error||h.logError(a.error);var b=f.handlePlatformError(a);b||f.showErrorMessage(a.userMsg).done(),e.canceled(a.userMsg)}})},this.getBankDetails=function(){j.getQuicktellerWithdrawalInfo().then(function(a){if(!a.success||0==a.data){a.error||h.logError(a.error);var b=f.handlePlatformError(a);b||f.showErrorMessage(a.userMsg).done(),e.canceled(a.userMsg)}i.bankDetails=a.data.BankDetails,i.nubanNumber=a.data.AccountNumberForQuicktellerWithdrawal;for(var c=0;c<i.bankDetails.length;c++)i.bankDetails[c].Id==a.data.BankIdForQuicktellerWithdrawal&&(i.selectedBank=i.bankDetails[c]);i.withdrawalEnabled()})},this.registerWebPayDirect=function(){i.InterswitchWebPayDirectDepositRequestBindingModel.Amount=i.Amount,i.InterswitchWebPayDirectDepositRequestBindingModel.SiteRedirectUrl=i.siteRedirectUrl,j.registerWebPayDirect(i.InterswitchWebPayDirectDepositRequestBindingModel).then(function(a){if(!a.success||0==a.data){a.error&&h.logError(a.error||a.userMsg,a.error&&a.userMsg);var b=f.handlePlatformError(a);return void(b||f.showErrorMessage(a.userMsg).done())}var c=($("#iFrameinterSwitch"),$('<form name="iFrameinterSwitch" id="iFrameinterSwitch" action="'+a.data.IFrameUrl+'" method="post" target="_self" ></form>'));for(property in a.data)c.append($("<input>").attr({type:"hidden",name:property,value:a.data[property]}));c.appendTo("#divIFrame"),c.submit()})},this.interswitchWithdrawals=function(){i.InterswitchWithdrawRequestBindingModel.Amount=i.Amount,i.InterswitchWithdrawRequestBindingModel.PaymentMethod=i.paymentMethod,i.showingbankDetails===!0&&(i.InterswitchWithdrawRequestBindingModel.AccountNumberForQuicktellerWithdrawal=i.nubanNumber,i.InterswitchWithdrawRequestBindingModel.BankIdForQuicktellerWithdrawal=i.selectedBank.Id),j.registerWithdraw(i.InterswitchWithdrawRequestBindingModel).then(function(a){if(!a.success||0==a.data){a.error&&h.logError(a.error||a.userMsg,a.error&&a.userMsg);var b=f.handlePlatformError(a);return void(b||f.showErrorMessage(a.userMsg).done())}h.logError(a.error||a.userMsg,a.error&&a.userMsg),f.showSuccessMessage(a.userMsg+i.successMessage).done(),e.accepted(a.userMsg,a.error)})},"Deposit"===e.transferType?i.depositEnabled():"Withdraw"===e.transferType&&("InterswitchQuickTellerWithdrawal"===this.interSwitchApi.Identifier?i.getBankDetails():i.withdrawalEnabled()),this.toggleFiltersContainer=function(){this.containerVisible=!this.containerVisible},i.getUserEmail(),g()}])}(),function(){angular.module("neteller",[]).controller("NetellerCtrl",["platformApiService","$location","$scope","$rootScope","helperService","$anchorScroll","loggingService",function(a,b,c,d,e,f,g){var h=this;this.NetellerApi=c.selectedApi;var i=a.paymentVendors.neteller;this.ImagePath=c.ImagePath,this.NetellerApi.image=this.ImagePath.NetellerImage,this.AuthenticationCode="",this.Amount="",this.UserSecureId="",this.AccountId="",this.userAccountId="",this.Email={},this.linkLabel=null,this.accountChanger=!0,this.userDepositLimit=null,this.checkDeposit=function(){i.isDepositEnabled().then(function(a){return a.success?void h.checkRegistration():void c.onTransferComplete(a.error||a.userMsg,a.error||a.userMsg,globalSettings.GlobalRedirection,"error")})},this.setAmount=function(a){this.Amount=a};var j=globalSettings.Deposit_QuickCashDelimiters.split(",").map(function(a){return parseFloat(a,10)});this.quickValues=_.uniq(_.remove(j,function(a){return!isNaN(a)})),this.checkRegistration=function(){i.isUserRegistered().then(function(a){if(!a.success){g.logError(a.error);var b=e.handlePlatformError(a);return void(b||e.showErrorMessage(a.userMsg).done())}a.data.IsRegistered?(a.data.AccountDetails.AccountId&&a.data.AccountDetails.EmailAddress?h.Email=a.data.AccountDetails.EmailAddress+" : "+a.data.AccountDetails.AccountId:a.data.AccountDetails.EmailAddress?h.Email=a.data.AccountDetails.EmailAddress:a.data.AccountDetails.AccountId&&(h.Email=a.data.AccountDetails.AccountId),h.AccountId=a.data.AccountDetails.AccountId||a.data.AccountDetails.EmailAddress):"Deposit"===c.transferType?h.registerDetails():c.onTransferComplete(locale.account.paymentMethods.neteller.netellerNotRegistered,a.error||a.userMsg,globalSettings.WithdrawalRedirection,"info")})},this.registerDetails=function(){h.accountChanger=!1,i.externalRegistrationDetails().then(function(a){return a.success?void(h.linkLabel=a.data.URL):void g.logError(a.error)})},this.NetellerDepositRequestBindingModel=new gamingAppModels.NetellerDepositRequestBindingModel,this.PerformDeposit=function(){null!=h.AccountId&&h.AccountId.trim().length>0?h.NetellerDepositRequestBindingModel.NetellerAccountIdentifier=h.AccountId:h.NetellerDepositRequestBindingModel.NetellerAccountIdentifier=h.userAccountId,h.NetellerDepositRequestBindingModel.Amount=h.Amount,h.NetellerDepositRequestBindingModel.UserSecureId=h.UserSecureId,h.NetellerDepositRequestBindingModel.PaymentMethod=this.NetellerApi.Identifier,i.performDeposit(h.NetellerDepositRequestBindingModel).then(function(a){return a.success&&0!=a.data?void c.onTransferComplete(a.error||a.userMsg,a.error||a.userMsg,globalSettings.DepositRedirection,"success"):void(a.error&&c.onTransferComplete(a.error||a.userMsg,a.error||a.userMsg,globalSettings.DepositRedirection,"error"))})},this.performWithdrawal=function(){i.performWithdrawal(h.Amount).then(function(a){return a.success&&0!=a.data?(c.onTransferComplete(locale.account.paymentMethods.transactionIsBeingProcessed,a.error||a.userMsg,globalSettings.WithdrawalRedirection,"success"),void h.pageRedirect()):void(a.error&&c.onTransferComplete(a.error||a.userMsg,a.error||a.userMsg,globalSettings.WithdrawalRedirection,"error"))})},"Deposit"===c.transferType?h.checkDeposit():"Withdraw"===c.transferType&&h.checkRegistration(),f()}])}(),function(){angular.module("paypoint",[]).controller("PayPointController",["$scope","platformApiService","$location","helperService","$anchorScroll","loggingService","moneyTransferService",function(a,b,c,d,e,f,g){var h=this,i=b.paymentVendors.paypoint,j=b.user;this.PayPointApi=a.selectedApi,this.ImagePath=a.ImagePath,this.PayPointApi.image=this.ImagePath.PayPointImage,this.CARDS=[],this.CARD=null,this.confirmPassword="",this.Amount="",this.email="",this.useExistingCard=!1,this.canUserAddNewCard=!0,this.hasRegisteredCard=!1,this.userDepositLimit=null,this.showing=h.showing;var k=globalSettings.Deposit_QuickCashDelimiters.split(",").map(function(a){return parseFloat(a,10)});this.quickValues=_.uniq(_.remove(k,function(a){return!isNaN(a)})),this.setAmount=function(a){this.Amount=a},this.getUserEmail=function(){j.getCurrentUserProfile().then(function(a){return a.success?void(h.email=a.data.UserDetails.Email):void f.logError("Unable to get user emial : "+a.error)})},this.isWithdrawal="Withdraw"===a.transferType,h.showing=!1,this.Width="200px",this.checkIfDepositIsEnabled=function(){i.isDepositEnabled().then(function(b){b.success||(f.logError(b.error),a.canceled(b.userMsg)),h.checkTheUserCards()})},this.WithdrawalEnabled=function(){i.isWithdrawalEnabled().then(function(b){b.success||(f.logError(b.error),a.canceled(b.userMsg)),h.checkTheUserCards()})},this.checkTheUserCards=function(){i.getCards(h.isWithdrawal).then(function(b){b.success||(f.logError(b.error),a.canceled(b.userMsg)),h.canUserAddNewCard=b.data.NumberOfAllowedCards>b.data.UserPaymentCards.length,b.data.UserPaymentCards.length>0?(h.useExistingCard=!0,h.hasRegisteredCard=!0,h.CARDS=b.data.UserPaymentCards,h.CARD=b.data.UserPaymentCards[0]):h.isWithdrawal?a.canceled(b.userMsg):h.hasRegisteredCard=!1})},this.PaypointFirstDepositRequestBindingModel=new gamingAppModels.PaypointFirstDepositRequestBindingModel,this.firstDeposit=function(){h.PaypointFirstDepositRequestBindingModel.Amount=h.Amount,i.addACardAndStartFirstDeposit(h.PaypointFirstDepositRequestBindingModel).then(function(a){if(!a.success)return void f.logError(a.error,a.userMsg);var b=g.getDepositRedirectionURL(),c=($("#iFrameApco"),$('<form name="apcoForm" id="apcoForm" action="'+a.data.PaypointFastTrackUrl+'" method="post" target="output_frame" ></form>'));for(property in a.data)c.append($("<input>").attr({type:"hidden",name:property,value:a.data[property]}));c.appendTo("#divIFrame"),c.submit(),$("#iFramePayPoint").load(function(){var a=this.contentWindow.location.href;a.search("DECLINED")||a.search("CANCEL")>-1?window.location.href=b:window.location.href=this.contentWindow.location.href}),h.showing=!0})},this.PaypointNotFirstDepositRequestBindingModel=new gamingAppModels.PaypointNotFirstDepositRequestBindingModel,this.notFirstDeposit=function(){h.PaypointNotFirstDepositRequestBindingModel.Amount=h.Amount,h.PaypointNotFirstDepositRequestBindingModel.CardId=h.CARD.Id,h.PaypointNotFirstDepositRequestBindingModel.Password=h.confirmPassword,i.performNotFirstDeposit(h.PaypointNotFirstDepositRequestBindingModel).then(function(b){return b.success&&0!=b.data?void a.onTransferComplete(locale.account.paymentMethods.transactionIsBeingProcessed,b.error||b.userMsg,globalSettings.DepositRedirection,"success"):void(b.error&&a.onTransferComplete(b.error||b.userMsg,b.error||b.userMsg,globalSettings.DepositRedirection,"error"))})},this.PaypointWithdrawalRequestBindingModel=new gamingAppModels.PaypointWithdrawalRequestBindingModel,this.performWithdrawal=function(){h.PaypointWithdrawalRequestBindingModel.Amount=h.Amount,h.PaypointWithdrawalRequestBindingModel.CardId=h.CARD.Id,i.registerWithdrawal(h.PaypointWithdrawalRequestBindingModel).then(function(b){return b.success&&0!=b.data?void a.onTransferComplete(locale.account.paymentMethods.transactionIsBeingProcessed,b.error||b.userMsg,globalSettings.WithdrawalRedirection,"success"):void(b.error&&a.onTransferComplete(b.error||b.userMsg,b.error||b.userMsg,globalSettings.WithdrawalRedirection,"error"))})},this.checkEnabled=function(a){return 1==a?"Enabled":"Disabled"},this.isWithdrawal?(this.WithdrawalEnabled(),h.getUserEmail()):(this.checkIfDepositIsEnabled(),h.getUserEmail()),e()}])}(),function(){angular.module("paysafe",[]).controller("PaysafeController",["$scope","platformApiService","$sce","$location","helperService","$anchorScroll","moneyTransferService",function(a,b,c,d,e,f,g){var h=this,i=b.paymentVendors.paysafe,j=b.user;this.PaysafeApi=a.selectedApi,this.ImagePath=a.ImagePath,this.PaysafeApi.image=this.ImagePath.PaysafeImage,this.userDepositLimit=null,this.Amount="",this.email="",this.showing=!1,this.iFramePath="";var k=globalSettings.Deposit_QuickCashDelimiters.split(",").map(function(a){return parseFloat(a,10)});this.quickValues=_.uniq(_.remove(k,function(a){return!isNaN(a)})),this.setAmount=function(a){this.Amount=a},this.getUserEmail=function(){j.getCurrentUserProfile().then(function(a){return a.success?void(h.email=a.data.UserDetails.Email):void loggingService.logError("Unable to get user emial : "+a.error)})},this.RegisterDepositBindingModel=new gamingAppModels.RegisterDepositBindingModel,this.registerPaysafeDeposit=function(){h.RegisterDepositBindingModel.Amount=h.Amount,h.RegisterDepositBindingModel.PaymentOkUrl=g.getDepositRedirectionURL(),h.RegisterDepositBindingModel.PaymentNotOkUrl=g.getDepositRedirectionURL(),i.registerDeposit(h.RegisterDepositBindingModel).then(function(b){if(!b.success){var d=e.handlePlatformError(b);return d||e.showErrorMessage(b.userMsg).done(),void a.canceled(b.userMsg)}h.iFramePath=c.trustAsResourceUrl(encodeURI(b.data.PaymentPanelUrl)),$("#output_frame").load(function(){var a=this.contentWindow.location.href;a.search("canceled")&&(window.location.href=this.contentWindow.location.href),a.search("accepted")&&(window.location.href=this.contentWindow.location.href)}),h.showing=!0})},f(),h.getUserEmail()}])}(),function(){angular.module("authenticatedResponse",[]).controller("AcceptedCanceledCtrl",["$timeout","$location","$scope",function(a,b,c){this.API=c.transferResponse.API,this.ImagePath=c.ImagePath,this.message=c.transferResponse.message,c.transferResponse=null}])}(),function(){angular.module("skrill",[]).controller("SkrillController",["platformApiService","$scope","$rootScope","$sce","helperService","$anchorScroll","loggingService","moneyTransferService",function(a,b,c,d,e,f,g,h){var i=this,j=a.paymentVendors.skrill;this.SkrillApi=b.selectedApi,this.ImagePath=b.ImagePath,this.Amount=null,this.Email={},this.showing=i.showing,i.showing=!1,this.userDepositLimit=null;var k=globalSettings.Deposit_QuickCashDelimiters.split(",").map(function(a){return parseFloat(a,10)});switch(this.quickValues=_.uniq(_.remove(k,function(a){return!isNaN(a)})),this.setAmount=function(a){this.Amount=a},this.title="",this.instruction="",this.SkrillApi.Identifier){case"SkrillALL":case"CCARD":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.skrillImage;break;case"SkrillACC":this.title=locale.account.paymentMethods.paypointCard.payPointTitle,this.instruction=locale.account.paymentMethods.skrill.cdCardInstructionsDeposit.partOne+"<br/><br/>"+locale.account.paymentMethods.skrill.cdCardInstructionsDeposit.partTwo+"<br/><br/>"+locale.account.paymentMethods.skrill.cdCardInstructionsDeposit.partThree+"<br/><br/>"+locale.account.paymentMethods.skrill.cdCardInstructionsDeposit.partFour+'<a target="_blank" href="/help-area/general-help/payment-methods/deposits/">'+locale.account.paymentMethods.skrill.cdCardInstructionsDeposit.partFive+"</a>"+locale.account.paymentMethods.skrill.cdCardInstructionsDeposit.partSix,this.SkrillApi.image=i.ImagePath.CDCardImage;break;case"SkrillELV":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,
this.SkrillApi.image=i.ImagePath.SkrillELV;break;case"SkrillEPY":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillEPY;break;case"SkrillGIR":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillGIR;break;case"SkrillEBT":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillEBT;break;case"SkrillSO2":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillSO2;break;case"SkrillPLI":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillPLI;break;case"SkrillP24":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillP24;break;case"SkrillSFT":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillSFT;break;case"SkrillACI":this.title=locale.account.paymentMethods.astroPayBoletoSkrill.title,this.instruction=locale.account.paymentMethods.astroPayBoletoSkrill.astroPayBoletoInstDeposit.partOne+"<br/>"+locale.account.paymentMethods.astroPayBoletoSkrill.astroPayBoletoInstDeposit.partTwo+"<br/>"+locale.account.paymentMethods.astroPayBoletoSkrill.astroPayBoletoInstDeposit.partThree,this.SkrillApi.image=i.ImagePath.SkrillACI;break;case"SkrillAUP":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillAUP;break;case"SkrillCSI":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillCSI;break;case"SkrillDID":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillDID;break;case"SkrillDNK":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillDNK;break;case"SkrillGCB":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillGCB;break;case"SkrillGLU":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillGLU;break;case"SkrillIDL":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillIDL;break;case"SkrillNPY":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillNPY;break;case"SkrillOBT":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillOBT;break;case"SkrillPSC":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillPSC;break;case"SkrillADB":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillADB;break;case"SkrillAOB":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillAOB;break;case"SkrillPSP":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillPSP;break;case"SkrillPWY":this.title=locale.account.paymentMethods.skrill.title,this.instruction=locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partOne+"<br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partTwo+'<a href="http://www.skrill.com" target="_blank">'+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partThree+"</a><br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFour+"<br/><br/>"+locale.account.paymentMethods.apco.averySkrillInstructionsDeposit.partFive,this.SkrillApi.image=i.ImagePath.SkrillPWY}this.getSkrillEmail=function(){j.getUserEmail().then(function(a){return a.success?(i.Email=a.data,void("Withdraw"===b.transferType&&i.withdrawalEnabled())):(g.logError(a.error),void b.canceled(a.userMsg))})},this.withdrawalEnabled=function(){j.isWithdrawalEnabled().then(function(a){a.success&&0!=a.data||a.error||b.onTransferComplete(a.userMsg,a.error,globalSettings.DepositRedirection,"error")})},this.iFreamPath="",this.skrillDepositRequestBindingModel=new gamingAppModels.skrillDepositRequestBindingModel,this.loadSkrillIFrame=function(){i.iFramePath=d.trustAsResourceUrl(encodeURI("")),i.skrillDepositRequestBindingModel.Amount=i.Amount,i.skrillDepositRequestBindingModel.ReturnUrl=h.getDepositRedirectionURL(),i.skrillDepositRequestBindingModel.CancelUrl=h.getDepositRedirectionURL(),i.skrillDepositRequestBindingModel.PaymentMethod=i.SkrillApi.Identifier,j.getPaymentMethodIFrameUrl(i.skrillDepositRequestBindingModel).then(function(a){return a.success?(i.iFramePath=d.trustAsResourceUrl(encodeURI(a.data)),void(i.showing=!0)):void b.onTransferComplete(a.userMsg,a.error,globalSettings.DepositRedirection,"error")})},this.SkrillWithdrawalRequestBindingModel=new gamingAppModels.SkrillWithdrawalRequestBindingModel,this.performSkrillWithdraw=function(){i.SkrillWithdrawalRequestBindingModel.AmountToWithdraw=i.Amount,j.registerWithdraw(i.SkrillWithdrawalRequestBindingModel).then(function(a){return a.success&&0!=a.data?void b.onTransferComplete(locale.account.paymentMethods.transactionIsBeingProcessed,a.error||a.userMsg,globalSettings.WithdrawalRedirection,"success"):void(a.error&&b.onTransferComplete(a.userMsg,a.error||a.userMsg,globalSettings.WithdrawalRedirection,"error"))})},i.getSkrillEmail(),f()}])}(),function(){angular.module("vendorImages.service",[]).service("vendorImagesService",[function(){return{imagePaths:{loadingImg:globalSettings.ImageResourceURL+"paymentMethods/ajax-loader.gif",secureImg:globalSettings.ImageResourceURL+"paymentMethods/ConnessioneProtetta_en.png",acceptSign:globalSettings.ImageResourceURL+"paymentMethods/tick.png",canceledSign:globalSettings.ImageResourceURL+"paymentMethods/stop.png",backButton:globalSettings.ImageResourceURL+"paymentMethods/Back-Button.jpg",backButtonWithdrawal:globalSettings.ImageResourceURL+"paymentMethods/Back-Button-Withdrawal.jpg",imageBackground:globalSettings.ImageResourceURL+"paymentMethods/Payment-Method-BG.jpg",imageWDBackground:globalSettings.ImageResourceURL+"paymentMethods/Payment-Method-Withdraw-BG.jpg",SkrillELV:globalSettings.ImageResourceURL+"paymentMethods/SkrillELV_BDR.png",SkrillEPY:globalSettings.ImageResourceURL+"paymentMethods/SkrillEPY_BDR.png",SkrillGIR:globalSettings.ImageResourceURL+"paymentMethods/SkrillGIR_BDR.png",SkrillEBT:globalSettings.ImageResourceURL+"paymentMethods/SkrillEBT_BDR.png",SkrillSO2:globalSettings.ImageResourceURL+"paymentMethods/SkrillSO2_BDR.png",SkrillP24:globalSettings.ImageResourceURL+"paymentMethods/SkrillP24_BDR.png",SkrillPLI:globalSettings.ImageResourceURL+"paymentMethods/SkrillPLI_BDR.png",SkrillSFT:globalSettings.ImageResourceURL+"paymentMethods/SkrillSFT_BDR.png",SkrillACI:globalSettings.ImageResourceURL+"paymentMethods/SkrillACI_BDR.png",SkrillAUP:globalSettings.ImageResourceURL+"paymentMethods/SkrillAUP_BDR.png",SkrillCSI:globalSettings.ImageResourceURL+"paymentMethods/SkrillCSI_BDR.png",SkrillDID:globalSettings.ImageResourceURL+"paymentMethods/SkrillDID_BDR.png",SkrillDNK:globalSettings.ImageResourceURL+"paymentMethods/SkrillDNK_BDR.png",SkrillGCB:globalSettings.ImageResourceURL+"paymentMethods/SkrillGCB_BDR.png",SkrillGLU:globalSettings.ImageResourceURL+"paymentMethods/SkrillGLU_BDR.png",SkrillIDL:globalSettings.ImageResourceURL+"paymentMethods/SkrillIDL_BDR.png",SkrillNPY:globalSettings.ImageResourceURL+"paymentMethods/SkrillNPY_BDR.png",SkrillOBT:globalSettings.ImageResourceURL+"paymentMethods/SkrillOBT_BDR.png",SkrillPSC:globalSettings.ImageResourceURL+"paymentMethods/SkrillPSC_BDR.png",SkrillPSP:globalSettings.ImageResourceURL+"paymentMethods/SkrillPSP_BDR.png",SkrillPWY:globalSettings.ImageResourceURL+"paymentMethods/SkrillPWY_BDR.png",SkrillADB:globalSettings.ImageResourceURL+"paymentMethods/SkrillADB_BDR.png",SkrillAOB:globalSettings.ImageResourceURL+"paymentMethods/SkrillAOB_BDR.png",ecopayzImage:globalSettings.ImageResourceURL+"paymentMethods/EcoPayRegular_BDR.png",epgImage:globalSettings.ImageResourceURL+"paymentMethods/EPGDeposit.png",interacEpgImage:globalSettings.ImageResourceURL+"paymentMethods/InteracDepositByEPG.png",skrillImage:globalSettings.ImageResourceURL+"paymentMethods/mbk_normal.gif",CDCardImage:globalSettings.ImageResourceURL+"paymentMethods/mbk_CC_IT.gif",CDCardAPCOImage:globalSettings.ImageResourceURL+"paymentMethods/ApcoFastPay.jpg",UKXImage:globalSettings.ImageResourceURL+"paymentMethods/Ukash.jpg",NetellerImage:globalSettings.ImageResourceURL+"paymentMethods/Neteller.jpg",PaysafeImage:globalSettings.ImageResourceURL+"paymentMethods/PaySafe.jpg",PayPointImage:globalSettings.ImageResourceURL+"paymentMethods/COPSLogo.jpg",BnkTrsImg:globalSettings.ImageResourceURL+"paymentMethods/BnkTrsImg.jpg",InterswitchImg:globalSettings.ImageResourceURL+"paymentMethods/InterswitchDirectWithdrawal.png",InterswitchApiWithdrawal:globalSettings.ImageResourceURL+"paymentMethods/InterswitchDirectWithdrawal.png",InterswitchApiBankTransfer:globalSettings.ImageResourceURL+"paymentMethods/bank-transfer.png",InterswitchApiAtm:globalSettings.ImageResourceURL+"paymentMethods/atm.png",InterswitchApiQuickteller:globalSettings.ImageResourceURL+"paymentMethods/quickteller.png",InterswitchApiWebpay:globalSettings.ImageResourceURL+"paymentMethods/webpay.png",AstroPayCashPaymentImage:globalSettings.ImageResourceURL+"paymentMethods/ApcoAstropayAPCP.png",AstroPayBoletoBancarioImage:globalSettings.ImageResourceURL+"paymentMethods/ApcoAstropayAPBO.png",AstroPayBankTransferImage:globalSettings.ImageResourceURL+"paymentMethods/ApcoAstropayAPBT.png",AstroPayCardImage:globalSettings.ImageResourceURL+"paymentMethods/ApcoAstropayASTROPAYCard.png",AstroPayLogo:globalSettings.ImageResourceURL+"paymentMethods/astropaylogo.png"}}}])}(),function(){angular.module("wirecard",[]).controller("WireCardController",["platformApiService","$location","$scope","helperService","$anchorScroll","loggingService","moneyTransferService",function(a,b,c,d,e,f,g){var h=this,i=a.paymentVendors.wirecard,j=a.user;this.WireCardApi=c.selectedApi,this.ImagePath=c.ImagePath,this.WireCardApi.image=this.ImagePath.PayPointImage,this.CARDS=[],this.CARD=null,this.email="",this.confirmPassword="",this.Amount="",this.useExistingCard=!1,this.canUserAddNewCard=!0,this.hasRegisteredCard=!1,this.userDepositLimit=null,this.showing=!1,this.isWithdrawal="Withdraw"===c.transferType,this.Width="200px";var k=globalSettings.Deposit_QuickCashDelimiters.split(",").map(function(a){return parseFloat(a,10)});this.quickValues=_.uniq(_.remove(k,function(a){return!isNaN(a)})),this.setAmount=function(a){this.Amount=a},this.getUserEmail=function(){j.getCurrentUserProfile().then(function(a){return a.success?void(h.email=a.data.UserDetails.Email):void f.logError("Unable to get user emial : "+a.error)})},this.checkIfDepositIsEnabled=function(){i.isDepositEnabled().then(function(a){a.success||(f.logError(a.error),c.canceled(a.userMsg)),h.checkTheUserCards()})},this.WithdrawalEnabled=function(){i.isWithdrawalEnabled().then(function(a){a.success||(f.logError(a.error),c.canceled(a.userMsg)),h.checkTheUserCards()})},this.checkTheUserCards=function(){i.getCards(h.isWithdrawal).then(function(a){a.success||(f.logError(a.error),c.canceled(a.userMsg)),h.canUserAddNewCard=a.data.NumberOfAllowedCards>a.data.UserPaymentCards.length,a.data.UserPaymentCards.length>0?(h.useExistingCard=!0,h.hasRegisteredCard=!0,h.CARDS=a.data.UserPaymentCards,h.CARD=a.data.UserPaymentCards[0]):h.isWithdrawal?c.canceled(a.userMsg):h.hasRegisteredCard=!1})};var l=g.getDepositRedirectionURL(),m=g.getDepositRedirectionURL(),n=g.getDepositRedirectionURL();this.WirecardRegisterDepositRequestBindingModel=new gamingAppModels.WirecardRegisterDepositRequestBindingModel,this.firstDeposit=function(){h.WirecardRegisterDepositRequestBindingModel.Amount=h.Amount,h.WirecardRegisterDepositRequestBindingModel.PaymentCode=h.WireCardApi.Identifier,h.WirecardRegisterDepositRequestBindingModel.SuccessUrl=l,h.WirecardRegisterDepositRequestBindingModel.CancelUrl=m,h.WirecardRegisterDepositRequestBindingModel.FailureUrl=m,h.WirecardRegisterDepositRequestBindingModel.ServiceUrl=n,h.WirecardRegisterDepositRequestBindingModel.PendingUrl=l,i.registerDeposit(h.WirecardRegisterDepositRequestBindingModel).then(function(a){if(!a.success)return void f.logError(a.error,a.userMsg);var b=($("#output_frame"),$('<form name="wirecardForm" id="wirecardForm" action="'+a.data.WireCardUrlToStartFirstDeposit+'" method="post" target="output_frame" ></form>'));for(property in a.data)b.append($("<input>").attr({type:"hidden",name:property,value:a.data[property]}));b.appendTo("#divIFrame"),b.submit(),$("#output_frame").load(function(){try{this.contentWindow&&this.contentWindow.location&&this.contentWindow.location.href&&(window.location.href=this.contentWindow.location.href)}catch(a){console.log(this)}}),h.showing=!0})},this.WirecardNotFirstDepositRequestBindingModel=new gamingAppModels.WirecardNotFirstDepositRequestBindingModel,this.notFirstDeposit=function(){h.WirecardNotFirstDepositRequestBindingModel.Amount=h.Amount,h.WirecardNotFirstDepositRequestBindingModel.CardId=h.CARD.Id,h.WirecardNotFirstDepositRequestBindingModel.Password=h.confirmPassword,i.performNotFirstDeposit(h.WirecardNotFirstDepositRequestBindingModel).then(function(a){if(!a.success||0==a.data){a.error&&f.logError(a.error||a.userMsg,a.error&&a.userMsg);var b=d.handlePlatformError(a);return void(b||d.showErrorMessage(a.userMsg).done())}f.logError(a.error||a.userMsg,a.error&&a.userMsg),d.showSuccessMessage(locale.account.paymentMethods.transactionIsBeingProcessed).done(),c.accepted(a.userMsg,a.error)})},this.WirecardWithdrawalRequestBindingModel=new gamingAppModels.WirecardWithdrawalRequestBindingModel,this.performWithdrawal=function(){h.WirecardWithdrawalRequestBindingModel.Amount=h.Amount,h.WirecardWithdrawalRequestBindingModel.CardId=h.CARD.Id,i.registerWithdrawal(h.WirecardWithdrawalRequestBindingModel).then(function(a){if(!a.success||0==a.data){a.error&&f.logError(a.error||a.userMsg,a.error&&a.userMsg);var b=d.handlePlatformError(a);return void(b||d.showErrorMessage(a.userMsg).done())}f.logError(a.error||a.userMsg,a.error&&a.userMsg),d.showSuccessMessage(locale.account.paymentMethods.transactionIsBeingProcessed).done(),c.accepted(a.userMsg,a.error)})},this.checkEnabled=function(a){return 1==a?"Enabled":"Disabled"},this.checkIfDepositIsEnabled(),h.getUserEmail(),e()}])}(),function(){angular.module("accountPaymentAutoWithdrawal",[]).controller("AutoWithdrawalsController",["$filter","$scope","$window","platformApiService","websiteApiService","authService","currencyService",function(a,b,c,d,e,f,g){var h=this;b.locale=c.locale,b.globalSettings=c.globalSettings,this.isAgent=f.isAgent(),this.checkWithdrawalOfDeposit=!0,this.depositRatio=0,this.withdrawalWin=0,this.isUserAboveThreshold=!1,this.htmlTextWithDepRto=locale.account.paymentMethods.withdrawal.autoWithdrawalDisc.replace("{withdrawable balance}",h.withdrawalWin),this.isYNotWholeBalanceDisc=!0,this.formatCurrency=function(a){return h.isDesktop?g.smartFormatNumber(f.getUserData().currency.Currency,"string"==typeof a?parseFloat(a):a,2):g.currencyFormat("string"==typeof a?parseFloat(a).toFixed(2):a.toFixed(2),f.getUserData().currency.Currency)},this.withdrawableFormaterCurrency=function(a){return h.checkWithdrawalOfDeposit?(h.isYNotWholeBalanceDisc=a>=h.withdrawalWin,h.isUserAboveThreshold?h.formatCurrency(a):h.formatCurrency(Math.min(a,h.withdrawalWin))):h.formatCurrency(a)},this.getDepositRatio=function(){d.finance.getUserWithdrawalConfiguration(c.location.pathname.split("/").pop()).then(function(b){b.success?(h.checkWithdrawalOfDeposit=b.data.CheckWithdrawalOfDeposit,h.depositRatio=a("number")(100*b.data.Ratio,2),h.withdrawalWin=b.data.WithdrawalWin,h.isUserAboveThreshold=b.data.UserAboveThreshold,h.setMinMaxLimits()):(h.depositRatio=0,h.withdrawalWin=0),h.htmlTextWithDepRto=locale.account.paymentMethods.withdrawal.autoWithdrawalDisc.replace("{withdrawable balance}",h.formatCurrency(h.withdrawalWin))})},this.getDepositRatioWithDailyLimits=function(){e.payments.userConfiguration.userWithdrawalConfiguration(c.location.pathname.split("/").pop()).then(function(b){b.success?(b.data.WithdrawalDailyAttempts&&(c.globalSettings.Account_PaymentMaxLimitAllowed.withdrawalDailyAttempts={},c.globalSettings.Account_PaymentMaxLimitAllowed.withdrawalDailyAttempts.currentValue=b.data.WithdrawalDailyAttempts.CurrentValue,c.globalSettings.Account_PaymentMaxLimitAllowed.withdrawalDailyAttempts.targetValue=b.data.WithdrawalDailyAttempts.TargetValue),h.checkWithdrawalOfDeposit=b.data.WithdrawalOfDeposit.CheckWithdrawalOfDeposit,h.depositRatio=a("number")(100*b.data.WithdrawalOfDeposit.Ratio,2),h.withdrawalWin=b.data.WithdrawalOfDeposit.WithdrawalWin,h.isUserAboveThreshold=b.data.WithdrawalOfDeposit.UserAboveThreshold,h.setMinMaxLimits()):(h.depositRatio=0,h.withdrawalWin=0),h.htmlTextWithDepRto=locale.account.paymentMethods.withdrawal.autoWithdrawalDisc.replace("{withdrawable balance}",h.formatCurrency(h.withdrawalWin))})},this.setMinMaxLimits=function(){var a=h.checkWithdrawalOfDeposit?h.isUserAboveThreshold?h.userBalance:h.withdrawalWin:h.userBalance;a=h.maximumLimitAmount<a?h.maximumLimitAmount:a,this.maximumLimitAmount=a,a<h.minimumLimitAmount&&(this.minimumLimitAmount=a)},this.init=function(){globalSettings.Account_PaymentMaxLimitAllowed.enabled?h.getDepositRatioWithDailyLimits():h.getDepositRatio()},h.init()}])}(),function(){angular.module("accountPaymentWithdrawalDailyAttempts",[]).controller("WithdrawalDailyAttemptsController",["$scope","$window",function(a,b){var c=this;a.locale=b.locale,a.globalSettings=b.globalSettings,this.showMaximumWithdrawals=!1,this.targetReached=!1,this.dailyAttemptsText="";var d=0,e=0;this.parseWithdrawalMaxLimitAllowed=function(){c.showMaximumWithdrawals=!0,c.targetReached=d+1>=e;var a=d+1+" of "+e;d+1<e?c.dailyAttemptsText=a+" Withdrawal attempts for today":d+1===e?c.dailyAttemptsText="Last Withdrawal attempt for today":c.dailyAttemptsText="Maximum withdrawal for the day exceeded"},a.$watchCollection("globalSettings.Account_PaymentMaxLimitAllowed",function(a,b){a.withdrawalDailyAttempts&&(d=parseInt(globalSettings.Account_PaymentMaxLimitAllowed.withdrawalDailyAttempts.currentValue),e=parseInt(globalSettings.Account_PaymentMaxLimitAllowed.withdrawalDailyAttempts.targetValue),c.parseWithdrawalMaxLimitAllowed())})}])}(),function(){angular.module("f2pGuardianApi",[]).factory("f2pGuardianApiHttp",["$rootScope","$http","$q","$interpolate",function(a,b,c,d){var e=function(a){var b={apiType:"f2pGuardian"};return a&&(a.urlEncoded&&(b.urlEncoded=a.urlEncoded),a.sendActivitySource&&(b.sendActivitySource=a.sendActivitySource)),b};return{get:function(f,g,h){var i=c.defer(),j=d(f)(g),k=e(h);return k.showLoader&&a.showLoader&&a.showLoader(),b.get(j,k).success(function(b){k.showLoader&&a.hideLoader&&a.hideLoader(),i.resolve({success:!0,data:b})}).error(function(b){k.showLoader&&a.hideLoader&&a.hideLoader(),i.resolve({success:!1,data:{},error:b})}),i.promise},delete:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return l.showLoader&&a.showLoader&&a.showLoader(),l.method="DELETE",l.url=k,l.data=h||{},b(l).success(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!0,data:b})}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise},post:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return h||(h={}),l.urlEncoded&&(h=$.param(h)),l.showLoader&&a.showLoader&&a.showLoader(),b.post(k,h,l).success(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!0,data:b})}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise},put:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return h||(h={}),l.urlEncoded&&(h=$.param(h)),l.showLoader&&a.showLoader&&a.showLoader(),b.put(k,h,l).success(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!0,data:b})}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise}}}]).factory("f2pGuardianApiConfig",[function(){return{auth:{baseUrl:globalSettings.F2PGuardianURL,endpoints:{getToken:"oauth/Token",validateToken:"auth/validate",revokeToken:"auth/revokeToken"}}}}]).factory("f2pGuardianApiService",["f2pGuardianApiHttp","f2pGuardianApiConfig",function(a,b){return{auth:{getToken:function(c,d,e){var f=b.auth.baseUrl+b.auth.endpoints.getToken,g={},h={username:c,password:d,brandId:e,grant_type:"password"},i={urlEncoded:!0,sendActivitySource:!0};return a.post(f,g,h,i)},validateToken:function(c){if(c){var d=b.auth.baseUrl+b.auth.endpoints.validateToken,e={},f={token:c},g={urlEncoded:!0,sendActivitySource:!0};return a.post(d,e,f,g)}},revokeToken:function(c){if(c){var d=b.auth.baseUrl+b.auth.endpoints.revokeToken,e={},f={token:c},g={urlEncoded:!0,sendActivitySource:!0};return a.post(d,e,f,g)}}}}}])}(),function(){angular.module("frontendApi",[]).factory("frontendApiHttp",["$rootScope","$http","$q","$interpolate",function(a,b,c,d){var e=function(a){var b={apiType:"frontend"};return a&&(a.loggingCall&&(b.loggingCall=a.loggingCall),a.inBehalfOf&&(b.inBehalfOf=a.inBehalfOf),a.urlEncoded&&(b.urlEncoded=a.urlEncoded),a.showLoader&&(b.showLoader=a.showLoader)),b};return{get:function(f,g,h){var i=c.defer(),j=d(f)(g),k=e(h);return k.showLoader&&a.showLoader&&a.showLoader(),b.get(j,k).success(function(b){k.showLoader&&a.hideLoader&&a.hideLoader(),i.resolve({success:!0,data:b})}).error(function(b){k.showLoader&&a.hideLoader&&a.hideLoader(),i.resolve({success:!1,data:{},error:b})}),i.promise},delete:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return l.showLoader&&a.showLoader&&a.showLoader(),l.method="DELETE",l.url=k,l.data=h||{},b(l).success(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!0,data:b})}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise},post:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return h||(h={}),l.urlEncoded&&(h=$.param(h)),l.showLoader&&a.showLoader&&a.showLoader(),b.post(k,h,l).success(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!0,data:b})}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise},put:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return h||(h={}),l.urlEncoded&&(h=$.param(h)),l.showLoader&&a.showLoader&&a.showLoader(),b.put(k,h,l).success(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),
j.resolve({success:!0,data:b})}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise}}}]).factory("frontendApiConfig",[function(){return{baseUrl:globalSettings.FrontendApiURL,endpoints:{logging:{httpLog:"Logging/httpLog",scriptLog:"Logging/scriptLog"}}}}]).factory("frontendApiService",["frontendApiConfig","frontendApiHttp",function(a,b){return{logging:{httpLog:function(c){var d=a.baseUrl+a.endpoints.logging.httpLog,e={},f=c,g={loggingCall:!0};return b.post(d,e,f,g)},scriptLog:function(c){var d=a.baseUrl+a.endpoints.logging.scriptLog,e={},f=c,g={loggingCall:!0};return b.post(d,e,f,g)}}}}])}(),function(){angular.module("guardianApi",[]).factory("guardianApiHttp",["$rootScope","$http","$q","$interpolate",function(a,b,c,d){var e=function(a){var b={apiType:"guardian"};return a&&(a.urlEncoded&&(b.urlEncoded=a.urlEncoded),a.sendActivitySource&&(b.sendActivitySource=a.sendActivitySource)),b};return{get:function(f,g,h){var i=c.defer(),j=d(f)(g),k=e(h);return k.showLoader&&a.showLoader&&a.showLoader(),b.get(j,k).success(function(b){k.showLoader&&a.hideLoader&&a.hideLoader(),i.resolve({success:!0,data:b})}).error(function(b){k.showLoader&&a.hideLoader&&a.hideLoader(),i.resolve({success:!1,data:{},error:b})}),i.promise},delete:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return l.showLoader&&a.showLoader&&a.showLoader(),l.method="DELETE",l.url=k,l.data=h||{},b(l).success(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!0,data:b})}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise},post:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return h||(h={}),l.urlEncoded&&(h=$.param(h)),l.showLoader&&a.showLoader&&a.showLoader(),b.post(k,h,l).success(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!0,data:b})}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise},put:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return h||(h={}),l.urlEncoded&&(h=$.param(h)),l.showLoader&&a.showLoader&&a.showLoader(),b.put(k,h,l).success(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!0,data:b})}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise}}}]).factory("guardianApiConfig",[function(){return{auth:{baseUrl:globalSettings.GuardianURL,endpoints:{getToken:"oauth/Token",validateToken:"auth/validate",revokeToken:"auth/revokeToken"}}}}]).factory("guardianApiService",["guardianApiHttp","guardianApiConfig",function(a,b){return{auth:{getToken:function(c,d,e){var f=b.auth.baseUrl+b.auth.endpoints.getToken,g={},h={username:c,password:d,brandId:e,grant_type:"password"},i={urlEncoded:!0,sendActivitySource:!0};return a.post(f,g,h,i)},validateToken:function(c){if(c){var d=b.auth.baseUrl+b.auth.endpoints.validateToken,e={},f={token:c},g={urlEncoded:!0,sendActivitySource:!0};return a.post(d,e,f,g)}},revokeToken:function(c){if(c){var d=b.auth.baseUrl+b.auth.endpoints.revokeToken,e={},f={token:c},g={urlEncoded:!0,sendActivitySource:!0};return a.post(d,e,f,g)}}}}}])}(),function(){angular.module("language.helper",[]).service("languageChecker",["$rootScope",function(a){var b={1:{currLang:"en",currLocale:"en-GB",langIsoCode:"eng"},2:{currLang:"am",currLocale:"am-ET",langIsoCode:"amh"}};this.getLanguageByIsoCode=function(a){return _.find(b,["langIsoCode",a])},this.getLanguageByLocale=function(a){return _.find(b,["currLocale",a])},this.getLanguageByTwoLetter=function(a){return _.find(b,["currLang",a])}}])}(),"object"==typeof localStorage)try{localStorage.setItem("localStorage",1),localStorage.removeItem("localStorage")}catch(a){Storage.prototype._setItem=Storage.prototype.setItem,Storage.prototype.setItem=function(){},alert('Your web browser does not support storing settings locally. In Safari, the most common cause of this is using "Private Browsing Mode". Some settings may not save or some features may not work properly for you.')}!function(){var a=angular.module("logging",[]).factory("loggingService",["$window","frontendApiService",function(a,b){function c(a,b,c,d,f){this.message=a,this.userMessage=c,this.logLevel=null!=d?d:e.logLevels.info,this.handled=null!=f&&f;null==b?this.stacktrace=ErrorStackParser.parse(new Error).map(function(a){return a.toString()}).join("\n"):this.stacktrace=b}function d(a,b,c,d){this.message=a,this.logLevel=null!=b?b:e.logLevels.info,this.handled=null!=c&&c;var f=localStorage.getItem("userData");this.userData=f?JSON.stringify(f):"",this.request={apiType:d.config.apiType,data:JSON.stringify(d.config.data),headers:d.config.headers,method:d.config.method,url:d.config.url},this.response={data:JSON.stringify(d.data),headers:d.headers,status:d.status,statusText:d.statusText}}var e=this;return this.logToScreenFn=null,this.logTypes={script:{name:"script",value:1e4},http:{name:"http",value:2e4}},this.logLevels={debug:{name:"DEBUG",value:1e4},info:{name:"INFO",value:2e4},warn:{name:"WARN",value:3e4},error:{name:"ERROR",value:4e4},fatal:{name:"FATAL",value:5e4}},c.prototype.constructor=c,d.prototype.constructor=d,this.minLogLevel=function(){var a=_.findKey(e.logLevels,{name:globalSettings.LogLevel.toUpperCase()});return null!=a?e.logLevels[a]:e.logLevels.error},this.logToConsole=function(a){if(a.logLevel.value<e.logLevels.error.value){var b="";b+=a.logLevel.value==e.logLevels.warn.value?'[c="color: orange"]':'[c="color: blue"]',log(b+"["+a.logLevel.name+"] "+a.message+"[c]")}else{var b='[c="color: red; font-weight: bold;"]['+a.logLevel.name+"] ";b+=a.message,a.handled||(b+=" (Unhandled)"),b+="[c]",log(b)}},this.logToServer=function(a,c){0!=globalSettings.LogToAPI&&(a.logLevel=a.logLevel.name,c==e.logTypes.script?b.logging.scriptLog(a):c==e.logTypes.http&&b.logging.httpLog(a))},this.logToScreen=function(a){return null==e.logToScreenFn?void e.serviceMethods.logError("loggingService.logToScreen failed - logToScreenFn not set",null):void e.logToScreenFn(a)},this.serviceMethods={logLevels:e.logLevels,setup:function(a){null!=a&&(e.logToScreenFn=a)},scriptLog:function(a,b,d,f){var g;if(null==f&&(f=!0),"object"==typeof a&&Error.prototype.isPrototypeOf(a)){var h=a;(null==d||d.value<e.logLevels.error.value)&&(d=e.logLevels.error),g=new c(h.message,h.stack,b,d,!1)}else g=new c(a,null,b,d,!0);g.userMessage&&e.logToScreen(g),g.logLevel.value>=e.minLogLevel().value&&(e.logToConsole(g),f&&e.logToServer(g,e.logTypes.script))},httpLog:function(a,b,c){var f;if("object"==typeof a&&Error.prototype.isPrototypeOf(a)){var g=a;(null==b||b.value<e.logLevels.error.value)&&(b=e.logLevels.error),f=new d(g.message,b,!1,c)}else f=new d(a,b,!0,c);f.logLevel.value>=e.minLogLevel().value&&e.logToServer(f,e.logTypes.http)},logError:function(a,b,c){this.scriptLog(a,b,e.logLevels.error,c)}},this.serviceMethods}]);a.config(["$provide",function(a){a.decorator("$exceptionHandler",["$delegate","$injector",function(a,b){return function(c,d){if(globalSettings.DebugMode)a(c,d);else{var e=b.get("loggingService");e.scriptLog(c,null,e.logLevels.fatal)}}}])}])}(),function(){angular.module("lotteryApi",[]).factory("lotteryApiHttp",["$rootScope","$http","$q","$interpolate",function(a,b,c,d){var e=function(a){var b={apiType:"lottery"};return b.headers={"X-API-PLAYSOURCE":1,"X-API-BRAND":globalSettings.BrandID},a&&(a.timeout&&(b.timeout=a.timeout),a.data&&(b.data=a.data),a.showLoader&&(b.showLoader=a.showLoader),a.userId&&(b.headers["X-API-USERID"]=a.userId),a.auth&&(b.headers.Authorization=a.auth)),b};return{get:function(f,g,h){var i=c.defer(),j=d(f)(g),k=e(h);return k.showLoader&&a.showLoader&&a.showLoader(),b.get(j,k).success(function(b){b&&b.hasError?i.resolve({success:!1,data:{},error:b}):(k.showLoader&&a.hideLoader&&a.hideLoader(),i.resolve({success:!0,data:b}))}).error(function(b){k.showLoader&&a.hideLoader&&a.hideLoader(),i.resolve({success:!1,data:{},error:b})}),i.promise},delete:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return l.showLoader&&a.showLoader&&a.showLoader(),l.method="DELETE",l.url=k,l.data=h||{},b(l).success(function(b){b&&b.hasError?j.resolve({success:!1,data:{},error:b}):(l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!0,data:b}))}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise},post:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return h||(h={}),l.urlEncoded&&(h=$.param(h)),l.showLoader&&a.showLoader&&a.showLoader(),b.post(k,h,l).success(function(b){b&&b.hasError?j.resolve({success:!1,data:{},error:b}):(l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!0,data:b}))}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise},put:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return h||(h={}),l.urlEncoded&&(h=$.param(h)),l.showLoader&&a.showLoader&&a.showLoader(),b.put(k,h,l).success(function(b){b&&b.hasError?j.resolve({success:!1,data:{},error:b}):(l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!0,data:b}))}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise}}}]).factory("lotteryApiConfig",[function(){return{config:{baseUrl:globalSettings.LotteryApiURL},setup:{endpoints:{getProducts:"api/Setup/Products"}},livelotto:{endpoints:{getBetListItems:"api/LiveLotto/BetListItems",getTicketByCode:"api/LiveLotto/SearchTicketByCode?ticketCode={{ticketCode}}"}}}}]).factory("lotteryApiService",["lotteryApiConfig","lotteryApiHttp","authService",function(a,b,c){return{setup:{getProducts:function(){return b.get(a.config.baseUrl+a.setup.endpoints.getProducts,{},{})}},livelotto:{getBetListItems:function(d){return b.post(a.config.baseUrl+a.livelotto.endpoints.getBetListItems,{},d,{userId:c.getUserData().userID,auth:c.getAccessToken()})},getTicketByCode:function(c){var d={};if(c.indexOf(",")!=-1){var e=c.split(",")[1];d={userId:e},c=c.split(",")[0]}var f=a.config.baseUrl+a.livelotto.endpoints.getTicketByCode,g={ticketCode:c};return b.get(f,g,d)}}}}])}(),function(){angular.module("platformApi",[]).factory("platformApiHttp",["$rootScope","$http","$q","$interpolate","$log",function(a,b,c,d,e){var f=function(a){var b={apiType:"gaming"};return a&&(a.noAuthToken&&(b.noAuthToken=a.noAuthToken),a.urlEncoded&&(b.urlEncoded=a.urlEncoded),a.showLoader&&(b.showLoader=a.showLoader),a.apiVersion&&(b.apiVersion=a.apiVersion),a.sendActivitySource&&(b.sendActivitySource=a.sendActivitySource)),b};return{get:function(e,g,h){var i=c.defer(),j=d(e)(g),k=f(h);return k.showLoader&&a.showLoader&&a.showLoader(),b.get(j,k).success(function(b){k.showLoader&&a.hideLoader&&a.hideLoader();var c={success:0==b.ResponseCode,responseCode:b.ResponseMessage,userMsg:b.SystemMessage||b.ResponseMessage};c.success?c.data=b.Result:c.error=b.SystemMessage,i.resolve(c)}).error(function(b,c){k.showLoader&&a.hideLoader&&a.hideLoader();var d={success:!1,error:"An error has occurred",userMsg:"An error has occurred",result:null,status:c};b&&(d.error=b.SystemMessage,d.userMsg=b.SystemMessage||b.ResponseMessage,b.Result&&(d.Result=b.Result)),i.resolve(d)}),i.promise},post:function(e,g,h,i){var j=c.defer(),k=d(e)(g),l=f(i);return h||(h={}),l.urlEncoded&&(h=$.param(h)),l.showLoader&&a.showLoader&&a.showLoader(),b.post(k,h,l).success(function(b){l.showLoader&&a.hideLoader&&a.hideLoader();var c={success:0==b.ResponseCode,responseCode:b.ResponseMessage,userMsg:b.SystemMessage||b.ResponseMessage};c.success?c.data=b.Result:c.error=b.SystemMessage,j.resolve(c)}).error(function(b,c){l.showLoader&&a.hideLoader&&a.hideLoader();var d={success:!1,responseCode:-1,error:"An error has occurred",userMsg:"An error has occurred",result:null,status:c};b&&(d.responseCode=b.ResponseCode,d.error=b.SystemMessage,d.userMsg=b.SystemMessage||b.ResponseMessage,b.Result&&(d.Result=b.Result)),j.resolve(d)}),j.promise},delete:function(e,g,h){var i=c.defer(),j=d(e)(g),k=f(h);return k.showLoader&&a.showLoader&&a.showLoader(),b.delete(j,k).success(function(b){k.showLoader&&a.hideLoader&&a.hideLoader();var c={success:0==b.ResponseCode,responseCode:b.ResponseMessage,userMsg:b.SystemMessage||b.ResponseMessage};c.success?c.data=b.Result:c.error=b.SystemMessage,i.resolve(c)}).error(function(b){k.showLoader&&a.hideLoader&&a.hideLoader();var c={success:!1,error:"An error has occurred",userMsg:"An error has occurred",result:null};b&&(c.error=b.SystemMessage,c.userMsg=b.SystemMessage||b.ResponseMessage,b.Result&&(c.Result=b.Result)),i.resolve(c)}),i.promise}}}]).factory("platformApiConfig",[function(){return{report:{baseUrl:globalSettings.GamingApiURL,endpoints:{report:{getSportsbookBetsByUserData:"api/Reports/SqlReports/SportsbookBetsByUserReportUniqueIdentifier/GetData",getBalanceOverviewData:"api/Reports/SqlReports/BalanceOverviewReportUniqueIdentifier/GetData",getCashPayoutsData:"api/Reports/SqlReports/CashPayoutsReportUniqueIdentifier/GetData",getSportsbookBetsData:"api/Reports/SqlReports/SportsbookBetsReportUniqueIdentifier/GetData",getAgentProductsSalesData:"api/Reports/SqlReports/SVGamingAgentProductsSalesReportUniqueIdentifier/GetData",getSportsbookSalesByChannelData:"api/Reports/SqlReports/SVGamingAgentSportsbookSalesByChannelReportUniqueIdentifier/GetData",getSportsbookWinsData:"api/Reports/SqlReports/SportsbookWinsReportUniqueIdentifier/GetData",getCashiersSummaryData:"api/Reports/SqlReports/TotalsSummaryReportUniqueIdentifier/GetData",getVirtualBetsData:"api/Reports/SqlReports/VirtualBetsReportUniqueIdentifier/GetData",getVirtualWinsData:"api/Reports/SqlReports/VirtualWinsReportUniqueIdentifier/GetData",getBVBetsData:"api/Reports/SqlReports/BVBetsReportUniqueIdentifier/GetData",getBVWinsData:"api/Reports/SqlReports/BVWinsReportUniqueIdentifier/GetData",getGRBetsData:"api/Reports/SqlReports/GRBetsReportUniqueIdentifier/GetData",getGRWinsData:"api/Reports/SqlReports/GRWinsReportUniqueIdentifier/GetData",getSqlReports:"api/Reports/SqlReports/BetSearchReportUniqueIdentifier/GetData",getAllProductsData:"api/Reports/SqlReports/GameActivitySummaryByProductReportUniqueIdentifier/GetData",getSportsbookProductData:"api/Reports/SqlReports/SportsbookGameActivityByUserReportUniqueIdentifier/GetData",getGoldenRaceProductData:"api/Reports/SqlReports/GoldenRaceGameActivityByUserReportUniqueIdentifier/GetData",getGlobalbetProductData:"api/Reports/SqlReports/GlobalBetGameActivityByUserReportUniqueIdentifier/GetData",getLiabilityOverviewData:"api/Reports/SqlReports/LiabilityOverviewReportUniqueIdentifier/GetData",getLiabilityAuditData:"api/Reports/SqlReports/LiabilityAuditAPIReportUniqueIdentifier/GetData",getCreditBalanceData:"api/Reports/SqlReports/CreditBalanceAPIReportUniqueIdentifier/GetData",getOnlineUsersBetSearchReportUniqueIdentifier:"api/Reports/SqlReports/OnlineUsersBetSearchReportUniqueIdentifier/GetData",getAgentCommissionData:"api/Reports/SqlReports/SVGamingAgentCommissionReportUniqueIdentifier/GetData",getAgentVirtualSalesData:"api/Reports/SqlReports/SVGamingAgentVirtualSalesByChannelReportUniqueIdentifier/GetData",getAgentLotterySalesData:"api/Reports/SqlReports/SVGamingAgentLotterySalesByChannelReportUniqueIdentifier/GetData",getLotteryBetsData:"api/Reports/SqlReports/LotteryBetsReportUniqueIdentifier/GetData",getLotteryWinsData:"api/Reports/SqlReports/LotteryWinsReportUniqueIdentifier/GetData",getLotteryExtWinsData:"api/Reports/SqlReports/LotteryExtWinsReportUniqueIdentifier/GetData",getLotSpecialFiveAnalysisData:"api/Reports/SqlReports/SVGamingLotteriesPowerballCommissionEstimateReportUniqueIdentifier/GetData",getLotSpecialFiveAnalysisDetailsData:"api/Reports/SqlReports/SVGamingLotteriesPowerballCommissionEstimateDetailsReportUniqueIdentifier/GetData",getLotDailyAnalysisData:"api/Reports/SqlReports/SVGamingLotteriesDailyCommissionEstimateReportUniqueIdentifier/GetData",getLotDailyAnalysisDetailsData:"api/Reports/SqlReports/SVGamingLotteriesDailyCommissionEstimateDetailsReportUniqueIdentifier/GetData",getVirtualsBetSearchData:"api/Reports/SqlReports/BetagyVirtualsBetSearchReportUniqueIdentifier/GetData",getSportsAnalysisData:"api/Reports/SqlReports/SVGamingSportsDailyCommissionEstimateReportUniqueIdentifier/GetData",getSportsAnalysisDetailsData:"api/Reports/SqlReports/SVGamingSportsDailyCommissionEstimateDetailsReportUniqueIdentifier/GetData",getBKVirtualAnalysisData:"api/Reports/SqlReports/SVGamingBVDailyCommissionEstimateReportUniqueIdentifier/GetData",getBKVirtualAnalysisDetailsData:"api/Reports/SqlReports/SVGamingBVDailyCommissionEstimateDetailsReportUniqueIdentifier/GetData",getBKVirtualMobileAnalysisData:"api/Reports/SqlReports/SVGamingBVMobileCommissionEstimateReportUniqueIdentifier/GetData",getBKVirtualMobileAnalysisDetailsData:"api/Reports/SqlReports/SVGamingBVMobileCommissionEstimateDetailsReportUniqueIdentifier/GetData",getGBVirtualAnalysisData:"api/Reports/SqlReports/SVGamingGBSoccerDailyCommissionEstimateReportUniqueIdentifier/GetData",getGBVirtualAnalysisDetailsData:"api/Reports/SqlReports/SVGamingGBSoccerDailyCommissionEstimateDetailsReportUniqueIdentifier/GetData",getGBColorAnalysisData:"api/Reports/SqlReports/SVGamingGBColorDailyCommissionEstimateReportUniqueIdentifier/GetData",getGBColorAnalysisDetailsData:"api/Reports/SqlReports/SVGamingGBColorDailyCommissionEstimateDetailsReportUniqueIdentifier/GetData",getMonthlySportBonusData:"api/Reports/SqlReports/SVGamingSportsBonusCommissionEstimateReportUniqueIdentifier/GetData",getMonthlySportBonusDetailsData:"api/Reports/SqlReports/SVGamingSportsBonusCommissionEstimateDetailsReportUniqueIdentifier/GetData",getVDogRaceAnalysisData:"api/Reports/SqlReports/SVGamingVirtualRacingCommissionEstimateReportUniqueIdentifier/GetData",getVDogRaceAnalysisDetailsData:"api/Reports/SqlReports/SVGamingVirtualRacingCommissionEstimateDetailsReportUniqueIdentifier/GetData",getSpin2WinAnalysisData:"api/Reports/SqlReports/SVGamingGRSPin2WinCommissionEstimateReportUniqueIdentifier/GetData",getSpin2WinAnalysisDetailsData:"api/Reports/SqlReports/SVGamingGRSpin2WinCommissionEstimateDetailsReportUniqueIdentifier/GetData",getGRLuckyBallCommissionEstimateDetailsData:"api/Reports/SqlReports/SVGamingPerfect6CommissionEstimateDetailsReportUniqueIdentifier/GetData",getGRLuckyBallCommissionEstimateData:"api/Reports/SqlReports/SVGamingPerfect6CommissionEstimateReportUniqueIdentifier/GetData",getSAUserDetailsData:"api/Reports/SqlReports/SuperAgentShopUserDetailsReportUniqueIdentifier/GetData",getCommissionPeriods:"api/Commissions/GetCommissionPeriods?commissionPlanId={{planId}}&AmountOfPeriods={{noPeriods}}",getCommissionAmountsToDeductForPeriod:"api/Commissions/GetCommissionAmountsToDeductForPeriod"}}},diagnostics:{baseUrl:globalSettings.GamingApiURL,endpoints:{logging:{postClientLog:"/api/Common/Logging/ClientLog"}}},finance:{baseUrl:globalSettings.GamingApiURL,endpoints:{financeAccount:{getAllAccounts:"/api/Finance/Accounts",getAccountById:"/api/Finance/Accounts/{{accountId}}",getPlaySourceCode:"/api/Finance/Accounts/PlaySource",getPlaySource:"/api/Finance/Accounts/ByPlaySource/{{playSource}}",transferBalance:"/api/Finance/Accounts/Transfer",getTransferCandidates:"/api/Finance/Accounts/Agents/TransferCandidates?UserStatusesFilterBy={{userStatusesFilterBy}}&DirectDescendantsOnly={{directDescendantsOnly}}&Recursive={{recursive}}&AgentsOnly={{agentsOnly}}&NonAgentsOnly={{nonAgentsOnly}}",transferFrom:"/api/Finance/Accounts/Agents/TransferFrom",transferFromMany:"/api/Finance/Accounts/Agents/TransferFromMany",transferTo:"/api/Finance/Accounts/Agents/TransferTo",transferToMany:"/api/Finance/Accounts/Agents/TransferToMany",getSubAccountBalance:"/api/Finance/Accounts/Agents/SubAccountBalances?subAccountId={{subAccountId}}"},transactionTypes:{getTransactionTypes:"/api/Finance/TransactionsTypes",getTransactionTypesByAccount:"/api/Finance/TransactionsTypes/ForAccount/{{localAccountId}}",getSubTransactionTypes:"/api/Finance/TransactionsTypes/{{transactionTypeId}}/SubTransactionTypes"},transactions:{getUserTransactions:"/api/Finance/Transactions/UserTransactions",getUserTransactionsByUser:"/api/Finance/Transactions/Agents/UserTransactions"},userLimits:{getMaxNumberOfSavedAccounts:"/api/Finance/VendorCreditCardDetails/MaxNumberOfSavedAccounts",getQueryDepositLimit:"/api/Finance/UserLimits/QueryDepositLimit",depositLimitGoals:"/api/Finance/UserLimits/DepositLimitGoals",getDepositRatio:"api/Financials/StakeDepositRatio",getUserWithdrawalConfiguration:"api/Financials/UserWithdrawalConfiguration?paymentMethodIdentifier={{paymentMethodIdentifier}}"},accountTypes:{GetLocalAccountTypes:"/api/Finance/AccountTypes/GetLocalAccountTypes"},liability:{GetLiabilityScore:"/api/Finance/Liability/LiabilityScore?userId={{userId}}&date={{date}}",getLiabilityThreshold:"/api/Finance/Liability/LiabilityThreshold/{{userId}}"},p2pCreditController:{GetCreditBalance:"/api/Finance/P2PCreditController/GetCreditBalance"}}},location:{baseUrl:globalSettings.GamingApiURL,endpoints:{country:{getAllCountries:"/api/Location/Countries",getCountryByCode:"/api/Location/Countries/{{countryCode}}",getCountryByipAddress:"/api/Location/Countries/{{ipAddress}}",getCountryStates:"/api/Location/Countries/{{countryCode}}/States",getCountryCityValidation:"api/Location/Countries/ValidateCityForCountry?countryCode={{countryCode}}&cityName={{cityName}}",getCountryCitySearchResult:"/api/Location/Countries/CitySearch",getCountryOfUser:"/api/Location/Countries/CountryOfUser"},state:{getStateCities:"/api/Location/States/{{countryCode}}_{{stateName}}/Cities",getStateProvinces:"/api/Location/States/{{countryCode}}_{{stateName}}/Provinces"},province:{getProvinceCities:"/api/Location/Provinces/{{countryCode}}_{{provinceName}}/Cities"},telephone:{getTelephoneExtensions:"/api/Location/TelephoneExtensions",getCountryTelephoneExtension:"/api/Location/TelephoneExtensions/{{countryCode}}"},city:{getCityState:"api/Location/Cities/{{countryCode}}_{{cityName}}/State",getCityProvince:"api/Location/Cities/{{countryCode}}_{{cityName}}/Province"}}},gamingVendors:{baseUrl:globalSettings.GamingApiURL,endpoints:{globalBet:{getGameFrameUrl:"/api/GamingVendors/GlobalBet/GameFrameUrl?globalBetClientType={{globalBetClientType}}",getLogoutUrl:"/api/GamingVendors/GlobalBet/LogoutUrl/WEB"},goldenRace:{isUserEnabled:"api/GamingVendors/GoldenRace/IsEnabled",getCashierUrl:"api/GamingVendors/GoldenRace/CashierUrl",getGroupEntityID:"api/GamingVendors/GoldenRace/GroupEntityID?userID={{userId}}"},casinoGames:{platformTypes:"/api/GamingVendors/CasinoGames/PlatformTypes",categories:"/api/GamingVendors/CasinoGames/Categories",games:"/api/GamingVendors/CasinoGames/Games?platformTypeCode={{platformTypeCode}}&categoryCode={{categoryCode}}",getGameUrl:"/api/GamingVendors/CasinoGames/Games/GetGameUrl?gameId={{gameId}}&platformTypeCode={{platformTypeCode}}&demoMode={{demoMode}}&lobbyurl={{lobbyUrl}}"},wallets:{getWallets:"/api/GamingVendors/Wallets/",withdrawableByCategory:"/api/GamingVendors/Wallets/{{walletCategory}}/Withdrawable/Identities",getWalletsByUserId:"/api/GamingVendors/Wallets/{{userId}}",getWalletByWalletId:"/api/GamingVendors/Wallets/{{walletId}}",postTransferBalance:"/api/GamingVendors/Wallets/TransferBalance",withdrawable:"/api/GamingVendors/Wallets/Withdrawable",transferCandidates:"/GamingVendors/Wallets/{{walletId}}/TransferCandidates"},poker:{getOSSupport:"/api/GamingVendors/Poker/HivePoker/OSSupport",getClient:"/api/GamingVendors/Poker/HivePoker/Client/{{osCode}}",isVendorEnabled:"/api/GamingVendors/Poker/HivePoker/IsEnabled",getUserInfo:"/api/GamingVendors/Poker/HivePoker/GetUserInfo",register:"/api/GamingVendors/Poker/HivePoker/Register",resetPassword:"/api/GamingVendors/Poker/HivePoker/ResetPassword",resendPassword:"/api/GamingVendors/Poker/HivePoker/ResendPassword"},sportsbook:{cashoutCoupon:"/api/GamingVendors/3BGSportsbook/CashoutCoupon?couponIdentifier={{couponIdentifier}}&remarks={{remarks}}",getTopLevelEnabledUserList:"/api/GamingVendors/3BGSportsbook/GetTopLevelEnabledUserList?includeAgents={{includeAgents}}&agentId={{agentId}}&canPlaySportsbook={{canPlaySportsbook}}",isVendorEnabled:"/api/GamingVendors/3BGSportsbook/IsEnabled",getDelegatedBetUserList:"api/GamingVendors/3BGSportsbook/GetDelegatedBetUserList",checkCouponRefundStatus:"api/GamingVendors/3BGSportsbook/CheckCouponRefundStatus?couponIdentifier={{couponIdentifier}}",getWinNotificationSetting:"api/GamingVendors/3BGSportsbook/GetWinNotificationSetting",setWinNotificationSetting:"api/GamingVendors/3BGSportsbook/SetWinNotificationSetting"}}},paymentVendors:{baseUrl:globalSettings.GamingApiURL,endpoints:{amole:{performDeposit:"api/PaymentVendors/Amole/PerformWebDeposit",authorizeDeposit:"api/PaymentVendors/Amole/AuthorizeDeposit",registerWithdrawal:"api/PaymentVendors/Amole/RegisterWithdrawal",fetchApprovedAmoleWithdrawals:"api/PaymentVendors/Amole/FetchApprovedAmoleWithdrawals",authorizationWithdrawal:"api/PaymentVendors/Amole/AuthorizationWithdrawal",finalizeWithdrawal:"api/PaymentVendors/Amole/FinalizeWithdrawal",cancelWithdrawal:"api/PaymentVendors/Amole/CancelWithdrawal"},neteller:{isDepositEnabled:"/api/PaymentVendors/Neteller/isDepositEnabled",isWithdrawalEnabled:"/api/PaymentVendors/Neteller/isWithdrawalEnabled",isUserRegistered:"/api/PaymentVendors/Neteller/isUserRegistered",externalRegistrationDetails:"/api/PaymentVendors/Neteller/externalRegistrationDetails",performDeposit:"/api/PaymentVendors/Neteller/PerformDeposit",performWithdrawal:"/api/PaymentVendors/Neteller/PerformWithdrawal?amountToWithdraw={{amountToWithdraw}}"},emoney:{isDepositEnabled:"/api/PaymentVendors/EMoney/IsDepositEnabled",isWithdrawalEnabled:"/api/PaymentVendors/EMoney/IsWithdrawalEnabled",isUserVerified:"/api/PaymentVendors/EMoney/IsUserVerified",getToken:"/api/PaymentVendors/EMoney/GetToken",deposit:"/api/PaymentVendors/EMoney/Deposit",withdraw:"/api/PaymentVendors/EMoney/Withdraw"},dummyDeposit:{performDeposit:"/api/PaymentVendors/DummyPaymentVendor/PerformDeposit?amount={{amount}}"},ecopayz:{isDepositEnabled:"/api/PaymentVendors/EcoPayz/IsDepositEnabled",isWithdrawalEnabled:"/api/PaymentVendors/EcoPayz/IsWithdrawalEnabled",getDepositRequestInfo:"/api/PaymentVendors/EcoPayz/GetRegularDepositIFrameUrl",registerWithdraw:"/api/PaymentVendors/EcoPayz/RequestWithdraw",getEcopayzAcc:"/api/PaymentVendors/EcoPayz/GetClientAccountNumber"},epg:{isDepositEnabled:"/api/PaymentVendors/EPG/IsDepositEnabled",isWithdrawalEnabled:"/api/PaymentVendors/EPG/IsWithdrawalEnabled",getDepositURL:"/api/PaymentVendors/EPG/GetDepositUrl",registerWithdraw:"/api/PaymentVendors/EPG/GetWithdrawalUrl",isPaymentMethodEnabled:"/api/PaymentVendors/EPG/IsPaymentMethodEnabled?paymentMethod={{paymentMethod}}",interacDepositExchange:"/api/PaymentVendors/EPG/InteracDepositExchange?amount={{amount}}",interacWithdrawalExchange:"/api/PaymentVendors/EPG/InteracWithdrawalExchange?amount={{amount}}",getInteracDepositUrl:"/api/PaymentVendors/EPG/GetInteracDepositUrl",getInteracWithdrawUrl:"/api/PaymentVendors/EPG/GetInteracWithdrawUrl"},paysafe:{registerDeposit:"/api/PaymentVendors/PaySafe/RegisterDeposit"},paystack:{getPaymentChannels:"/api/PaymentVendors/Paystack/PaymentChannels",registerDeposit:"/api/PaymentVendors/Paystack/RegisterDeposit",registerWithdrawal:"/api/PaymentVendors/Paystack/RegisterWithdrawal"},gtPay:{isDepositEnabled:"/api/PaymentVendors/GTPay/IsDepositEnabled",registerDeposit:"/api/PaymentVendors/GTPay/RegisterDeposit"},bankTransfer:{registerWithdraw:"/api/PaymentVendors/BankTransfer/RegisterWithdraw",getBankTransferDetails:"api/Finance/BankTransferDetails",postBankTransferDetails:"api/Finance/BankTransferDetails",getBankProfileByUserFriendlyName:"api/Finance/BankTransferDetails/{{userFriendlyName}}",getBankProfileById:"api/Finance/BankTransferDetails/{{id}}",deleteBankProfileById:"api/Finance/BankTransferDetails/{{id}}",updateDefaultBankTransferDetails:"api/Finance/BankTransferDetails/updateDefaultBankTransferDetails",checkAllowedBankProfiles:"api/Finance/BankTransferDetails/MaxNumberOfSavedAccounts"},bankInformation:{getBankList:"api/Finance/BankInformation/BankList",getVendorCreditCardDetails:"api/Finance/VendorCreditCardDetails?vendorName={{paymentVendor}}",deleteVendorCreditCardDetails:"api/Finance/VendorCreditCardDetails/{{cardId}}"},interswitch:{depositEnabled:"api/PaymentVendors/Interswitch/IsDepositEnabled",withdrawalEnabled:"api/PaymentVendors/Interswitch/IsWithdrawalEnabled",registerWebPayDirect:"api/PaymentVendors/Interswitch/RegisterWebPayDirectDeposit",registerWithdraw:"/api/PaymentVendors/Interswitch/RegisterWithdrawal",registerInterswitchWithdrawal:"api/PaymentVendors/Interswitch/RegisterInterswitchWithdrawal",getQuicktellerWithdrawalInfo:"api/PaymentVendors/Interswitch/GetQuicktellerWithdrawalInfo",getBankList:"api/PaymentVendors/Interswitch/GetBankList"},msu:{registerDeposit:"api/PaymentVendors/MSU/RegisterDeposit"},paypoint:{isDepositEnabled:"/api/PaymentVendors/Paypoint/IsDepositEnabled",isWithdrawalEnabled:"/api/PaymentVendors/Paypoint/IsWithdrawalEnabled",getCards:"/api/PaymentVendors/Paypoint/GetCards?isWithdrawal={{isWithdrawal}}",addACardAndStartFirstDeposit:"/api/PaymentVendors/Paypoint/AddACardAndStartFirstDeposit",handleFirstDepositResponse:"/api/PaymentVendors/Paypoint/HandleFirstDepositResponse",performNotFirstDeposit:"/api/PaymentVendors/Paypoint/PerformNotFirstDeposit",registerWithdrawal:"/api/PaymentVendors/Paypoint/RegisterWithdrawal"},wirecard:{isDepositEnabled:"/api/PaymentVendors/Wirecard/IsDepositEnabled",isWithdrawalEnabled:"/api/PaymentVendors/Wirecard/IsWithdrawalEnabled",getCards:"/api/PaymentVendors/Wirecard/GetCards?isWithdrawal={{isWithdrawal}}",registerDeposit:"/api/PaymentVendors/Wirecard/RegisterDeposit",handleFirstDepositResponse:"/api/PaymentVendors/Wirecard/HandleFirstDepositResponse",performNotFirstDeposit:"/api/PaymentVendors/Wirecard/PerformNotFirstDeposit",registerWithdrawal:"/api/PaymentVendors/Wirecard/RegisterWithdrawal"},apco:{isDepositEnabled:"/api/PaymentVendors/Apco/IsDepositEnabled?paymentCode={{paymentCode}}",isWithdrawalEnabled:"/api/PaymentVendors/Apco/IsWithdrawalEnabled?paymentCode={{paymentCode}}",getCards:"/api/PaymentVendors/Apco/GetCards",getDepositRequestInfo:"/api/PaymentVendors/Apco/GetDepositRequestInfo",registerWithdraw:"/api/PaymentVendors/Apco/registerWithdraw"},skrill:{isDepositEnabled:"/api/PaymentVendors/Skrill/IsDepositEnabled",isWithdrawalEnabled:"/api/PaymentVendors/Skrill/IsWithdrawalEnabled",getUserEmail:"/api/PaymentVendors/Skrill/GetUserEmail",getIFrameUrlToStartUserDeposit:"/api/PaymentVendors/Skrill/GetIFrameUrlToStartUserDeposit",getPaymentMethodIFrameUrl:"/api/PaymentVendors/Skrill/GetPaymentMethodIFrameUrl",registerWithdraw:"/api/PaymentVendors/Skrill/RegisterWithdraw"},paymentMethods:{getAllDepositPaymentMethods:"/api/PaymentVendors/PaymentMethods/Deposit",getAllWithdrawalPaymentMethods:"/api/PaymentVendors/PaymentMethods/Withdrawal",getAllPendingWithdrawals:"/api/Finance/Transactions/GetPendingWithdrawals",requestACancelPendingWithdrawal:"/api/Finance/Transactions/CancelWithdrawal",hasPerformedDeposit:"/api/Finance/Transactions/HasPerformedDeposit"},safariCom:{registerOnlineDeposit:"/api/PaymentVendors/Safaricom/RegisterDepositOnline",registerWithdrawal:"/api/PaymentVendors/Safaricom/RegisterWithdrawal",getFeeBands:"/api/PaymentVendors/Safaricom/GetFeeBands"},zenith:{registerWithdrawal:"/api/PaymentVendors/ZenithBank/RegisterWithdrawal",registerZenithWithdrawalBankDetails:"api/PaymentVendors/ZenithBank/RegisterZenithWithdrawalBankDetails",getBankList:"api/PaymentVendors/ZenithBank/GetBankList"},mpesaExpress:{registerDeposit:"/api/PaymentVendors/KescomExpress/RegisterDeposit",transactionStatus:"/api/PaymentVendors/KescomExpress/Deposit/Status?transactionId={{transactionId}}"}}},user:{baseUrl:globalSettings.GamingApiURL,endpoints:{messages:{getUnreadCount:"/api/User/Messages/UnreadCount",getLoginMessages:"/api/User/Messages/LoginMessages",markMessageAsRead:"/api/User/Messages/{{messageId}}/MarkRead",markMessageAsUnread:"/api/User/Messages/{{messageId}}/MarkUnread",
deleteMessage:"/api/User/Messages/{{messageId}}/Delete",searchMessages:"/api/User/Messages/Search?",getAllMessages:"/api/User/Messages",getMessageDetails:"/api/User/Messages/{{messageId}}",sendMessage:"api/User/Messages/PostMessage",getMessageTemplates:"api/User/Messages/MessageTemplates"},profile:{getCurrentUserProfile:"/api/User/Profile",updateCurrentUserProfile:"/api/User/Profile",getLoginSessions:"api/User/Profile/Agents/SessionHistory/{{userId}}?from={{from}}&to={{to}}",getRealityCheckAmount:"/api/User/Profile/GetRealityCheckAmount",getRealityCheckTimeoutLimits:"/api/User/Profile/RealityCheckTimeoutLimits",getSessionTimeoutLimits:"/api/User/Profile/SessionTimeoutLimits",getUserList:"/api/User/Profile/Agents/UserList",getAgentCode:"/api/User/Profile/Agents/AgentCode",isAgent:"/api/User/Profile/Agents/IsAgent",changePassword:"/api/User/Profile/Agents/ChangePassword",isVirtualsEnabled:"api/GamingVendors/BetagyVirtuals/IsEnabled",isVirtualsEnabledWithIntent:"api/GamingVendors/BetagyVirtuals/IsEnabledWithIntent?bvIntentType={{bvIntentType}}",isSportsbookEnabled:"api/GamingVendors/3BGSportsbook/IsEnabled",verifyMobileNumber:"api/User/Profile/VerifyMobileNumber",getUserExtraDetails:"api/User/Profile/UserExtraDetails",setUserExtraDetails:"api/User/Profile/UserExtraDetails"}}},common:{baseUrl:globalSettings.GamingApiURL,endpoints:{requestBet:"/api/Common/RequestBet"}},security:{baseUrl:globalSettings.GamingApiURL,endpoints:{accounts:{getResetPasswordOption:"/api/Security/Accounts/RequestPasswordReset/Current",getChangePhoneNumberOption:"/api/Security/Accounts/RequestChangePhoneNumber/Current",postChangePassword:"/api/Security/Accounts/ChangePassword",getSecurityQuestion:"/api/Security/Accounts/{{userName}}/SecurityQuestion",getUserStatus:"/api/Security/Accounts/Status",resetPassword:"/api/Security/Accounts/ResetPassword",requestPasswordReset:"/api/Security/Accounts/RequestPasswordReset",requestPasswordResetByEmail:"/api/Security/Accounts/RequestResetPasswordByEmail",requestPasswordResetBySms:"/api/Security/Accounts/RequestResetPasswordBySMS",validatePasswordReset:"/api/Security/Accounts/ValidatePasswordReset?token={{token}}",completePasswordReset:"/api/Security/Accounts/CompletePasswordReset",completePasswordResetBySms:"/api/Security/Accounts/Request/Activation",regenerateTokenForService:"/api/Security/Accounts/RegenerateTokenForService",validateOneTimePassword:"/api/Security/Accounts/ValidateOneTimePassword",startVerificationBySMS:"/api/Security/Accounts/Request/StartVerificationBySMS"},registration:{getActivationOption:"/api/Security/Registration/RegistrationActivationOptions/Current",validateUserName:"/api/Security/Registration/ValidateUserName?userName={{userName}}",validateMobileNumber:"/api/Security/Registration/ValidateMobileNumber",validateEmailAddress:"/api/Security/Registration/ValidateEmailAddress?emailAddress={{emailAddress}}",validatePassword:"/api/Security/Registration/ValidatePassword",getSiteDiscoveryMethods:"/api/Security/Registration/SiteDiscoveryMethods",registerUser:"/api/Security/Registration/RegisterUser",registerByEmail:"/api/Security/Registration/RegistrationByEmail",registerBySms:"/api/Security/Registration/RegistrationBySMS",registerNewUser:"/api/Security/Registration/RegisterNewUser",getEmailLanguages:"/api/Security/Registration/EmailCommunicationLanguages",getSecurityQuestions:"/api/Security/Registration/SecurityQuestions",getRegistrationCountries:"/api/Security/Registration/RegistrationCountries",getRegistrationCurrencies:"/api/Security/Registration/RegistrationCurrencies",getDepositLimitPeriods:"/api/Security/Registration/DepositLimitPeriod",postActivateUser:"/api/Security/Registration/ActivateAccount",resendActivation:"/api/Security/Registration/ResendActivation",canRegisterSubAccountPlayers:"/api/Security/Registration/CanRegisterSubAccountPlayers",getCitzenshipRequiredInfo:"api/Security/Registration/CitzenshipRequiredInfo?citzenshipCountryCode={{citzenshipCountryCode}}",isKYCCheckEnabled:"api/Settings/Brand/IsKYCCheckEnabled"}}},settings:{baseUrl:globalSettings.GamingApiURL,endpoints:{brand:{hasActivationProcess:"/api/Settings/Brand/HasAccountActivationProcess"}}},clientSpecific:{baseUrl:globalSettings.GamingApiURL,endpoints:{user:{agents:{registerNewShopOwner:"/api/{{clientIdentifier}}/User/Agents/RegisterNewShopOwner",registerShopOwner:"/api/{{clientIdentifier}}/User/Agents/RegisterShopOwner",addCashiers:"/api/{{clientIdentifier}}/User/Agents/AddCashiers"}}}},commissions:{baseUrl:globalSettings.GamingApiURL,endpoints:{getCommissionPlans:"api/Commissions/GetCommissionPlans",getCommissionPlan:"api/Commissions/GetCommissionPlan?commissionPlanId={{commissionPlanId}}",getCommissionPlansForUser:"api/Commissions/GetCommissionPlansForUser",getTargets:"api/Commissions/GetTargets",getProgress:"api/Commissions/GetProgress"}}}}]).factory("platformApiService",["platformApiConfig","platformApiHttp",function(a,b){return{report:{getSqlReports:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getSqlReports,e={};return b.post(d,{},c,e)},getCashiersSummaryData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getCashiersSummaryData,e={};return b.post(d,{},c,e)},getBalanceOverviewData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getBalanceOverviewData,e={};return b.post(d,{},c,e)},getSportsbookBetsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getSportsbookBetsData,e={};return b.post(d,{},c,e)},getAgentProductsSalesData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getAgentProductsSalesData,e={};return b.post(d,{},c,e)},getSportsbookSalesByChannelData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getSportsbookSalesByChannelData,e={};return b.post(d,{},c,e)},getSportsbookBetsByUserData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getSportsbookBetsByUserData,e={};return b.post(d,{},c,e)},getSportsbookWinsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getSportsbookWinsData,e={};return b.post(d,{},c,e)},getCashPayoutsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getCashPayoutsData,e={};return b.post(d,{},c,e)},getVirtualWinsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getVirtualWinsData,e={};return b.post(d,{},c,e)},getVirtualBetsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getVirtualBetsData,e={};return b.post(d,{},c,e)},getBVWinsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getBVWinsData,e={};return b.post(d,{},c,e)},getBVBetsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getBVBetsData,e={};return b.post(d,{},c,e)},getGRWinsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getGRWinsData,e={};return b.post(d,{},c,e)},getGRBetsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getGRBetsData,e={};return b.post(d,{},c,e)},getAllProductsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getAllProductsData,e={};return b.post(d,{},c,e)},getSportsbookProductData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getSportsbookProductData,e={};return b.post(d,{},c,e)},getGlobalbetProductData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getGlobalbetProductData,e={};return b.post(d,{},c,e)},getGoldenRaceProductData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getGoldenRaceProductData,e={};return b.post(d,{},c,e)},getLiabilityOverviewData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getLiabilityOverviewData,e={};return b.post(d,{},c,e)},getLiabilityAuditData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getLiabilityAuditData,e={};return b.post(d,{},c,e)},getCreditBalanceData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getCreditBalanceData,e={};return b.post(d,{},c,e)},getOnlineUsersBetSearchReportUniqueIdentifier:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getOnlineUsersBetSearchReportUniqueIdentifier,e={};return b.post(d,{},c,e)},getAgentCommissionData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getAgentCommissionData,e={};return b.post(d,{},c,e)},getAgentVirtualSalesData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getAgentVirtualSalesData,e={};return b.post(d,{},c,e)},getAgentLotterySalesData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getAgentLotterySalesData,e={};return b.post(d,{},c,e)},getLotteryBetsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getLotteryBetsData,e={};return b.post(d,{},c,e)},getLotteryWinsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getLotteryWinsData,e={};return b.post(d,{},c,e)},getLotteryExtWinsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getLotteryExtWinsData,e={};return b.post(d,{},c,e)},getVirtualsBetSearchData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getVirtualsBetSearchData,e={};return b.post(d,{},c,e)},getSportsAnalysisData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getSportsAnalysisData,e={};return b.post(d,{},c,e)},getSportsAnalysisDetailsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getSportsAnalysisDetailsData,e={};return b.post(d,{},c,e)},getBKVirtualAnalysisData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getBKVirtualAnalysisData,e={};return b.post(d,{},c,e)},getBKVirtualAnalysisDetailsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getBKVirtualAnalysisDetailsData,e={};return b.post(d,{},c,e)},getBKVMobileAnalysisData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getBKVirtualMobileAnalysisData,e={};return b.post(d,{},c,e)},getBKVMobileAnalysisDetailsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getBKVirtualMobileAnalysisDetailsData,e={};return b.post(d,{},c,e)},getGBVirtualAnalysisData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getGBVirtualAnalysisData,e={};return b.post(d,{},c,e)},getGBVirtualAnalysisDetailsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getGBVirtualAnalysisDetailsData,e={};return b.post(d,{},c,e)},getGBColorAnalysisData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getGBColorAnalysisData,e={};return b.post(d,{},c,e)},getGBColorAnalysisDetailsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getGBColorAnalysisDetailsData,e={};return b.post(d,{},c,e)},getLotSpecialFiveAnalysisData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getLotSpecialFiveAnalysisData,e={};return b.post(d,{},c,e)},getLotSpecialFiveAnalysisDetailsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getLotSpecialFiveAnalysisDetailsData,e={};return b.post(d,{},c,e)},getLotDailyAnalysisData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getLotDailyAnalysisData,e={};return b.post(d,{},c,e)},getLotDailyAnalysisDetailsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getLotDailyAnalysisDetailsData,e={};return b.post(d,{},c,e)},getVDogRaceAnalysisData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getVDogRaceAnalysisData,e={};return b.post(d,{},c,e)},getVDogRaceAnalysisDetailsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getVDogRaceAnalysisDetailsData,e={};return b.post(d,{},c,e)},getSpin2WinAnalysisData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getSpin2WinAnalysisData,e={};return b.post(d,{},c,e)},getSpin2WinAnalysisDetailsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getSpin2WinAnalysisDetailsData,e={};return b.post(d,{},c,e)},getGRLuckyBallCommissionEstimateDetailsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getGRLuckyBallCommissionEstimateDetailsData,e={};return b.post(d,{},c,e)},getGRLuckyBallCommissionEstimateData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getGRLuckyBallCommissionEstimateData,e={};return b.post(d,{},c,e)},getSAUserDetailsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getSAUserDetailsData,e={};return b.post(d,{},c,e)},getCommissionPeriods:function(c,d){var e=a.finance.baseUrl+a.report.endpoints.report.getCommissionPeriods,f={planId:c,noPeriods:d},g={showLoader:!0};return b.get(e,f,g)},getCommissionAmountsToDeductForPeriod:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getCommissionAmountsToDeductForPeriod,e={};return b.post(d,{},c,e)},getMonthlySportBonusData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getMonthlySportBonusData,e={};return b.post(d,{},c,e)},getMonthlySportBonusDetailsData:function(c){var d=a.report.baseUrl+a.report.endpoints.report.getMonthlySportBonusDetailsData,e={};return b.post(d,{},c,e)}},finance:{getAllAccounts:function(){var c=a.finance.baseUrl+a.finance.endpoints.financeAccount.getAllAccounts,d={};return b.get(c,{},d)},getAccountById:function(c){var d=a.finance.baseUrl+a.finance.endpoints.financeAccount.getAccountById,e={accountId:c},f={};return b.get(d,e,f)},getPlaySourceCode:function(){var c=a.finance.baseUrl+a.finance.endpoints.financeAccount.getPlaySourceCode,d={};return b.get(c,{},d)},getPlaySource:function(c){var d=a.finance.baseUrl+a.finance.endpoints.financeAccount.getPlaySource,e={playSource:c},f={};return b.get(d,e,f)},transferBalance:function(c){var d=a.finance.baseUrl+a.finance.endpoints.financeAccount.transferBalance,e={showLoader:!0};return b.post(d,{},c,e)},getTransferCandidates:function(c,d,e,f,g){var h=a.finance.baseUrl+a.finance.endpoints.financeAccount.getTransferCandidates,i={userStatusesFilterBy:c,directDescendantsOnly:d,recursive:e,agentsOnly:f,nonAgentsOnly:g},j={showLoader:!0};return b.get(h,i,j)},transferFrom:function(c){var d=a.finance.baseUrl+a.finance.endpoints.financeAccount.transferFrom,e={showLoader:!0};return b.post(d,{},c,e)},transferFromMany:function(c){var d=a.finance.baseUrl+a.finance.endpoints.financeAccount.transferFromMany,e={showLoader:!0};return b.post(d,{},c,e)},transferTo:function(c){var d=a.finance.baseUrl+a.finance.endpoints.financeAccount.transferTo,e={showLoader:!0};return b.post(d,{},c,e)},transferToMany:function(c){var d=a.finance.baseUrl+a.finance.endpoints.financeAccount.transferToMany,e={showLoader:!0};return b.post(d,{},c,e)},getSubAccountBalance:function(c){var d=a.finance.baseUrl+a.finance.endpoints.financeAccount.getSubAccountBalance,e={subAccountId:c},f={showLoader:!1};return b.get(d,e,f)},getTransactionTypes:function(){var c=a.finance.baseUrl+a.finance.endpoints.transactionTypes.getTransactionTypes,d={};return b.get(c,{},d)},getTransactionTypesByAccount:function(c){var d=a.finance.baseUrl+a.finance.endpoints.transactionTypes.getTransactionTypesByAccount,e={localAccountId:c},f={};return b.get(d,e,f)},getSubTransactionTypes:function(c){var d=a.finance.baseUrl+a.finance.endpoints.transactionTypes.getSubTransactionTypes,e={transactionTypeId:c},f={};return b.get(d,e,f)},getUserTransactions:function(c){var d=a.finance.baseUrl+a.finance.endpoints.transactions.getUserTransactions,e={showLoader:!0};return b.post(d,{},c,e)},getUserTransactionsByUser:function(c){var d=a.finance.baseUrl+a.finance.endpoints.transactions.getUserTransactionsByUser,e={showLoader:!0};return b.post(d,{},c,e)},getMaxNumberOfSavedAccounts:function(){var c=a.finance.baseUrl+a.finance.endpoints.userLimits.getMaxNumberOfSavedAccounts,d={};return b.get(c,{},d)},getQueryDepositLimit:function(){var c=a.finance.baseUrl+a.finance.endpoints.userLimits.getQueryDepositLimit,d={};return b.get(c,{},d)},getDepositLimitGoals:function(){var c=a.finance.baseUrl+a.finance.endpoints.userLimits.depositLimitGoals,d={};return b.get(c,{},d)},getDepositRatio:function(){var c=a.finance.baseUrl+a.finance.endpoints.userLimits.getDepositRatio,d={};return b.get(c,{},d)},getUserWithdrawalConfiguration:function(c){var d=a.finance.baseUrl+a.finance.endpoints.userLimits.getUserWithdrawalConfiguration,e={},f={paymentMethodIdentifier:c||""};return b.get(d,f,e)},setDepositLimitGoals:function(c){var d=a.finance.baseUrl+a.finance.endpoints.userLimits.depositLimitGoals,e={};return b.post(d,{},c,e)},getAccountTypes:function(){var c=a.finance.baseUrl+a.finance.endpoints.accountTypes.GetLocalAccountTypes,d={};return b.get(c,{},d)},getLiabilityScore:function(c,d){var e=a.finance.baseUrl+a.finance.endpoints.liability.GetLiabilityScore,f={userId:c,date:d},g={};return b.get(e,f,g)},getLiabilityThreshold:function(c){var d=a.finance.baseUrl+a.finance.endpoints.liability.getLiabilityThreshold,e={userId:c},f={};return b.get(d,e,f)},getCreditBalance:function(c){var d=a.finance.baseUrl+a.finance.endpoints.p2pCreditController.GetCreditBalance,e={};return b.post(d,{},c,e)}},gamingVendors:{globalBet:{getGameFrameUrl:function(c){var d=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.globalBet.getGameFrameUrl,e={globalBetClientType:c},f={};return b.get(d,e,f)},getLogoutUrl:function(){var c=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.globalBet.getLogoutUrl,d={};return b.get(c,{},d)}},goldenRace:{isUserEnabled:function(){var c=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.goldenRace.isUserEnabled,d={};return b.get(c,{},d)},getCashierUrl:function(){var c=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.goldenRace.getCashierUrl,d={};return b.get(c,{},d)},getGroupEntityID:function(c){var d=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.goldenRace.getGroupEntityID,e={userId:c},f={};return b.get(d,e,f)}},casinoGames:{platformTypes:function(c){var d=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.casinoGames.platformTypes,e={countryCode:c},f={};return b.get(d,e,f)},categories:function(){var c=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.casinoGames.categories,d={};return b.get(c,{},d)},games:function(c,d){var e=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.casinoGames.games,f={platformTypeCode:c,categoryCode:d},g={showLoader:!0};return b.get(e,f,g)},getGameUrl:function(c,d,e,f){var g=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.casinoGames.getGameUrl,h={gameId:c,platformTypeCode:d,demoMode:e,lobbyUrl:f},i={showLoader:!0};return b.get(g,h,i)}},wallets:{withdrawable:function(){var c=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.wallets.withdrawable,d={};return b.get(c,{},d)},withdrawableByCategory:function(c){var d=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.wallets.withdrawableByCategory,e={},f={walletCategory:c};return b.get(d,f,e)},getWalletsByUserId:function(c){var d=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.wallets.getWalletsByUserId,e={userId:c},f={};return b.get(d,e,f)},walletCategory:function(c){var d=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.wallets.walletCategory,e={walletCategory:c},f={};return b.get(d,e,f)},transferCandidates:function(c){var d=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.wallets.transferCandidates,e={walletId:c},f={};return b.get(d,e,f)},getCurrentUserProfile:function(){var c=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.wallets.getCurrentUserProfile,d={};return b.get(c,{},d)},transferBalance:function(c){var d=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.wallets.transferBalance,e={showLoader:!0};return b.post(d,{},c,e)}},poker:{getOSSupport:function(){var c=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.poker.getOSSupport,d={};return b.get(c,{},d)},getClient:function(c){var d=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.poker.getClient,e={osCode:c},f={};return b.get(d,e,f)},isPokerVendorEnabled:function(){var c=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.poker.isVendorEnabled,d={};return b.get(c,{},d)},getUserInfo:function(){var c=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.poker.getUserInfo,d={};return b.get(c,{},d)},register:function(c){var d=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.poker.register,e={};return b.post(d,{},c,e)},resetPassword:function(c){var d=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.poker.resetPassword,e={};return b.post(d,{},c,e)},resendPassword:function(){var c=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.poker.resendPassword,d={};return b.post(c,{},{},d)}},sportsbook:{cashoutCoupon:function(c,d){var e=a.security.baseUrl+a.gamingVendors.endpoints.sportsbook.cashoutCoupon;return urlValues={couponIdentifier:c,remarks:d},options={},b.post(e,urlValues,{},options)},getTopLevelEnabledUserList:function(c,d,e){var f=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.sportsbook.getTopLevelEnabledUserList,g={includeAgents:c,agentId:d,canPlaySportsbook:e},h={showLoader:!0};return b.get(f,g,h)},isVendorEnabled:function(){var c=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.sportsbook.isVendorEnabled,d={};return b.get(c,{},d)},getDelegatedBetUserList:function(){var c=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.sportsbook.getDelegatedBetUserList,d={};return b.get(c,{},d)},checkCouponRefundStatus:function(c){var d=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.sportsbook.checkCouponRefundStatus,e={couponIdentifier:c},f={};return b.get(d,e,f)},getWinNotificationSetting:function(){var c=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.sportsbook.getWinNotificationSetting,d={};return b.get(c,{},d)},setWinNotificationSetting:function(c){var d=a.gamingVendors.baseUrl+a.gamingVendors.endpoints.sportsbook.setWinNotificationSetting,e={};return b.post(d,{},c,e)}}},paymentVendors:{amole:{performDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.amole.performDeposit,e={};return b.post(d,{},c,e)},authorizeDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.amole.authorizeDeposit,e={};return b.post(d,{},c,e)},registerWithdrawal:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.amole.registerWithdrawal,e={};return b.post(d,{},c,e)},fetchApprovedAmoleWithdrawals:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.amole.fetchApprovedAmoleWithdrawals,d={};return b.get(c,{},d)},authorizationWithdrawal:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.amole.authorizationWithdrawal,e={};return b.post(d,{},c,e)},finalizeWithdrawal:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.amole.finalizeWithdrawal,e={};return b.post(d,{},c,e)},cancelWithdrawal:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.amole.cancelWithdrawal,e={};return b.post(d,{},c,e)}},epg:{isDepositEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.epg.isDepositEnabled,d={};return b.get(c,{},d)},isWithdrawalEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.epg.isWithdrawalEnabled,d={};return b.get(c,{},d)},getDepositURL:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.epg.getDepositURL,e={};return b.post(d,{},c,e)},registerWithdraw:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.epg.registerWithdraw,e={};return b.post(d,{},c,e)},isPaymentMethodEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.epg.isPaymentMethodEnabled,d={};return b.get(c,{},d)},interacDepositExchange:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.epg.interacDepositExchange,e={amount:c},f={};return b.get(d,e,{},f)},interacWithdrawalExchange:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.epg.interacWithdrawalExchange,e={amount:c},f={};return b.get(d,e,{},f)},getInteracDepositUrl:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.epg.getInteracDepositUrl,e={};return b.post(d,{},c,e)},getInteracWithdrawUrl:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.epg.getInteracWithdrawUrl,e={};return b.post(d,{},c,e)}},dummyDeposit:{performDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.dummyDeposit.performDeposit,e={amount:c},f={showLoader:!0};return b.post(d,e,{},f)},getDepositRequestInfo:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.dummyDeposit.getDepositRequestInfo,e={};return b.post(d,{},c,e)}},ecopayz:{isDepositEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.ecopayz.isDepositEnabled,d={};return b.get(c,{},d)},isWithdrawalEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.ecopayz.isWithdrawalEnabled,d={};return b.get(c,{},d)},getDepositRequestInfo:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.ecopayz.getDepositRequestInfo,e={};return b.post(d,{},c,e)},registerWithdraw:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.ecopayz.registerWithdraw,e={};return b.post(d,{},c,e)},getEcopayzAcc:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.ecopayz.getEcopayzAcc,d={};return b.get(c,{},d)}},apco:{isDepositEnabled:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.apco.isDepositEnabled,e={paymentCode:c},f={};return b.get(d,e,f)},isWithdrawalEnabled:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.apco.isWithdrawalEnabled,e={paymentCode:c},f={};return b.get(d,e,f)},getCards:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.apco.getCards,d={};return b.get(c,{},d)},getDepositRequestInfo:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.apco.getDepositRequestInfo,e={};return b.post(d,{},c,e)},registerWithdraw:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.apco.registerWithdraw,e={};return b.post(d,{},c,e)}},bankTransfer:{registerWithdraw:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.bankTransfer.registerWithdraw,e={showLoader:!0};return b.post(d,{},c,e)},getBankTransferDetails:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.bankTransfer.getBankTransferDetails,d={};return b.get(c,{},d)},postBankTransferDetails:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.bankTransfer.postBankTransferDetails,e={showLoader:!0};return b.post(d,{},c,e)},getBankProfileByUserFriendlyName:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.bankTransfer.getBankProfileByUserFriendlyName,e={userFriendlyName:c},f={showLoader:!0};return b.get(d,e,f)},getBankProfileById:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.bankTransfer.getBankProfileById,e={id:c},f={showLoader:!0};return b.get(d,e,f)},deleteBankProfileById:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.bankTransfer.deleteBankProfileById,e={id:c},f={showLoader:!0};return b.delete(d,e,f)},updateDefaultBankTransferDetails:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.bankTransfer.updateDefaultBankTransferDetails,e={showLoader:!0};return b.post(d,{},c,e)},checkAllowedBankProfiles:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.bankTransfer.checkAllowedBankProfiles,d={showLoader:!0};return b.get(c,d)}},bankInformation:{getBankList:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.bankInformation.getBankList,d={showLoader:!0};return b.get(c,{},d)},getVendorCreditCardDetails:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.bankInformation.getVendorCreditCardDetails,e={paymentVendor:c},f={showLoader:!1};return b.get(d,e,f)},deleteVendorCreditCardDetails:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.bankInformation.deleteVendorCreditCardDetails,e={cardId:c},f={showLoader:!0};return b.delete(d,e,f)}},interswitch:{registerWithdraw:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.interswitch.registerWithdraw,e={showLoader:!0};return b.post(d,{},c,e)},registerInterswitchWithdrawal:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.interswitch.registerInterswitchWithdrawal,e={showLoader:!0};return b.post(d,{},c,e)},depositEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.interswitch.depositEnabled,d={showLoader:!0};return b.get(c,{},d)},withdrawalEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.interswitch.withdrawalEnabled,d={showLoader:!0};return b.get(c,{},d)},registerWebPayDirect:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.interswitch.registerWebPayDirect,e={showLoader:!0};return b.post(d,{},c,e)},getQuicktellerWithdrawalInfo:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.interswitch.getQuicktellerWithdrawalInfo,d={showLoader:!0};return b.get(c,{},d)},getBankList:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.interswitch.getBankList,d={showLoader:!0};return b.get(c,{},d)}},msu:{registerDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.msu.registerDeposit,e={};return b.post(d,{},c,e)}},emoney:{isDepositEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.emoney.isDepositEnabled,d={};return b.get(c,{},d)},isWithdrawalEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.emoney.isWithdrawalEnabled,d={};return b.get(c,{},d)},isUserVerified:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.emoney.isUserVerified,d={};return b.get(c,{},d)},getToken:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.emoney.getToken,d={};return b.get(c,{},d)},deposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.emoney.deposit,e={};return b.post(d,{},c,e)},withdraw:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.emoney.withdraw,e={};return b.post(d,{},c,e)}},neteller:{isDepositEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.neteller.isDepositEnabled,d={showLoader:!0};return b.get(c,{},d)},isWithdrawalEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.neteller.isWithdrawalEnabled,d={showLoader:!0};return b.get(c,{},d)},isUserRegistered:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.neteller.isUserRegistered,d={showLoader:!0};return b.get(c,{},d)},externalRegistrationDetails:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.neteller.externalRegistrationDetails,d={};return b.get(c,{},d)},performDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.neteller.performDeposit,e={};return b.post(d,{},c,e)},performWithdrawal:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.neteller.performWithdrawal,e={amountToWithdraw:c},f={showLoader:!0};return b.post(d,e,{},f)}},paypoint:{isDepositEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paypoint.isDepositEnabled,d={showLoader:!0};return b.get(c,{},d)},isWithdrawalEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paypoint.isWithdrawalEnabled,d={};return b.get(c,{},d)},getCards:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paypoint.getCards,e={isWithdrawal:c},f={showLoader:!0};return b.get(d,e,f)},addACardAndStartFirstDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paypoint.addACardAndStartFirstDeposit,e={showLoader:!0};return b.post(d,{},c,e)},handleFirstDepositResponse:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paypoint.handleFirstDepositResponse,d={};return b.post(c,{},{},d)},performNotFirstDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paypoint.performNotFirstDeposit,e={showLoader:!0};return b.post(d,{},c,e)},registerWithdrawal:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paypoint.registerWithdrawal,e={showLoader:!0};return b.post(d,{},c,e)}},paymentMethods:{hasPerformedDeposit:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paymentMethods.hasPerformedDeposit,d={};return b.get(c,{},d)},getAllDepositPaymentMethods:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paymentMethods.getAllDepositPaymentMethods,d={showLoader:!0};return b.get(c,{},d)},getAllWithdrawalPaymentMethods:function(){
var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paymentMethods.getAllWithdrawalPaymentMethods,d={};return b.get(c,{},d)},getAllPendingWithdrawals:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paymentMethods.getAllPendingWithdrawals,e={};return b.post(d,{},c,e)},requestACancelPendingWithdrawal:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paymentMethods.requestACancelPendingWithdrawal,e={};return b.post(d,{},c,e)}},paysafe:{registerDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paysafe.registerDeposit,e={showLoader:!0};return b.post(d,{},c,e)}},paystack:{getPaymentChannels:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paystack.getPaymentChannels,d={showLoader:!0};return b.get(c,{},d)},registerDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paystack.registerDeposit,e={showLoader:!0};return b.post(d,{},c,e)},registerWithdrawal:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.paystack.registerWithdrawal,e={showLoader:!0};return b.post(d,{},c,e)}},zenith:{registerWithdrawal:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.zenith.registerWithdrawal,e={showLoader:!0};return b.post(d,{},c,e)},registerZenithWithdrawalBankDetails:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.zenith.registerZenithWithdrawalBankDetails,e={showLoader:!0};return b.post(d,{},c,e)},getBankList:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.zenith.getBankList,d={showLoader:!0};return b.get(c,{},d)}},mpesaExpress:{registerDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.mpesaExpress.registerDeposit,e={Amount:c},f={showLoader:!1};return b.post(d,{},e,f)},transactionStatus:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.mpesaExpress.transactionStatus,e={transactionId:c},f={showLoader:!1};return b.get(d,e,f)}},gtPay:{isDepositEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.gtPay.isDepositEnabled,d={showLoader:!0};return b.get(c,{},d)},registerDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.gtPay.registerDeposit,e={showLoader:!0};return b.post(d,{},c,e)}},skrill:{isDepositEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.skrill.isDepositEnabled,d={showLoader:!0};return b.get(c,{},d)},isWithdrawalEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.skrill.isWithdrawalEnabled,d={showLoader:!0};return b.get(c,{},d)},getUserEmail:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.skrill.getUserEmail,d={showLoader:!0};return b.get(c,{},d)},getIFrameUrlToStartUserDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.skrill.getIFrameUrlToStartUserDeposit,e={};return b.post(d,{},c,e)},getPaymentMethodIFrameUrl:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.skrill.getPaymentMethodIFrameUrl,e={};return b.post(d,{},c,e)},registerWithdraw:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.skrill.registerWithdraw,e={showLoader:!0};return b.post(d,{},c,e)}},wirecard:{isDepositEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.wirecard.isDepositEnabled,d={showLoader:!0};return b.get(c,{},d)},isWithdrawalEnabled:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.wirecard.isWithdrawalEnabled,d={showLoader:!0};return b.get(c,{},d)},getCards:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.wirecard.getCards,e={isWithdrawal:c},f={showLoader:!0};return b.get(d,e,f)},registerDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.wirecard.registerDeposit,e={showLoader:!0};return b.post(d,{},c,e)},performNotFirstDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.wirecard.performNotFirstDeposit,e={showLoader:!0};return b.post(d,{},c,e)},registerWithdrawal:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.wirecard.registerWithdrawal,e={showLoader:!0};return b.post(d,{},c,e)}},safariCom:{registerOnlineDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.safariCom.registerOnlineDeposit,e={showLoader:!0};return b.post(d,{},c,e)},registerWithdrawal:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.safariCom.registerWithdrawal,e={showLoader:!0};return b.post(d,{},c,e)},getFeeBands:function(c,d){var e=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.safariCom.getFeeBands,f={PaymentMethod:c,Amount:d},g={};return b.post(e,{},f,g)}},safariCom:{registerOnlineDeposit:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.safariCom.registerOnlineDeposit,e={showLoader:!0};return b.post(d,{},c,e)},registerWithdrawal:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.safariCom.registerWithdrawal,e={showLoader:!0};return b.post(d,{},c,e)},getFeeBands:function(c,d){var e=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.safariCom.getFeeBands,f={PaymentMethod:c,Amount:d},g={};return b.post(e,{},f,g)}}},location:{getAllCountries:function(){var c=a.location.baseUrl+a.location.endpoints.country.getAllCountries,d={sendActivitySource:!0};return b.get(c,{},d)},getCountryByCode:function(c){var d=a.location.baseUrl+a.location.endpoints.country.getCountryByCode,e={countryCode:c},f={sendActivitySource:!0};return b.get(d,e,f)},getCountryByipAddress:function(c){var d=a.location.baseUrl+a.location.endpoints.country.getCountryByipAddress,e={ipAddress:c},f={};return b.get(d,e,f)},getCountryStates:function(c){var d=a.location.baseUrl+a.location.endpoints.country.getCountryStates,e={countryCode:c},f={sendActivitySource:!0};return b.get(d,e,f)},getCountryCityValidation:function(c,d){var e=a.location.baseUrl+a.location.endpoints.country.getCountryCityValidation,f={countryCode:c,cityName:d},g={};return b.post(e,f,{},g)},getCountryCitySearchResult:function(c){var d=a.location.baseUrl+a.location.endpoints.country.getCountryCitySearchResult,e={};return b.post(d,{},c,e)},getCountryOfUser:function(){var c=a.location.baseUrl+a.location.endpoints.country.getCountryOfUser,d={};return b.get(c,{},d)},getStateProvinces:function(c,d){var e=a.location.baseUrl+a.location.endpoints.state.getStateProvinces,f={countryCode:c,stateName:d},g={};return b.get(e,f,g)},getStateCities:function(c,d){var e=a.location.baseUrl+a.location.endpoints.state.getStateCities,f={countryCode:c,stateName:d},g={};return b.get(e,f,g)},getProvinceCities:function(c,d){var e=a.location.baseUrl+a.location.endpoints.province.getProvinceCities,f={countryCode:c,provinceName:d},g={};return b.get(e,f,g)},getTelephoneExtensions:function(){var c=a.location.baseUrl+a.location.endpoints.telephone.getTelephoneExtensions,d={};return b.get(c,{},d)},getCountryTelephoneExtension:function(c){var d=a.location.baseUrl+a.location.endpoints.telephone.getCountryTelephoneExtension,e={countryCode:c},f={};return b.get(d,e,f)},getCityState:function(c,d){var e=a.location.baseUrl+a.location.endpoints.city.getCityState,f={countryCode:c,cityName:d},g={};return b.get(e,f,g)},getCityProvince:function(c,d){var e=a.location.baseUrl+a.location.endpoints.city.getCityProvince,f={countryCode:c,cityName:d},g={};return b.get(e,f,g)}},user:{getCurrentUserProfile:function(){var c=a.user.baseUrl+a.user.endpoints.profile.getCurrentUserProfile,d={};return b.get(c,{},d)},updateCurrentUserProfile:function(c){var d=a.user.baseUrl+a.user.endpoints.profile.updateCurrentUserProfile,e={showLoader:!0};return b.post(d,{},c,e)},getRealityCheckAmount:function(){var c=a.user.baseUrl+a.user.endpoints.profile.getRealityCheckAmount,d={};return b.get(c,{},d)},getLoginSessions:function(c,d,e){var f=a.user.baseUrl+a.user.endpoints.profile.getLoginSessions,g={userId:c,from:d,to:e},h={};return b.get(f,g,{},h)},getRealityCheckTimeoutLimits:function(){var c=a.user.baseUrl+a.user.endpoints.profile.getRealityCheckTimeoutLimits,d={};return b.get(c,{},d)},getSessionTimeoutLimits:function(){var c=a.user.baseUrl+a.user.endpoints.profile.getSessionTimeoutLimits,d={};return b.get(c,{},d)},getUserList:function(c){var d=a.user.baseUrl+a.user.endpoints.profile.getUserList,e={showLoader:!0};return b.post(d,{},c,e)},getAgentCode:function(){var c=a.user.baseUrl+a.user.endpoints.profile.getAgentCode,d={};return b.get(c,{},d)},isAgent:function(c){var d=a.user.baseUrl+a.user.endpoints.profile.isAgent,e={apiVersion:c||1};return b.get(d,{},e)},changePassword:function(c){var d=a.user.baseUrl+a.user.endpoints.profile.changePassword,e={showLoader:!0};return b.post(d,{},c,e)},getUnreadMessageCount:function(){var c=a.user.baseUrl+a.user.endpoints.messages.getUnreadCount,d={};return b.get(c,{},d)},getLoginMessages:function(){var c=a.user.baseUrl+a.user.endpoints.messages.getLoginMessages,d={};return b.get(c,{},d)},markMessageAsRead:function(c){var d=a.user.baseUrl+a.user.endpoints.messages.markMessageAsRead,e={messageId:c},f={};return b.post(d,e,{},f)},markMessageAsUnread:function(c){var d=a.user.baseUrl+a.user.endpoints.messages.markMessageAsUnread,e={messageId:c};return b.post(d,e,{},{})},deleteMessage:function(c){var d=a.user.baseUrl+a.user.endpoints.messages.deleteMessage,e={messageId:c},f={};return b.post(d,e,{},f)},searchMessages:function(c){var d=a.user.baseUrl+a.user.endpoints.messages.searchMessages;d+="from="+c.from+"&to="+c.to,null!=c.state&&(d+="&state="+c.state),null!=c.title&&(d+="&title="+c.title),null!=c.rowsPerPage&&(d+="&rowsPerPage="+c.rowsPerPage),null!=c.pageNumber&&(d+="&pageNumber="+c.pageNumber);var e={};return b.get(d,{},e)},getAllMessages:function(){var c=a.user.baseUrl+a.user.endpoints.messages.getAllMessages,d={};return b.get(c,{},d)},getMessageDetails:function(c){var d=a.user.baseUrl+a.user.endpoints.messages.getMessageDetails,e={messageId:c},f={showLoader:!0};return b.get(d,e,f)},sendMessage:function(c){var d=a.user.baseUrl+a.user.endpoints.messages.sendMessage,e={showLoader:!0};return b.post(d,{},c,e)},getMessageTemplates:function(){var c=a.user.baseUrl+a.user.endpoints.messages.getMessageTemplates,d={};return b.get(c,{},d)},isVirtualsEnabled:function(){var c=a.user.baseUrl+a.user.endpoints.profile.isVirtualsEnabled;return b.get(c)},isVirtualsEnabledWithIntent:function(c){var d=a.user.baseUrl+a.user.endpoints.profile.isVirtualsEnabledWithIntent,e={bvIntentType:c};return b.get(d,e)},isSportsbookEnabled:function(){var c=a.user.baseUrl+a.user.endpoints.profile.isSportsbookEnabled;return b.get(c)},verifyMobileNumber:function(c){var d=a.user.baseUrl+a.user.endpoints.profile.verifyMobileNumber,e={MobileNumber:c},f={showLoader:!0};return b.post(d,{},e,f)},getUserExtraDetails:function(){var c=a.user.baseUrl+a.user.endpoints.profile.getUserExtraDetails;return b.get(c)},setUserExtraDetails:function(c){var d=a.user.baseUrl+a.user.endpoints.profile.setUserExtraDetails,e={};return b.post(d,{},c,e)}},common:{requestBet:function(c){var d=a.common.baseUrl+a.common.endpoints.requestBet,e={};return b.post(d,{},c,e)}},security:{getResetPasswordOption:function(){var c=a.security.baseUrl+a.security.endpoints.accounts.getResetPasswordOption,d={};return b.get(c,{},d)},getChangePhoneNumberOption:function(){var c=a.security.baseUrl+a.security.endpoints.accounts.getChangePhoneNumberOption,d={};return b.get(c,{},d)},postChangePassword:function(c){var d=a.security.baseUrl+a.security.endpoints.accounts.postChangePassword,e={showLoader:!0};return b.post(d,{},c,e)},getSecurityQuestion:function(c){var d=a.security.baseUrl+a.security.endpoints.accounts.getSecurityQuestion,e={userName:c},f={};return b.get(d,e,f)},resetPassword:function(c){var d=a.security.baseUrl+a.security.endpoints.accounts.resetPassword,e={showLoader:!0};return b.post(d,{},c,e)},requestPasswordReset:function(c){var d=a.security.baseUrl+a.security.endpoints.accounts.requestPasswordReset,e={showLoader:!0};return b.post(d,{},c,e)},requestPasswordResetByEmail:function(c){var d=a.security.baseUrl+a.security.endpoints.accounts.requestPasswordResetByEmail,e={showLoader:!0};return b.post(d,{},c,e)},requestPasswordResetBySms:function(c){var d=a.security.baseUrl+a.security.endpoints.accounts.requestPasswordResetBySms,e={showLoader:!0};return b.post(d,{},c,e)},validatePasswordReset:function(c){var d=a.security.baseUrl+a.security.endpoints.accounts.validatePasswordReset;return urlValues={token:c},options={},b.post(d,urlValues,{},options)},completePasswordReset:function(c){var d=a.security.baseUrl+a.security.endpoints.accounts.completePasswordReset,e={showLoader:!0};return b.post(d,{},c,e)},completePasswordResetBySms:function(c){var d=a.security.baseUrl+a.security.endpoints.accounts.completePasswordResetBySms,e={showLoader:!0};return b.post(d,{},c,e)},getUserStatus:function(){var c=a.security.baseUrl+a.security.endpoints.accounts.getUserStatus,d={};return b.get(c,{},d)},regenerateTokenForService:function(c){var d=a.security.baseUrl+a.security.endpoints.accounts.regenerateTokenForService,e={showLoader:!0,sendActivitySource:!0};return b.post(d,{},c,e)},validateOneTimePassword:function(c){var d=a.security.baseUrl+a.security.endpoints.accounts.validateOneTimePassword,e={showLoader:!0,sendActivitySource:!0};return b.post(d,{},c,e)},startVerificationBySMS:function(c){var d=a.security.baseUrl+a.security.endpoints.accounts.startVerificationBySMS,e={showLoader:!0,sendActivitySource:!0};return b.post(d,{},c,e)},getActivationOption:function(){var c=a.security.baseUrl+a.security.endpoints.registration.getActivationOption,d={sendActivitySource:!0};return b.get(c,{},d)},validateUserName:function(c){var d=a.security.baseUrl+a.security.endpoints.registration.validateUserName,e={userName:c},f={sendActivitySource:!0};return b.get(d,e,f)},validateMobileNumber:function(c){var d=a.security.baseUrl+a.security.endpoints.registration.validateMobileNumber,e={showLoader:!0,sendActivitySource:!0};return b.post(d,{},c,e)},validateEmailAddress:function(c){var d=a.security.baseUrl+a.security.endpoints.registration.validateEmailAddress,e={emailAddress:c},f={sendActivitySource:!0};return b.get(d,e,f)},validatePassword:function(c){var d=a.security.baseUrl+a.security.endpoints.registration.validatePassword,e={sendActivitySource:!0};return b.post(d,{},c,e)},getSiteDiscoveryMethods:function(){var c=a.security.baseUrl+a.security.endpoints.registration.getSiteDiscoveryMethods,d={sendActivitySource:!0};return b.get(c,{},d)},registerUser:function(c){var d=a.security.baseUrl+a.security.endpoints.registration.registerUser,e={sendActivitySource:!0};return b.post(d,{},c,e)},registerByEmail:function(c){var d=a.security.baseUrl+a.security.endpoints.registration.registerByEmail,e={sendActivitySource:!0};return b.post(d,{},c,e)},registerBySms:function(c){var d=a.security.baseUrl+a.security.endpoints.registration.registerBySms,e={sendActivitySource:!0};return b.post(d,{},c,e)},registerNewUser:function(c){var d=a.security.baseUrl+a.security.endpoints.registration.registerNewUser,e={sendActivitySource:!0};return b.post(d,{},c,e)},activateUser:function(c){var d=a.security.baseUrl+a.security.endpoints.registration.postActivateUser,e={showLoader:!0,sendActivitySource:!0};return b.post(d,{},c,e)},resendActivation:function(c){var d=a.security.baseUrl+a.security.endpoints.registration.resendActivation,e={sendActivitySource:!0};return b.post(d,{},c,e)},getEmailLanguages:function(){var c=a.security.baseUrl+a.security.endpoints.registration.getEmailLanguages,d={sendActivitySource:!0};return b.get(c,{},d)},getSecurityQuestions:function(){var c=a.security.baseUrl+a.security.endpoints.registration.getSecurityQuestions,d={showLoader:!0,sendActivitySource:!0};return b.get(c,{},d)},getRegistrationCountries:function(){var c=a.security.baseUrl+a.security.endpoints.registration.getRegistrationCountries,d={sendActivitySource:!0};return b.get(c,{},d)},getRegistrationCurrencies:function(){var c=a.security.baseUrl+a.security.endpoints.registration.getRegistrationCurrencies,d={sendActivitySource:!0};return b.get(c,{},d)},getDepositLimitPeriods:function(){var c=a.security.baseUrl+a.security.endpoints.registration.getDepositLimitPeriods,d={sendActivitySource:!0};return b.get(c,{},d)},canRegisterSubAccountPlayers:function(){var c=a.security.baseUrl+a.security.endpoints.registration.canRegisterSubAccountPlayers,d={sendActivitySource:!0};return b.get(c,{},d)},getCitzenshipRequiredInfo:function(c){var d=a.security.baseUrl+a.security.endpoints.registration.getCitzenshipRequiredInfo,e={citzenshipCountryCode:c},f={sendActivitySource:!0};return b.get(d,e,f)},isKYCCheckEnabled:function(){var c=a.security.baseUrl+a.security.endpoints.registration.isKYCCheckEnabled,d={};return b.get(c,{},d)}},settings:{hasActivationProcess:function(){var c=a.security.baseUrl+a.settings.endpoints.brand.hasActivationProcess,d={},e={sendActivitySource:!0};return b.get(c,d,e)}},clientSpecific:{registerNewShopOwner:function(c,d){var e=a.clientSpecific.baseUrl+a.clientSpecific.endpoints.user.agents.registerNewShopOwner,f={clientIdentifier:c},g={sendActivitySource:!0};return b.post(e,f,d,g)},registerShopOwner:function(c,d){var e=a.clientSpecific.baseUrl+a.clientSpecific.endpoints.user.agents.registerShopOwner,f={clientIdentifier:c},g={sendActivitySource:!0};return b.post(e,f,d,g)},addCashiers:function(c,d){var e=a.clientSpecific.baseUrl+a.clientSpecific.endpoints.user.agents.addCashiers,f={clientIdentifier:c},g={};return b.post(e,f,d,g)}},commissions:{getCommissionPlans:function(){var c=a.commissions.baseUrl+a.commissions.endpoints.getCommissionPlans,d={};return b.get(c,{},d)},getCommissionPlan:function(c){var d=a.commissions.baseUrl+a.commissions.endpoints.getCommissionPlan,e={commissionPlanId:c},f={};return b.get(d,e,f)},getCommissionPlansForUser:function(){var c=a.commissions.baseUrl+a.commissions.endpoints.getCommissionPlansForUser,d={};return b.get(c,{},d)},getTargets:function(c){var d=a.commissions.baseUrl+a.commissions.endpoints.getTargets,e={};return b.post(d,{},c,e)},getProgress:function(c){var d=a.commissions.baseUrl+a.commissions.endpoints.getProgress,e={};return b.post(d,{},c,e)}}}}])}(),function(){gamingAppModels={GTPayRegisterDepositRequestModel:function(){this.Amount=0,this.ReturnURL=""},TransactionsRequestBindingModel:function(){this.MainTxTypesIdentifiers=[0,0],this.SubTxTypesIdentifiers=[0,0],this.DateFrom="",this.DateTo=""},BankTransferWithdrawRequestBindingModel:function(){this.Amount=0,this.Bank="",this.AccountNumber="",this.AccountHolder="",this.SortCode="",this.SwiftCode="",this.RoutingNo="",this.IBANCode=""},InterswitchWithdrawRequestBindingModel:function(){this.Amount=0,this.PaymentMethod="",this.AccountNumberForQuicktellerWithdrawal=0,this.BankIdForQuicktellerWithdrawal=""},InterswitchWebPayDirectDepositRequestBindingModel:function(){this.Amount=0,this.SiteRedirectUrl=""},InterswitchWebPayDirectDepositConfirmationBindingModel:function(){this.DataReceived=""},UserProfileContactInformationSaveBindingModel:function(){this.Id=0,this.AddressType=0,this.PostCode="",this.Address="",this.Telephone="",this.Mobile=""},NetellerDepositRequestBindingModel:function(){this.NetellerAccountIdentifier="",this.Amount=0,this.UserSecureId=0,this.PaymentMethod=""},RegisterDepositBindingModel:function(){this.Amount=0,this.PaymentOkUrl="",this.PaymentNotOkUrl=""},TransferToAccountRequestModel:function(){this.SourceAccountId="",this.TargetAccountId="",this.Amount=0},PaypointFirstDepositRequestBindingModel:function(){this.Amount=0},PaypointNotFirstDepositRequestBindingModel:function(){this.Amount=0,this.CardId=0},PaypointWithdrawalRequestBindingModel:function(){this.Amount=0,this.CardId=0},WirecardRegisterDepositRequestBindingModel:function(){this.Amount=0,this.PaymentCode="",this.SuccessUrl="",this.CancelUrl="",this.FailureUrl="",this.ServiceUrl="",this.PendingUrl=""},WirecardNotFirstDepositRequestBindingModel:function(){this.Amount=0,this.CardId=0},WirecardWithdrawalRequestBindingModel:function(){this.Amount=0,this.CardId=0},EMoneyRequestBindingModel:function(){this.Amount=0,this.Pan="",this.TokenCode="",this.WebPin=""},EcoPayzRequestBindingModel:function(){this.Amount=0,this.PaymentMethod="",this.OnSuccessUrl="",this.OnFailureUrl="",this.CancellationUrl="",this.CallbackUrl=""},EPGRequestBindingModel:function(){this.Amount=0,this.SuccessUrl="",this.ErrorUrl="",this.CancelledUrl=""},ApcoDepositRequestBindingModel:function(){this.Amount=0,this.PaymentCode=0,this.OkUrl="",this.NokUrl="",this.NationalID=""},ApcoRegisterWithdrawRequestBindingModel:function(){this.Amount=0,this.PaymentCode=0,this.PaymentCardId=0,this.NationalID="",this.BeneficiaryID="",this.BankName="",this.BankBranch="",this.BankAccount="",this.IBAN="",this.AccountType=""},skrillDepositRequestBindingModel:function(){this.Amount=0,this.ReturnUrl="",this.CancelUrl="",this.PaymentMethod=""},SkrillWithdrawalRequestBindingModel:function(){this.AmountToWithdraw=0},UserProfileSaveBindingModel:function(){this.ContactInformation=[],this.SecurityQuestion="",this.SecurityAnswer="",this.AddContactInformation=function(a){this.ContactInformation.push(a)}},TransferFundsRequestModel:function(){this.SourceWalletId="",this.TargetWalletId="",this.Amount=0},ChangePasswordBindingModel:function(){this.CurrentPassword="",this.NewPassword=""},ResetPasswordBindingModel:function(){this.Username="",this.SecurityAnswer=""},PendingWithdrawalsRequestModel:function(){this.PageNumber=0,this.PageSize=0},CancelWithdrawalRequestModel:function(){this.TransactionId=0,this.TransactionTypeId=0},PaystackDepositBindingModel:function(){this.Amount=0,this.CallbackUrl="",this.Channels=""},PaystackWithdrawalRequestBindingModel:function(){this.Amount=0,this.CallbackUrl="",this.Channels=""},MpesaRegisterOnlineDepositRequestBindingModel:function(){this.Amount=0},MpesaWithdrawalRequestBindingModel:function(){this.Amount=0}}}(),function(){angular.module("sportsApi",[]).factory("sportsApiHttp",["$rootScope","$http","$q","$interpolate",function(a,b,c,d){var e=function(a){var b={apiType:"sports"};return a&&(a.noAuthToken&&(b.noAuthToken=a.noAuthToken),a.inBehalfOf&&(b.inBehalfOf=a.inBehalfOf),a.urlEncoded&&(b.urlEncoded=a.urlEncoded),a.showLoader&&(b.showLoader=a.showLoader),a.timeout&&(b.timeout=a.timeout),a.sendActivitySource&&(b.sendActivitySource=a.sendActivitySource)),b};return{get:function(f,g,h){var i=c.defer(),j=d(f)(g),k=e(h);return k.showLoader&&a.showLoader&&a.showLoader(),b.get(j,k).success(function(b){k.showLoader&&a.hideLoader&&a.hideLoader(),i.resolve({success:!0,data:b})}).error(function(b){k.showLoader&&a.hideLoader&&a.hideLoader(),i.resolve({success:!1,data:{},error:b})}),i.promise},delete:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return l.showLoader&&a.showLoader&&a.showLoader(),l.method="DELETE",l.url=k,l.data=h||{},b(l).success(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!0,data:b})}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise},post:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return h||(h={}),l.urlEncoded&&(h=$.param(h)),l.showLoader&&a.showLoader&&a.showLoader(),b.post(k,h,l).success(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!0,data:b})}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise},put:function(f,g,h,i){var j=c.defer(),k=d(f)(g),l=e(i);return h||(h={}),l.urlEncoded&&(h=$.param(h)),l.showLoader&&a.showLoader&&a.showLoader(),b.put(k,h,l).success(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!0,data:b})}).error(function(b){l.showLoader&&a.hideLoader&&a.hideLoader(),j.resolve({success:!1,data:{},error:b})}),j.promise}}}]).factory("sportsApiConfig",[function(){return{coupon:{baseUrl:globalSettings.SportsBookApiURL,endpoints:{getCoupons:"api/couponsList/{{couponStatus}}/datefrom/{{dateFrom}}/dateto/{{dateTo}}/page/{{pageSize}}/{{requestedPage}}/{{includeUsers}}/{{settlementDate}}/{{couponCode}}",getCouponsListNoDate:"api/couponsListNoDate/{{couponStatus}}/{{includeUsers}}/{{pageSize}}/{{language}}/{{idChannel}}",getCouponsByPost:"api/couponsListByPost",getCouponByCode:"api/coupons/allByCodeWithSettlementDate/{{couponCode}}/language/{{language}}",getCouponByCodeNoCheck:"api/coupons/noCheck/allByCode/{{couponCode}}/language/{{language}}",getPokerCouponByCode:"api/PokerCoupons/byCode/{{couponCode}}/language/{{language}}",setCouponPrintedByCode:"api/coupons/printed/{{couponCode}}",payOrCancelCoupon:"api/coupons/paid/{{couponId}}/{{payOrCancel}}",expandCoupon:"api/coupons/ExpandCoupon/{{couponCode}}",rebetCoupon:"api/coupons/rebet/byCode/{{couponCode}}/language/{{language}}",getLatestWinnersByChannel:"api/BetCoupons/LatestWinnersChannel/{{noOfWinners}}",getBestSellers:"api/BetCoupons/BestSellers/Current",getBestSellerById:"api/BetCoupons/BestSellers/GetBestSeller/{{bestSellerId}}",updateCoupon:"api/{{couponType}}/UpdateCoupon",addSelection:"api/{{couponType}}/AddSelections/{{language}}{{selectionIdsURL}}",addSelectionToCoupon:"api/{{couponType}}/AddSelectionsToCoupon/{{language}}{{selectionIdsURL}}",removeSelectionFromCoupon:"api/{{couponType}}/RemoveSelection?selectionId={{selectionId}}",addSelectionFromProvider:"api/VirtualSportCoupons/AddSelectionFromProvider/{{language}}?oddsId={{oddsId}}&oddsFieldType={{oddsFieldType}}",removeSelectionFromProvider:"api/VirtualSportCoupons/RemoveSelectionFromProvider?oddsId={{oddsId}}&oddsFieldType={{oddsFieldType}}",addSelectionToCouponFromProvider:"api/VirtualSportCoupons/AddSelectionToCouponFromProvider/{{language}}?oddsId={{oddsId}}&oddsFieldType={{oddsFieldType}}",postCoupon:"api/coupons/InsertCoupon",postCouponPokerShares:"api/coupons/{{allowOddChanges}}/{{allowStakeReduction}}/{{transferStakeFromAgent}}/{{requestTransactionId}}",postCouponPokerPool:"api/coupons/pokerpool/{{requestTransactionId}}",createCoupon:"api/coupons/create/language/{{language}}",getPendingCoupons:"api/coupons/pending",getPendingCouponByCode:"api/coupons/pending/byCode/{{couponCode}}",updatePendingCoupon:"api/coupons/pending/byCode/accept/{{couponCode}}/{{accepted}}",bookCoupon:"api/BetCoupons/Book/{{requestTransactionId}}",getBookedCoupon:"api/BetCoupons/Booked/{{bookedCouponCode}}/{{language}}",getPokerpoolBookedCoupon:"api/PokerCoupons/Booked/{{bookedCouponCode}}/{{language}}",getCashoutValue:"api/coupons/cashoutvalue_new/{{couponCode}}",cashout:"api/coupons/cashout_new",cashoutValuesBulk:"api/coupons/bulkcashoutvalues",getPendingCashouts:"api/coupons/pendingcashout",getPendingCashoutById:"api/coupons/pendingcashout/byCode/{{cashoutId}}",getOddsChanged:"api/feeds/oddschanged/{{language}}"}},custom:{baseUrl:globalSettings.SportsBookApiURL,endpoints:{convertMediatechToken:"api/custom/mt/gettoken",getUsableToken:"api/custom/getUsableToken"}},feed:{baseUrl:globalSettings.SportsBookFeedApiURL||globalSettings.SportsBookApiURL,endpoints:{getEventsBySport:"api/feeds/{{feedType}}/{{language}}/{{scheduleTimeFrame}}/{{sportId}}",getEventsByRange:"api/feeds/{{feedType}}/{{language}}/{{scheduleTimeFrame}}/{{itemIdRange}}/{{areaId}}/{{regionId}}",getEventsByRangeUngrouped:"api/feeds/{{feedType}}/ungrouped/{{language}}/{{scheduleTimeFrame}}/{{itemIdRange}}/{{areaId}}/{{regionId}}",getEventsByDate:"api/feeds/prematch/GetEvents/{{language}}/{{date}}/{{areaId}}/{{regionId}}/{{sportId}}",getPagedEvents:"api/feeds/prematch/GetPagedEvents/{{language}}/{{date}}/{{areaId}}/{{regionId}}/{{sportId}}/{{skip}}/{{take}}",getPagedEventsWithoutPaging:"api/feeds/prematch/GetPagedEvents/{{language}}/{{date}}/{{areaId}}/{{regionId}}/{{sportId}}",getPagedEventsTimeFrameWithSort:"api/feeds/prematch/GetPagedEvents/{{language}}/{{scheduleTimeFrame}}/{{sortBy}}/{{areaId}}/{{regionId}}/{{sportId}}/{{skip}}/{{take}}",getPagedEventsTimeFrameWithSortWithoutPaging:"api/feeds/prematch/GetPagedEvents/{{language}}/{{scheduleTimeFrame}}/{{sortBy}}/{{areaId}}/{{regionId}}/{{sportId}}",getEventDetails:"api/feeds/{{feedType}}/event/{{language}}/{{scheduleTimeFrame}}/{{eventId}}/{{excludedIdArea}}",getFeedInfo:"api/feeds/{{feedType}}/info",getPrematchTournaments:"api/feeds/prematch/matches/{{language}}/{{scheduleTimeFrame}}",getPrematchTournamentsCustomMenu:"api/feeds/prematch/matches/custommenu/{{language}}/{{scheduleTimeFrame}}",getPrematchTournamentsBySport:"api/feeds/prematch/matches/{{language}}/{{scheduleTimeFrame}}/{{sportId}}",getPrematchTournamentsBySportByRange:"api/feeds/prematch/matches/byRange/{{language}}/{{scheduleTimeFrame}}/{{sportId}}/{{dateRange}}",getPrematchTournamentsBySportCustomMenu:"api/feeds/prematch/matches/custommenu/{{language}}/{{scheduleTimeFrame}}/{{sportId}}",getPrematchTournamentsBySportCustomMenuByRange:"api/feeds/prematch/matches/custommenu/byRange/{{language}}/{{scheduleTimeFrame}}/{{sportId}}/{{dateRange}}",getOutrightTournaments:"api/feeds/prematch/outrights/{{language}}/{{scheduleTimeFrame}}",getOutrightTournamentsBySport:"api/feeds/prematch/outrights/{{language}}/{{scheduleTimeFrame}}/{{sportId}}",getOutrightTournamentsBySportByRange:"api/feeds/prematch/outrights/byRange/{{language}}/{{scheduleTimeFrame}}/{{sportId}}/{{dateRange}}",getPokerTournaments:"api/feeds/poker/{{language}}/{{scheduleTimeFrame}}",getLatestResults:"api/feeds/{{feedType}}/results/latest/{{language}}/{{noOfResults}}",searchEvents:"api/feeds/{{feedType}}/Search/lang/{{language}}?search={{searchQuery}}",shopSearchEvents:"api/feeds/{{feedType}}/ShopSearch/lang/{{language}}?search={{searchQuery}}",getMarketMovers:"api/feeds/{{feedType}}/MarketMovers/ByMostPopular/{{idSport}}/{{noOfEvents}}/{{language}}/{{idMarketType}}/{{channelSpecific}}",getHottestMarkets:"api/feeds/{{feedType}}/hottestmarkets/{{language}}/{{noOfEvents}}/{{idSport}}",getMostPopular:"api/feeds/{{feedType}}/mostpopular/{{language}}/{{idSport}}/{{numberOfEvents}}/{{date}}",getMostPopularByLeague:"api/feeds/{{feedType}}/mostpopularsports/{{language}}/{{idSport}}/{{leagueCount}}/{{numberOfEvents}}/{{date}}",getUpcomingEvents:"api/feeds/{{feedType}}/lastminute/{{language}}/{{idSport}}/{{numberOfEvents}}/{{date}}",getLastMinute:"api/feeds/{{feedType}}/lastminute/{{language}}/{{idSport}}/{{numberOfEvents}}",getMatchOfTheDay:"api/feeds/{{feedType}}/matchoftheday/{{language}}/{{idSport}}",getQuickBet:"api/feeds/prematch/QuickBet/{{smartBetCode}}/lang/{{language}}",getQuickBetByMarketTypes:"api/feeds/prematch/QuickBet/ByMarketTypes/{{smartBetCode}}/{{marketTypes}}/{{language}}",getActiveSmartBetCodes:"api/feeds/onlinecodes",getEventOddFeedUngroupedLite:"api/feeds/{{feedType}}/lite/event/ungrouped/{{language}}/{{scheduleTimeFrame}}/{{eventId}}/{{excludedIdArea}}",getEventOddFeedLite:"api/feeds/{{feedType}}/lite/event/{{language}}/{{scheduleTimeFrame}}/{{eventId}}/{{excludedIdArea}}",getMatchMaxOdds:"api/feeds/prematch/lite/getMatchMaxOdds/{{language}}/{{price}}/{{range}}",getOddsChangedLocked:"api/feeds/oddschangedlocked/{{language}}",getOddsForTeams:"api/feeds/GetOddsForTeams",listEvents:"api/feeds/prematch/{{language}}/{{scheduleTimeFrame}}",listEventsCustomMenu:"api/feeds/prematch/custommenu/{{language}}/{{scheduleTimeFrame}}",listSportsEvents:"api/feeds/prematch/{{language}}/{{scheduleTimeFrame}}/{{sportId}}",listSportsEventsByRange:"api/feeds/prematch/byRange/{{language}}/{{scheduleTimeFrame}}/{{sportId}}/{{dateRange}}",listEventsOdds:"api/feeds/prematch/Markets/byItemsPost/{{language}}/{{scheduleTimeFrame}}",listEventsOddsByRange:"api/feeds/prematch/Markets/byRange/byItemsPost/{{language}}/{{scheduleTimeFrame}}/{{dateRange}}",listPrintOddsFastSport:"api/feeds/prematch/lite/print/bySport/{{language}}/{{scheduleTimeFrame}}/{{areaId}}/{{sportId}}",listPrintOddsFastSportByRange:"api/feeds/prematch/lite/print/byRange/bySport/{{language}}/{{scheduleTimeFrame}}/{{areaId}}/{{sportId}}/{{dateRange}}",listPrintOddsFastTournament:"api/feeds/prematch/lite/byItemsPost/{{language}}/{{scheduleTimeFrame}}/{{areaId}}/{{orderByDate}}",listPrintOddsFastTournamentByRange:"api/feeds/prematch/lite/byRange/byItemsPost//{{language}}/{{scheduleTimeFrame}}/{{areaId}}/{{orderByDate}}/{{dateRange}}",
listPrintOddsStandardMarket:"api/feeds/prematch/lite/byMarkets/byPost/{{language}}/{{scheduleTimeFrame}}/{{orderByDate}}",listPrintOddsStandardMarketByRange:"api/feeds/prematch/lite/byRange/byMarkets/byPost/{{language}}/{{scheduleTimeFrame}}/{{orderByDate}}",listPrintOddsStandardArea:"api/feeds/prematch/lite/byItemsPost/{{language}}/{{scheduleTimeFrame}}/{{areaId}}/{{orderByDate}}",listPrintOddsStandardAreaByRange:"api/feeds/prematch/lite/byRange/byItemsPost/{{language}}/{{scheduleTimeFrame}}/{{areaId}}/{{orderByDate}}/{{dateRange}}"}},liveFeed:{baseUrl:globalSettings.SportsBookFeedApiURL||globalSettings.SportsBookApiURL,endpoints:{getLiveEvents:"api/feeds/live",getLiveEventDetails:"api/feeds/live/{{matchId}}/{{language}}",getLiveEventDetailsByArea:"api/feeds/live/byArea/{{matchId}}/{{areaId}}/{{language}}",getLiveUpcomingEvents:"api/feeds/live/upcoming",getLiveMultiview:"api/feeds/live/overview/{{language}}",getLiveOverview:"api/feeds/live/overview/general/{{language}}",getLiveAreaOddsByLayout:"api/feeds/live/areaOddsByLayout/{{language}}/{{sportId}}/{{layoutModelId}}/{{areaId}}/{{oneSpecialValueBalancedMarketOnly}}/{{includeSpecialValueInMarketName}}/{{includeMarkets}}/{{includeAllMarketsOnSportsMarkets}}",getLiveMostPopular:"api/feeds/live/mostpopular/{{sportId}}/{{numberOfEvents}}"}},user:{baseUrl:globalSettings.SportsBookApiURL,endpoints:{getUserDetails:"api/GetUserDetails",getBalance:"api/GetBalance",getUserAgents:"api/AgentUsers/{{statusEnabled}}/{{sportsEnabled}}/{{recursive}}/{{includeOnlyUsers}}/{{level}}"}},settings:{baseUrl:globalSettings.SportsBookFeedApiURL||globalSettings.SportsBookApiURL,endpoints:{getBonusList:"api/settings/bonuslist",getGlobalVariables:"api/settings/globalvariables",getMarketTypeIds:"api/settings/markettypeids",getIncompatibleMarketExceptions:"api/settings/incompatiblemarketexceptions"}},virtuals:{baseUrl:globalSettings.VirtualsApiURL,endpoints:{getCouponsByPost:"api/couponsListByPost",getCouponByCode:"api/virtuals/coupons/byCode/{{couponCode}}"}}}}]).factory("sportsApiService",["sportsApiConfig","sportsApiHttp",function(a,b){return{coupon:{getCoupons:function(c,d,e,f,g,h,i,j,k,l){var m=a.coupon.baseUrl+a.coupon.endpoints.getCoupons,n={couponStatus:c,dateFrom:d,dateTo:e,pageSize:f,requestedPage:g,includeUsers:h,settlementDate:i,couponCode:j,language:k},o={inBehalfOf:l};return b.get(m,n,o)},getCouponsListNoDate:function(c,d,e,f,g){var h=a.coupon.baseUrl+a.coupon.endpoints.getCouponsListNoDate,i={couponStatus:c,includeUsers:e,pageSize:d,language:f,idChannel:g};return b.get(h,i,{})},getCouponsByPost:function(c,d,e,f,g,h,i,j,k,l){var m=a.coupon.baseUrl+a.coupon.endpoints.getCouponsByPost,n={},o={couponStatus:c,dateFrom:d,dateTo:e,pageSize:f,requestedPage:g,includUsers:h,lang:k,couponCode:j,settlementDate:i},p={inBehalfOf:l};return b.post(m,n,o,p)},getCouponByCode:function(c,d){var e={};if(c.indexOf(",")!=-1){var f=c.split(",")[1];e={inBehalfOf:f},c=c.split(",")[0]}var g=a.coupon.baseUrl+a.coupon.endpoints.getCouponByCode,h={couponCode:c,language:d};return b.get(g,h,e)},getCouponByCodeNoCheck:function(c,d){var e=a.coupon.baseUrl+a.coupon.endpoints.getCouponByCodeNoCheck,f={couponCode:c,language:d},g={};return b.get(e,f,g)},expandCoupon:function(c){var d=a.coupon.baseUrl+a.coupon.endpoints.expandCoupon,e={couponCode:c},f={};return b.get(d,e,f)},getPokerCouponByCode:function(c,d){var e={};if(c.indexOf(",")!=-1){var f=c.split(",")[1];e={inBehalfOf:f},c=c.split(",")[0]}var g=a.coupon.baseUrl+a.coupon.endpoints.getPokerCouponByCode,h={couponCode:c,language:d};return b.get(g,h,e)},setCouponPrintedByCode:function(c){var d=a.coupon.baseUrl+a.coupon.endpoints.setCouponPrintedByCode,e={couponCode:c},f={},g={};return b.post(d,e,f,g)},payOrCancelCoupon:function(c,d,e){var f=a.coupon.baseUrl+a.coupon.endpoints.payOrCancelCoupon,g={couponId:c,payOrCancel:d},h={},i={inBehalfOf:e};return b.put(f,g,h,i)},rebetCoupon:function(c,d){var e=a.coupon.baseUrl+a.coupon.endpoints.rebetCoupon,f={couponCode:c,language:d},g={};return b.get(e,f,g)},getLatestWinnersByChannel:function(c){var d=a.coupon.baseUrl+a.coupon.endpoints.getLatestWinnersByChannel,e={noOfWinners:c},f={};return b.get(d,e,f)},getBestSellers:function(){var c=a.coupon.baseUrl+a.coupon.endpoints.getBestSellers,d={},e={};return b.get(c,d,e)},getBestSellerById:function(c){var d=a.coupon.baseUrl+a.coupon.endpoints.getBestSellerById,e={bestSellerId:c},f={};return b.get(d,e,f)},updateCoupon:function(c,d,e){var f=a.coupon.baseUrl+a.coupon.endpoints.updateCoupon,g={couponType:c},h=d,i={};return null!=e&&e.trim().length>0&&(i.inBehalfOf=e),b.put(f,g,h,i)},addSelection:function(c,d,e,f){var g=a.coupon.baseUrl+a.coupon.endpoints.addSelection,h={couponType:c,language:d,selectionIdsURL:e},i={},j={};return null!=f&&f.trim().length>0&&(j.inBehalfOf=f),b.post(g,h,i,j)},addSelectionToCoupon:function(c,d,e,f,g){var h=a.coupon.baseUrl+a.coupon.endpoints.addSelectionToCoupon,i={couponType:c,language:d,selectionIdsURL:e},j=f,k={};return null!=g&&g.trim().length>0&&(k.inBehalfOf=g),b.post(h,i,j,k)},removeSelectionFromCoupon:function(c,d,e,f,g){var h=a.coupon.baseUrl+a.coupon.endpoints.removeSelectionFromCoupon,i={couponType:c,language:d,selectionId:e},j=f,k={};return null!=g&&g.trim().length>0&&(k.inBehalfOf=g),b.delete(h,i,j,k)},addSelectionFromProvider:function(c,d,e,f,g){var h=a.coupon.baseUrl+a.coupon.endpoints.addSelectionFromProvider,i={language:c,oddsId:d,oddsFieldType:e},j=f,k={};return null!=g&&g.trim().length>0&&(k.inBehalfOf=g),b.post(h,i,j,k)},removeSelectionFromProvider:function(c,d,e,f){var g=a.coupon.baseUrl+a.coupon.endpoints.removeSelectionFromProvider,h={oddsId:c,oddsFieldType:d},i=e,j={};return null!=f&&f.trim().length>0&&(j.inBehalfOf=f),b.delete(g,h,i,j)},addSelectionToCouponFromProvider:function(c,d,e,f,g){var h=a.coupon.baseUrl+a.coupon.endpoints.addSelectionToCouponFromProvider,i={language:c,oddsId:d,oddsFieldType:e},j=f,k={};return null!=g&&g.trim().length>0&&(k.inBehalfOf=g),b.post(h,i,j,k)},postCoupon:function(c,d,e,f,g,h,i){var j=a.coupon.baseUrl+a.coupon.endpoints.postCoupon,k={},l={};l=globalSettings.Sports_SendBookedCouponCode?{BetCoupon:h,AllowOddChanges:"true"===c,AllowStakeReduction:"true"===d,TransferStakeFromAgent:"true"===e,RequestTransactionId:g,BookedCouponCode:i?i:null}:{BetCoupon:h,AllowOddChanges:"true"===c,AllowStakeReduction:"true"===d,TransferStakeFromAgent:"true"===e,RequestTransactionId:g};var m={showLoader:!0,inBehalfOf:f};return b.post(j,k,l,m)},postCouponPokerShares:function(c,d,e,f,g,h){var i=a.coupon.baseUrl+a.coupon.endpoints.postCouponPokerShares,j={allowOddChanges:c,allowStakeReduction:d,transferStakeFromAgent:e,requestTransactionId:g},k=h,l={showLoader:!0,inBehalfOf:f};return b.post(i,j,k,l)},postCouponPokerPool:function(c,d){var e=a.coupon.baseUrl+a.coupon.endpoints.postCouponPokerPool,f={requestTransactionId:c},g=d,h={showLoader:!0};return b.post(e,f,g,h)},createCoupon:function(c,d,e,f){var g=a.coupon.baseUrl+a.coupon.endpoints.createCoupon,h={language:c},i={Stake:d,Groupings:e,Selections:f},j={};return b.post(g,h,i,j)},getPendingCoupons:function(){var c=a.coupon.baseUrl+a.coupon.endpoints.getPendingCoupons,d={},e={};return b.get(c,d,e)},getPendingCouponByCode:function(c,d){var e=a.coupon.baseUrl+a.coupon.endpoints.getPendingCouponByCode,f={couponCode:c},g={inBehalfOf:d};return b.get(e,f,g)},updatePendingCoupon:function(c,d,e){var f=a.coupon.baseUrl+a.coupon.endpoints.updatePendingCoupon,g={couponCode:c,accepted:d},h={},i={inBehalfOf:e};return b.put(f,g,h,i)},bookCoupon:function(c,d){var e=a.coupon.baseUrl+a.coupon.endpoints.bookCoupon,f={requestTransactionId:c},g=d,h={};return b.post(e,f,g,h)},getBookedCoupon:function(c,d){var e=a.coupon.baseUrl+a.coupon.endpoints.getBookedCoupon,f={bookedCouponCode:c,language:d},g={};return b.get(e,f,g)},getPokerpoolBookedCoupon:function(c,d){var e=a.coupon.baseUrl+a.coupon.endpoints.getPokerpoolBookedCoupon,f={bookedCouponCode:c,language:d},g={};return b.get(e,f,g)},getCashoutValue:function(c){var d=a.coupon.baseUrl+a.coupon.endpoints.getCashoutValue,e={couponCode:c},f={};return b.get(d,e,f)},cashoutValuesBulk:function(c){var d=a.coupon.baseUrl+a.coupon.endpoints.cashoutValuesBulk,e={},f=c,g={};return b.post(d,e,f,g)},cashout:function(c,d){var e=a.coupon.baseUrl+a.coupon.endpoints.cashout,f={},g=c,h={inBehalfOf:d};return b.post(e,f,g,h)},getPendingCashouts:function(){var c=a.coupon.baseUrl+a.coupon.endpoints.getPendingCashouts,d={},e={};return b.get(c,d,e)},getPendingCashoutById:function(c){var d=a.coupon.baseUrl+a.coupon.endpoints.getPendingCashoutById,e={cashoutId:c},f={};return b.get(d,e,f)}},custom:{convertMediatechToken:function(c){var d=a.custom.baseUrl+a.custom.endpoints.convertMediatechToken,e={},f={authenticationToken:c},g={};return b.post(d,e,f,g)},getUsableToken:function(c){var d=a.custom.baseUrl+a.custom.endpoints.getUsableToken,e={},f={token:c},g={};return b.post(d,e,f,g)}},feed:{getEventsBySport:function(c,d,e,f){var g=a.feed.baseUrl+a.feed.endpoints.getEventsBySport,h={language:c,scheduleTimeFrame:d,sportId:e,feedType:f||"prematch"},i={noAuthToken:!0};return b.get(g,h,i)},getEventsByRange:function(c,d,e,f,g,h){var i=a.feed.baseUrl+a.feed.endpoints.getEventsByRange,j={language:c,scheduleTimeFrame:d,itemIdRange:e,areaId:f,regionId:g,feedType:h||"prematch"},k={noAuthToken:!0};return b.get(i,j,k)},getEventsByRangeUngrouped:function(c,d,e,f,g,h){var i=a.feed.baseUrl+a.feed.endpoints.getEventsByRangeUngrouped,j={language:c,scheduleTimeFrame:d,itemIdRange:e,areaId:f,regionId:g,feedType:h||"prematch"},k={noAuthToken:!0};return b.get(i,j,k)},getEventsByDate:function(c,d,e,f,g){var h=a.feed.baseUrl+a.feed.endpoints.getEventsByDate,i={language:c,date:d,areaId:f,regionId:g,sportId:e},j={noAuthToken:!0};return b.get(h,i,j)},getPagedEvents:function(c,d,e,f,g,h,i){if(5===arguments.length)var j=a.feed.baseUrl+a.feed.endpoints.getPagedEventsWithoutPaging,k={language:c,date:d,areaId:f,regionId:g,sportId:e};else if(7===arguments.length)var j=a.feed.baseUrl+a.feed.endpoints.getPagedEvents,k={language:c,date:d,areaId:f,regionId:g,sportId:e,skip:h,take:i};var l={noAuthToken:!0};return b.get(j,k,l)},getPagedEventsTimeFrameWithSort:function(c,d,e,f,g,h,i,j){if(6===arguments.length)var k=a.feed.baseUrl+a.feed.endpoints.getPagedEventsTimeFrameWithSortWithoutPaging,l={language:c,scheduleTimeFrame:d,sortBy:e,areaId:g,regionId:h,sportId:f};else if(8===arguments.length)var k=a.feed.baseUrl+a.feed.endpoints.getPagedEventsTimeFrameWithSort,l={language:c,scheduleTimeFrame:d,sortBy:e,areaId:g,regionId:h,sportId:f,skip:i,take:j};var m={noAuthToken:!0};return b.get(k,l,m)},getFeedInfo:function(c){var d=a.feed.baseUrl+a.feed.endpoints.getFeedInfo,e={feedType:c||"prematch"},f={noAuthToken:!0};return b.get(d,e,f)},getPrematchTournaments:function(c,d){var e=a.feed.baseUrl+a.feed.endpoints.getPrematchTournaments;globalSettings.Sports_EnableCustomMenu&&(e=a.feed.baseUrl+a.feed.endpoints.getPrematchTournamentsCustomMenu);var f={language:c,scheduleTimeFrame:d},g={noAuthToken:!0};return b.get(e,f,g)},getPrematchTournamentsBySport:function(c,d,e){var f=a.feed.baseUrl+a.feed.endpoints.getPrematchTournamentsBySport;globalSettings.Sports_EnableCustomMenu&&(f=a.feed.baseUrl+a.feed.endpoints.getPrematchTournamentsBySportCustomMenu);var g={language:c,scheduleTimeFrame:d,sportId:e},h={noAuthToken:!0};return b.get(f,g,h)},getPrematchTournamentsBySportByRange:function(c,d,e,f){var g=a.feed.baseUrl+a.feed.endpoints.getPrematchTournamentsBySportByRange;globalSettings.Sports_EnableCustomMenu&&(g=a.feed.baseUrl+a.feed.endpoints.getPrematchTournamentsBySportCustomMenuByRange);var h={language:c,scheduleTimeFrame:d,sportId:e,dateRange:f},i={noAuthToken:!0};return b.get(g,h,i)},getOutrightTournaments:function(c,d){var e=a.feed.baseUrl+a.feed.endpoints.getOutrightTournaments,f={language:c,scheduleTimeFrame:d},g={noAuthToken:!0};return b.get(e,f,g)},getOutrightTournamentsBySport:function(c,d,e){var f=a.feed.baseUrl+a.feed.endpoints.getOutrightTournamentsBySport,g={language:c,scheduleTimeFrame:d,sportId:e},h={noAuthToken:!0};return b.get(f,g,h)},getOutrightTournamentsBySportByRange:function(c,d,e,f){var g=a.feed.baseUrl+a.feed.endpoints.getOutrightTournamentsBySportByRange,h={language:c,scheduleTimeFrame:d,sportId:e,dateRange:f},i={noAuthToken:!0};return b.get(g,h,i)},getPokerTournaments:function(c,d){var e=a.feed.baseUrl+a.feed.endpoints.getPokerTournaments,f={language:c,scheduleTimeFrame:d},g={noAuthToken:!0};return b.get(e,f,g)},getLatestResults:function(c,d,e){var f=a.feed.baseUrl+a.feed.endpoints.getLatestResults,g={language:c,noOfResults:d,feedType:e||"prematch"},h={noAuthToken:!0};return b.get(f,g,h)},searchEvents:function(c,d,e,f){var g=a.feed.baseUrl+a.feed.endpoints.searchEvents,h={language:c,searchQuery:d,feedType:e||"prematch"},i={noAuthToken:!0,timeout:f};return b.get(g,h,i)},shopSearchEvents:function(c,d,e,f){var g=a.feed.baseUrl+a.feed.endpoints.shopSearchEvents,h={language:c,searchQuery:d,feedType:e||"prematch"},i={noAuthToken:!0,timeout:f};return b.get(g,h,i)},getMarketMovers:function(c,d,e,f,g,h){var i=a.feed.baseUrl+a.feed.endpoints.getMarketMovers,j={idSport:c,noOfEvents:d,language:e,idMarketType:f,channelSpecific:g,feedType:h||"prematch"},k={noAuthToken:!0};return b.get(i,j,k)},getHottestMarkets:function(c,d,e,f){var g=a.feed.baseUrl+a.feed.endpoints.getHottestMarkets,h={language:c,noOfEvents:d,idSport:e,feedType:f||"prematch"},i={noAuthToken:!0};return b.get(g,h,i)},getMostPopular:function(c,d,e,f,g){var h=a.feed.baseUrl+a.feed.endpoints.getMostPopular,i={language:c,idSport:d,numberOfEvents:e,date:f,feedType:g||"prematch"},j={noAuthToken:!0};return b.get(h,i,j)},getMostPopularByLeague:function(c,d,e,f,g,h){var i=a.feed.baseUrl+a.feed.endpoints.getMostPopularByLeague,j={language:c,idSport:d,leagueCount:e,numberOfEvents:f,date:g,feedType:h||"prematch"},k={noAuthToken:!0};return b.get(i,j,k)},getUpcomingEvents:function(c,d,e,f,g){var h=a.feed.baseUrl+a.feed.endpoints.getUpcomingEvents,i={language:c,idSport:d,numberOfEvents:e,date:f,feedType:g||"prematch"},j={noAuthToken:!0};return b.get(h,i,j)},getLastMinute:function(c,d,e,f){var g=a.feed.baseUrl+a.feed.endpoints.getLastMinute,h={language:c,idSport:d,numberOfEvents:e,feedType:f||"prematch"},i={noAuthToken:!0};return b.get(g,h,i)},getMatchOfTheDay:function(c,d,e){var f=a.feed.baseUrl+a.feed.endpoints.getMatchOfTheDay,g={language:c,idSport:d,feedType:e||"prematch"},h={noAuthToken:!0};return b.get(f,g,h)},getQuickBet:function(c,d){var e=a.feed.baseUrl+a.feed.endpoints.getQuickBet,f={smartBetCode:c,language:d},g={noAuthToken:!0};return b.get(e,f,g)},getQuickBetByMarketTypes:function(c,d,e){var f=a.feed.baseUrl+a.feed.endpoints.getQuickBetByMarketTypes,g={smartBetCode:c,marketTypes:d,language:e},h={noAuthToken:!0};return b.get(f,g,h)},getActiveSmartBetCodes:function(){var c=a.feed.baseUrl+a.feed.endpoints.getActiveSmartBetCodes,d={},e={noAuthToken:!0};return b.get(c,d,e)},getEventOddFeedUngroupedLite:function(c,d,e,f,g){var h=a.feed.baseUrl+a.feed.endpoints.getEventOddFeedUngroupedLite,i={language:c,scheduleTimeFrame:d,eventId:e,excludedIdArea:f,feedType:g||"prematch"},j={noAuthToken:!0};return b.get(h,i,j)},getEventOddFeedLite:function(c,d,e,f,g){var h=a.feed.baseUrl+a.feed.endpoints.getEventOddFeedLite,i={language:c,scheduleTimeFrame:d,eventId:e,excludedIdArea:f,feedType:g||"prematch"},j={noAuthToken:!0};return b.get(h,i,j)},getMatchMaxOdds:function(c,d,e){var f=a.feed.baseUrl+a.feed.endpoints.getMatchMaxOdds,g={language:c,price:d,range:e},h={noAuthToken:!0};return b.get(f,g,h)},getOddsChanged:function(c,d){var e=a.coupon.baseUrl+a.coupon.endpoints.getOddsChanged,f={language:c},g=d,h={noAuthToken:!0};return b.post(e,f,g,h)},getOddsChangedLocked:function(c,d){var e=a.feed.baseUrl+a.feed.endpoints.getOddsChangedLocked,f={language:c},g=d,h={noAuthToken:!0};return b.post(e,f,g,h)},getOddsForTeams:function(c){var d=a.feed.baseUrl+a.feed.endpoints.getOddsForTeams,e={},f=c,g={noAuthToken:!0};return b.post(d,e,f,g)},listEvents:function(c,d){var e=a.feed.baseUrl+a.feed.endpoints.listEvents;globalSettings.Sports_EnableCustomMenu&&(e=a.feed.baseUrl+a.feed.endpoints.listEventsCustomMenu);var f={language:c,scheduleTimeFrame:d},g={noAuthToken:!0};return b.get(e,f,g)},listSportsEvents:function(c,d,e){var f=a.feed.baseUrl+a.feed.endpoints.listSportsEvents,g={language:c,scheduleTimeFrame:d,sportId:e},h={noAuthToken:!0};return b.get(f,g,h)},listSportsEventsByRange:function(c,d,e,f){var g=a.feed.baseUrl+a.feed.endpoints.listSportsEventsByRange,h={language:c,scheduleTimeFrame:d,sportId:e,dateRange:f},i={noAuthToken:!0};return b.get(g,h,i)},listEventsOdds:function(c,d,e){var f=a.feed.baseUrl+a.feed.endpoints.listEventsOdds,g={language:c,scheduleTimeFrame:d},h="'"+e+"'",i={noAuthToken:!0};return b.post(f,g,h,i)},listEventsOddsByRange:function(c,d,e,f){var g=a.feed.baseUrl+a.feed.endpoints.listEventsOddsByRange,h={language:c,scheduleTimeFrame:d,dateRange:e},i="'"+f+"'",j={noAuthToken:!0};return b.post(g,h,i,j)},listPrintOddsFastSport:function(c,d,e,f){var g=a.feed.baseUrl+a.feed.endpoints.listPrintOddsFastSport,h={language:c,scheduleTimeFrame:d,areaId:e,sportId:f},i={noAuthToken:!0};return b.get(g,h,i)},listPrintOddsFastSportByRange:function(c,d,e,f,g){var h=a.feed.baseUrl+a.feed.endpoints.listPrintOddsFastSportByRange,i={language:c,scheduleTimeFrame:d,areaId:e,sportId:f,dateRange:g},j={noAuthToken:!0};return b.get(h,i,j)},listPrintOddsFastTournament:function(c,d,e,f,g){var h=a.feed.baseUrl+a.feed.endpoints.listPrintOddsFastTournament,i={language:c,scheduleTimeFrame:d,areaId:e,orderByDate:f},j="'"+g+"'",k={noAuthToken:!0};return b.post(h,i,j,k)},listPrintOddsFastTournamentByRange:function(c,d,e,f,g,h){var i=a.feed.baseUrl+a.feed.endpoints.listPrintOddsFastTournamentByRange,j={language:c,scheduleTimeFrame:d,areaId:e,orderByDate:f,dateRange:g},k="'"+h+"'",l={noAuthToken:!0};return b.post(i,j,k,l)},listPrintOddsStandardMarket:function(c,d,e,f,g){var h=a.feed.baseUrl+a.feed.endpoints.listPrintOddsStandardMarket,i={language:c,scheduleTimeFrame:d,orderByDate:f},j={MarketTypeIdRange:e,ItemIdRange:g},k={noAuthToken:!0};return b.post(h,i,j,k)},listPrintOddsStandardMarketByRange:function(c,d,e,f,g,h){var i=a.feed.baseUrl+a.feed.endpoints.listPrintOddsStandardMarketByRange,j={language:c,scheduleTimeFrame:d,orderByDate:f},k={MarketTypeIdRange:e,ItemIdRange:h,DaysFromTodayRange:g.split(",").map(Number)},l={noAuthToken:!0};return b.post(i,j,k,l)},listPrintOddsStandardArea:function(c,d,e,f,g){var h=a.feed.baseUrl+a.feed.endpoints.listPrintOddsStandardArea,i={language:c,scheduleTimeFrame:d,areaId:e,orderByDate:f},j="'"+g+"'",k={noAuthToken:!0};return b.post(h,i,j,k)},listPrintOddsStandardAreaByRange:function(c,d,e,f,g,h){var i=a.feed.baseUrl+a.feed.endpoints.listPrintOddsStandardAreaByRange,j={language:c,scheduleTimeFrame:d,areaId:e,orderByDate:f,dateRange:g},k="'"+h+"'",l={noAuthToken:!0};return b.post(i,j,k,l)}},liveFeed:{getLiveEvents:function(){var c=a.liveFeed.baseUrl+a.liveFeed.endpoints.getLiveEvents,d={},e={noAuthToken:!0};return b.get(c,d,e)},getLiveEventDetails:function(c,d,e){var f=a.liveFeed.baseUrl+a.liveFeed.endpoints.getLiveEventDetails,g={matchId:c,language:d};e&&(f=a.liveFeed.baseUrl+a.liveFeed.endpoints.getLiveEventDetailsByArea,g.areaId=e);var h={noAuthToken:!0};return b.get(f,g,h)},getLiveUpcomingEvents:function(){var c=a.liveFeed.baseUrl+a.liveFeed.endpoints.getLiveUpcomingEvents,d={},e={noAuthToken:!0};return b.get(c,d,e)},getLiveMultiview:function(c){var d=a.liveFeed.baseUrl+a.liveFeed.endpoints.getLiveMultiview,e={language:c},f={noAuthToken:!0};return b.get(d,e,f)},getLiveOverview:function(c){var d=a.liveFeed.baseUrl+a.liveFeed.endpoints.getLiveOverview,e={language:c},f={noAuthToken:!0};return b.get(d,e,f)},getLiveAreaOddsByLayout:function(c,d,e,f,g,h,i,j){var k=a.liveFeed.baseUrl+a.liveFeed.endpoints.getLiveAreaOddsByLayout,l={language:c,sportId:d,layoutModelId:e,areaId:f,oneSpecialValueBalancedMarketOnly:g,includeSpecialValueInMarketName:h,includeMarkets:i,includeAllMarketsOnSportsMarkets:j},m={noAuthToken:!0};return b.get(k,l,m)},getLiveMostPopular:function(c,d){var e=a.liveFeed.baseUrl+a.liveFeed.endpoints.getLiveMostPopular,f={sportId:c,numberOfEvents:d},g={noAuthToken:!0};return b.get(e,f,g)}},user:{getUserDetails:function(){var c=a.user.baseUrl+a.user.endpoints.getUserDetails,d={},e={};return b.get(c,d,e)},getBalance:function(){var c=a.user.baseUrl+a.user.endpoints.getBalance,d={},e={};return b.get(c,d,e)},getUserAgents:function(c,d,e,f,g,h){var i=a.user.baseUrl+a.user.endpoints.getUserAgents,j={statusEnabled:c,sportsEnabled:d,recursive:e,includeOnlyUsers:f,level:g},k={inBehalfOf:h};return b.get(i,j,k)}},settings:{getBonusList:function(){var c=a.settings.baseUrl+a.settings.endpoints.getBonusList,d={},e={};return b.get(c,d,e)},getGlobalVariables:function(){var c=a.settings.baseUrl+a.settings.endpoints.getGlobalVariables,d={},e={};return b.get(c,d,e)},getMarketTypeIds:function(){var c=a.settings.baseUrl+a.settings.endpoints.getMarketTypeIds,d={},e={};return b.get(c,d,e)},getIncompatibleMarketExceptions:function(){var c=a.settings.baseUrl+a.settings.endpoints.getIncompatibleMarketExceptions,d={},e={};return b.get(c,d,e)}},virtuals:{getCouponsByPost:function(c,d,e,f,g,h,i,j,k,l){var m=a.virtuals.baseUrl+a.virtuals.endpoints.getCouponsByPost,n={},o={couponStatus:c,dateFrom:d,dateTo:e,pageSize:f,requestedPage:g,includUsers:h,lang:k,couponCode:j,settlementDate:i},p={inBehalfOf:l};return b.post(m,n,o,p)},getCouponByCode:function(c){var d={};if(c.indexOf(",")!=-1){var e=c.split(",")[1];d={inBehalfOf:e},c=c.split(",")[0]}var f=a.virtuals.baseUrl+a.virtuals.endpoints.getCouponByCode,g={couponCode:c};return b.get(f,g,d)}}}}])}(),function(){angular.module("thirdPartyApi",[]).factory("thirdPartyApiHttp",["$http","$q","$interpolate",function(a,b,c){var d=function(a){var b={apiType:"thirdParty"};return a&&a.urlEncoded&&(b.urlEncoded=a.urlEncoded),b};return{get:function(e,f,g){var h=b.defer(),i=c(e)(f);return a.get(i,d(g)).success(function(a){h.resolve({success:!0,data:a})}).error(function(a){h.resolve({success:!1,data:a})}),h.promise},delete:function(e,f,g){var h=b.defer(),i=c(e)(f);return a.delete(i,d(g)).success(function(a){h.resolve({success:!0,data:a})}).error(function(a){h.resolve({success:!1,data:a})}),h.promise},post:function(e,f,g,h){var i=b.defer(),j=c(e)(f),k=d(h);return g||(g={}),k.urlEncoded&&(g=$.param(g)),a.post(j,g,k).success(function(a){i.resolve({success:!0,data:a})}).error(function(a){i.resolve({success:!1,data:a})}),i.promise},put:function(e,f,g,h){var i=b.defer(),j=c(e)(f),k=d(h);return g||(g={}),k.urlEncoded&&(g=$.param(g)),a.put(j,g,k).success(function(a){i.resolve({success:!0,data:a})}).error(function(a){i.resolve({success:!1,data:a})}),i.promise}}}]).factory("thirdPartyApiConfig",["$location",function(a){return{ipify:{baseUrl:"https://api.ipify.org/",endpoints:{getFormattedIp:"?format={{format}}"}},results:{baseUrl:globalSettings.Sports_BetRadarResultsURL,endpoints:{getSportsList:"{{language}}/gismo/sport_matches_sportlist/{{date}}/47",getResultsList:"{{language}}/gismo/sport_matches/{{sportId}}/{{date}}"}},statistics:{baseUrl:globalSettings.Sports_BetRadarResultsURL,endpoints:{getMatchStatistics:"{{language}}/gismo/stats_match_get/{{matchId}}",getHeadToHeadStatistics:"{{language}}/gismo/stats_team_versus/{{homeTeamId}}/{{awayTeamId}}",getLastMatchesStatistics:"{{language}}/gismo/stats_team_lastx/{{teamId}}",getNextMatchesStatistics:"{{language}}/gismo/stats_team_nextx/{{teamId}}",getOverUnderStatistics:"{{language}}/gismo/stats_season_overunder/{{seasonId}}",getGoalscorerStatistics:"{{language}}/gismo/stats_season_topgoals/{{seasonId}}",getAssistsStatistics:"{{language}}/gismo/stats_season_topassists/{{seasonId}}",getCardsStatistics:"{{language}}/gismo/stats_season_topcards/{{seasonId}}",getSeasonTableStatistics:"{{language}}/gismo/stats_season_tables/{{seasonId}}"}}}}]).factory("thirdPartyApiService",["thirdPartyApiConfig","thirdPartyApiHttp",function(a,b){return{ipify:{getFormattedIp:function(c){var d=a.ipify.baseUrl+a.ipify.endpoints.getFormattedIp,e={format:c},f={};return b.get(d,e,f)}},results:{getSportsList:function(c,d){var e=a.results.baseUrl+a.results.endpoints.getSportsList,f={language:c,date:d},g={};return b.get(e,f,g)},getResultsList:function(c,d,e){var f=a.results.baseUrl+a.results.endpoints.getResultsList,g={language:c,sportId:d,date:e},h={};return b.get(f,g,h)}},statistics:{getMatchStatistics:function(c,d){var e=a.statistics.baseUrl+a.statistics.endpoints.getMatchStatistics,f={language:c,matchId:d},g={};return b.get(e,f,g)},getHeadToHeadStatistics:function(c,d,e){var f=a.statistics.baseUrl+a.statistics.endpoints.getHeadToHeadStatistics,g={language:c,homeTeamId:d,awayTeamId:e},h={};return b.get(f,g,h)},getLastMatchesStatistics:function(c,d){var e=a.statistics.baseUrl+a.statistics.endpoints.getLastMatchesStatistics,f={language:c,teamId:d},g={};return b.get(e,f,g)},getNextMatchesStatistics:function(c,d){var e=a.statistics.baseUrl+a.statistics.endpoints.getNextMatchesStatistics,f={language:c,teamId:d},g={};return b.get(e,f,g)},getOverUnderStatistics:function(c,d){var e=a.statistics.baseUrl+a.statistics.endpoints.getOverUnderStatistics,f={language:c,seasonId:d},g={};return b.get(e,f,g)},getGoalscorerStatistics:function(c,d){var e=a.statistics.baseUrl+a.statistics.endpoints.getGoalscorerStatistics,f={language:c,seasonId:d},g={};return b.get(e,f,g)},getAssistsStatistics:function(c,d){var e=a.statistics.baseUrl+a.statistics.endpoints.getAssistsStatistics,f={language:c,seasonId:d},g={};return b.get(e,f,g)},getCardsStatistics:function(c,d){var e=a.statistics.baseUrl+a.statistics.endpoints.getCardsStatistics,f={language:c,seasonId:d},g={};return b.get(e,f,g)},getSeasonTableStatistics:function(c,d){var e=a.statistics.baseUrl+a.statistics.endpoints.getSeasonTableStatistics,f={language:c,seasonId:d},g={};return b.get(e,f,g)}}}}])}(),function(){angular.module("umbracoApi",[]).factory("umbracoApiHttp",["$http","$q","$interpolate",function(a,b,c){var d=function(a){var b={apiType:"umbraco"};return a&&a.urlEncoded&&(b.urlEncoded=a.urlEncoded),b};return{get:function(e,f,g){var h=b.defer(),i=c(e)(f);return a.get(i,d(g)).success(function(a){h.resolve({success:!0,data:a})}).error(function(a){h.resolve({success:!1,data:a})}),h.promise},delete:function(e,f,g){var h=b.defer(),i=c(e)(f);return a.delete(i,d(g)).success(function(a){h.resolve({success:!0,data:a})}).error(function(a){h.resolve({success:!1,data:a})}),h.promise},post:function(e,f,g,h){var i=b.defer(),j=c(e)(f),k=d(h);return g||(g={}),k.urlEncoded&&(g=$.param(g)),a.post(j,g,k).success(function(a){i.resolve({success:!0,data:a})}).error(function(a){i.resolve({success:!1,data:a})}),i.promise},put:function(e,f,g,h){var i=b.defer(),j=c(e)(f),k=d(h);return g||(g={}),k.urlEncoded&&(g=$.param(g)),a.put(j,g,k).success(function(a){i.resolve({success:!0,data:a})}).error(function(a){i.resolve({success:!1,data:a})}),i.promise}}}]).factory("umbracoApiConfig",["$location",function(a){return{desktop:{baseUrl:globalSettings.CurrentDomainURL+"/",endpoints:{getSportsSEOContentBlock:"UmbracoApi/Desktop/Sports/GetSEOContentBlock?sportName={{sportName}}",getSportsAccBonusInfoModalContent:"UmbracoApi/Desktop/Sports/GetAccBonusInfoModalContent?lang={{lang}}",getWidgetsList:"UmbracoApi/Desktop/Sports/GetWidgetsList?lang={{lang}}",getLiveMatchStatusMappings:"UmbracoApi/Desktop/Live/GetLiveMatchStatusMappings?lang={{lang}}",getPaymentBannersList:"UmbracoApi/Desktop/Payment/GetPaymentBannersList",getDepositExtraDetails:"UmbracoApi/Desktop/Deposit/GetDepositExtraDetails?lang={{lang}}",getDepositMethodList:"UmbracoApi/Desktop/Deposit/GetDepositMethodList",getDepositMethodData:"UmbracoApi/Desktop/Deposit/GetDepositMethodData?paymentId={{paymentId}}",getWithdrawalExtraDetails:"UmbracoApi/Desktop/Withdrawal/GetWithdrawalExtraDetails?lang={{lang}}",getWithdrawalMethodList:"UmbracoApi/Desktop/Withdrawal/GetWithdrawalMethodList",getWithdrawalMethodData:"UmbracoApi/Desktop/Withdrawal/GetWithdrawalMethodData?paymentId={{paymentId}}",getPaymentsContentStrings:"UmbracoApi/Desktop/Payment/GetPaymentsContentStrings?lang={{lang}}",getShopDownloadLinks:"UmbracoApi/Desktop/Shop/GetDownloadLinks?lang={{lang}}",getCashDeskShortcutsInfo:"UmbracoApi/Desktop/Shop/GetShortcutsInfo?lang={{lang}}",getMarketingList:"UmbracoApi/Desktop/Shop/GetMarketingList?lang={{lang}}",getMarketingDetails:"UmbracoApi/Desktop/Shop/getMarketingDetails?pageId={{pageId}}&lang={{lang}}",getPromotions:"UmbracoApi/Desktop/Promotions/GetPromotions?lang={{lang}}",getGroupStageSections:"UmbracoApi/Desktop/Predictor/GetGroupStageSections",getKnockoutSections:"UmbracoApi/Desktop/Predictor/GetKnockoutSections",getMaintenanceData:"UmbracoApi/Desktop/GetMaintenanceData?pageUrl={{pageUrl}}&lang={{lang}}",getSportBannersSection:"UmbracoApi/Desktop/SportsBanners/GetSportBannersSection?lang={{lang}}",getSportScreenSaverBanners:"UmbracoApi/Desktop/SportsScreensaver/Banners?lang={{lang}}",getMainSectionBackground:"UmbracoApi/Desktop/Sports/GetMainSectionBackground",getAgentContentList:"UmbracoApi/Desktop/Shop/GetAgentContentList?lang={{lang}}",getAgentContentPage:"UmbracoApi/Desktop/Shop/GetAgentContentPage?pageId={{pageId}}&lang={{lang}}",getLatestDigitalAcceptanceByAgent:"UmbracoApi/Desktop/Shop/GetLatestDigitalAcceptanceByAgent?userId={{userId}}&agentType={{agentType}}",getDigitalAcceptanceAgreement:"UmbracoApi/Desktop/Shop/GetDigitalAcceptanceAgreementByAgentType?userId={{userId}}&agentType={{agentType}}&agreementType={{agreementType}}&version={{version}}",getVirtualsMenu:"UmbracoApi/Desktop/Virtuals/GetVirtualsMenu?lang={{lang}}",getVirtualLeaguesMenu:"UmbracoApi/Desktop/Virtuals/GetVirtualLeaguesMenu?lang={{lang}}",getVirtualsMenuBanners:"UmbracoApi/Desktop/Virtuals/GetVirtualsMenuBanners?lang={{lang}}",getVirtualLeaguesMenuBanners:"UmbracoApi/Desktop/Virtuals/GetVirtualLeaguesMenuBanners?lang={{lang}}",getSplitRegistrationContent:"UmbracoApi/Desktop/Register/GetSplitRegistrationContent?lang={{lang}}",getUpsellRegisterContent:"UmbracoApi/Desktop/Register/GetUpsellRegisterContent?lang={{lang}}",getResetPasswordContent:"UmbracoApi/Desktop/ResetPassword/GetResetPasswordContent?lang={{lang}}",getLoginContent:"UmbracoApi/Desktop/Login/GetLoginContent?lang={{lang}}"}},mobile:{baseUrl:globalSettings.CurrentDomainURL+"/",endpoints:{getPromotions:"UmbracoApi/Mobile/Promotions/GetPromotions?lang={{lang}}",getDepositExtraDetails:"UmbracoApi/Mobile/Deposit/GetDepositExtraDetails?lang={{lang}}",getDepositMethodList:"UmbracoApi/Mobile/Deposit/GetDepositMethodList",getDepositMethodData:"UmbracoApi/Mobile/Deposit/GetDepositMethodData?paymentId={{paymentId}}",getWithdrawalExtraDetails:"UmbracoApi/Mobile/Withdrawal/GetWithdrawalExtraDetails?lang={{lang}}",getWithdrawalMethodList:"UmbracoApi/Mobile/Withdrawal/GetWithdrawalMethodList",getWithdrawalMethodData:"UmbracoApi/Mobile/Withdrawal/GetWithdrawalMethodData?paymentId={{paymentId}}",getPaymentsContentStrings:"UmbracoApi/Desktop/Payment/GetPaymentsContentStrings?lang={{lang}}",getPaymentsOfflineDetails:"UmbracoApi/Mobile/Payment/GetPaymentsOfflineDetails",getHelpSections:"UmbracoApi/Mobile/Help/GetHelpSections",getOMSQuestions:"UmbracoApi/Mobile/Help/GetOMSQuestions",getRegisterSections:"UmbracoApi/Mobile/Register/GetRegisterSections",getUpsellPageContentText:"UmbracoApi/Mobile/Register/GetUpsellPageContentText?lang={{lang}}",getRegisterContent:"UmbracoApi/Mobile/Register/GetRegisterContent",getSuccessRegisterContent:"UmbracoApi/Mobile/Register/GetSuccessRegisterContent",getLoginSections:"UmbracoApi/Mobile/Login/GetLoginSections",getResetPasswordSections:"UmbracoApi/Mobile/ResetPassword/GetResetPasswordSections",getSportBannersSection:"UmbracoApi/Mobile/SportsBanners/GetSportBannersSection",getSportsMainMenu:"UmbracoApi/Mobile/Sports/GetMainMenu",getSportsBottomMenu:"UmbracoApi/Mobile/Sports/GetBottomMenu",getSportsCouponReceipt:"UmbracoApi/Mobile/Sports/GetCouponReceipt",getLiveMarketGroupingDetails:"UmbracoApi/Mobile/Sports/getLiveMarketGroupingDetails",
getGroupStageSections:"UmbracoApi/Mobile/Predictor/GetGroupStageSections",getKnockoutSections:"UmbracoApi/Mobile/Predictor/GetKnockoutSections",getMaintenanceData:"UmbracoApi/Mobile/GetMaintenanceData?pageUrl={{pageUrl}}&lang={{lang}}",getMobileVerificationCampaign:"UmbracoApi/Mobile/MobileVerificationCampaign/GetDetails",getLiveMatchStatusMappings:"UmbracoApi/Mobile/Live/GetLiveMatchStatusMappings?lang={{lang}}"}},shared:{baseUrl:globalSettings.CurrentDomainURL+"/",endpoints:{getCountrySelectionDetails:"UmbracoApi/CountrySelection/GetDetails"}}}}]).factory("umbracoApiService",["umbracoApiConfig","umbracoApiHttp",function(a,b){return{desktop:{getPaymentBannersList:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getPaymentBannersList,e={lang:c},f={};return b.get(d,e,f)},getDepositExtraDetails:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getDepositExtraDetails,e={lang:c},f={};return b.get(d,e,f)},getPaymentsContentStrings:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getPaymentsContentStrings,e={lang:c},f={};return b.get(d,e,f)},getDepositMethodList:function(){var c=a.desktop.baseUrl+a.desktop.endpoints.getDepositMethodList,d={},e={};return b.get(c,d,e)},getDepositMethodData:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getDepositMethodData,e={paymentId:c},f={};return b.get(d,e,f)},getWithdrawalExtraDetails:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getWithdrawalExtraDetails,e={lang:c},f={};return b.get(d,e,f)},getWithdrawalMethodList:function(){var c=a.desktop.baseUrl+a.desktop.endpoints.getWithdrawalMethodList,d={},e={};return b.get(c,d,e)},getWithdrawalMethodData:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getWithdrawalMethodData,e={paymentId:c},f={};return b.get(d,e,f)},getSportsSEOContentBlock:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getSportsSEOContentBlock,e={sportName:c},f={};return b.get(d,e,f)},getShopDownloadLinks:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getShopDownloadLinks,e={lang:c},f={};return b.get(d,e,f)},getCashDeskShortcutsInfo:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getCashDeskShortcutsInfo,e={lang:c},f={};return b.get(d,e,f)},getMarketingList:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getMarketingList,e={lang:c},f={};return b.get(d,e,f)},getMarketingDetails:function(c,d){var e=a.desktop.baseUrl+a.desktop.endpoints.getMarketingDetails,f={pageId:c,lang:d},g={};return b.get(e,f,g)},getPromotions:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getPromotions,e={lang:c},f={};return b.get(d,e,f)},getGroupStageSections:function(){var c=a.desktop.baseUrl+a.desktop.endpoints.getGroupStageSections,d={},e={};return b.get(c,d,e)},getKnockoutSections:function(){var c=a.desktop.baseUrl+a.desktop.endpoints.getKnockoutSections,d={},e={};return b.get(c,d,e)},getMaintenanceData:function(c,d){var e=a.desktop.baseUrl+a.desktop.endpoints.getMaintenanceData,f={pageUrl:c,lang:d},g={};return b.get(e,f,g)},getSportBannersSection:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getSportBannersSection,e={lang:c},f={};return b.get(d,e,f)},getSportScreenSaverBanners:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getSportScreenSaverBanners,e={lang:c},f={};return b.get(d,e,f)},getMainSectionBackground:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getMainSectionBackground,e={lang:c},f={};return b.get(d,e,f)},getAgentContentList:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getAgentContentList,e={lang:c},f={};return b.get(d,e,f)},getAgentContentPage:function(c,d){var e=a.desktop.baseUrl+a.desktop.endpoints.getAgentContentPage,f={pageId:c,lang:d},g={};return b.get(e,f,g)},getLatestDigitalAcceptanceByAgent:function(c,d){var e=a.desktop.baseUrl+a.desktop.endpoints.getLatestDigitalAcceptanceByAgent,f={userId:c,agentType:d},g={};return b.get(e,f,g)},getDigitalAcceptanceAgreement:function(c,d,e,f){var g=a.desktop.baseUrl+a.desktop.endpoints.getDigitalAcceptanceAgreement,h={userId:c,agentType:d,agreementType:e,version:f},i={};return b.get(g,h,i)},getVirtualsMenu:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getVirtualsMenu,e={lang:c},f={};return b.get(d,e,f)},getVirtualLeaguesMenu:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getVirtualLeaguesMenu,e={lang:c},f={};return b.get(d,e,f)},getVirtualsMenuBanners:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getVirtualsMenuBanners,e={lang:c},f={};return b.get(d,e,f)},getVirtualLeaguesMenuBanners:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getVirtualLeaguesMenuBanners,e={lang:c},f={};return b.get(d,e,f)},getSplitRegistrationContent:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getSplitRegistrationContent,e={lang:c},f={};return b.get(d,e,f)},getResetPasswordContent:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getResetPasswordContent,e={lang:c},f={};return b.get(d,e,f)},getUpsellRegisterContent:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getUpsellRegisterContent,e={lang:c},f={};return b.get(d,e,f)},getLoginContent:function(c){var d=a.desktop.baseUrl+a.desktop.endpoints.getLoginContent,e={lang:c},f={};return b.get(d,e,f)},getSportsAccBonusInfoModalContent:function(c){var d=a.mobile.baseUrl+a.desktop.endpoints.getSportsAccBonusInfoModalContent,e={lang:c},f={};return b.get(d,e,f)},getWidgetsList:function(c){var d=a.mobile.baseUrl+a.desktop.endpoints.getWidgetsList,e={lang:c},f={};return b.get(d,e,f)},getLiveMatchStatusMappings:function(c){var d=a.mobile.baseUrl+a.desktop.endpoints.getLiveMatchStatusMappings,e={lang:c},f={};return b.get(d,e,f)}},mobile:{getDepositExtraDetails:function(c){var d=a.mobile.baseUrl+a.mobile.endpoints.getDepositExtraDetails,e={lang:c},f={};return b.get(d,e,f)},getPaymentsContentStrings:function(c){var d=a.mobile.baseUrl+a.mobile.endpoints.getPaymentsContentStrings,e={lang:c},f={};return b.get(d,e,f)},getDepositMethodList:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getDepositMethodList,d={},e={};return b.get(c,d,e)},getDepositMethodData:function(c){var d=a.mobile.baseUrl+a.mobile.endpoints.getDepositMethodData,e={paymentId:c},f={};return b.get(d,e,f)},getWithdrawalExtraDetails:function(c){var d=a.mobile.baseUrl+a.mobile.endpoints.getWithdrawalExtraDetails,e={lang:c},f={};return b.get(d,e,f)},getWithdrawalMethodList:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getWithdrawalMethodList,d={},e={};return b.get(c,d,e)},getWithdrawalMethodData:function(c){var d=a.mobile.baseUrl+a.mobile.endpoints.getWithdrawalMethodData,e={paymentId:c},f={};return b.get(d,e,f)},getPaymentsOfflineDetails:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getPaymentsOfflineDetails,d={},e={};return b.get(c,d,e)},getPromotions:function(c){var d=a.mobile.baseUrl+a.mobile.endpoints.getPromotions,e={lang:c},f={};return b.get(d,e,f)},getHelpSections:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getHelpSections,d={},e={};return b.get(c,d,e)},getOMSQuestions:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getOMSQuestions,d={},e={};return b.get(c,d,e)},getRegisterSections:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getRegisterSections,d={},e={};return b.get(c,d,e)},getUpsellPageContentText:function(c){var d=a.mobile.baseUrl+a.mobile.endpoints.getUpsellPageContentText,e={lang:c},f={};return b.get(d,e,f)},getRegisterContent:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getRegisterContent,d={},e={};return b.get(c,d,e)},getSuccessRegisterContent:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getSuccessRegisterContent,d={},e={};return b.get(c,d,e)},getLoginSections:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getLoginSections,d={},e={};return b.get(c,d,e)},getResetPasswordSections:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getResetPasswordSections,d={},e={};return b.get(c,d,e)},getVirtualSections:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getVirtualSections,d={},e={};return b.get(c,d,e)},getSportBannersSection:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getSportBannersSection,d={},e={};return b.get(c,d,e)},getSportsMainMenu:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getSportsMainMenu,d={},e={};return b.get(c,d,e)},getSportsBottomMenu:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getSportsBottomMenu,d={},e={};return b.get(c,d,e)},getSportsCouponReceipt:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getSportsCouponReceipt,d={},e={};return b.get(c,d,e)},getLiveMarketGroupingDetails:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getLiveMarketGroupingDetails,d={},e={};return b.get(c,d,e)},getGroupStageSections:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getGroupStageSections,d={},e={};return b.get(c,d,e)},getKnockoutSections:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getKnockoutSections,d={},e={};return b.get(c,d,e)},getMaintenanceData:function(c,d){var e=a.mobile.baseUrl+a.mobile.endpoints.getMaintenanceData,f={pageUrl:c,lang:d},g={};return b.get(e,f,g)},getMobileVerificationCampaign:function(){var c=a.mobile.baseUrl+a.mobile.endpoints.getMobileVerificationCampaign,d={},e={};return b.get(c,d,e)},getLiveMatchStatusMappings:function(c){var d=a.mobile.baseUrl+a.mobile.endpoints.getLiveMatchStatusMappings,e={lang:c},f={};return b.get(d,e,f)}},shared:{getCountrySelectionDetails:function(){var c=a.shared.baseUrl+a.shared.endpoints.getCountrySelectionDetails,d={},e={};return b.get(c,d,e)}}}}])}(),function(){angular.module("websiteApi",[]).factory("websiteApiHttp",["$rootScope","$http","$q","$interpolate","$log",function(a,b,c,d,e){var f=function(a){var b={apiType:"website"};return a&&(a.noAuthToken&&(b.noAuthToken=a.noAuthToken),a.urlEncoded&&(b.urlEncoded=a.urlEncoded),a.showLoader&&(b.showLoader=a.showLoader),a.apiVersion&&(b.apiVersion=a.apiVersion),a.sendActivitySource&&(b.sendActivitySource=a.sendActivitySource),a.params&&(b.params=a.params)),b},g=function(a,b){var c=[200,409];return{statusCode:b,success:200===b,isError:!_.includes(c,b),data:a}};return{get:function(e,h,i){var j=c.defer(),k=d(e)(h),l=f(i);return l.showLoader&&a.showLoader&&a.showLoader(),b.get(k,l).success(function(b,c){l.showLoader&&a.hideLoader&&a.hideLoader();var d=g(b,c);j.resolve(d)}).error(function(b,c){l.showLoader&&a.hideLoader&&a.hideLoader();var d=g(b,c);j.resolve(d)}),j.promise},post:function(e,h,i,j){var k=c.defer(),l=d(e)(h),m=f(j);return i||(i={}),m.urlEncoded&&(i=$.param(i)),m.showLoader&&a.showLoader&&a.showLoader(),b.post(l,i,m).success(function(b,c){m.showLoader&&a.hideLoader&&a.hideLoader();var d=g(b,c);k.resolve(d)}).error(function(b,c){m.showLoader&&a.hideLoader&&a.hideLoader();var d=g(b,c);k.resolve(d)}),k.promise},delete:function(e,h,i){var j=c.defer(),k=d(e)(h),l=f(i);return l.showLoader&&a.showLoader&&a.showLoader(),b.delete(k,l).success(function(b,c){l.showLoader&&a.hideLoader&&a.hideLoader();var d=g(b,c);j.resolve(d)}).error(function(b,c){l.showLoader&&a.hideLoader&&a.hideLoader();var d=g(b,c);j.resolve(d)}),j.promise}}}]).factory("websiteApiConfig",[function(){String.prototype.endsWith||(String.prototype.endsWith=function(a,b){return(void 0===b||b>this.length)&&(b=this.length),this.substring(b-a.length,b)===a});var a=globalSettings.WebsiteApiURL;return a.endsWith("/")||(a+="/"),{f2p:{baseUrl:a,endpoints:{getF2PUserBasicDetails:"api/User/Profile/Agents/GetF2PUserBasicDetails",registerF2PAccountIntoBetking:"api/User/Profile/Agents/RegisterF2PAccountIntoBetking"}},location:{baseUrl:a,endpoints:{getBlockedActions:"api/Location/BlockedActions?sv={{siteVersion}}"}},user:{baseUrl:a,endpoints:{profile:{registerNewSubAccountAgent:"api/User/Profile/Agents/RegisterNewSubAccountAgent",isExistingUsername:"api/User/Profile/Agents/IsExistingUsername?UsernameToCheck={{username}}",linkF2PAccount:"api/User/Profile/LinkF2PAccountWithUnverifiedMobileNumberAccount"}}},assistanceProgram:{baseUrl:a,endpoints:{getActiveLoans:"/agency/api/Loan/Loans?loanTypeCode={{loanTypeCode}}",getloanRepayments:"/agency/api/Loan/LoanRepayments?loanID={{loanID}}",payAssistanceLoanAmount:"agency/api/Loan/PerformPayment",getLoanTypes:"/agency/api/Loan/LoanTypes"}},bonus:{baseUrl:a,endpoints:{claims:{getAllBonusClaims:"/api/Bonus/Claims",getBonusClaimsById:"/api/Bonus/Claims/{{claimId}}",getBonusClaimsProgressById:"/api/Bonus/Claims/{{claimId}}/Progress",activateBonusClaims:"/api/Bonus/Claims/Activate",pauseBonus:"/api/Bonus/Claims/Pause",unpauseBonus:"/api/Bonus/Claims/UnPause"}}},paymentVendors:{baseUrl:a,endpoints:{registerLoadbalancerWithdrawal:"api/PaymentVendors/RegisterWithdrawal",getAcceptingTraffic:"/api/PaymentVendors/WithdrawalVendorProperties",getAllDepositPaymentMethods:"/payments/api/PaymentVendors/PaymentMethods/Deposit",getAllWithdrawalPaymentMethods:"/payments/api/PaymentVendors/PaymentMethods/Withdrawal",withdrawalStatus:"api/Financials/Withdrawal/Status",depositStatus:"api/Financials/Deposit/Status"}},payments:{baseUrl:a,endpoints:{paystack:{getUserLastDepositMethod:"API/Payments/paystack/LastDepositMethod",registerMomoWithdrawal:"API/Payments/paystack/RegisterMomoWithdrawal",registerDeposit:"/api/payments/paystack/RegisterDeposit",processDeposit:"/api/payments/paystack/ProcessDeposit",confirmDeposit:"/api/payments/paystack/ConfirmDeposit",chargeDeposit:"/api/payments/paystack/ChargeCardDeposit",checkDepositStatus:"/api/payments/paystack/Deposit/Status?paymentMethod={{paymentIdentifier}}&transactionId={{transactionId}}",canPaymentMethodChange:"/api/payments/paystack/CanPaymentMethodChange"},cbe:{requestTransferCode:"/api/PaymentVendors/CBE/RequestTransferCode",registerWithdrawal:"api/PaymentVendors/CBE/RegisterWithdrawal",cancelDepositTransaction:"api/PaymentVendors/CBE/CancelDepositTransaction",fetchPendingDeposits:"api/PaymentVendors/CBE/DepositTransactions"},amole:{registerWithdrawal:"api/Payments/Amole/RegisterWithdrawal"},userConfiguration:{userWithdrawalConfiguration:"api/Financials/UserWithdrawalConfiguration?paymentMethodIdentifier={{paymentIdentifier}}"},telebirr:{generateUrl:"payments/Integrations/TeleBirr/GenerateDepositUrl",depositStaus:"payments/Integrations/TeleBirr/Deposit/Status",pendingTransactions:"payments/Integrations/TeleBirr/Deposit/PendingDepositTransactions"}}},registration:{baseUrl:a,endpoints:{getIdTypes:"/api/Registration/IDDocument/Types",checkType:"/api/Registration/IDDocument/Validate",checkKYCStatus:"API/KYC/User/Status"}}}}]).factory("websiteApiService",["websiteApiConfig","websiteApiHttp",function(a,b){return{f2p:{getF2PUserBasicDetails:function(c){var d=a.f2p.baseUrl+a.f2p.endpoints.getF2PUserBasicDetails,e={showLoader:!1};return b.post(d,{},c,e)},registerF2PAccountIntoBetking:function(c){var d=a.f2p.baseUrl+a.f2p.endpoints.registerF2PAccountIntoBetking,e={showLoader:!1,sendActivitySource:!0};return b.post(d,{},c,e)}},location:{getBlockedActions:function(){var c=a.location.baseUrl+a.location.endpoints.getBlockedActions,d={siteVersion:globalSettings.SiteVersion},e={};return b.get(c,d,e)}},user:{registerNewSubAccountAgent:function(c){var d=a.user.baseUrl+a.user.endpoints.profile.registerNewSubAccountAgent,e={showLoader:!1,sendActivitySource:!0};return b.post(d,{},c,e)},isExistingUsername:function(c){var d=a.user.baseUrl+a.user.endpoints.profile.isExistingUsername,e={username:c},f={sendActivitySource:!0};return b.get(d,e,f)},linkF2PAccount:function(c){var d=a.user.baseUrl+a.user.endpoints.profile.linkF2PAccount,e={Token:c},f={showLoader:!0,sendActivitySource:!0};return b.post(d,{},e,f)}},assistanceProgram:{getActiveLoans:function(c){var d=a.assistanceProgram.baseUrl+a.assistanceProgram.endpoints.getActiveLoans,e={showLoader:!0};return b.get(d,c,e)},getloanRepayments:function(c){var d=a.assistanceProgram.baseUrl+a.assistanceProgram.endpoints.getloanRepayments,e={showLoader:!0};return b.get(d,c,e)},getLoanTypes:function(){var c=a.assistanceProgram.baseUrl+a.assistanceProgram.endpoints.getLoanTypes,d={showLoader:!0};return b.get(c,d)},payAssistanceLoanAmount:function(c){var d=a.assistanceProgram.baseUrl+a.assistanceProgram.endpoints.payAssistanceLoanAmount,e={},f={LoanId:c.LoanId,Amount:c.Amount};return b.post(d,f,f,e)}},bonus:{getAllBonusClaims:function(){var c=a.bonus.baseUrl+a.bonus.endpoints.claims.getAllBonusClaims,d={};return b.get(c,{},d)},getBonusClaimsById:function(c){var d=a.bonus.baseUrl+a.bonus.endpoints.claims.getBonusClaimsById,e={claimId:c},f={};return b.get(d,e,f)},getBonusClaimsProgressById:function(c){var d=a.bonus.baseUrl+a.bonus.endpoints.claims.getBonusClaimsProgressById,e={claimId:c},f={};return b.get(d,e,f)},activateBonusClaims:function(c){var d=a.bonus.baseUrl+a.bonus.endpoints.claims.activateBonusClaims,e={showLoader:!0};return b.post(d,{},c,e)},pauseBonus:function(c){var d=a.bonus.baseUrl+a.bonus.endpoints.claims.pauseBonus,e={ClaimId:c},f={showLoader:!0};return b.post(d,{},e,f)},unpauseBonus:function(c){var d=a.bonus.baseUrl+a.bonus.endpoints.claims.unpauseBonus,e={ClaimId:c},f={showLoader:!0};return b.post(d,{},e,f)}},paymentVendors:{registerLoadbalancerWithdrawal:function(c){var d=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.registerLoadbalancerWithdrawal,e=c,f={sendActivitySource:!0};return b.post(d,{},e,f)},getAcceptingTraffic:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.getAcceptingTraffic,d={siteVersion:globalSettings.SiteVersion},e={};return b.get(c,d,e)},getAllDepositPaymentMethods:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.getAllDepositPaymentMethods,d={showLoader:!0};return b.get(c,{},d)},getAllWithdrawalPaymentMethods:function(){var c=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.getAllWithdrawalPaymentMethods,d={};return b.get(c,{},d)},withdrawalStatus:function(c,d){var e=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.withdrawalStatus+"?transactionId="+c+"&transactionTypeId="+d,f={},g={};return b.get(e,f,g)},depositStatus:function(c,d){var e=a.paymentVendors.baseUrl+a.paymentVendors.endpoints.depositStatus+"?transactionId="+c+"&transactionTypeId="+d,f={},g={};return b.get(e,f,g)}},payments:{paystack:{getUserLastDepositMethod:function(){var c=a.payments.baseUrl+a.payments.endpoints.paystack.getUserLastDepositMethod,d={};return b.get(c,{},d)},registerMomoWithdrawal:function(c){var d=a.payments.baseUrl+a.payments.endpoints.paystack.registerMomoWithdrawal,e=c,f={};return b.post(d,{},e,f)},registerDeposit:function(c){var d=a.payments.baseUrl+a.payments.endpoints.paystack.registerDeposit,e=c,f={};return b.post(d,{},e,f)},processDeposit:function(c){var d=a.payments.baseUrl+a.payments.endpoints.paystack.processDeposit,e=c,f={};return b.post(d,{},e,f)},confirmDeposit:function(c){var d=a.payments.baseUrl+a.payments.endpoints.paystack.confirmDeposit,e=c,f={};return b.post(d,{},e,f)},chargeDeposit:function(c){var d=a.payments.baseUrl+a.payments.endpoints.paystack.chargeDeposit,e=c,f={};return b.post(d,{},e,f)},checkDepositStatus:function(c,d){var e=a.payments.baseUrl+a.payments.endpoints.paystack.checkDepositStatus,f={paymentIdentifier:c,transactionId:d},g={};return b.get(e,f,g)},canPaymentMethodChange:function(){var c=a.payments.baseUrl+a.payments.endpoints.paystack.canPaymentMethodChange,d={};return b.get(c,{},d)}},cbe:{requestTransferCode:function(c){var d=a.payments.baseUrl+a.payments.endpoints.cbe.requestTransferCode,e=c,f={};return b.post(d,{},e,f)},registerWithdrawal:function(c){var d=a.payments.baseUrl+a.payments.endpoints.cbe.registerWithdrawal,e=c,f={};return b.post(d,{},e,f)},cancelDepositTransaction:function(c){var d=a.payments.baseUrl+a.payments.endpoints.cbe.cancelDepositTransaction,e=c,f={};return b.post(d,{},e,f)},fetchPendingDeposits:function(){var c=a.payments.baseUrl+a.payments.endpoints.cbe.fetchPendingDeposits,d={};return b.get(c,{},d)}},amole:{registerWithdrawal:function(c){var d=a.payments.baseUrl+a.payments.endpoints.amole.registerWithdrawal,e=c,f={};return b.post(d,{},e,f)}},amole:{registerWithdrawal:function(c){var d=a.payments.baseUrl+a.payments.endpoints.amole.registerWithdrawal,e=c,f={};return b.post(d,{},e,f)}},userConfiguration:{userWithdrawalConfiguration:function(c){var d=a.payments.baseUrl+a.payments.endpoints.userConfiguration.userWithdrawalConfiguration,e={paymentIdentifier:c},f={};return b.get(d,e,f)}},telebirr:{generateUrl:function(c){var d=a.payments.baseUrl+a.payments.endpoints.telebirr.generateUrl,e=c,f={};return b.post(d,{},e,f)},depositStaus:function(c){var d=a.payments.baseUrl+a.payments.endpoints.telebirr.depositStaus,e={transactionId:c},f={params:e};return b.get(d,{},f)},pendingTransactions:function(){var c=a.payments.baseUrl+a.payments.endpoints.telebirr.pendingTransactions,d={};return b.get(c,{},d)}}},registration:{getIdTypes:function(){var c=a.registration.baseUrl+a.registration.endpoints.getIdTypes,d={};return b.get(c,{},d)},checkType:function(c){var d=a.registration.baseUrl+a.registration.endpoints.checkType,e=c,f={};return b.post(d,{},e,f)},checkKYCStatus:function(){var c=a.registration.baseUrl+a.registration.endpoints.checkKYCStatus,d={};return b.get(c,{},d)}}}}])}(),function(){angular.module("app.directive",[]).directive("imagifySection",["$window",function(a){return globalSettings.Account_ImagifyCouponCheck?{replace:"true",restrict:"A",scope:{imageData:"=imageData",deferExecution:"@deferExecution"},link:function(a,b,c){function d(){domtoimage.toPng(b[0]).then(function(b){a.imageData=b})}setTimeout(d,a.deferExecution||0)}}:{}}]).directive("onLastRepeat",function(){return function(a,b,c){a.$last&&setTimeout(function(){a.$emit("onRepeatLast",b,c)},1)}}).directive("goBack",["$window",function(a){return{restrict:"A",link:function(b,c,d){c.on("click",function(){a.history.back()})}}}]).directive("goTop",function(){return{restrict:"A",link:function(a,b,c){b.on("click",function(){$("html, body").animate({scrollTop:$("#top").offset().top},600)})}}}).directive("onSizeChanged",["$window",function(a){return{restrict:"A",scope:{onSizeChanged:"&"},link:function(b,c,d){function e(){b.onSizeChanged()(f)}var f=c[0];a.addEventListener("resize",e)}}}]).directive("ngEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}}).directive("expandMarkets",function(){return{restrict:"A",link:function(a,b,c){var d=b,e=a.$index;globalSettings.Sports_EnableExpandedOdds&&"all"!=globalSettings.Sports_NumberOfExpandedOdds&&e<globalSettings.Sports_NumberOfExpandedOdds&&setTimeout(function(){$(d).click()},0)}}}).directive("expandInnerMarkets",function(){return{restrict:"A",link:function(a,b,c){var d=b,e=a.$index;e<=12&&setTimeout(function(){$(d).click()},400)}}}).directive("formatInnerOdds",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){a(function(){var a=c.children().length;if($(window).width()<=1300){if(c.css("max-width","calc(100% - 246px)"),a>8){Math.ceil(a/8);c.parent().css("margin","0 -1px 0 1px")}}else if(c.css("max-width","calc(100% - 232px)"),a>9){Math.ceil(a/9);c.parent().css("margin","0 -1px 0 1px")}},0)}}}]).directive("expandMatchOdds",function(){return{restrict:"A",link:function(a,b,c){var d=c.matchidparam;if(void 0!=d){var e=c.smartbetcode;e==d&&setTimeout(function(){$(b).click()},0)}}}}).directive("changeCourtBg",function(){return{restrict:"EA",link:function(a,b,c){that=b,a.bgType="",a.changeScoreBg=function(){setTimeout(function(){a.bgType=that.contents().find(".sr-content:first").attr("data-pitch-type")},1500)},a.$on("changeScoreBg",function(b,c){a.changeScoreBg()})}}}).directive("alternateRowGroups",function(){return{restrict:"EA",scope:{currentEventname:"@"},link:function(a,b,c){c.$observe("currentEventname",function(a){var c=a,d=b.prev().attr("current-Eventname"),e=b.prev().hasClass("even-row");c!=d&&(b.addClass("first-in-group"),1==e?b.removeClass("even-row"):b.addClass("even-row")),c==d&&(b.removeClass("first-in-group"),1==e?b.addClass("even-row"):b.removeClass("even-row"))})}}}).directive("search",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){var e=c.search;d.$render=function(a){var c=a||0===a?a:e;b.val(c)},b.on("focus",function(){d.$viewValue||b.val("")}),b.on("blur",function(){d.$viewValue||b.val(e)})}}}).directive("owlCarousel",function(){return{restrict:"EA",scope:{owlOptions:"="},transclude:!1,controller:["$scope","$element",function(a,b){var c=null,d=$(b),e=angular.extend({},a.owlOptions);this.CarouselDestroy=function(){c.destroy()},this.CarouselCreateUpdate=function(){c&&this.CarouselDestroy(),d.owlCarousel(a.owlOptions),c=d.data("owl.carousel")},a.$on(e.id?"carousel."+e.id:"carousel",function(a,b){d.trigger(b+".owl.carousel")})}]}}).directive("owlCarouselItem",function(){return{restrict:"EA",require:"^owlCarousel",link:function(a,b,c,d){a.$last&&d.CarouselCreateUpdate()}}}).directive("ngCloak",["$timeout",function(a){return{restrict:"A",compile:function(b,c){a(function(){c.$set("ngCloak",void 0),b.removeClass("ng-cloak")})}}}]).directive("socialIcon",["$timeout",function(a){return{restrict:"E",replace:!0,template:'<div class="social-icons"> <div class="social-icon {{icon}}"> <div class="social-icon-wrapper"> <div class="logo" ng-click="compileContent(); popupShouldShow($event)"> <img ng-src="{{imagePath}}" alt="Social Icon"/> </div><div class="social-icon-content {{icon}}"> <div class="social-title"> <span><i class="fa fa-{{faIcon}}"></i>{{title}}</span><i class="fa fa-times" ng-click="removeModal()"></i></div><div class="social-content"></div></div></div></div></div>',scope:{title:"@",content:"@",icon:"@"},link:function(b,c,d){function e(a,b,c){if(!(a.length<2)){var d=[],e=null;c?$(a).each(function(a,c){d.push($(c)),$(b).attr("class")!==$(c).attr("class")&&(e=d.splice(a,1)[0],$(b).css("z-index",parseInt($(e).css("z-index"))+1))}):$(b).css("z-index",100)}}switch(b.imagePath="",b.faIcon="",b.icon){case"whatsapp":b.imagePath=globalSettings.SiteContentURL+"/images/WhatsApp-icon.png",b.faIcon="whatsapp";break;case"telegram":b.imagePath=globalSettings.SiteContentURL+"/images/Telegram_logo.png",b.faIcon="telegram"}b.compileContent=function(){a(function(){var a=$("body").find(".social-icon"),d=c.find(".social-icon"),f=c.find(".social-content");e(a,d,!0),f.html(b.content)})},b.popupShouldShow=function(b){a(function(){$(".social-icon-content").hide(),$(b.target).parent().siblings(".social-icon-content").show()})},b.removeModal=function(a){var b=$("body").find(".social-icon"),d=c.find(".social-icon");e(b,d,!1),$(".social-icon-content").hide()}}}}]).directive("crossHover",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){b.$watch("aCrossHover",function(b,d){function e(){c.find("tr").each(function(a,b){var c=$(b),d=c.find("td").not(".dateRow");d.each(function(a,b){$(b).removeClass(function(a,b){var c=b.split(" "),d=[];return $.each(c,function(a,b){/col.*/.test(b)&&d.push(b)}),d.join(" ")}),$(b).addClass("col-"+a)})})}function f(){j=_.last($(this).attr("class").split(/\s+/)),c.find("tr:not(.trMultiline):not(.nohover) .oddItem."+j).addClass("hover_class"),$(this).closest("tr").not(".trMultiline").not(".nohover").addClass("hover_class")}function g(){$(this).closest("tr").not(".trMultiline").not(".nohover").removeClass("hover_class"),c.find("tr:not(.trMultiline):not(.nohover) .oddItem."+j).removeClass("hover_class")}function h(){j=null,c.find("tr").off({mouseenter:f,mouseleave:g},"td"),c.find("tr").on({mouseenter:f,mouseleave:g},"td")}function i(){if(k.length)return k.on("click",function(){a(function(){e(),h()},350)})}var j=null,k=c.parents(".tdEventsTable").siblings("#tdClassiQuote").find(".owl-item");e(),h(),i()})}}}]).directive("integerValidation",function(){return{require:"?ngModel",link:function(a,b,c,d){d&&(d.$parsers.push(function(a){if(angular.isUndefined(a))var a="";var b=a.replace(/[^0-9]+/g,"");return a!==b&&(d.$setViewValue(b),d.$render()),b}),b.bind("keypress",function(a){32===a.keyCode&&a.preventDefault()}))}}}).directive("focusIf",["$timeout","$parse",function(a,b){return{link:function(c,d,e){var f=b(e.focusIf);c.$watch(f,function(b){b===!0&&a(function(){d[0].focus()})}),d.bind("blur",function(){c.$apply(f.assign(c,!1))})}}}]).directive("ngSvg",function(){return{restrict:"E",scope:{source:"="},link:function(a,b,c){a.$watch("source",function(a,c){a&&b.replaceWith('<object type="image/svg+xml" data="'+a+'"></object>')},!0)}}}).directive("progressBar",["$compile",function(a){return{restrict:"A",scope:{value:"=value",minValue:"=?minValue",goal:"=goal",label:"=?label",afterIcon:"=?afterIcon"},link:function(b,c,d){function e(){var a=null;if(b.minValue=b.minValue||0,b.value=b.value||[],b.goal=b.goal||[],b.value>=b.goal)a="100%";else{var c=100*(b.value-b.minValue)/(b.goal-b.minValue);a=c<=0?"0%":c.toString()+"%"}return a}b.label=b.label||"",b.afterIcon=b.afterIcon||!1;var f=null;f=b.afterIcon?angular.element('<div class="ng-progress-bar-wrapper"><div class="ng-progress-bar" style="width:'+e()+'"></div><i class="fa fa-caret-up pointer-current-result"></i></div>'):""!==b.label?angular.element('<div class="ng-progress-bar-wrapper"><div class="ng-progress-bar" style="width:'+e()+'"></div><span class= "ng-progress-bar-label" style="text-align:center">'+b.label+"</span></div>"):angular.element('<div class="ng-progress-bar-wrapper"><div class="ng-progress-bar" style="width:'+e()+'"></div></div>'),a(f)(b,function(a){c.prepend(a)}),b.$watch("[goal,value,minValue]",function(a,b){a!==b&&(c[0].children[0].children[0].style.cssText="transition: width 2s; width:"+e())},!0),b.$watch("label",function(a,b){a!==b&&(c[0].children[0].children[1].innerHTML=a)},!0)}}}]).directive("chartistNgPie",["$compile",function(a){function b(a,b,c){setTimeout(function(){var b=Chartist[a.type]("#"+a.id,a.data,a.options,a.responsiveOptions);b.on("draw",function(a){if("slice"===a.type){var b=a.element._node.getTotalLength();a.element.attr({"stroke-dasharray":b+"px "+b+"px"});var c={"stroke-dashoffset":{id:"anim"+a.index,dur:700,from:-b+"px",to:"0px",easing:Chartist.Svg.Easing.easeInOutCirc,fill:"freeze"}};0!==a.index&&(c["stroke-dashoffset"].begin="anim"+(a.index-1)+".end"),a.element.attr({"stroke-dashoffset":-b+"px"}),a.element.animate(c,!1)}}),a.$watch("data",function(c,d){c!==d&&b.update(c,a.options,!0)},!0),a.$watch("options",function(c,d){c!==d&&b.update(a.data,c,!0)},!0)},0)}return{scope:{data:"=",options:"=",responsiveOptions:"@",type:"@",id:"@",tooltips:"@"},link:b,restrict:"EA"}}]).directive("otpScreen",function(){return{restrict:"E",bindToController:{mobileExtension:"=",mobileNumber:"=",username:"=",otpType:"=",onOtpVerified:"&"},templateUrl:"/partials/authenticated/shared/otp/otpVerification.html",controller:"OTPController",controllerAs:"otpCtrl",scope:{}}}).directive("autoWithdrawalsPartial",function(){return{restrict:"E",bindToController:{userBalance:"=",minimumLimitAmount:"=",maximumLimitAmount:"=",isDesktop:"="},templateUrl:"/partials/authenticated/shared/autoWithdrawals/autoWithdrawals.html",controller:"AutoWithdrawalsController",controllerAs:"aWCtrl",scope:{}}}).directive("depositWithdrawalsBalancePartial",function(){return{restrict:"E",bindToController:{userBalance:"=",isDesktop:"=",show:"=",disable:"=",action:"=",param:"=?",btnType:"="},templateUrl:"/partials/authenticated/shared/depositWithdrawals/depositWithdrawals.html",controller:"DepositWithdrawalsBalancePartialController",controllerAs:"dWCtrl",scope:{},transclude:!0}}).directive("depositWithdrawalsBalancePartialOffline",function(){return{restrict:"E",bindToController:{userBalance:"=",isDesktop:"=",show:"="},templateUrl:"/partials/authenticated/shared/depositWithdrawals/depositWithdrawalsOffline.html",controller:"DepositWithdrawalsBalancePartialOfflineController",controllerAs:"dWOCtrl",scope:{}}}).directive("withdrawalDailyAttemptsDisclaimerPartial",function(){return{restrict:"E",templateUrl:"/partials/authenticated/shared/withdraw/withdrawalDailyAttemptsDisclaimer.html",controller:"WithdrawalDailyAttemptsController",controllerAs:"withdrawalDailyAttemptsCtrl",scope:{}}})}(),function(){angular.module("app.filter",[]).filter("orderObjectBy",function(){return function(a,b,c){var d=[];return angular.forEach(a,function(a){
d.push(a)}),d.sort(function(a,c){return a[b]>c[b]?1:-1}),c&&d.reverse(),d}}).filter("unsOrderObjectBy",function(){return function(a,b,c){var d=function(a){return _.isString(a[b])?a[b].toLowerCase():a[b]};return _.orderBy(a,[d],c?"desc":"asc")}}).filter("html",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]).filter("setDecimal",["$filter",function(a){return function(a,b){if(isNaN(a))return a;var c="1"+Array(+(b>0&&b+1)).join("0");return Math.round(a*c)/c}}]).filter("currencyFormat",["currencyService","authService","$sessionStorage",function(a,b,c){return function(d,e){if("es"==globalSettings.CurrentLanguage||"it"==globalSettings.CurrentLanguage)return parseFloat(d).toFixed(2).replace(".",",").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.");var f="";return b.getUserData()?f=b.getUserData().currency.Currency:c.SportsbookGlobalVariable&&c.SportsbookGlobalVariable.CurrencyId&&(f=a.getCurrencyCode(c.SportsbookGlobalVariable.CurrencyId)),a.smartFormatNumber(f,"string"==typeof d?parseFloat(d):d,e)}}]).filter("positive",function(){return function(a){return a?Math.abs(a):0}}).filter("unique",function(){return function(a,b){var c=[],d=[];return angular.forEach(a,function(a){var e=a[b];d.indexOf(e)===-1&&(d.push(e),c.push(a))}),c}}).filter("to_trusted",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]).filter("to_date",["$filter",function(a){return function(b){if(null==b)return"";var c=a("date")(new Date(b),"dd MMM yyyy");return c.toUpperCase()}}]).filter("dateSuffix",["$filter",function(a){var b=["th","st","nd","rd"];return function(c){var d=a("date")(c,"dd MMM yyyy"),e=parseInt(d.substring(0,2)),f=d.substring(2),g=e<30?e%20:e%30,h=g<=3?b[g]:b[0];return e+h+f}}]).filter("dateToLocal",function(){return function(a){return moment(a).tz(moment.tz.guess(moment()))}}).filter("propsFilter",function(){return function(a,b){var c=[];return angular.isArray(a)?a.forEach(function(a){for(var d=!1,e=Object.keys(b),f=0;f<e.length;f++){var g=e[f],h=b[g].toLowerCase();if(a[g].toString().toLowerCase().indexOf(h)!==-1){d=!0;break}}d&&c.push(a)}):c=a,c}}).filter("isStringEmpty",function(){return function(a){return null!==a&&0!==a.trim().length?a:"None"}}).filter("isMaleOrFemale",function(){return function(a){return"M"===a?"Male":"Female"}}).filter("getCountryNameByIso",function(){return function(a,b){if(b.length>0)for(var c=0;c<b.length;c++)if(b[c].ThreeLetterCode===a)return b[c].Name;return"No Country Selected"}}).filter("getCurrencyPretty",function(){return function(a,b){if(b.length>0)for(var c=0;c<b.length;c++)if(b[c].IsoCode===a)return b[c].Symbol+" "+b[c].Name;return"No Currency Selected"}}).filter("getSQPretty",function(){return function(a,b){if(b.length>0)for(var c=0;c<b.length;c++)if(b[c].Id===a)return b[c].Name;return"No Security Question Selected"}}).filter("getDepositLimitPretty",function(){return function(a,b,c){if(b.length>0)for(var d=0;d<b.length;d++)if(a==b[d].Id)return 0==b[d].Id?b[d].Name:c+" "+b[d].Name;return"No Deposit Limit Selected"}}).filter("getEmailLanguagePretty",function(){return function(a,b){if(b.length>0)for(var c=0;c<b.length;c++)if(b[c].IsoCode===a)return b[c].DisplayName;return"No Security Question Selected"}}).filter("formatOdd",function(){return function(a,b){if(isNaN(a))return a;var c=null;switch(b.value){case 1:var d=function(a,b){return b<1e-7?a:d(b,Math.floor(a%b))};a=parseFloat(a);var e=(a>1?a-1:a).toFixed(2),f=e.toString().length-2,g=Math.pow(10,f),h=(e*g).toFixed(0),i=d(h,g);h=(h/i).toFixed(0),g=(g/i).toFixed(0),c=Math.floor(h)+"/"+Math.floor(g);break;case 2:c=a>=2?Math.round(100*(a-1)):Math.round(-100/(a-1)),c=c>0?"+"+c:c;break;case 0:default:c=parseFloat(a).toFixed(2)}return c}}).filter("removeDecimalPoints",["$filter",function(a){return function(b){return b?a("numberTruncate")(b).replace(".00",""):b}}]).filter("numberTruncate",["$filter",function(a){return function(a){if(a){_.isString(a)&&(a=a.replace(/,/g,""));var b=a.toString().match(/^-?\d+(?:\.\d{0,2})?/)[0];return b.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}return a}}]).filter("formatCustomDateTime",["$filter",function(a){return function(b,c){if(!b)return b;var d=moment(b).startOf("day").diff(moment().startOf("day"),"days"),e="";return c&&(e=":ss"),0==d?locale.sports.coupon.couponOdds.today+a("amDateFormat")(b,", HH:mm"+e):1==d?locale.sports.coupon.couponOdds.tomorrow+a("amDateFormat")(b,", HH:mm"+e):d>0&&d<7?a("amDateFormat")(b,"ddd, HH:mm"+e):d<0||d>=7?a("amDateFormat")(b,"DD/MM/YY, HH:mm"+e):void 0}}]).filter("formatCustomDate",["$filter",function(a){return function(b,c){if(b){var d=moment(b).startOf("day").diff(moment().startOf("day"),"days"),e="";return c&&(e=" yy"),0==d?locale.sports.coupon.couponOdds.today:1==d?locale.sports.coupon.couponOdds.tomorrow:a("amDateFormat")(b,"ddd, DD MMM"+e)}return b}}]).filter("filterSearch",["$filter",function(a){return function(b,c){return b&&c?b.filter(function(b){return a("formatCustomDateTime")(b.couponDate).toLowerCase().indexOf(c.toLowerCase())!==-1||b.couponCode.toLowerCase().indexOf(c.toLowerCase())!==-1||b.totalStake.toLowerCase().indexOf(c.toLowerCase())!==-1}):b}}]).filter("highlight",["helperService",function(a){return function(b,c){if(!c)return b;const d=a.escapeRegExp(c),e=new RegExp(d,"gi");return b.replace("&amp;","&").replace(e,function(a){return'<span class="highlighted">'+a+"</span>"})}}]).filter("filterOverviewTournamentSearch",function(){return function(a,b,c){return a&&b&&"all"!=b?"favourites"==b&&c.length>0?a.filter(function(a){return c.indexOf(a.SportId+"|"+a.Id)!=-1}):a.filter(function(a){return a.TournamentId==b}):a}}).filter("filterLiveDiarySportSearch",function(){return function(a,b,c){return a&&b&&"all"!=b?"favourites"==b&&c.length>0?a.filter(function(a){return c.indexOf(a.SportId+"|"+a.MatchIdMapping)!=-1}):a.filter(function(a){return a.SportId==b}):a}}).filter("filterOverviewEventSearch",function(){return function(a,b){return a&&b?a.filter(function(a){return a.TournamentName.toLowerCase().indexOf(b.toLowerCase())!==-1||a.Teams[0].Name.toLowerCase().indexOf(b.toLowerCase())!==-1||a.Teams[1].Name.toLowerCase().indexOf(b.toLowerCase())!==-1}):a}}).filter("filterLiveDiaryEventSearch",["$filter",function(a){return function(b,c){return b&&c?b.filter(function(b){return b.CategoryName.toLowerCase().indexOf(c.toLowerCase())!==-1||b.TournamentName.toLowerCase().indexOf(c.toLowerCase())!==-1||b.MatchName.toLowerCase().indexOf(c.toLowerCase())!==-1||a("amDateFormat")(b.MatchDate,"HH:mm | ddd, DD MMM").toLowerCase().indexOf(c.toLowerCase())!==-1}):b}}])}(),function(){angular.module("app",["ui.router","angularMoment","ngStorage","rzModule","ui-bootstrap-custom","vs-repeat","monospaced.qrcode","ngCookies","angularValidator","angularBootstrapNavTree","ngSanitize","ui.select","ngMessages","ngAnimate","ngDialog","ng-currency","tmh.dynamicLocale","validation.match","oc.lazyLoad","siyfion.sfTypeahead","720kb.datepicker","chartistAngularDirective","app.service","app.directive","app.filter","umbracoApi","sportsApi","platformApi","guardianApi","f2pGuardianApi","frontendApi","thirdPartyApi","logging","frontendApi","logging","state.service","stateConfig.service","dataUpdate.service","liveChat.service","deviceFingerprint.service","lotteryApi","geoAccessControl","websiteApi","auth","auth.service","currency.service","language.helper","sports","live","coupon","casinoGames","liveCasinoGames","terms","partners","account","shop","poker","reports.service","virtuals","betSearchHelpers.service"]).config(["$locationProvider",function(a){document.querySelector("base")&&a.html5Mode(!0)}]).config(["$httpProvider","$compileProvider",function(a,b){a.interceptors.push("httpInterceptor"),a.useApplyAsync(!0);var c=null!=globalSettings.DebugMode&&globalSettings.DebugMode;b.debugInfoEnabled(c)}]).config(["$localStorageProvider",function(a){a.setKeyPrefix("");var b=function(a){try{return angular.toJson(a)}catch(a){console.log("LSP - Did not serialize key")}},c=function(a){try{return angular.fromJson(a)}catch(a){console.log("LSP - Did not deserialize key")}};a.setSerializer(b),a.setDeserializer(c)}]).config(["$sessionStorageProvider",function(a){a.setKeyPrefix("");var b=function(a){try{return angular.toJson(a)}catch(a){console.log("SSP - Did not serialize key")}},c=function(a){try{return angular.fromJson(a)}catch(a){console.log("SSP - Did not deserialize key")}};a.setSerializer(b),a.setDeserializer(c)}]).config(["tmhDynamicLocaleProvider",function(a){a.localeLocationPattern(globalSettings.SiteContentURL+"/dist/libs/angular-i18n/angular-locale_{{locale}}.js")}]).config(["$urlMatcherFactoryProvider",function(a){a.caseInsensitive(!0)}]).config(["$anchorScrollProvider",function(a){a.disableAutoScrolling()}]).config(["$sceDelegateProvider",function(a){if(0!=globalSettings.SiteContentURL.length){var b=globalSettings.SiteContentURL;b.endsWith("/")||(b+="/"),a.resourceUrlWhitelist(["self",b+"**"])}}]).run(["$rootScope","$sessionStorage","amMoment","ngDialog","tmhDynamicLocale","stateService","sportsApiService","helperService","cashoutService","$timeout","geoAccessControlService",function(a,b,c,d,e,f,g,h,i,j,k){k.runChecks(),document.querySelector("base")&&(f.registerStates(),f.setupTransitions()),b.SportsbookGlobalVariable||h.getGlobalVariables(),b.SportsbookMarketTypeIds&&0!=b.SportsbookMarketTypeIds.length||h.getMarketTypeIds(),g.settings.getBonusList().then(function(a){return a.success?void(b.SportsbookBonusList=a.data):void console.error("Unable to retrieve bonus list")}),g.settings.getIncompatibleMarketExceptions().then(function(a){return a.success?void(b.SportsbookMarketsExceptionList=a.data):void console.error("Unable to retrieve incompatible market exceptions")}),a.loaderTimeout=null,a.showLoader=function(b,c,d){a.hideLoader(b);var e=1e3;null!=d&&d>=0&&(e=d);var f=j(function(){null==b?b=angular.element("[ui-view]")||$("body"):"string"==typeof b&&(b=$(b));var a=$('<div class="loading '+(c||"")+'"></div>');"static"==b.css("position")&&b.css("position","relative"),b.append(a)},e);e>0&&(a.loaderTimeout=f)},a.hideLoader=function(b){null!=a.loaderTimeout&&(j.cancel(a.loaderTimeout),a.loaderTimeout=null),null==b?b=angular.element("[ui-view]")||$("body"):"string"==typeof b&&(b=$(b)),b.css("position","initial"),b.find("> .loading").remove()},c.changeLocale(globalSettings.CurrentLanguage),ngDialog=d,e.set(globalSettings.CurrentLocale),globalSettings.Sports_EnableCashOut&&i.init()}]).decorator("ngCloakDirective",["$delegate",function(a){return a.length>1?[a[1]]:a}]).factory("infoModalService",["umbracoApiService",function(a){var b={accBonus:void 0};return{infoModalContent:b,getAccBonusInfoModalContent:function(){this.infoModalContent.accBonus||a.desktop.getSportsAccBonusInfoModalContent().then(function(a){a.success&&(b.accBonus=a.data)})}}}]).controller("MainController",["$rootScope","$scope","$timeout","$interval","$interpolate","$cookies","$location","$window","$state","$http","$q","umbracoApiService","helperService","authService","loggingService","oddFormatsService","liveChatService","thirdPartyApiService","platformApiService","$localStorage","infoModalService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=this;b.isPokerShares=g.absUrl().indexOf("pokershares")>-1||h.location.href.indexOf("pokershares")>-1,this.detectUserCountry=function(){var a=k.defer();return r.ipify.getFormattedIp("json").then(function(b){if(!(b&&b.success&&b.data&&b.data.ip))return o.logError("Redirect check failed [1]"),void a.resolve();var c=b.data.ip,d=c.split("."),e=parseInt(d[0]).toString(16)+parseInt(d[1]).toString(16)+parseInt(d[2]).toString(16)+parseInt(d[3]).toString(16),f="0x"+e;s.location.getCountryByipAddress(f).then(function(b){b&&b.success&&b.data&&b.data.ThreeLetterCode?a.resolve(b.data.ThreeLetterCode):(o.logError("Redirect check failed [2]"),a.resolve())})}),a.promise},this.geolocationRedirect=function(){v.detectUserCountry().then(function(a){if(a){var b=globalSettings.General_GeolocationRedirect[a];b&&b.trim().length>0&&(h.location.href=b+h.location.pathname+h.location.search)}})},Object.keys(globalSettings.General_GeolocationRedirect).length>0&&v.geolocationRedirect(),this.visibleToThisUser=function(a,b){return!(a&&!n.isAgent())&&(!b||!n.isAgent())},this.popupInANewTab=function(a,b){h.open(a,"_blank")},this.openLiveChat=function(){q.openChat()},this.closeLiveChat=function(){q.closeChat()},this.showLiveChatError=function(){m.showStickyMessage("error",locale.common.liveChatUnavailable,5e3)},o.setup(function(a){a.logLevel.value>=o.logLevels.error.value?m.showMessage("error",a.userMessage,"exclamation-triangle").done():m.showMessage("success",a.userMessage,"check-circle-o").done()}),this.showQuickCashier=!1,this.supportedLanguages=supportedLanguages,this.language=this.supportedLanguages[globalSettings.CurrentLanguage].code,this.supportedLanguagesLength=0;for(var w in this.supportedLanguages)v.supportedLanguages.hasOwnProperty(w)&&v.supportedLanguagesLength++;if(b.$watch("mainCtrl.language",function(a,b){a!==b&&v.onLanguageChanged()}),this.onLanguageChanged=function(){f.put("SiteLang",v.language,{path:"/",expires:moment().add("7","day").toDate()}),location.reload()},this.interpolateTranslations=function(a){if(null!=a){for(var b in a)a.hasOwnProperty(b)&&("object"==typeof a[b]?a[b]=v.interpolateTranslations(a[b]):a[b]=e(a[b])(localeSettings));return a}},this.isMenuActive=function(a){return g.absUrl().indexOf(a)>-1},this.isSubMenuActive=function(a){a=a.replace(/\/$/,"");var b=a.split("/").filter(Boolean);return 1==b.length?g.absUrl().endsWith(a):g.absUrl().indexOf(a)>-1},this.navigateToUrl=function(a){if(a&&0!=a.trim().length){a=a.trim().replace("#","").replace(/\/$/gi,""),a.startsWith("/")||(a="/"+a);for(var b=i.get(),c=0;c<b.length;c++){var d=b[c],e=d.$$state(),f=e.url.exec(a);if(f)return void i.go(d.name,f)}j.head(a).then(function(b){m.goToUmbracoPage(a)}).catch(function(){g.path("/")})}},this.goToUmbracoPage=function(a,b,c){m.goToUmbracoPage(a,b,c)},window.location.search.length){var x=m.getQueryStringParameter("ic"),y=m.getQueryStringParameter("btag");if(x&&x.toString().length&&f.get("KM_AFF_TRK"))f.remove("KM_AFF_TRK",{path:"/"});else if(y&&y.toString().length&&!x){if(globalSettings.CookieFirstClick&&!f.get("KM_AFF_TRK")){var z=moment().add(globalSettings.General_AffiliateCookieExpiry,"day").toDate();document.cookie="KM_AFF_TRK="+y+"; expires="+z.toUTCString()+"; path=/; SameSite=None; Secure"}if(globalSettings.CookieLastClick){f.get("KM_AFF_TRK")&&f.remove("KM_AFF_TRK");var z=moment().add(globalSettings.General_AffiliateCookieExpiry,"day").toDate();document.cookie="KM_AFF_TRK="+y+"; expires="+z.toUTCString()+"; path=/; SameSite=None; Secure"}}}this.oddFormats=p.oddFormats,this.oddFormat=p.getOddFormat(),this.ofPopupDisplayed=!1,this.toggleOddFormatsPopup=function(a){if(v.ofPopupDisplayed)$(".oddFormatsPopup").hide(),v.ofPopupDisplayed=!1;else{v.helpVisible=!1;var b=a?$(a.target):null;b&&$(".oddFormatsPopup").css({position:"absolute",top:b.offset().top+b.outerHeight()+2,left:b.width()/2-5}).show(),v.ofPopupDisplayed=!0}},this.onOddFormatChanged=function(a){p.setOddFormat(a),v.oddFormat=a,v.toggleOddFormatsPopup()},this.helpVisible=!1,this.toggleHelpContent=function(){v.ofPopupDisplayed=!1,v.helpVisible=!v.helpVisible},this.siteLayout=globalSettings.General_FullWidthLayout?"full-width":"fixed-width",this.layouts=[{name:"Full Width",value:"full-width"},{name:"Fixed Width",value:"fixed-width"}],this.setLayout=function(a){v.siteLayout=a.value,globalSettings.General_FullWidthLayout=a.value,"full-width"===a.value?$(".stickied-table").removeClass("fixed-width").addClass("full-width"):"fixed-width"===a.value&&$(".stickied-table").removeClass("full-width").addClass("fixed-width")},this.setCustomScrollbars=function(){c(v.enableScrollbars?function(){$("#leftContainer, .mainContent").mCustomScrollbar(v.contentScrollbarsConfig),$("#rightContainer").mCustomScrollbar(v.contentScrollbarsConfig),v.setStickyCouponLayout(v.stickyCouponOptions[1]),$(".mainContent footer.footer-container").empty().html($("#divMainContainer > div > footer.footer-container > div").clone()),$("#divMainContainer > div > footer.footer-container").css("display","none"),$(".mainContent footer.footer-container").css("display","flex")}:function(){$("#leftContainer, .mainContent").mCustomScrollbar(v.contentScrollbarsConfig)&&($("#leftContainer, .mainContent").mCustomScrollbar("stop"),$(".mainContent footer.footer-container, .live #leftContainer footer.footer-container").css("display","none"),$("#divMainContainer > div > footer.footer-container").css("display","flex")),$("#rightContainer").length>0&&$("#rightContainer").mCustomScrollbar("destroy"),v.enableStickyCoupon&&$(".scrollCouponContent").mCustomScrollbar(v.couponScrollbarConfig)})},this.contentScrollbarsConfig={theme:"minimal",scrollbarPosition:"inside",advanced:{updateOnContentResize:!0},scrollInertia:500,snapAmount:1},this.enableScrollbars=globalSettings.General_ContentScrollBars,this.setCustomScrollbars(),this.scrollLayout=[{name:"Enable",value:!0},{name:"Disable",value:!1}],this.setScrollLayout=function(a){v.enableScrollbars=a.value,globalSettings.General_ContentScrollBars=a.value,v.setCustomScrollbars()},this.setStickyCoupon=function(a){v.enableStickyCoupon?(a&&(t.enableStickyCoupon=!0),c(function(){v.enableScrollbars?($(".scrollCouponContent").length>0&&$(".scrollCouponContent").mCustomScrollbar("destroy"),$("#rightContainer").mCustomScrollbar(v.contentScrollbarsConfig)):($(".scrollCouponContent").mCustomScrollbar(v.couponScrollbarConfig),$("#rightContainer").length>0&&$("#rightContainer").mCustomScrollbar("destroy"))})):(a&&(t.enableStickyCoupon=!1),c(function(){$("#rightContainer").mCustomScrollbar(v.contentScrollbarsConfig),$(".scrollCouponContent").length>0&&$(".scrollCouponContent").mCustomScrollbar("destroy")}))},a.$on("stickyCouponOnFirstBetPlaced",function(){v.enableStickyCoupon&&$(".scrollCouponContent").length>0&&$(".scrollCouponContent").mCustomScrollbar(v.couponScrollbarConfig)}),this.couponScrollbarConfig={theme:"minimal",scrollbarPosition:"inside",advanced:{updateOnContentResize:!0},scrollInertia:0,setHeight:!1},this.enableStickyCoupon=void 0===t.enableStickyCoupon?globalSettings.Sports_EnableStickyCoupon:t.enableStickyCoupon,this.stickyCouponOptions=[{name:"Enable",value:!0},{name:"Disable",value:!1}],this.setStickyCouponLayout=function(a,b){v.enableStickyCoupon=a.value,globalSettings.Sports_EnableStickyCoupon=a.value,v.setStickyCoupon(b)},$(window).on("load",function(){v.setStickyCouponLayout({value:v.enableStickyCoupon})}),this.liveMatchTrackerMode=!!t.liveMatchTrackerMode,this.liveMatchTrackerModes=[{name:"Normal",value:!0},{name:"Data Saver",value:!1}],this.setLiveMatchTrackerModes=function(a){v.liveMatchTrackerMode=a.value,t.liveMatchTrackerMode=a.value},this.siteTheme=f.get("siteTheme")||"default",this.cssURL="",this.themes=supportedThemes,this.setTheme=function(a){v.siteTheme=a.value},this.changeCssURL=function(a){var b=angular.element("head").find('link[href*="site."]');c(function(){b.attr("href",a)})},this.setThemeToCookies=function(){var a=globalSettings.SiteContentURL+"/dist/css/",b="?v="+globalSettings.SiteVersion,c="9999-12-31T23:59:59.223Z";f.put("siteTheme",v.siteTheme,{expires:c,path:"/"}),"default"===f.get("siteTheme")?v.cssURL=a+"site.css"+b:v.cssURL=a+"site."+f.get("siteTheme")+".css"+b,this.changeCssURL(this.cssURL),this.setLogoURL()},this.logoURL=globalSettings.SiteContentURL+"/images/Brand-logo/brand-logo.svg",this.setLogoURL=function(){if(globalSettings.General_SwitchableThemes){var a=globalSettings.SiteContentURL+"/images/Brand-logo/",b=f.get("siteTheme");null==b||0==b.trim().length||"default"==b?v.logoURL=a+"brand-logo.svg":v.logoURL=a+globalSettings.BrandName+"-logo-"+b+".svg"}},this.setLogoURL(),this.currentTime=null,d(function(){v.currentTime=moment().tz(moment.tz.guess(moment())).format("HH:mm z")},1e3),a.globalSettings=globalSettings,"undefined"!=typeof localeOverride&&_.merge(locale,localeOverride),a.locale=this.interpolateTranslations(locale),a.topLevelCtrlScope=b,b.panelSlideToggle=function(a){var b=$(a.currentTarget);b.parent().parent().next().stop(),b.parent().parent().next().slideToggle(),b.toggleClass("rotateIcon")},globalSettings.DebugMode&&(showSuccessMessage=function(){m.showSuccessMessage("Coupon submitted successfully. This is some extra text placed here to test how multiline popups are styled!").done()},showSuccessMessageWithButtons=function(){m.showSuccessMessage("Coupon submitted successfully.",null,!0,"Close",!0,"Ok").done()},showInfoMessage=function(){m.showInfoMessage("Ticket sent for evaluation")},showInfoMessageWithButtons=function(){m.showInfoMessage("Ticket sent for evaluation",null,!0,"Close",!0,"Ok").done()},showWarningMessage=function(){m.showWarningMessage("This is a warning message").done()},showWarningMessageWithButtons=function(){m.showWarningMessage("This is a warning message",null,!0,"Close",!0,"Ok").done()},showErrorMessage=function(){m.showErrorMessage("The match you are trying to place a bet on has already ended").done()},showErrorMessage=function(){m.showErrorMessage("The match you are trying to place a bet on has already ended",null,!0,"Close",!0,"Ok").done()},showConfirmationMessage=function(){var a='<div class="couponConfirmation"><div class="contentMessage"><div class="messageContent"><span class="message text-left">'+locale.common.couponCopyDetials+"</span></div></div></div>";m.showMessageWithHtml(a,!0,locale.common.no,!0,locale.common.yes).done()},showTitleMessage=function(){m.showMessageWithTitle("My Title!","My text content goes here...").done()},showInputMessage=function(){m.showMessageWithInput("Reason for evaluation?","text","Reason...",null,!0,"Cancel",!0,"Proceed").done()},showStickyMessageError=function(){m.showStickyMessage("error","Error Message",!1).done()},showStickyMessageSuccess=function(){m.showStickyMessage("success","Success Message",!1).done()},showStickyMessageInfo=function(){m.showStickyMessage("info","Info Message",!1).done()}),this.getMaintenanceData=function(){var a=window.location.pathname;l.desktop.getMaintenanceData(a,globalSettings.CurrentLanguage).then(function(a){if(a.success){if(!a.data||"null"==a.data.MessageContent)return;var b=JSON.parse(a.data.MessageContent);b&&b.length&&angular.forEach(b,function(a){if(a.startDate=moment(a.startDate),a.endDate=moment(a.endDate),moment().isBetween(a.startDate,a.endDate)){var b="yellow";switch(a.messageType){case"1":b="blue";break;case"2":b="red"}$.sticky(a.message,{speed:"fast",position:"bottom-left",duplicates:!1,autoclose:!1,color:b})}})}})},v.getMaintenanceData(),this.currentInfoModalContent=!1,u.getAccBonusInfoModalContent(),this.openInfoModal=function(a){this.currentInfoModalContent=u.infoModalContent[a]},this.closeInfoModal=function(){this.currentInfoModalContent=void 0},b.$on("openInfoModal",function(a){v.openInfoModal(a)}),b.$on("closeInfoModal",function(){v.closeInfoModal()})}])}(),function(){angular.module("app.service",[]).factory("SportsbookCouponBuilder",["$rootScope",function(a){var b=isNaN(globalSettings.BrandID)?null:parseInt(globalSettings.BrandID);return new Sportsbook.CouponBuilder(globalSettings.SportsBookApiURL,b,!1)}]).service("httpInterceptor",["$rootScope","$q","authService","$injector",function(a,b,c,d){return{request:function(a){if(new RegExp(".html$","i").test(a.url))return new RegExp("/partials/").test(a.url)&&(a.url=a.url+"?v="+globalSettings.SiteVersion),a;if(new RegExp(".svg$","i").test(a.url))return a.headers["Content-Type"]="image/svg+xml",a;if(new RegExp("^/?(dist|images)/.+..+$","i").test(a.url))return globalSettings.SiteContentURL.length>0&&console.log("Non CDNified URL: "+a.url),a;var b=null,d=!1;return"sports"!=a.apiType&&"gaming"!=a.apiType&&"website"!=a.apiType||(b=c.getAccessToken()),b&&!a.noAuthToken&&(a.headers.Authorization="Bearer "+b,d=!0),globalSettings.ActivitySource&&(a.sendActivitySource||d)&&(a.headers.ActivitySource=globalSettings.ActivitySource),a.headers["Content-Type"]=a.urlEncoded?"application/x-www-form-urlencoded":"application/json",a.inBehalfOf&&(a.headers.InBehalfOf=a.inBehalfOf),"gaming"!=a.apiType&&"website"!=a.apiType||(a.headers["Cache-Control"]="no-cache",a.headers["X-API-LANGUAGE"]=globalSettings.CurrentLocale,a.apiVersion&&(a.headers["X-API-VERSION"]=a.apiVersion)),"gaming"!=a.apiType&&"guardian"!=a.apiType&&"website"!=a.apiType||!globalSettings.BrandID?"f2pGuardian"==a.apiType&&globalSettings.F2PBrandID&&(a.headers["X-BRAND-ID"]=globalSettings.F2PBrandID):a.headers["X-BRAND-ID"]=globalSettings.BrandID,a},response:function(a){var c=d.get("loggingService");return c.httpLog("["+a.config.method+"] operation at "+a.config.url+" returned with HTTP Status "+a.status,c.logLevels.debug,a),b.when(a)},responseError:function(e){if("frontend"==e.config.apiType&&e.config.loggingCall)return b.reject(e);var f=d.get("loggingService");return f.httpLog("["+e.config.method+"] operation at "+e.config.url+" returned with HTTP Status "+e.status,f.logLevels.error,e),401==e.status&&("sports"!=e.config.apiType&&"gaming"!=e.config.apiType&&"website"!=e.config.apiType||c.clearUserData(),a.hideLoader()),null!=e.data&&null!=e.data.Message&&(e.data.SystemMessage=e.data.Message),b.reject(e)}}}]).service("oddFormatsService",["$rootScope","$localStorage",function(a,b){return{oddFormats:[{value:0,name:locale.common.oddFormats.decimal},{value:1,name:locale.common.oddFormats.fractional},{value:2,name:locale.common.oddFormats.american}],getOddFormat:function(){return null!=b.oddFormat&&null!=this.getByValue(b.oddFormat)?this.getByValue(b.oddFormat):(this.setOddFormat(this.oddFormats[0]),this.oddFormats[0])},setOddFormat:function(a){b.oddFormat=a.value},getByValue:function(a){return _.find(this.oddFormats,function(b){return b.value==a})}}}]).factory("realityCheckService",["$rootScope","$localStorage","$interval","platformApiService","$injector",function(a,b,c,d,e){function f(){return b.userData&&(b.userData.ellapsedRealityCheckTime||0===b.userData.ellapsedRealityCheckTime)||g(0),b.userData.ellapsedRealityCheckTime}function g(a){var c=b.userData;c&&(c.ellapsedRealityCheckTime=a,b.userData=c)}function h(a){if(null===k){var b=f(),d=Math.floor(b/a)+1,e=a*d;k=c(function(){var b=f()+1;b>=e&&(j(e),e+=a),g(b)},6e4)}}function i(){null!==k&&(c.cancel(k),k=null)}function j(b){var c='<div class="couponConfirmation"><div class="contentMessage"><div class="messageContent"><i class="fa fa-info-circle"></i><span class="message text-left">'+locale.common.realityCheck.partOne+b+locale.common.realityCheck.partTwo+"</span></div></div></div>",d=e.get("helperService");d.showMessageWithHtml(c,!0,locale.common.close,!0,locale.common.ok).then(function(){a.$broadcast("logoutRequest")}).done()}var k=null;return{start:function(){globalSettings.EnableRealityCheck&&d.user.getRealityCheckAmount().then(function(a){a.success&&a.data&&a.data!=-1&&h(a.data)})},stop:function(){globalSettings.EnableRealityCheck&&i()}}}]).factory("helperService",["$location","$state","$window","$localStorage","$sessionStorage","$q","$injector",function(a,b,c,d,e,f,g){function h(a){var b=a?window.parent.dataLayer:window.dataLayer;return b||(a?(window.parent.dataLayer=[],b=window.parent.dataLayer):(window.dataLayer=[],b=window.dataLayer)),b}return{showMessageWithHtml:function(a,b,c,d,e,f,g,h){return swal({html:a,showCloseButton:!0,width:h||500,showCancelButton:b,showConfirmButton:d,cancelButtonText:c,confirmButtonText:e,cancelButtonClass:"btn-cancel",confirmButtonClass:"btn-confirm",allowEscapeKey:!0,allowOutsideClick:!0,buttonsStyling:!1,padding:null,customClass:g||null,onClose:f})},showMessageWithTitle:function(a,b,c,d,e,f,g,h){return swal({title:a,text:b,showCloseButton:!0,showCancelButton:c,showConfirmButton:e,cancelButtonText:d,confirmButtonText:f,cancelButtonClass:"btn-cancel",confirmButtonClass:"btn-confirm",allowEscapeKey:!0,allowOutsideClick:!0,buttonsStyling:!1,padding:null,customClass:h||null,onClose:g})},showMessageWithInput:function(a,b,c,d,e,f,g,h,i,j){var k=["with-input"];return j&&k.push(j),swal({title:a,input:b,inputPlaceholder:c,inputValidator:d,showCloseButton:!0,showCancelButton:e,showConfirmButton:g,cancelButtonText:f,confirmButtonText:h,cancelButtonClass:"btn-cancel",confirmButtonClass:"btn-confirm",allowEscapeKey:!0,allowOutsideClick:!0,buttonsStyling:!1,padding:null,customClass:k.join(" "),onClose:i})},showMessage:function(a,b,c,d,e,f,g,h,i){var j='<div class="message-box '+a+'"><div class="icon"><i class="fa fa-'+c+'"></i></div><div class="contentMessage">'+b+"</div></div>";return this.showMessageWithHtml(j,d,e,f,g,h,i)},showMessageWithLoader:function(a,b,c,d,e,f,g,h,i,j){var k='<div class="message-box '+a+'"><div class="icon"><i class="fa fa-'+c+'"></i></div><div class="contentMessage">'+b+'</div></div> <div class="spinner">  <div class="loading" style="left:0"></div >  </div> ';return this.showMessageWithHtml(k,d,e,f,g,h,i)},showSuccessMessage:function(a,b,c,d,e,f,g,h){return null==b?this.showMessage("success",a,"check",c,d,e,f,g,h):b("success",a,c,d,e,f,g,h)},showInfoMessage:function(a,b,c,d,e,f,g,h){return null==b?this.showMessage("info",a,"info-circle",c,d,e,f,g,h):b("info",a,c,d,e,f,g,h)},showWarningMessage:function(a,b,c,d,e,f,g,h){return null==b?this.showMessage("warning",a,"exclamation-triangle",c,d,e,f,g,h):b("warning",a,c,d,e,f,g,h)},showErrorMessage:function(a,b,c,d,e,f,g,h){return null==b?this.showMessage("error",a,"exclamation-triangle",c,d,e,f,g,h):b("error",a,c,d,e,f,g,h)},showStickyMessage:function(a,b,c){switch(a){case"success":color="green";break;case"error":color="red";break;default:color="blue"}null==c&&(c=5e3),$.sticky(b,{speed:"fast",duplicates:!1,autoclose:c,color:color})},getQueryStringParameter:function(a,b){b||(b=window.location.href),a=a.replace(/[\[\]]/g,"\\$&");var c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null},getUrlParameters:function(a){for(var b,c=/[?&]([^=#]+)=([^&#]*)/g,d={};b=c.exec(a);)d[b[1]]=b[2];return d},getActivationLink:function(a,b){var c=window.location.origin+"/activate?";return c+=a?"resend=true&userid="+("undefined"==typeof b||null==b?"{userid}":b):"userid={userid}&checkcode={checkcode}"},goToUmbracoPage:function(a,d,e){var f="";if(d){null==e&&(e={});var g=b.href(d,e,{absolute:!0});if(!g)return;var h=document.querySelector("base").href;f=g.replace(h,"")}var i="";i=f.trim().length>0?[a,f].join("/"):a,i.startsWith("/")||(i="/"+i),c.location.href=i},getGlobalVariables:function(){var a=f.defer(),b=g.get("sportsApiService");return b.settings.getGlobalVariables().then(function(b){if(!b.success)return console.error("Unable to retrieve global variables"),void a.resolve();e.SportsbookGlobalVariable=b.data;var c=d["couponJSON_v1.6"];null!=c&&null!=c.BetCouponGlobalVariable&&(c.BetCouponGlobalVariable=b.data),a.resolve()}),a.promise},getMarketTypeIds:function(){var a=f.defer(),b=g.get("sportsApiService");return b.settings.getMarketTypeIds().then(function(b){return b.success?(e.SportsbookMarketTypeIds=b.data,void a.resolve()):(console.error("Unable to retrieve MarketTypeIds"),void a.resolve())}),a.promise},generateUniqueId:function(){return Math.random().toString(36).substr(2,9)},setValueToDataLayer:function(a,b,c){var d={};d[a]=b,h(c).push(d)},createOptimoveEvent:function(a,b,c,d){if(globalSettings.Tracking_EnableDataLayer){var e={event:a};e[b]=c,h(d).push(e)}},createDataLayerEvent:function(a,b){globalSettings.Tracking_EnableDataLayer&&h(b).push(a)},dataLayerSiteUX:function(){const a=new RegExp("(.azurewebsites.net)|(local.betking)");return a.exec(window.location.hostname)?"DEV":"D"},toMD5Hash:function(a){function b(a){for(var b,c="0123456789ABCDEF",d="",e=0;e<a.length;e++)b=a.charCodeAt(e),d+=c.charAt(b>>>4&15)+c.charAt(15&b);return d}function c(a){for(var b=Array(a.length>>2),c=0;c<b.length;c++)b[c]=0;for(c=0;c<8*a.length;c+=8)b[c>>5]|=(255&a.charCodeAt(c/8))<<c%32;return b}function d(a){for(var b="",c=0;c<32*a.length;c+=8)b+=String.fromCharCode(a[c>>5]>>>c%32&255);return b}function e(a,b){a[b>>5]|=128<<b%32,
a[14+(b+64>>>9<<4)]=b;for(var c=1732584193,d=-271733879,e=-1732584194,f=271733878,l=0;l<a.length;l+=16){var m=c,n=d,o=e,p=f;d=j(d=j(d=j(d=j(d=i(d=i(d=i(d=i(d=h(d=h(d=h(d=h(d=g(d=g(d=g(d=g(d,e=g(e,f=g(f,c=g(c,d,e,f,a[l+0],7,-680876936),d,e,a[l+1],12,-389564586),c,d,a[l+2],17,606105819),f,c,a[l+3],22,-1044525330),e=g(e,f=g(f,c=g(c,d,e,f,a[l+4],7,-176418897),d,e,a[l+5],12,1200080426),c,d,a[l+6],17,-1473231341),f,c,a[l+7],22,-45705983),e=g(e,f=g(f,c=g(c,d,e,f,a[l+8],7,1770035416),d,e,a[l+9],12,-1958414417),c,d,a[l+10],17,-42063),f,c,a[l+11],22,-1990404162),e=g(e,f=g(f,c=g(c,d,e,f,a[l+12],7,1804603682),d,e,a[l+13],12,-40341101),c,d,a[l+14],17,-1502002290),f,c,a[l+15],22,1236535329),e=h(e,f=h(f,c=h(c,d,e,f,a[l+1],5,-165796510),d,e,a[l+6],9,-1069501632),c,d,a[l+11],14,643717713),f,c,a[l+0],20,-373897302),e=h(e,f=h(f,c=h(c,d,e,f,a[l+5],5,-701558691),d,e,a[l+10],9,38016083),c,d,a[l+15],14,-660478335),f,c,a[l+4],20,-405537848),e=h(e,f=h(f,c=h(c,d,e,f,a[l+9],5,568446438),d,e,a[l+14],9,-1019803690),c,d,a[l+3],14,-187363961),f,c,a[l+8],20,1163531501),e=h(e,f=h(f,c=h(c,d,e,f,a[l+13],5,-1444681467),d,e,a[l+2],9,-51403784),c,d,a[l+7],14,1735328473),f,c,a[l+12],20,-1926607734),e=i(e,f=i(f,c=i(c,d,e,f,a[l+5],4,-378558),d,e,a[l+8],11,-2022574463),c,d,a[l+11],16,1839030562),f,c,a[l+14],23,-35309556),e=i(e,f=i(f,c=i(c,d,e,f,a[l+1],4,-1530992060),d,e,a[l+4],11,1272893353),c,d,a[l+7],16,-155497632),f,c,a[l+10],23,-1094730640),e=i(e,f=i(f,c=i(c,d,e,f,a[l+13],4,681279174),d,e,a[l+0],11,-358537222),c,d,a[l+3],16,-722521979),f,c,a[l+6],23,76029189),e=i(e,f=i(f,c=i(c,d,e,f,a[l+9],4,-640364487),d,e,a[l+12],11,-421815835),c,d,a[l+15],16,530742520),f,c,a[l+2],23,-995338651),e=j(e,f=j(f,c=j(c,d,e,f,a[l+0],6,-198630844),d,e,a[l+7],10,1126891415),c,d,a[l+14],15,-1416354905),f,c,a[l+5],21,-57434055),e=j(e,f=j(f,c=j(c,d,e,f,a[l+12],6,1700485571),d,e,a[l+3],10,-1894986606),c,d,a[l+10],15,-1051523),f,c,a[l+1],21,-2054922799),e=j(e,f=j(f,c=j(c,d,e,f,a[l+8],6,1873313359),d,e,a[l+15],10,-30611744),c,d,a[l+6],15,-1560198380),f,c,a[l+13],21,1309151649),e=j(e,f=j(f,c=j(c,d,e,f,a[l+4],6,-145523070),d,e,a[l+11],10,-1120210379),c,d,a[l+2],15,718787259),f,c,a[l+9],21,-343485551),c=k(c,m),d=k(d,n),e=k(e,o),f=k(f,p)}return Array(c,d,e,f)}function f(a,b,c,d,e,f){return k(l(k(k(b,a),k(d,f)),e),c)}function g(a,b,c,d,e,g,h){return f(b&c|~b&d,a,b,e,g,h)}function h(a,b,c,d,e,g,h){return f(b&d|c&~d,a,b,e,g,h)}function i(a,b,c,d,e,g,h){return f(b^c^d,a,b,e,g,h)}function j(a,b,c,d,e,g,h){return f(c^(b|~d),a,b,e,g,h)}function k(a,b){var c=(65535&a)+(65535&b);return(a>>16)+(b>>16)+(c>>16)<<16|65535&c}function l(a,b){return a<<b|a>>>32-b}var m=function(a){return result=b(d(e(c(a),8*a.length))),result.toLowerCase()},n=m(a);return n},handlePlatformError:function(a){if(!a)return!1;if(a.Result&&a.Result.length>0){for(var b="",c=0;c<a.Result.length;c++)b+=a.Result[c],c<a.Result.length-1&&(b+="<br/>");return this.showErrorMessage("<p>"+b+"</p>"),!0}return null!=a.SystemMessage?(this.showErrorMessage("<p>"+a.SystemMessage+"</p>"),!0):null!=a.userMsg&&(this.showErrorMessage("<p>"+a.userMsg+"</p>"),!0)},generateHashCode:function(a){for(var b=JSON.stringify(a,function(a,b){if("$$hashKey"!==a)return b}),c=0,d=0;d<b.length;d++){var e=b.charCodeAt(d);c=(c<<5)-c+e,c&=c}return c},pageVisibilityApi:function(){var a,b;return"undefined"!=typeof document.hidden?(b="hidden",a="visibilitychange"):"undefined"!=typeof document.msHidden?(b="msHidden",a="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(b="webkitHidden",a="webkitvisibilitychange"),{eventName:a,isPageHidden:document[b],hiddenVariableName:b}},escapeRegExp:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},cleanMobileNumber:function(a){return a&&"0"===a[0]?a.substr(1):a},parseUsername:function(a){var b={value:a,isValid:!1,isMobileNumber:!1,mobilePrefix:null,mobileNumber:null},c=globalSettings.Account_LoginType.toLowerCase(),d=new RegExp(/^\d+$/),e=new RegExp(globalSettings.Account_MobileRegex);if(a)if("usernameormobile"==c||"mobile"==c)if(d.test(a)){if(e.test(a)){var f=this.cleanMobileNumber(a);b.value=f,b.isValid=!0,b.isMobileNumber=!0,b.mobilePrefix=globalSettings.Account_LoginPrefix,b.mobileNumber=f}else if(a.startsWith(globalSettings.Account_LoginPrefix)){var g=a.replace(globalSettings.Account_LoginPrefix,"");if(e.test(g)){var f=this.cleanMobileNumber(g);b.isValid=!0,b.isMobileNumber=!0,b.value=f,b.mobilePrefix=globalSettings.Account_LoginPrefix,b.mobileNumber=f}}}else"usernameormobile"===c&&(b.isValid=!0);else b.isValid=!0;return b}}}])}(),function(){angular.module("auth",[]).controller("AuthController",["$rootScope","$scope","$q","$sessionStorage","$state","$interval","bankProfileService","authService","helperService","platformApiService","realityCheckService","loggingService","guardianApiService","f2pGuardianApiService","$injector","$localStorage","$filter","deviceFingerprintService","$timeout","currencyService","websiteApiService","umbracoApiService","ngDialog",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){function x(){a.showLoader("#btnViewBalances","element-small local",0),A.getPlaySource("web").then(function(b){if(a.hideLoader("#btnViewBalances"),!b.success)return void l.logError("Unable to get user balances: "+b.error);z.userBalances=[];var c=b.data,d=0;angular.forEach(c,function(a){null!=a.Credit&&$.isNumeric(a.Credit)&&(d+=parseFloat(a.Credit)),a.Name=a.Name.replace(" Account",""),globalSettings.Header_ShowBalance&&a.IsMain&&z.userBalances.push({name:a.Name,balance:a.Balance});for(var b in locale.account.cashier.accounts){var c=a.Name[0].toLowerCase()+a.Name.slice(1);b===c&&(a.Name=locale.account.cashier.accounts[b])}}),d>0&&c.push({Id:"credit",Name:locale.account.balance.credit,Balance:d}),angular.copy(c,z.balances)}).catch(function(b){var c={hasLoadingError:!0};z.userBalances=[c],a.hideLoader("#btnViewBalances")})}function y(){const a={event:"user-data-init",siteLang:globalSettings.CurrentLanguage,siteUX:i.dataLayerSiteUX()};if(h.hasValidLogin())var c=b.$watch(function(){return z.userBalances.length},function(){z.userBalances.length>0&&(a.userID=h.getUserData().userID,a.userType=h.dataLayerUserType(),a.userBalance=z.userBalances[0].balance,h.getUserData().parentId&&(a.parentUserID=h.getUserData().parentId),i.createDataLayerEvent(a),c())});else i.createDataLayerEvent(a)}var z=this,A=j.finance,B=j.user,C=j.security;this.bkToken=b.ngDialogData&&b.ngDialogData.bkToken||null,this.f2pToken=b.ngDialogData&&b.ngDialogData.f2pToken||null,this.error=b.ngDialogData&&b.ngDialogData.error||null,this.cmsContentData=[],this.comingFromTitle="",this.comingFromSubTitle=null,this.loginUsername="",this.loginPassword="",this.userLoggedIn=h.hasValidLogin(),this.saveBankAccStatus=g.getSaveBankAccStatus(),this.userStatus=null,this.unverifiedAccount="UNCONF"!==z.userStatus&&h.hasValidLogin()&&h.hasVerifyAccountData()&&"VerifyInProgress"==h.getVerifyAccountData().type,this.verifyAccountStatus=h.hasVerifyAccountData()?h.getVerifyAccountData().type:"",this.loggedUserData=h.getUserData()||{},this.verifyAccountData=h.getVerifyAccountData(),this.currencySymbol=this.loggedUserData.currency?this.loggedUserData.currency.CurrencySymbol:"",this.isAgent=h.isAgent(),this.loginInProgress=!1,this.balances=[],this.balancesDisplayed=!1,this.unreadMessageCount="-",this.userBalances=[],this.doNotShowAgain=!1,this.popupShouldBeShown=!1,this.canRegisterSubAccountPlayers=h.getCanRegisterSubAccountPlayers(),this.inputHasValidLength=function(a){return!a.hasOwnProperty("required")&&!a.hasOwnProperty("minlength")&&!a.hasOwnProperty("maxlength")},this.userBalance=null,this.messageCountInterval=null,this.balanceRefreshInterval=null,this.f2pUserName=null,this.errorMessage=null,this.goToDepositPage=function(){globalSettings.ShopEnabled&&h.hasValidLogin()&&h.isAgent()?i.goToUmbracoPage("shop/sh/deposit"):i.goToUmbracoPage("account/ac/deposit")},this.getCMSContent=function(){v.desktop.getLoginContent(globalSettings.CurrentLanguage).then(function(a){a.success?(z.cmsContentData=a.data,z.f2pToken?(z.comingFromTitle=z.cmsContentData.loginTitleTextF2P,z.comingFromSubTitle=z.cmsContentData.loginSubTitleText):(z.comingFromTitle=z.cmsContentData.loginTitleText,z.comingFromSubTitle=null)):l.logError(a.error)})},this.getUserInfoWithToken=function(b,d,f){var g=z.getUserDetails(),j=z.getIsAgent(),l=z.getUserStatus(),m=z.getCanRegisterSubAccountPlayers(),n=i.getGlobalVariables(),p=z.getIsVirtualsEnabled(),q=z.getIsGoldenRaceEnabled();c.all([g,j,l,m,n,p,q]).then(function(){h.verifyAccountMobile(),h.setLastLoginID(h.getUserData().userID),h.loginInProgress(!1),a.$broadcast("loginCompleted",!0),z.getUnreadMessageCount(),k.start(),onLoginSuccess({$injector:o}),z.balances=[],z.calculateUserBalance();var c=h.getVerifyAccountData();if("UNCONF"!=h.getUserStatus()&&"Verified"!=c.type)$.fancybox({modal:!1,showCloseButton:!0,hideOnContentClick:!1,hideOnOverlayClick:!1,width:480,height:434,type:"iframe",padding:0,margin:0,fitToView:!1,iframe:{scrolling:"no"},autoSize:!1,href:"/unconfirmed-verification-iframe"});else{if(globalSettings.ShopEnabled&&h.isAgent()&&!e.current.name.startsWith("shop"))return void i.goToUmbracoPage("shop");d&&"PCHANG"!=h.getUserStatus()&&z.getLoginMessages()}if(b?window.location.href=b:window.location.href.indexOf("registration-successful")!=-1&&i.goToUmbracoPage("sports"),z.f2pToken)a.showLoader(".loginFormDetails",null,0),u.user.linkF2PAccount(z.f2pToken).then(function(b){if(a.hideLoader(".loginFormDetails"),!b.success)return z.logout(),void(b.data&&"F2P_Mismatch_MobileNo"===b.data.ErrorCode?z.errorMessage=z.cmsContentData.loginMismatchMobileNumberErrorText:b.data&&"F2P_Mobile_Already_Linked"===b.data.ErrorCode?z.errorMessage=z.cmsContentData.loginMobileAlreadyLinkedErrorText:b.data&&"F2P_Invalid_Token"===b.data.ErrorCode?z.errorMessage=z.cmsContentData.loginInvalidTokenErrorText:z.errorMessage=b.data.ErrorCode);var c=w.getOpenDialogs();w.close(c[0]),a.loginSuccessDialog=w.open({template:"/partials/login/loginDialogSuccess.html",className:"loginForm success",name:"LoginSuccessDialog",id:"LoginSuccessDialog",data:{cmsContent:z.cmsContentData},showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!0,appendTo:!1,preCloseCallback:!1})});else if(f){var g=w.getOpenDialogs();w.close(g[0])}})},this.login=function(b,c,d,e,f){if(null==f&&(f=!0),!h.hasValidLogin()&&!h.loginInProgress()){if(null==e&&(e=!0),!b||!c){if(!z.loginUsername||!z.loginPassword)return void i.showErrorMessage(locale.login.invalidCredentials);b=z.loginUsername,c=z.loginPassword}h.clearUserData();var g=i.parseUsername(b);b=g.isMobileNumber?g.mobilePrefix+g.mobileNumber:g.value,h.loginInProgress(!0),m.auth.getToken(b,c,globalSettings.BrandID).then(function(c){c.success?(h.setAccessToken(c.data),z.getUserInfoWithToken(d,e,f),z.loginUsername="",z.loginPassword=""):g.isMobileNumber?u.user.isExistingUsername(b).then(function(b){!b.success||b.data?z.errorMessage=locale.login.invalidCredentials:z.errorMessage=locale.login.mobileNotVerified,h.loginInProgress(!1),a.$broadcast("loginCompleted",!1),h.clearUserData(),l.logError("Unable to get API token for mobile number",z.f2pToken?null:z.errorMessage)}):("Invalid Credentials"===c.error.error_description?z.errorMessage=locale.login.invalidCredentials:"Exceeded maximum authentication failures"===c.error.error_description?z.errorMessage=locale.login.accountLocked:z.errorMessage=c.error.error_description,h.loginInProgress(!1),a.$broadcast("loginCompleted",!1),h.clearUserData(),l.logError("Unable to get API token: "+JSON.stringify(c.error),z.f2pToken?null:z.errorMessage))})}},this.loginWithToken=function(b,c,d){h.hasValidLogin()||h.loginInProgress()||(void 0===d&&(d=!0),h.clearUserData(),h.loginInProgress(!0),m.auth.validateToken(b).then(function(e){e.success&&e.data&&e.data.isValidated?(h.setAccessToken({access_token:b}),z.getUserInfoWithToken(c,d,!0)):(z.errorMessage="The token has expired!",h.loginInProgress(!1),a.$broadcast("loginCompleted",!1),h.clearUserData(),l.logError("Unable to get API token: "+JSON.stringify(e.error),z.errorMessage))}))},this.popupShouldShow=function(){var a=p.doNotShowAgain;return 0===globalSettings.Header_DepositTreshold?z.popupShouldBeShown=!1:!a&&z.userBalance<globalSettings.Header_DepositTreshold?z.popupShouldBeShown=!0:z.popupShouldBeShown=!1},this.formatBalance=function(a){if(z.userLoggedIn)return globalSettings.Sports_RemoveTrailingZeros?t.isInverseCurrency(z.loggedUserData.currency.Currency)?q("removeDecimalPoints")(a)+z.loggedUserData.currency.CurrencySymbol:z.loggedUserData.currency.CurrencySymbol+q("removeDecimalPoints")(a):t.isInverseCurrency(z.loggedUserData.currency.Currency)?q("numberTruncate")(a)+z.loggedUserData.currency.CurrencySymbol:z.loggedUserData.currency.CurrencySymbol+q("numberTruncate")(a)},this.handleLocalStorage=function(){var a=p.doNotShowAgain;z.doNotShowAgain&&(a||(p.doNotShowAgain=!0)),z.popupShouldBeShown=!1},this.calculateUserBalance=function(){null==h.getAgentType(h.getUserData().userType)&&A.getPlaySource("web").then(function(a){return a.success?(z.userBalance=a.data.map(function(a){return a.Balance}).reduce(function(a,b){return a+b}),void(h.getVerifyAccountData()&&"Locked"!=h.getVerifyAccountData().type&&z.popupShouldShow())):void l.logError("Unable to get user balances: "+a.error)})},this.operatorLogin=function(){var b=i.getQueryStringParameter("token"),d=i.getQueryStringParameter("pageRedirect");if(null==b||0==b.trim().length)return void(window.location.href="/");a.showLoader(),h.clearUserData(),h.setAccessToken({access_token:b});var e=z.getUserDetails(!1),f=z.getUserStatus(!1);z.getCanRegisterSubAccountPlayers();c.all([e,f]).then(function(){h.getLastLoginID()!=-1&&h.getLastLoginID()!=h.getUserData().UserID&&h.clearCouponData(),h.setLastLoginID(h.getUserData().UserID);var a=h.getVerifyAccountData();"UNCONF"!=h.getUserStatus()&&"Verified"!=a.type?$.fancybox({modal:!1,showCloseButton:!0,hideOnContentClick:!1,hideOnOverlayClick:!1,width:480,height:434,type:"iframe",padding:0,margin:0,fitToView:!1,iframe:{scrolling:"no"},autoSize:!1,href:"/unconfirmed-verification-iframe"}):null!=d&&d.trim().length>0&&(window.location.href=d)})},this.getUserDetails=function(a){null==a&&(a=!0);var b=c.defer();return B.getCurrentUserProfile().then(function(c){c.success?(h.setUserDetails(c.data),b.resolve()):(h.clearUserData(),l.logError("Unable to get user details: "+JSON.stringify(c.error),a?locale.login.loginError:null),b.resolve())}),b.promise},this.getIsAgent=function(){if(globalSettings.AgentsEnabled===!0){var a=c.defer();return B.isAgent().then(function(b){return b.success?(h.setIsAgent(b.data),void a.resolve()):(l.logError(b.error),void a.resolve())}),a.promise}return void h.setIsAgent(!1)},this.getUserStatus=function(){var a=c.defer();return C.getUserStatus().then(function(b){return b.success?(h.setUserStatus(b.data.Code),void a.resolve()):(l.logError("Unable to get user status: "+b.error),void a.resolve())}),a.promise},this.getCanRegisterSubAccountPlayers=function(){var a=c.defer();return globalSettings.AgentsEnabled?(C.canRegisterSubAccountPlayers().then(function(b){return b.success?(h.setCanRegisterSubAccountPlayers(b.data),void a.resolve()):(l.logError("Unable to get can register sub account: "+b.error),void a.resolve())}),a.promise):(h.setCanRegisterSubAccountPlayers(!1),void a.resolve())},this.getIsVirtualsEnabled=function(){var a=c.defer(),b="SHOP";return j.user.isVirtualsEnabledWithIntent(b).then(function(b){b.success?h.setIsVirtualsEnabled(b.data):(l.logError("Unable to check if virtuals is enabled: "+b.error),h.setIsVirtualsEnabled(!1)),a.resolve()}),a.promise},this.getIsGoldenRaceEnabled=function(){var a=c.defer();return j.gamingVendors.goldenRace.isUserEnabled().then(function(b){b.success?h.setIsGoldenRaceEnabled(b.data):(l.logError("Unable to check if GoldenRace is enabled: "+b.error),h.setIsGoldenRaceEnabled(!1)),a.resolve()}),a.promise},this.getLoginMessages=function(){var a=c.defer();return B.getLoginMessages().then(function(b){if(!b.success)return l.logError("Unable to get login messages: "+b.error),void a.resolve();var c=[];angular.forEach(b.data,function(a){c.push({html:'<div class="onLogin"><div class="contentMessage"><div class="onLoginTitle">'+a.Title+"</div>"+a.Contents+"</div></div>",width:750,showCloseButton:!0,confirmButtonClass:"btn-confirm",buttonsStyling:!1,allowEscapeKey:!1,allowOutsideClick:!1,animation:!1,onClose:function(){B.markMessageAsRead(a.Id)}})}),c.length>0&&swal.queue(c).done(),a.resolve()}),a.promise},this.getUnreadMessageCount=function(){B.getUnreadMessageCount().then(function(a){return a.success?void(d.unreadCount=a.data):(l.logError("Unable to get unread message count: "+a.error),void(d.unreadCount="-"))})},this.logout=function(a){var b=h.getAccessToken(),c=h.getUserData().userID.toString();m.auth.revokeToken(b),i.getGlobalVariables(),h.clearUserData(),z.balances=[],i.createDataLayerEvent({event:"user-logout",userID:c}),a&&("reloadpage"==a?window.top.location.reload():window.top.location.href=a)},this.goToRegister=function(){var a=w.getOpenDialogs();w.close(a[0]),z.f2pToken?z.upsellRegistrationFlow():globalSettings.Registration_UserJourneyRegister?z.registrationUserJourney():globalSettings.Header_EnableRegisterButton&&z.normalRegistrationFlow()},this.registrationUserJourney=function(){a.registrationUserJourneyDialog=w.open({template:"/partials/authenticated/shared/register/userJourneyRegistration/registerWrapper.html",className:"register-deposit-journey-form",name:"RegisterDepositJourneyDialog",id:"RegisterDepositJourneyDialog",controller:"RegisterUserJourneyController",controllerAs:"regUsrJrnyCtrl",data:{},showClose:!0,closeByDocument:!1,closeByEscape:!1,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1})},this.upsellRegistrationFlow=function(){a.upsellRegisterDialog=w.open({template:"/partials/authenticated/shared/register/upsellRegistration/register.html",className:"registerUpsellForm",name:"RegisterUpsellDialog",id:"RegisterUpsellDialog",controller:"RegisterUpsellController",controllerAs:"registerUpsellCtrl",data:{f2pToken:z.f2pToken},showClose:!0,closeByDocument:!1,closeByEscape:!1,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1})},this.normalRegistrationFlow=function(){if(globalSettings.Registration_SplitRegister)$.fancybox({modal:!1,showCloseButton:!0,hideOnContentClick:!1,hideOnOverlayClick:!1,autoSize:!1,width:520,height:710,type:"iframe",padding:0,margin:0,fitToView:!1,helpers:{overlay:{closeClick:!1}},href:"/register-iframe",wrapCSS:"split-registration",afterClose:function(a,b){window.top.location.reload()}});else if(globalSettings.General_EnableOTPbySms){var a=507;globalSettings.Registration_QuickRegister&&(a=540),$.fancybox({modal:!1,showCloseButton:!0,hideOnContentClick:!1,hideOnOverlayClick:!1,width:760,height:a,type:"iframe",padding:0,margin:0,fitToView:!1,iframe:{scrolling:"no"},autoSize:!1,href:"/register-iframe",afterShow:function(a,b){$("html").css("overflow-y","hidden")},afterClose:function(a,b){$("html").css("overflow-y","auto"),window.top.location.reload()}})}else i.goToUmbracoPage("register")},this.goToAccount=function(){i.goToUmbracoPage("account")},this.goToAccountBalance=function(){i.goToUmbracoPage("account","accountBalance")},this.showBalances=function(){z.balances=[],null!=z.balanceRefreshInterval&&(f.cancel(z.balanceRefreshInterval),z.balanceRefreshInterval=f(z.showBalances,3e5)),x(),"1903"===globalSettings.BrandID&&"UNCONF"===h.getUserStatus()&&z.getUserStatus()},this.goToMessages=function(){z.userLoggedIn&&(z.isAgent?globalSettings.ShopEnabled?i.goToUmbracoPage("shop","shopMessagesOverview"):i.goToUmbracoPage("agents","agentsMessagesOverview"):i.goToUmbracoPage("account","accountMessagesOverview"))},this.goToForgotPassword=function(){var a=w.getOpenDialogs();w.close(a[0]),i.goToUmbracoPage("reset-password")},this.verifyPhoneNumber=function(){$.fancybox({modal:!1,showCloseButton:!0,hideOnContentClick:!1,hideOnOverlayClick:!1,width:760,height:581,type:"iframe",padding:0,margin:0,fitToView:!1,iframe:{scrolling:"no"},autoSize:!1,href:"/phone-verification-iframe",afterShow:function(a,b){$("html").css("overflow-y","hidden")},afterClose:function(a,b){$("html").css("overflow-y","auto"),h.clearUserData(),z.popupShouldBeShown=!1}})},this.isPrefixedUsername=function(){return"mobile"==globalSettings.Account_LoginType.toLowerCase()},this.getUsernamePlaceholder=function(){switch(globalSettings.Account_LoginType.toLowerCase()){case"username":return locale.login.usernamePlaceholder;case"usernameormobile":return locale.login.usernameOrMobilePlaceholder;case"mobile":return locale.login.mobilePlaceholder}},b.$on("verifyPhoneNumberRequest",function(a){z.verifyPhoneNumber()}),b.$on("hideUnverifiedAccountPopupRequest",function(a){z.unverifiedAccount=!1}),b.$watch(function(){return h.hasValidLogin()},function(a,b){if(b&&!a&&k.stop(),z.userLoggedIn=a,z.unverifiedAccount="UNCONF"!==z.userStatus&&h.hasVerifyAccountData()&&"VerifyInProgress"==h.getVerifyAccountData().type,z.loggedUserData=h.getUserData()||{},z.verifyAccountData=h.getVerifyAccountData(),z.isAgent=h.isAgent(),a){if(z.messageCountInterval=f(function(){B.getUnreadMessageCount().then(function(a){return a.success?void(d.unreadCount=a.data):(l.logError("Unable to get unread message count: "+a.error),void(d.unreadCount="-"))})},12e4),z.showBalances(),z.balanceRefreshInterval=f(z.showBalances,3e5),s(function(){i.createOptimoveEvent("onLogin","userId",h.getUserData().userID.toString()),i.createDataLayerEvent({event:"user-login",userID:h.getUserData().userID.toString(),userType:h.dataLayerUserType()}),globalSettings.Tracking_EnableDataLayer&&(i.setValueToDataLayer("userID",h.getUserData().userID),i.setValueToDataLayer("userFP",r.getFingerprint()))}),a!=b){var c=h.getVerifyAccountData();"UNCONF"!=h.getUserStatus()&&"Verified"!=c.type&&$.fancybox({modal:!1,showCloseButton:!0,hideOnContentClick:!1,hideOnOverlayClick:!1,width:480,height:434,type:"iframe",padding:0,margin:0,fitToView:!1,iframe:{scrolling:"no"},autoSize:!1,href:"/unconfirmed-verification-iframe"})}}else f.cancel(z.messageCountInterval),z.messageCountInterval=null,null!=z.balanceRefreshInterval&&(f.cancel(z.balanceRefreshInterval),z.balanceRefreshInterval=null)}),b.$watch(function(){return h.getUserStatus()},function(a,b){if(a!=b){switch(z.userStatus=a,a){case"PCHANG":globalSettings.ShopEnabled&&h.isAgent()?i.goToUmbracoPage("shop","shopChangePassword"):i.goToUmbracoPage("account","accountChangePassword");break;case"UNCONF":z.unverifiedAccount=!1,globalSettings.General_AllowUnconfirmedUsers||(globalSettings.General_EnableOTPbySms?"/phone-verification-iframe/"!==window.location.pathname&&C.getActivationOption().then(function(a){"ByEmail"==a.data?(i.showMessageWithTitle(locale.account.register.confirmRegistration.confirmAccountTitle,locale.account.register.confirmRegistration.confirmEmailSent,!1,null,!1,null).done(),h.clearUserData()):"BySms"==a.data&&z.verifyPhoneNumber()}):(i.showMessageWithTitle(locale.account.register.confirmRegistration.confirmAccountTitle,locale.account.register.confirmRegistration.confirmEmailSent,!1,null,!1,null).done(),h.clearUserData()))}a&&z.showBalances()}}),b.$watch(function(){return h.loginInProgress()},function(a,b){z.loginInProgress=a}),b.$watch(function(){return null!=d.unreadCount?d.unreadCount:"-"},function(a,b){z.unreadMessageCount=a}),b.$watch(function(){return g.getSaveBankAccStatus()},function(a){z.saveBankAccStatus=a}),b.$on("couponService:couponPosted",function(a){z.showBalances()}),b.$on("cashoutService:cashoutApproved",function(a){z.showBalances()}),b.$on("evaluationService:couponAccepted",function(a){z.showBalances()}),b.$on("logoutRequest",function(a,c){b.$apply(function(){z.logout()})}),b.$on("loginRequest",function(a,b,c,d,e,f){z.login(b,c,d,e,f)}),b.$on("loginWithTokenRequest",function(a,b,c,d){z.loginWithToken(b,c,d)}),h.hasValidLogin()?(k.start(),z.getUnreadMessageCount(),"PCHANG"!=h.getUserStatus()&&z.getLoginMessages(),globalSettings.Header_ShowBalance&&z.showBalances()):h.clearUserData(),y(),this.onInit=function(){z.getCMSContent()},z.onInit()}])}(),function(){angular.module("auth.service",[]).factory("authService",["$rootScope","$localStorage","$sessionStorage",function(a,b,c){var d=!1;return{getUserData:function(){return b.userData},getVerifyAccountData:function(){return b.verifyAccountData},setVerifyAccountStatus:function(a){var c=b.verifyAccountData;c&&(c.type=a,b.verifyAccountData=c)},hasVerifyAccountData:function(){var a=b.verifyAccountData;return null!=a},clearUserData:function(){if(delete b.userData,delete b.verifyAccountData,delete c.unreadCount,delete c.agentUserJSON,delete b.evaluationList,delete b.interaccountTablePageSize,null!=b.couponSettings){var a=b.couponSettings.split(",");a.length>=3&&(b.couponSettings=a[0]+","+a[1]+","+a[2]+",,"+a[4])}},setUserDetails:function(a){var c=b.userData?b.userData:{};c.userID=a.UserDetails.UserId,c.userName=a.UserDetails.Username,c.firstName=a.UserDetails.Name,c.lastName=a.UserDetails.Surname,c.email=a.UserDetails.Email,c.userType=a.UserDetails.UserTypeCode,c.ellapsedRealityCheckTime=0,c.currency={Currency:a.UserDetails.Currency,CurrencySymbol:a.UserDetails.CurrencySymbol},null!=a.ParentDetails&&(c.parentUserID=a.ParentDetails.ParentId,c.parentUserName=a.ParentDetails.Username,c.parentFirstName=a.ParentDetails.Name,c.parentLastName=a.ParentDetails.Surname,c.parentEmail=a.ParentDetails.Email,c.parentMobileNumber=_.find(a.ParentDetails.PhoneContactDetails,function(a){return"MB"==a.PhoneContactTypeCode}),c.parentHomeNumber=_.find(a.ParentDetails.PhoneContactDetails,function(a){return"HM"==a.PhoneContactTypeCode}),c.parentUserType="J_SUPER_AG"),b.userData=c},truncate:function(a){return isNaN(a)?NaN:a>0?Math.floor(a):Math.ceil(a)},isAccountMenuLocked:function(a){var b=!1;return this.getVerifyAccountData()&&"Locked"==this.getVerifyAccountData().type&&void 0==globalSettings.General_RouteWhiteListForLockedUsers.split(",").filter(function(b){return b==a})[0]&&(b=!0),b},isAgent:function(){return this.hasValidLogin()&&this.getUserData().isAgent},setIsAgent:function(a){var c=b.userData?b.userData:{};c.isAgent=a,b.userData=c},verifyAccountMobile:function(){var a,c=b.userData.parentMobileNumber;if(globalSettings.General_EnableOTPbySms&&globalSettings.General_EnableMobilePhoneVerification&&!this.getUserData().isAgent&&c)switch(c.PhoneContactVerificationStatus){case null:case void 0:case"":case"UNCF":case"STRVER":a="VerifyInProgress";break;case"VER":a="Verified";break;case"LCKD":a="Locked";break;default:a="Verified"}else a="Verified";var d,e,f=!1;if(globalSettings.Registration_DeadlineDate&&""!=globalSettings.Registration_DeadlineDate){var g=moment(globalSettings.Registration_DeadlineDate),h=moment(),i=moment(g).diff(h),j=moment.duration(i,"milliseconds").asMilliseconds();d=this.truncate(moment.duration(i,"milliseconds").asDays()),e=moment.duration(i,"milliseconds").subtract(d,"day").hours(),j<=0&&"Verified"!=a&&(a="Locked",f=!0)}var k=b.verifyAccountData?b.verifyAccountData:{};k.type=a,k.gracePeriod=f,k.daysLeft=d,k.hoursLeft=e,k.mobileNumber=c?c.ContactNumber:"",b.verifyAccountData=k},agentTypes:{user:"user",agent:"agent",cashier:"cashier",superAgent:"superAgent",masterAgent:"masterAgent",subAccountPlayer:"subAccountPlayer"},getAgentType:function(a){return void 0!=a?getAgentType(a,this.agentTypes):null},getAccessToken:function(){return b.userData?b.userData.accessToken:null},setAccessToken:function(a){var c=b.userData?b.userData:{};c.accessToken=a.access_token,b.userData=c},getUserStatus:function(){return b.userData?b.userData.userStatus:null},setUserStatus:function(a){var c=b.userData?b.userData:{};c.userStatus=a,b.userData=c},hasValidLogin:function(){var a=b.userData?b.userData:{};return null!=a.accessToken&&null!=a.userID&&null!=a.userName&&null!=a.userType&&null!=a.isAgent},loginInProgress:function(a){return null!=a&&(d=a),d},getCanRegisterSubAccountPlayers:function(){return b.userData?b.userData.canRegisterSubAccountPlayers:null},setCanRegisterSubAccountPlayers:function(a){var c=b.userData?b.userData:{};c.canRegisterSubAccountPlayers=a,b.userData=c},getLastLoginID:function(){return b.lastLoginID?b.lastLoginID:-1},setLastLoginID:function(a){b.lastLoginID=a},isVirtualsEnabled:function(){return!!b.userData&&b.userData.isVirtualsEnabled},setIsVirtualsEnabled:function(a){var c=b.userData?b.userData:{};c.isVirtualsEnabled=a,b.userData=c},isGoldenRaceEnabled:function(){return!b.userData||b.userData.isGoldenRaceEnabled},setIsGoldenRaceEnabled:function(a){var c=b.userData?b.userData:{};c.isGoldenRaceEnabled=a,b.userData=c},clearCouponData:function(){delete b.lottoCouponJSON,delete b.virtualCouponJSON,delete b.agentUserJSON,delete b.reservaList;for(var c=1;c<6;c++)delete b["savedBetCoupon"+c];for(var c=1;c<6;c++)delete b["savedLottoCoupon"+c];for(var c=1;c<6;c++)delete b["savedVirtualCoupon"+c];a.$broadcast("clearCoupon")},dataLayerUserType:function(){var a=this.getAgentType(this.getUserData().userType);return a===this.agentTypes.subAccountPlayer?"SUB":a===this.agentTypes.cashier?"C":a===this.agentTypes.agent?"A":a==this.agentTypes.superAgent?"SA":a==this.agentTypes.masterAgent?"MA":"U"}}}])}(),function(){angular.module("account",["accountBalance","authenticatedBetSearch","authenticatedBetSearchVirtuals","accountOpenBets","authenticatedCouponDetails","authenticatedCouponDetailsVirtuals","authenticatedCouponDetailsLottery","authenticatedMoneyTransfer","authenticatedUserJourneyMoneyTransfer","authenticatedEditProfile","authenticatedProfileManagment","authenticatedChangePassword","authenticatedChangePhoneNumber","authenticatedResetPassword","authenticatedStatementSearch","authenticatedRegister","authenticatedSplitRegistration","authenticatedUserJourneyRegister","authenticatedJourneyDeposit","authenticatedUpsellRegister","authenticatedPrintOdds","authenticatedMessageCentre","authenticatedMessageOverview","authenticatedSendNewMessage","authenticatedMessageDetails","accountBetRequest","authenticatedQuickCashier","authenticatedManageUsers","authenticatedActivate","authenticatedFundTransfer","authenticatedInterAccount","authenticatedInterAccountNew","authenticatedPhoneVerification","authenticatedOTP","accountBonus","vendorImages.service","accountPaymentAutoWithdrawal","accountPaymentWithdrawalDailyAttempts","accountPaymentDepositWithdrawal","accountPaymentDepositWithdrawalOffline"]).controller("AccountController",["$scope","$location","$window","authService","$http","$transitions","$state","umbracoApiService","loggingService","helperService","bankProfileService",function(a,b,c,d,e,f,g,h,i,j,k){globalSettings.ShopEnabled&&d.isAgent()&&j.goToUmbracoPage("shop");var l=this;l.agentItems,l.agentMenuStructure,l.requiredLanguage="en-GB"==globalSettings.CurrentLocale?"en-US":globalSettings.CurrentLocale,this.isAgentsPage=function(){return b.absUrl().indexOf(globalSettings.CurrentLanguage+"/agents")>-1},this.getUserMenu=function(){l.menuStructure=[{sectionTitle:locale.account.userAreaMenu.accountInformation,sectionTitleFaIconClass:"fa-briefcase",sectionItems:[{itemTitle:locale.account.userAreaMenu.balance,itemFaIconClass:"fa-money",navSettings:{type:"state",target:"accountBalance"},visible:!0,isLocked:d.isAccountMenuLocked("accountBalance")},{itemTitle:locale.account.userAreaMenu.accountStatement.title,itemFaIconClass:"fa fa-book",navSettings:{type:"state",target:"accountStatementSearch"},visible:!0,isLocked:d.isAccountMenuLocked("accountStatementSearch")},{itemTitle:locale.account.bonus.title,itemFaIconClass:"fa-gift",navSettings:{type:"state",target:"accountBonus"},visible:globalSettings.BonusEnabled,isLocked:d.isAccountMenuLocked("accountBonus")},{itemTitle:locale.account.paymentMethods.deposit.menuTitle,itemFaIconClass:"fa-plus-circle",navSettings:{type:"state",target:"accountDeposit"},visible:!0,isLocked:d.isAccountMenuLocked("accountDeposit")},{itemTitle:locale.account.paymentMethods.withdrawal.title,itemFaIconClass:"fa-minus-circle",navSettings:{target:"accountWithdraw"},visible:!0,isLocked:d.isAccountMenuLocked("accountWithdraw")
},{itemTitle:locale.account.userAreaMenu.editProfile,itemFaIconClass:"fa-drivers-license-o",navSettings:{type:"state",target:"accountEditProfile"},visible:!0,isLocked:d.isAccountMenuLocked("accountEditProfile")},{itemTitle:locale.account.password.changePassword,itemFaIconClass:"fa-key",navSettings:{type:"state",target:"accountChangePassword"},visible:!0,isLocked:d.isAccountMenuLocked("accountChangePassword")},{itemTitle:locale.account.phoneVerification.popup.changePhoneNumber,itemFaIconClass:"fa-mobile",navSettings:{type:"state",target:"accountChangePhoneNumber"},visible:globalSettings.Account_MobileEditability&&d.getVerifyAccountData()&&"Verified"!=d.getVerifyAccountData().type,isLocked:d.isAccountMenuLocked("accountChangePhoneNumber")},{itemTitle:locale.account.userAreaMenu.messageCenter.pageTitle,itemFaIconClass:"fa-envelope",navSettings:{type:"state",target:"accountMessagesOverview"},visible:globalSettings.EnableMessaging,isLocked:d.isAccountMenuLocked("accountMessagesOverview")},{itemTitle:locale.account.userAreaMenu.betSearch,itemFaIconClass:"fa-list",navSettings:{type:"state",target:"accountBetSearch"},visible:!0,isLocked:d.isAccountMenuLocked("accountBetSearch")},{itemTitle:locale.account.userAreaMenu.betListVirtuals,itemFaIconClass:"fa-vimeo",navSettings:{type:"state",target:"accountBetSearchVirtuals"},visible:!1,isLocked:d.isAccountMenuLocked("accountBetSearchVirtuals")},{itemTitle:locale.account.userAreaMenu.openBets,itemFaIconClass:"fa-ticket",navSettings:{type:"state",target:"accountOpenBets"},visible:globalSettings.Sports_EnableAccountOpenBets,isLocked:d.isAccountMenuLocked("accountOpenBets")}],visible:!0},{sectionTitle:locale.account.printOdds.printOdds,sectionTitleFaIconClass:"fa-print",sectionItems:[{itemTitle:locale.account.printOdds.fastPrintOdds,itemFaIconClass:"fa-barcode",navSettings:{type:"state",target:"accountFastPrint"},visible:globalSettings.EnablePrintOdds,isLocked:d.isAccountMenuLocked("accountFastPrint")},{itemTitle:locale.account.printOdds.standardPrintOdds,itemFaIconClass:"fa-print",navSettings:{type:"state",target:"accountStandardPrint"},visible:globalSettings.EnablePrintOdds,isLocked:d.isAccountMenuLocked("accountStandardPrint")}],visible:globalSettings.EnablePrintOdds}]},this.showExpandedNavbar=function(){var a=angular.element(window).width();a>1279||(l.overlayShown=!l.overlayShown)},this.showCollapsedNavbar=function(){l.overlayShown=!1},a.updateMenuSelection=function(){if(null!=l.menuStructure)for(var a=0;a<l.menuStructure.length;a++)for(var c=0;c<l.menuStructure[a].sectionItems.length;c++){var d=l.menuStructure[a].sectionItems[c],e=g.href(d.navSettings.target,d.navSettings.params||{});d.selected=b.absUrl().indexOf(e)>-1}},f.onStart({},function(b){b.promise.finally(function(){a.updateMenuSelection()})}),this.navigate=function(a,b,d){d||("popup"==a.type?c.open(a.target):b?a.target.startsWith("agent")?j.goToUmbracoPage("agents",a.target):a.target.startsWith("account")&&j.goToUmbracoPage("account",a.target):g.go(a.target,a.params||{}))},this.getUserMenu()}])}(),function(){angular.module("accountBalance",[]).controller("AccountBalanceController",["$rootScope","$scope","$state","$q","platformApiService","loggingService","$filter","currencyService",function(a,b,c,d,e,f,g,h){var i=this,j=e.finance,k=e.user,l=e.paymentVendors.paymentMethods;this.balances=null,this.apiParam="",this.TransferTo=null,this.totalBalance=0,this.totalCredit=0,this.SourceWalletId=null,this.SourceWalletBalance=0,this.SourceWalletName="",this.TargetWalletId=null,this.TargetWalletName="",this.Amount=0,this.Currency="",this.CurrencySymbol="",this.MainWalletId=null,this.MainWalletName="",this.stepPosition=0,this.finalSteps=null,this.info={},this.hideEnterAmountStep3=!1,this.hideEnterAmountStep4=!1,this.inputAmountReadonly=!1,this.tempStringHolder={},this.redirectTo=function(a){c.go("accountMessageDetails",{messageId:a,ret:"overview"})},this.getPlaySourceCode=function(){window.location.href.indexOf("/remote-cashier")>-1?i.apiParam="SHOPCLI":i.apiParam="WEB"},this.getTransferWallet=function(a,b,c){i.SourceWalletId=a,i.SourceWalletBalance=c,i.SourceWalletName=b,i.stepPosition=2,i.hideEnterAmountStep3=!1,i.inputAmountReadonly=!1,i.TargetWalletName="",i.TargetWalletId=0},this.formatBalances=function(a){return globalSettings.Sports_RemoveTrailingZeros?h.isInverseCurrency(i.Currency)?g("removeDecimalPoints")(a)+i.CurrencySymbol:i.CurrencySymbol+g("removeDecimalPoints")(a):h.isInverseCurrency(i.Currency)?g("numberTruncate")(a)+i.CurrencySymbol:i.CurrencySymbol+g("numberTruncate")(a)},this.getTransferUser=function(a,b){i.TargetWalletName=b,i.TargetWalletId=a,i.hideEnterAmountStep3=!1,i.inputAmountReadonly=!1,i.stepPosition=3,i.TargetWalletId!==i.MainWalletId&&i.SourceWalletId!==i.MainWalletId?(i.info.stepThreeTitle=locale.account.cashier.transferFrom+i.SourceWalletName+" "+locale.common.to+" "+i.MainWalletName,i.info.stepFourTitle=locale.account.cashier.transferFrom+i.MainWalletName+" "+locale.common.to+" "+i.TargetWalletName,i.finalSteps=!0,i.inputAmountReadonly=!1):(i.info.stepThreeTitle=locale.account.cashier.transferFrom+i.SourceWalletName+" "+locale.common.to+" "+i.TargetWalletName,i.finalSteps=!1)},this.getTransferAmount=function(){i.Amount<=i.SourceWalletBalance?(i.inputAmountReadonly=!0,i.finalSteps===!1?i.transferAmount(i.SourceWalletId,i.TargetWalletId).then(function(a){a&&(i.info.stepThreeTitle=i.CurrencySymbol+i.Amount+locale.account.cashier.successfullTransfer+i.TargetWalletName),i.hideEnterAmountStep3=!0,i.Amount=0,i.changeVisibleAmount()}):i.finalSteps===!0&&i.transferAmount(i.SourceWalletId,i.MainWalletId).then(function(a){a&&(i.info.stepThreeTitle=i.CurrencySymbol+i.Amount+locale.account.cashier.successfullTransfer+i.MainWalletName),i.stepPosition=4,i.hideEnterAmountStep3=!0})):(i.hideEnterAmountStep3=!1,i.inputAmountReadonly=!1,f.logError(locale.account.cashier.amountNotValid,locale.account.cashier.amountNotValid))},this.cancel=function(){i.stepPosition=1,i.SourceWalletId=null},this.getTransferAmountLastRow=function(){i.transferAmount(i.MainWalletId,i.TargetWalletId).then(function(a){a&&(i.info.stepFourTitle=i.CurrencySymbol+i.Amount+""+locale.account.cashier.successfullTransfer+i.TargetWalletName),i.Amount=0,i.stepPosition=5,i.changeVisibleAmount()})},this.transferAmount=function(a,b){var c=d.defer(),e=new gamingAppModels.TransferToAccountRequestModel;return e.SourceAccountId=a,e.TargetAccountId=b,e.Amount=i.Amount,j.transferBalance(e).then(function(a){if(!a.success)return 3===i.stepPosition?i.info.stepThreeTitle=a.userMsg:i.info.stepFourTitle=a.userMsg,void c.resolve(!1);var b=e.SourceAccountId,d=e.TargetAccountId,f=e.Amount;angular.forEach(i.balances,function(a){a.Id==b?a.Balance-=parseInt(f):a.Id==d&&(a.Balance+=parseInt(f))}),c.resolve(!0)}),c.promise},this.getAllDepositPaymentMethods=function(){var a=d.defer();return l.getAllDepositPaymentMethods().then(function(b){b&&b.data&&b.data.length>0&&(i.Currency=b.data[0].MinimumLimit.Currency,i.CurrencySymbol=b.data[0].MinimumLimit.CurrencySymbol),a.resolve()}),a.promise},this.changeVisibleAmount=function(){j.getPlaySource(i.apiParam).then(function(a){i.balances=a.data})},this.getPlaySource=function(){var a=d.defer();return i.balances=[],i.totalBalance=0,i.totalCredit=0,j.getPlaySource(i.apiParam).then(function(b){if(!b.success)return f.logError("Unable to get user balances: "+b.error,b.userMsg),void a.resolve();var c=b.data;angular.forEach(c,function(a){null!=a.Credit&&$.isNumeric(a.Credit)&&(i.totalCredit+=parseFloat(a.Credit)),a.IsMain===!0&&(i.MainWalletId=a.Id,i.MainWalletName=a.Name),i.totalBalance+=a.Balance,a.Name=a.Name.replace(" Account","");for(var b in locale.account.cashier.accounts){var c=a.Name[0].toLowerCase()+a.Name.slice(1);b===c&&(a.Name=locale.account.cashier.accounts[b])}}),i.balances=c,a.resolve()}),a.promise},this.getAllMessages=function(a){var b=d.defer();return k.getAllMessages().then(function(c){if(!c.success)return void f.logError("Unable to get messages: "+c.error,c.userMsg);var d=c.data;d.sort(function(a,b){return moment(b.SentOnDate)-moment(a.SentOnDate)}),i.allMessages=d.slice(0,a),b.resolve()}),b.promise},this.agentCode=null,this.getAgentCode=function(){var a=d.defer();return globalSettings.AgentsEnabled===!0?(k.isAgent().then(function(b){return b.success?(b.data&&k.getAgentCode().then(function(a){return a.success?void(i.agentCode=a.data):void f.logError(a.error)}),void a.resolve()):(f.logError(b.error),void a.resolve())}),a.promise):void 0},this.init=function(){a.showLoader(),i.getPlaySourceCode();var b=i.getAllDepositPaymentMethods(),c=i.getPlaySource(),e=i.getAllMessages(10),f=i.getAgentCode();d.all([b,c,e,f]).then(function(){a.hideLoader()})},this.init()}])}(),function(){angular.module("accountBonus",["accountBonusBankVerification"]).controller("AccountBonusController",["$q","ngDialog","websiteApiService","loggingService","$interval","umbracoApiService","helperService",function(a,b,c,d,e,f,g){var h=this,i=c.bonus,j=[];this.singleBonusData=[],this.singleBonusStatus="",this.singleBonusProgressData=[],this.bankVerificationDialog=null,this.getSinglePromoDetail=function(a){f.desktop.getPromotions(globalSettings.CurrentLanguage).then(function(b){j=b.data,i.getBonusClaimsById(a).then(function(a){if(!a.success)return void d.logError("Error occurred while getting bonus claims: "+a.error,a.userMsg);h.singleBonusData=h.parseRecord(a.data);var b=!1;!h.singleBonusData.isActivated||h.singleBonusData.isExpired||h.singleBonusData.isCancelled?h.singleBonusData.isActivated&&h.singleBonusData.isExpired&&!h.singleBonusData.isCancelled?(h.singleBonusStatus="previousBonus",b=!0):h.singleBonusData.isActivated||h.singleBonusData.isExpired||h.singleBonusData.isCancelled?(h.singleBonusData.isCancelled||!h.singleBonusData.isActivated&&h.singleBonusData.isExpired)&&(h.singleBonusStatus="missedBonus"):h.singleBonusStatus="inactiveBonus":(h.singleBonusData.isPaused?h.singleBonusStatus="pausedBonus":h.singleBonusStatus="activeBonus",b=!0),b?h.getBonusClaimsProgressById(h.singleBonusData):h.singleBonusProgressData={bonusId:h.singleBonusData.bonusId,progressPercentage:0,currentAmount:0,nextReleaseAmount:0}})})},this.getPromoDetails=function(a){f.desktop.getPromotions(globalSettings.CurrentLanguage).then(function(b){j=b.data,h.getAllBonusClaims(a)})},this.getAllBonusClaims=function(b){h.bonusClaims={activeBonus:{name:"activeBonus",data:[]},pausedBonus:{name:"pausedBonus",data:[]},inactiveBonus:{name:"inactiveBonus",data:[]},previousBonus:{name:"previousBonus",data:[]},missedBonus:{name:"missedBonus",data:[]}},i.getAllBonusClaims().then(function(c){if(!c.success)return void d.logError("Error occurred while getting bonus claims: "+c.error,c.userMsg);if(null!=b){var e=$.grep(c.data,function(a){return b==a.TermsCode});if(e.length>0)return void h.getSinglePromoDetail(e[0].Id)}for(var f=[],g=[],i=[],j=0;j<c.data.length;j++){var k=c.data[j],l=h.parseRecord(k),m="";!l.isActivated||l.isExpired||l.isCancelled||l.isPaused?l.isActivated&&!l.isExpired&&!l.isCancelled&&l.isPaused?(m="pausedBonus",g.push(l)):l.isActivated&&l.isExpired&&!l.isCancelled?(m="previousBonus",i.push(l)):l.isActivated||l.isExpired||l.isCancelled?(l.isCancelled||!l.isActivated&&l.isExpired)&&(m="missedBonus",h.bonusClaims.missedBonus.data.push(l),l.progressData={bonusId:l.bonusId,progressPercentage:0,currentAmount:0,nextReleaseAmount:0}):(m="inactiveBonus",h.bonusClaims.inactiveBonus.data.push(l),l.progressData={bonusId:l.bonusId,progressPercentage:0,currentAmount:0,nextReleaseAmount:0}):(m="activeBonus",f.push(l)),h.displayPercentageBar(l)}a.all(f).then(function(a){_.forEach(a,function(a){a&&(h.getBonusClaimsProgressById(a),h.bonusClaims.activeBonus.data.push(a))})}),a.all(g).then(function(a){_.forEach(a,function(a){a&&(h.getBonusClaimsProgressById(a),h.bonusClaims.pausedBonus.data.push(a))})}),a.all(i).then(function(a){_.forEach(a,function(a){a&&(h.getBonusClaimsProgressById(a),h.bonusClaims.previousBonus.data.push(a))})})})},this.displayPercentageBar=function(a){e(function(){var b=$("#percentageBar_"+a.bonusId).width();percWidth=b/100*Math.round(a.progressData.progressPercentage),$("#percentageBar_"+a.bonusId+" .prog_bar").animate({width:percWidth},2e3,function(){var b=$("#percentageBar_"+a.bonusId+" .prog_text").width();0!=a.progressData.progressPercentage&&$("#percentageBar_"+a.bonusId+" .prog_text").css("left","calc(50% - "+b/2+"px)").fadeIn("slow")})}.bind(this),10,1)},this.getBonusClaimsProgressById=function(b){var c=a.defer();return i.getBonusClaimsProgressById(b.bonusId).then(function(a){return a.success?(b.progressData=h.parseProgressRecord(a.data),h.singleBonusProgressData=h.parseProgressRecord(a.data),h.displayPercentageBar(b),void c.resolve(a.data)):(d.logError("Error occurred while getting bonus claims: "+a.error,a.userMsg),void c.resolve())}),c.promise},this.showActivateConfirmationDialog=function(a){var b=$(a.currentTarget),c=b.attr("data-addInfo"),d=b.attr("data-type"),e=b.attr("data-bonusId"),f="";switch(d){case"Welcome":f='<div class="couponConfirmation"><div class="contentMessage"><div class="messageContent"><span class="message text-left"><p>'+locale.account.bonus.activationMessages.welcome.partOne+'&nbsp;<a href="'+c+'" target="_blank">'+locale.account.bonus.activationMessages.welcome.cta+"</a>.</p><p>"+locale.account.bonus.activationMessages.welcome.partTwo+"</p></span></div></div></div>";break;case"Other":default:f='<div class="couponConfirmation"><div class="contentMessage"><div class="messageContent"><span class="message text-left"><p>'+locale.account.bonus.activationMessages.other.partOne+"</p><p>"+locale.account.bonus.activationMessages.other.partTwo+'&nbsp;<a href="'+c+'" target="_blank">'+locale.account.bonus.activationMessages.other.cta+"</a>.</p></span></div></div></div>"}g.showMessageWithHtml(f,!0,locale.common.cancel,!0,locale.common.confirm).then(function(){h.activateBonusClaims(e)})},this.activateBonusClaims=function(a){var c={ClaimId:a};i.activateBonusClaims(c).then(function(a){if(a.success)h.getAllBonusClaims();else if(a.data&&"BONUS_CLAIM_ACTIVATION_ISSUES"===a.data.ErrorCode&&a.data.ErrorDetails){const c={bankTransferDetailsStatus:a.data.ErrorDetails.BankTransferDetails,bankTransferDetailsVerified:void 0===a.data.ErrorDetails.BankTransferDetails,userKYCStatus:a.data.ErrorDetails.UserKYC,userKYCVerified:void 0===a.data.ErrorDetails.UserKYC};if(c.bankTransferDetailsVerified){if(!c.userKYCVerified){const e=globalSettings.Account_KYCVerificationFormUrl;e?window.location.href=e:g.showErrorMessage(locale.account.bonus.kycFormUnavailable)}}else h.bankVerificationDialog=b.open({template:"/partials/authenticated/account/bonus/bonusBankVerification.html",id:"bankVerificationDialog",className:"bank-verification-dialog",data:{bonusEligibility:c},showClose:!0,closeByDocument:!1,closeByEscape:!0,closeByNavigation:!0}),h.bankVerificationDialog.closePromise.then(function(){h.getAllBonusClaims()})}else d.logError("Error occurred while activating bonus: "+a.error,a.userMsg)})},this.pauseBonus=function(a,b){i.pauseBonus(a.bonusId).then(function(c){return c.success?(g.showSuccessMessage(locale.account.bonus.bonusPaused).done(),void("singleBonus"==b?h.getSinglePromoDetail(a.bonusId):"bonusList"==b&&h.getAllBonusClaims())):void d.logError("Error occurred while pausing bonus: "+c.error,c.userMsg)})},this.unpauseBonus=function(a,b){i.unpauseBonus(a.bonusId).then(function(c){return c.success?(g.showSuccessMessage(locale.account.bonus.bonusUnpaused).done(),void("singleBonus"==b?h.getSinglePromoDetail(a.bonusId):"bonusList"==b&&h.getAllBonusClaims())):void d.logError("Error occurred while unpausing bonus: "+c.error,c.userMsg)})},this.parseRecord=function(a){var b=$.grep(j,function(b){return b.promoCode==a.TermsCode}),c={bonusId:a.Id,name:b.length>0?b[0].promoContentTitle:"",expiryDate:a.ExpiresOn,promoCode:a.TermsCode,isActivated:a.IsActivated,isExpired:a.IsExpired,isCancelled:a.IsCancelled,isPaused:a.IsPaused,promoURL:b.length>0?b[0].promoURL:"",promoType:b.length>0?b[0].promotionType:"Other",additionalInfoURL:b.length>0?b[0].additionalInfoURL:"",bonusThumbImageURL:b.length>0?b[0].bonusThumbImageURL:"",progressData:{}};return c},this.parseProgressRecord=function(a){var b=a.CurrentContributionAmount/a.NextReleaseContributionAmount*100,c={bonusId:a.BonusClaimId,progressPercentage:b<=100?b:100,currentAmount:a.CurrentContributionAmount,nextReleaseAmount:a.NextReleaseContributionAmount,isBonusTransferPossible:a.IsBonusTransferPossible};return c},this.containerSlideToggle=function(a){var b=$(a.currentTarget);b.parent().next().slideToggle(),b.toggleClass("rotateIcon")},this.init=function(a){h.getPromoDetails(a)}}])}(),function(){angular.module("accountBonusBankVerification",[]).controller("bonusBankVerificationController",["$rootScope","$scope","platformApiService","helperService","bankProfileService",function(a,b,c,d,e){var f=this;this.bankList=[],this.bankName=null,this.accountNumber=null,this.submitting=!1,this.saveProfile=function(){a.showLoader(".button-container .submit-button","element-small",0),f.submitting=!0;var c={AccountNumber:f.accountNumber,BankCode:f.bankName.BankCode};e.saveNewBankProfile(c,!1,!0).then(function(c){if(a.hideLoader(".button-container .submit-button"),f.submitting=!1,c){const e=b.ngDialogData.bonusEligibility;if(!e.userKYCVerified){const g=globalSettings.Account_KYCVerificationFormUrl;if(g)return void(window.location.href=g);d.showErrorMessage(locale.account.bonus.kycFormUnavailable)}b.closeThisDialog()}})},this.init=function(){e.banks?f.bankList=e.banks:c.paymentVendors.bankInformation.getBankList().then(function(a){a.success?(e.banks=a.data,f.bankList=a.data):d.showErrorMessage(errorMsg||userMsg)})}()}])}(),function(){angular.module("authenticatedBetSearchLottery",[]).factory("betSearchLotteryService",["$q","$sessionStorage","$filter","lotteryApiService",function(a,b,c,d){return{getSearchParams:function(){return b.betSearchLotteryParams?b.betSearchLotteryParams:{}},setSearchParams:function(a){b.betSearchLotteryParams=a},searchBets:function(){var c=a.defer();b.betSearchLotteryParams||c.reject("No search parameters found");var e=b.betSearchLotteryParams,f=moment(e.fromDate,"DD/MM/YYYY").format(),g=moment(e.toDate,"DD/MM/YYYY").hours(23).minutes(59).seconds(59).milliseconds(999).format(),h=e.couponCode?e.couponCode:void 0,i={userId:e.user==-1||0==e.user?+e.agent:+e.user,dateFrom:f,dateTo:g,pageSize:1e3,pageNumber:1};return h&&(i.ticketCodeFilter=h),e.outcome&&e.outcome!=-1?i.statusFilter=[e.outcome]:i.statusFilter=[1,2,3,4,5],i.gameType=e.gametype?e.gametype:null,d.livelotto.getBetListItems(i).then(function(a){c.resolve(a)}),c.promise},parseLegendTitle:function(a){return parseLegendTitle(a)},parseRecord:function(a,b){var d=a.ticketCode,e=c("currencyFormat")(a.stake,2),f=a.userName||"-",g="-";if(null!=a.transactionDate&&""!=a.transactionDate){var h=new Date(a.transactionDate);g=moment(h).format("DD/MM/YYYY, HH:mm:ss")}var i="-";if(null!=a.resultDate&&""!=a.resultDate){var h=new Date(a.resultDate);i=moment(h).format("DD/MM/YYYY, HH:mm:ss")}var j="-";switch(a.statusId){case 1:j=this.parseLegendTitle(legendTitles.running);break;case 2:j=this.parseLegendTitle(legendTitles.negative);break;case 3:j=this.parseLegendTitle(legendTitles.positive);break;case 4:j=this.parseLegendTitle(legendTitles.cancelled);break;case 5:j=this.parseLegendTitle(legendTitles.partialWon);break;default:j=this.parseLegendTitle(legendTitles.unknown)}var k="-";a.winning&&a.winning>0&&(k=a.winning,k=c("currencyFormat")(k,2));var l=b.filter(function(b){if(b.value===a.gameType)return b})[0].description;return[d,g,i,e,j,k,f,l]},getGameTypes:function(){var b=a.defer();return d.setup.getProducts().then(function(a){if(a.success){var c=[];a.data.payload.forEach(function(a){c.push({value:a.key,description:a.value})}),b.resolve(c)}else b.reject("Error loading gametypes")}),b.promise}}}]).controller("BetSearchLotteryController",["$scope","$rootScope","$sessionStorage","$location","$filter","$state","betSearchLotteryService","authService","loggingService","getDescendantsList","betSearchHelpersService",function(a,b,c,d,e,f,g,h,i,j,k){var l=this;$.fn.dataTable.moment("DD/MM/YYYY, HH:mm:ss");var m=h.getUserData(),n=g.getSearchParams(),o=[];if(this.betSearchTitle=locale.account.userAreaMenu.betListLottery,this.betSearchIcon="fa-list",this.isAgent=h.isAgent(),this.showAgentLabel=!1,this.descendantsList=[],l.AllUsers,this.outcomeList=[{value:-1,description:locale.common.all},{value:1,description:locale.account.betSearch.couponStatus.running},{value:2,description:locale.account.betSearch.couponStatus.lost},{value:3,description:locale.account.betSearch.couponStatus.won},{value:4,description:locale.account.betSearch.couponStatus.cancelled},{value:5,description:locale.account.betSearch.couponStatus.partialWon}],this.gametypeList=[],this.agent=m.userID,this.user=null,this.couponCode=n.couponCode||"",this.outcome=n.outcome||l.outcomeList[0].value,this.gametype=n.gametype||null,this.period=n.period||1,this.fromDate=n.fromDate||moment().subtract(7,"day").format("DD/MM/YYYY"),this.toDate=n.toDate||moment().format("DD/MM/YYYY"),this.filterBySettlement=n.filterBySettlement||!1,this.minDate=moment().startOf("year").year(2020).toDate(),this.maxDate=moment().toDate(),this.isBetweenDates=function(a,b,c){if(moment(c,"DD/MM/YYYY").isSame(moment(a,"DD/MM/YYYY"))||moment(c,"DD/MM/YYYY").isSame(moment(b,"DD/MM/YYYY")))return!0;var d=moment(c,"DD/MM/YYYY").isBetween(moment(a,"DD/MM/YYYY"),moment(b,"DD/MM/YYYY"));return d},this.setLimitSearchDates=function(a){var b,c,d,e;"From"==a?(b=l.fromDate,d=l.toDate,c=moment(l.fromDate,"DD/MM/YYYY").add(globalSettings.Account_BetSearchLottery_MonthLimit,"month").subtract(1,"day").format("DD/MM/YYYY"),moment(d,"DD/MM/YYYY").isBefore(b,"DD/MM/YYYY")&&(l.toDate=b,d=b),e=l.isBetweenDates(b,c,d),e||(l.toDate=c),l.toDate=moment(c,"DD/MM/YYYY").isAfter(moment())?moment().format("DD/MM/YYYY"):c):(c=l.toDate,d=l.fromDate,b=moment(l.toDate,"DD/MM/YYYY").subtract(globalSettings.Account_BetSearchLottery_MonthLimit,"month").add(1,"day").format("DD/MM/YYYY"),moment(d,"DD/MM/YYYY").isAfter(c,"DD/MM/YYYY")&&(l.fromDate=c,d=c),e=l.isBetweenDates(b,c,d),e||(l.fromDate=b))},this.searchColumns=[{title:locale.account.betSearch.ticket},{title:locale.common.date,class:"center"},{title:locale.account.betSearch.dateOfResult,class:"center"},{title:locale.account.betSearch.amount,class:"right"},{title:locale.account.betSearch.result,class:"center"},{title:locale.account.betSearch.winning,class:"right"},{title:locale.common.user,class:"center"},{title:locale.account.betSearch.gametype,class:"center"}],this.searchResults=[],this.loading=!1,this.parseUserListRecord=function(a){return l.AllUsers=k.createAllUsersRecord(a),k.parseUserListRecord(a)},this.onPeriodChanged=function(){newRange=k.handlePeriodChange(l.period),newRange[0]&&(l.fromDate=newRange[0]),newRange[1]&&(l.toDate=newRange[1])},this.isAgentsPage=function(){return d.absUrl().indexOf(globalSettings.CurrentLanguage+"/agents")>-1},this.resetForm=function(){l.agent=m.userID,l.couponCode="",l.outcome=l.outcomeList[0].value,l.gametype=l.gametypeList[0].value,l.period=1,l.fromDate=moment().subtract(7,"day").format("DD/MM/YYYY"),l.toDate=moment().format("DD/MM/YYYY")},this.openCouponDetails=function(){var c=$("#searchResults").dataTable().api().row(this).data();if(c){var d=c[0],e=o.filter(function(a){if(a.ticketCode===d)return a})[0].userId;switch(f.current.name){case"agentsBetSearchLottery":f.go("agentsBetSearchLotteryCouponDetails",{ticketCode:d+","+e});break;case"shopBetSearchLottery":f.go("shopBetSearchLotteryCouponDetails",{ticketCode:d+","+e});break;default:f.go("accountBetSearchLotteryCouponDetails",{ticketCode:d+","+e})}a.$apply(),b.showLoader()}},this.isTableInitialized=function(){return $.fn.DataTable.isDataTable($("#searchResults"))},this.getDTLocaleUrl=function(){return k.getDTLocaleUrl()},this.searchBets=function(){1!=l.loading&&(g.setSearchParams({period:parseInt(l.period),fromDate:l.fromDate,toDate:l.toDate,couponCode:l.couponCode,outcome:l.outcome,agent:l.agent,user:null==l.user?m.userID:l.user,gametype:l.gametype}),l.searchResults=[],o=[],b.showLoader(),l.loading=!0,g.searchBets().then(function(a){if(a.success){o=a.data.payload;for(var d=0,f=0,h=0;h<o.length;h++){var i=o[h];d+=i.stake,null!=i.winning&&i.winning>0&&(f+=i.winning),l.searchResults.push(g.parseRecord(i,l.gametypeList))}l.isTableInitialized()&&$("#searchResults").dataTable().api().destroy(),$("#searchResults").dataTable({dom:'<"top"if>rt<"bottom"pl><"clear">',oLanguage:{sLengthMenu:"Rows per page _MENU_"},data:l.searchResults,columns:l.searchColumns,pageLength:10,order:[[1,"desc"]],bSort:!1,stateSave:!0,stateSaveCallback:function(a,b){c.betSearchSettings=JSON.stringify(b)},stateLoadCallback:function(){if(c.betSearchSettings)return JSON.parse(c.betSearchSettings)},language:{url:l.getDTLocaleUrl()},footerCallback:function(){var a=this.api();$(a.column(2).footer()).html('<span style="font-weight:bold;">'+locale.common.total+"</span>"),$(a.column(3).footer()).html(e("currencyFormat")(d,2)),$(a.column(4).footer()).html('<span style="font-weight:bold;">'+locale.common.total+"</span>"),$(a.column(5).footer()).html(e("currencyFormat")(f,2))},drawCallback:function(){$("#searchResults tbody tr td:not(.rebet)").off("click"),$("#searchResults tbody tr td:not(.rebet)").on("click",l.openCouponDetails),globalSettings.Sports_EnableRebet&&globalSettings.Sports_EnableRebetInBetList&&($("#searchResults tbody tr td.rebet button").off("click"),$("#searchResults tbody tr td.rebet button").on("click",l.rebetCoupon))}})}else console.error("Error occurred while searching for bets: "+JSON.stringify(a.error));l.loading=!1,b.hideLoader()}))},h.getAgentType(h.getUserData().userType)!=h.agentTypes.masterAgent&&h.getAgentType(h.getUserData().userType)!=h.agentTypes.superAgent||(l.showAgentLabel=!0),h.isAgent()&&h.getAgentType(h.getUserData().userType)!=h.agentTypes.cashier){if(!j.success||!j.data)return void i.logError("Unable to get user agents: "+JSON.stringify(j.error));l.descendantsList=l.parseUserListRecord(j.data),l.descendantsList.sort(function(a,b){var c=a.FirstName.toUpperCase(),d=b.FirstName.toUpperCase();return c<d?-1:c>d?1:0}),l.descendantsList.splice(0,0,l.AllUsers)}this.onInit=function(){g.getGameTypes().then(function(a){l.gametypeList=a,null===l.gametype&&(l.gametype=l.gametypeList[0].value),l.searchBets()})},l.onInit()}])}(),function(){var a=angular.module("authenticatedCouponDetailsLottery",[]);a.controller("CouponDetailsLotteryController",["$scope","$rootScope","$window","$location","$localStorage","$q","couponService","cashoutService","helperService","$filter","authService","betSearchLotteryService","$uiRouterGlobals","$state","lotteryApiService","platformApiService","loggingService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=this;this.couponDetailsTitle=locale.account.betSearch.couponDetailsLottery,this.couponDetailsIcon="fa-list",this.isVirtuals=!1,this.gametypeList=null,this.userData=k.getUserData(),this.userLoggedIn=k.hasValidLogin(),this.currencySymbol=this.userData?this.userData.currency.CurrencySymbol:"",this.showPrintBtn=!1,this.winningsImageData=null,this.winningsImageTable=null,this.goBack=function(){switch(n.current.name){case"accountBetSearchLotteryCouponDetails":n.go("accountBetSearchLottery",{});break;case"agentsBetSearchLotteryCouponDetails":n.go("agentsBetSearchLottery",{});break;case"shopBetSearchLotteryCouponDetails":n.go("shopBetSearchLottery",{})}},this.parseCouponDetails=function(a){switch(a.stake=j("currencyFormat")(a.stake,2),a.wonAmount=a.wonAmount?j("currencyFormat")(a.wonAmount,2):"",a.ticketStatus){case 1:a.statusTxt=locale.account.betSearch.running;break;case 2:a.statusTxt=locale.account.betSearch.negative;break;case 3:a.statusTxt=locale.account.betSearch.positive;break;case 4:a.statusTxt=locale.account.betSearch.cancelled;break;case 5:a.statusTxt=locale.account.betSearch.couponStatus.partialWon;break;default:a.statusTxt=locale.account.betSearch.unknown}return a.gameTypeTxt=r.gametypeList.filter(function(b){if(b.value===a.gameType)return b})[0].description,a.RebetEnabled=!1,a.showPayOrCancelButton=!1,a},this.parseSelection=function(a,b){var c=a.draws[b],d=c.id,e=a.metaData.filter(function(a){return a.drawId===d})[0],f=e.selectionId,g=c.results,h=c.drawDate,i=a.picks,j=a.powerballPicks,k=a.quickPick,l=0;a.selections.forEach(function(a){l+=a.permutationCount});var m="-",n="";switch(e.statusId){case 1:m=locale.account.betSearch.running,n="running";break;case 2:m=locale.account.betSearch.negative,n="lost";break;case 3:m=locale.account.betSearch.positive,n="won";break;case 4:m=locale.account.betSearch.cancelled,n="void";break;case 5:m=locale.account.betSearch.couponStatus.partialWon,n="halfWonVoid";break;default:m=locale.account.betSearch.unknown,n=""}return{selectionId:f,drawId:d,drawResult:g,drawDate:h,selectionNumbers:i,powerballNumbers:j,isQuickPick:k,combinations:l,outcome:m,outcomeCssClass:n}},this.copyToClipboard=function(a){var b=$(a.currentTarget),c=$("<input>");$("body").append(c),c.val(b.text().trim()).select(),document.execCommand("copy"),c.remove()},this.isTableInitialized=function(a){return $.fn.DataTable.isDataTable($(a))},this.getTicketByCode=function(a){o.livelotto.getTicketByCode(m.params.ticketCode).then(function(a){b.hideLoader();var c=null;if(!a.success)return q.logError("Unable to get coupon details: "+JSON.stringify(a.error)),void r.goBack();if(null==a.data||null==a.data.payload.ticketCode)return void r.goBack();c=a.data.payload,r.couponDetails=r.parseCouponDetails(c),r.couponDetails.totalCombinations=0;for(var d=[],e=0;e<c.selectionGroups.length;e++){for(var f=c.selectionGroups[e],g=[],h=0;h<f.draws.length;h++)g.push(r.parseSelection(f,h));r.couponDetails.totalCombinations+=g[0].combinations,d.push(g)}r.selectionGroupsData=d})},this.init=function(){b.showLoader(),this.eventListData=null,l.getGameTypes().then(function(a){r.gametypeList=a,r.getTicketByCode(m.params.ticketCode)})},r.init(),a.$watch(function(){return k.hasValidLogin()},function(a,b){r.userLoggedIn=a}),a.$on("onRepeatLast",function(a,b,c){"couponEventList"==c.onLastRepeat&&(r.isTableInitialized("#couponEvents")&&$("#couponEvents").dataTable().api().destroy(),$("#couponEvents").DataTable({ordering:!1,paging:!1,searching:!1,info:!1}))})}])}(),function(){angular.module("authenticatedBetSearchVirtuals",[]).factory("betSearchVirtualsService",["$q","$sessionStorage","$filter","authService","platformApiService",function(a,b,c,d,e){return{getSearchParams:function(){return b.betSearchVirtualsParams?b.betSearchVirtualsParams:{}},setSearchParams:function(a){b.betSearchVirtualsParams=a},searchBets:function(){var c=a.defer();b.betSearchVirtualsParams||c.reject("No search parameters found");var d=b.betSearchVirtualsParams,f=moment(d.fromDate,"DD/MM/YYYY").format(),g=moment(d.toDate,"DD/MM/YYYY").hours(23).minutes(59).seconds(59).milliseconds(999).format(),h=d.couponCode?d.couponCode:"",i=null,j=d.filterBySettlement;i=d.user==-1||0==d.user?d.agent:d.user;var k={Parameters:[{ParameterName:"CouponCode",ParameterValue:h},{ParameterName:"ExternalUserId",ParameterValue:i},{ParameterName:"BrandId",ParameterValue:globalSettings.BrandID},{ParameterName:"CouponStatusId",ParameterValue:d.outcome},{ParameterName:"FromDate",ParameterValue:f},{ParameterName:"ToDate",ParameterValue:g},{ParameterName:"SearchBySettlementDate",ParameterValue:j},{ParameterName:"IncludeUsers",ParameterValue:!0}]};return k.Parameters.forEach(function(a,b){"CouponCode"===a.ParameterName&&_.isEmpty(a.ParameterValue)&&k.Parameters.splice(b,1),"CouponStatusId"===a.ParameterName&&0==a.ParameterValue&&k.Parameters.splice(b,1)}),e.report.getVirtualsBetSearchData(k).then(function(a){c.resolve(a)}),c.promise},parseLegendTitle:function(a){return parseLegendTitle(a)},parseRecord:function(a){var b=a.IsLive?"L":"",d=a.CouponCode,e=c("currencyFormat")(a.Stake,2),f=a.UserName||"-",g="-";if(null!=a.CouponDate&&""!=a.CouponDate){
var h=new Date(a.CouponDate);g=moment(h).format("DD/MM/YYYY, HH:mm:ss")}var i="-";if(null!=a.PaymentDate&&""!=a.PaymentDate){var h=new Date(a.PaymentDate);i=moment(h).format("DD/MM/YYYY, HH:mm:ss")}var j="-",k=0;switch(a.CouponStatusId){case 1:j=this.parseLegendTitle(legendTitles.running);break;case 2:j=this.parseLegendTitle(legendTitles.negative);break;case 3:j=this.parseLegendTitle(legendTitles.positive);break;case 4:j=this.parseLegendTitle(legendTitles.cancelled);break;case 5:j=this.parseLegendTitle(legendTitles.partialWon);break;default:j=this.parseLegendTitle(legendTitles.unknown)}a.Won&&a.Won>0&&(k=a.Won),k=c("currencyFormat")(k,2);var l="";return a.IsAgentSettled&&(l='<i class="fa fa-check-circle betPaid"></i>'),[b,d,g,i,e,j,k,f,a.UserId]}}}]).controller("BetSearchVirtualsController",["$scope","$rootScope","$sessionStorage","$location","$filter","$state","betSearchVirtualsService","authService","loggingService","getDescendantsList","betSearchHelpersService",function(a,b,c,d,e,f,g,h,i,j,k){var l=this;$.fn.dataTable.moment("DD/MM/YYYY, HH:mm:ss");var m=h.getUserData(),n=g.getSearchParams(),o=[];if(this.betSearchTitle=locale.account.userAreaMenu.betSearchVirtualsTitle,this.betSearchIcon="fa-vimeo",this.showDisclaimer=locale.account.userAreaMenu.betSearchVirtualsBottomDisclaimer,this.isAgent=h.isAgent(),this.showAgentLabel=!1,this.descendantsList=[],l.AllUsers,this.outcomeList=[{value:null,description:locale.common.all},{value:1,description:locale.account.betSearch.outcomeOptions.placed},{value:2,description:locale.account.betSearch.outcomeOptions.losers},{value:3,description:locale.account.betSearch.outcomeOptions.winnings},{value:4,description:locale.account.betSearch.outcomeOptions.cancelled}],this.agent=m.userID,this.user=null,this.couponCode=n.couponCode||"",this.outcome=+n.outcome||null,this.period=n.period||1,this.fromDate=n.fromDate||moment().subtract(7,"day").format("DD/MM/YYYY"),this.toDate=n.toDate||moment().format("DD/MM/YYYY"),this.filterBySettlement=n.filterBySettlement||!1,this.minDate=moment().startOf("year").year(2005).toDate(),this.maxDate=moment().toDate(),this.isBetweenDates=function(a,b,c){if(moment(c,"DD/MM/YYYY").isSame(moment(a,"DD/MM/YYYY"))||moment(c,"DD/MM/YYYY").isSame(moment(b,"DD/MM/YYYY")))return!0;var d=moment(c,"DD/MM/YYYY").isBetween(moment(a,"DD/MM/YYYY"),moment(b,"DD/MM/YYYY"));return d},this.setLimitSearchDates=function(a){var b,c,d,e;"From"==a?(b=l.fromDate,d=l.toDate,c=moment(l.fromDate,"DD/MM/YYYY").add(globalSettings.Account_BetSearch_MonthLimit,"month").format("DD/MM/YYYY"),moment(d,"DD/MM/YYYY").isBefore(b,"DD/MM/YYYY")&&(l.toDate=b,d=b),e=l.isBetweenDates(b,c,d),e||(l.toDate=c),l.toDate=moment(c,"DD/MM/YYYY").isAfter(moment())?moment().format("DD/MM/YYYY"):c):(c=l.toDate,d=l.fromDate,b=moment(l.toDate,"DD/MM/YYYY").subtract(globalSettings.Account_BetSearch_MonthLimit,"month").format("DD/MM/YYYY"),moment(d,"DD/MM/YYYY").isAfter(c,"DD/MM/YYYY")&&(l.fromDate=c,d=c),e=l.isBetweenDates(b,c,d),e||(l.fromDate=b))},this.searchColumns=[{title:"",class:"center"},{title:locale.account.betSearch.coupon},{title:locale.common.date,class:"center"},{title:locale.account.betSearch.dateOfResult,class:"center"},{title:locale.account.betSearch.amount,class:"right"},{title:locale.account.betSearch.result,class:"center"},{title:locale.account.betSearch.winning,class:"right"},{title:locale.common.user,class:"center"}],this.searchResults=[],this.loading=!1,this.stringSort=function(a,b){return a.trim()<b.trim()?-1:a.trim()>b.trim()?1:0},this.parseUserListRecord=function(a){return l.AllUsers=k.createAllUsersRecord(a),k.parseUserListRecord(a)},this.onPeriodChanged=function(){newRange=k.handlePeriodChange(l.period),newRange[0]&&(l.fromDate=newRange[0]),newRange[1]&&(l.toDate=newRange[1])},this.isAgentsPage=function(){return d.absUrl().indexOf(globalSettings.CurrentLanguage+"/agents")>-1},this.resetForm=function(){l.agent=m.userID,l.couponCode="",l.outcome=null,l.period=1,l.fromDate=moment().subtract(7,"day").format("DD/MM/YYYY"),l.toDate=moment().format("DD/MM/YYYY"),l.filterBySettlement=!1},this.openCouponDetails=function(){var c=$("#searchResults").dataTable().api().row(this).data();if(c){var d=c[1],e=o.filter(function(a){if(a.CouponCode===d)return a})[0].ExternalUserId;switch(f.current.name){case"agentsBetSearchVirtuals":f.go("agentsBetSearchVirtualsCouponDetails",{couponCode:d+","+e});break;case"shopBetSearchVirtuals":f.go("shopBetSearchVirtualsCouponDetails",{couponCode:d+","+e});break;default:f.go("accountBetSearchVirtualsCouponDetails",{couponCode:d+","+e})}a.$apply(),b.showLoader()}},this.isTableInitialized=function(){return $.fn.DataTable.isDataTable($("#searchResults"))},this.getDTLocaleUrl=function(){return k.getDTLocaleUrl()},this.searchBets=function(){1!=l.loading&&(g.setSearchParams({period:parseInt(l.period),fromDate:l.fromDate,toDate:l.toDate,couponCode:l.couponCode,outcome:l.outcome,filterBySettlement:l.filterBySettlement,agent:l.agent,user:null==l.user?m.userID:l.user}),l.searchResults=[],o=[],b.showLoader(),l.loading=!0,g.searchBets().then(function(a){if(a.success){var d=a.data.Data;angular.copy(d,o);for(var f=0,h=0,i=0;i<d.length;i++){var j=d[i];f+=j.Stake,null!=j.Won&&j.Won>0&&(h+=j.Won),l.searchResults.push(g.parseRecord(j))}l.isTableInitialized()&&$("#searchResults").dataTable().api().destroy(),$("#searchResults").dataTable({dom:'<"top"if>rt<"bottom"pl><"clear">',oLanguage:{sLengthMenu:"Rows per page _MENU_"},data:l.searchResults,columns:l.searchColumns,pageLength:10,order:[[2,"desc"]],bSort:!1,stateSave:!0,stateSaveCallback:function(a,b){c.betSearchSettings=JSON.stringify(b)},stateLoadCallback:function(){if(c.betSearchSettings)return JSON.parse(c.betSearchSettings)},language:{url:l.getDTLocaleUrl()},footerCallback:function(){var a=this.api();$(a.column(3).footer()).html('<span style="font-weight:bold;">'+locale.common.total+"</span>"),$(a.column(4).footer()).html(e("currencyFormat")(f,2)),$(a.column(5).footer()).html('<span style="font-weight:bold;">'+locale.common.total+"</span>"),$(a.column(6).footer()).html(e("currencyFormat")(h,2))},drawCallback:function(){$("#searchResults tbody tr td:not(.rebet)").off("click"),$("#searchResults tbody tr td:not(.rebet)").on("click",l.openCouponDetails),globalSettings.Sports_EnableRebet&&globalSettings.Sports_EnableRebetInBetList&&($("#searchResults tbody tr td.rebet button").off("click"),$("#searchResults tbody tr td.rebet button").on("click",l.rebetCoupon))}})}else console.error("Error occurred while searching for bets: "+JSON.stringify(a.error));l.loading=!1,b.hideLoader()}))},this.searchBets(),h.getAgentType(h.getUserData().userType)!=h.agentTypes.masterAgent&&h.getAgentType(h.getUserData().userType)!=h.agentTypes.superAgent||(l.showAgentLabel=!0),h.isAgent()&&h.getAgentType(h.getUserData().userType)!=h.agentTypes.cashier){if(!j.success||!j.data)return void i.logError("Unable to get user agents: "+JSON.stringify(j.error));l.descendantsList=l.parseUserListRecord(j.data),l.descendantsList.sort(function(a,b){var c=a.FirstName.toUpperCase(),d=b.FirstName.toUpperCase();return c<d?-1:c>d?1:0}),l.descendantsList.splice(0,0,l.AllUsers)}}])}(),function(){var a=angular.module("authenticatedCouponDetailsVirtuals",[]);a.controller("CouponDetailsVirtualsController",["$scope","$rootScope","$window","$location","$localStorage","$q","couponService","cashoutService","helperService","$filter","authService","betSearchVirtualsService","$uiRouterGlobals","$state","sportsApiService","platformApiService","loggingService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=this;m.params.couponCode.split(",")[0];this.couponDetailsTitle=locale.account.betSearch.couponDetailsVirtuals,this.couponDetailsIcon="fa-vimeo",this.isVirtuals=!0,this.userData=k.getUserData(),this.userLoggedIn=k.hasValidLogin(),this.currencySymbol=this.userData?this.userData.currency.CurrencySymbol:"",this.showPrintBtn=!1,this.winningsImageData=null,this.winningsImageTable=null,this.goBack=function(){switch(n.current.name){case"accountBetSearchVirtualsCouponDetails":n.go("accountBetSearchVirtuals",{});break;case"agentsBetSearchVirtualsCouponDetails":n.go("agentsBetSearchVirtuals",{});break;case"shopBetSearchVirtualsCouponDetails":n.go("shopBetSearchVirtuals",{})}},this.parseCouponDetails=function(a){return a.MaxPotentialWin=j("currencyFormat")(a.MaxWin+a.MaxBonus,2),a.Stake=j("currencyFormat")(a.Stake,2),a.MinBonus=j("currencyFormat")(a.MinBonus,2),a.MaxBonus=j("currencyFormat")(a.MaxBonus,2),a.MinWin=j("currencyFormat")(a.MinWin,2),a.MaxWin=j("currencyFormat")(a.MaxWin,2),a.Winnings=a.Won?j("currencyFormat")(a.Won,2):"",a.CombinationGroups=$(a.Groupings).each(function(a,b){var c=j("currencyFormat")(b.Combinations*b.Stake.toFixed(3),2);b.StakeTxt=b.Combinations+" X "+b.Stake.toFixed(3)+" = "+c,b.MinBonus=j("currencyFormat")(b.MinBonus,2),b.MaxBonus=j("currencyFormat")(b.MaxBonus,2),b.MinWin=j("currencyFormat")(b.MinWin,2),b.MaxWin=j("currencyFormat")(b.MaxWin,2)}),1==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.running:2==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.negative:3==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.positive:4==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.cancelled:5==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.couponStatus.partialWon:a.StatusTxt=locale.account.betSearch.unknown,a.RebetEnabled=!1,a.showPayOrCancelButton=!1,a},this.parseOdd=function(a){var b="";switch(a.IDGrandFather){case 3604053:b="Italiano";break;case 5:b="Live";break;case 2:b="League";break;case 1:b="Liga"}var c=""===b?a.IDEvent:a.IDEvent+" ("+b+")",d=a.EventDate,e=a.EventName+" ("+locale.sports.events.eventOdds.week+" "+a.RoundNumber+")",f=a.MarketName,g=a.SelectionName;g+=1==a.OnlyRegularTime?" "+locale.sports.coupon.combinationSet.onlyRegularTimeShort:"";var h=null!=a.OddValue?a.OddValue.toFixed(2).toString():"-",i=r.parseResult(a),j=a.FixedOdd?"B":"";globalSettings.SiteContentURL+"/images/couponDetails/";return{IDEvent:c,eventDate:d,eventName:e,marketName:f,selectionName:g,oddValue:h,result:i[0],isBanker:j,resultImgColor:i[1].length>0?'<span class="image-result '+i[1]+' "><span></span><span></span></span>':"",allResults:i[2],showAllResults:i[3],purchasedShares:100*a.PurchasedShares,markup:a.Markup}},this.parseResult=function(a){var b="",c="";a.Win==-1?(b=locale.account.betSearch.legendBlue,c="blue"):0==a.Win?(b=locale.account.betSearch.legendRed,c="red"):1==a.Win?(b=locale.account.betSearch.legendGreen,c="green"):3==a.Win?(b=locale.account.betSearch.legendBlueRed,c="blue_red"):4==a.Win?(b=locale.account.betSearch.legendBlueGreen,c="blue_green"):a.Win===-2&&(b=locale.account.betSearch.legendBrown,c="brown");var d="",e=!1,f="";try{if("Unset"!=a.Result){var g="";if(a.Results.length>1){g=a.Results[0].Value+" - "+a.Results[1].Value;for(var h=0,i=0;i<a.Results.length;i+=2)f+='<div class="rowContainer"><div class="divHeader">'+a.Results[i].Family+'</div><div class="divContent">'+a.Results[i].Value+"-"+a.Results[i+1].Value+"</div></div>",h++;h>1?e=!0:f="",d=2==a.IDSport||3==a.IDSport||9==a.IDSport||11==a.IDSport||13==a.IDSport||14==a.IDSport||17==a.IDSport||19==a.IDSport||20==a.IDSport||22==a.IDSport||28==a.IDSport||83==a.IDSport?g:1==a.IDSport||6==a.IDSport||12==a.IDSport||29==a.IDSport||59==a.IDSport||252==a.IDSport||253==a.IDSport||254==a.IDSport?a.Results.length>3?g+"</br>("+a.Results[2].Value+" - "+a.Results[3].Value+")":g+"</br>("+a.Results[0].Value+" - "+a.Results[1].Value+")":4==a.IDSport||16==a.IDSport||60==a.IDSport?g+"</br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+", "+a.Results[6].Value+" - "+a.Results[7].Value+")":26==a.IDSport?g+"</br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+", "+a.Results[6].Value+" - "+a.Results[7].Value+", "+a.Results[8].Value+" - "+a.Results[9].Value+")":5==a.IDSport||23==a.IDSport?a.Results.length>11?g+"</br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+", "+a.Results[6].Value+" - "+a.Results[7].Value+", "+a.Results[8].Value+" - "+a.Results[9].Value+", "+a.Results[10].Value+" - "+a.Results[11].Value+")":a.Results.length>7?g+"</br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+", "+a.Results[6].Value+" - "+a.Results[7].Value+")":g+"</br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+")":b}else d=b}}catch(a){d=b}return[d,c,f,e]},this.copyToClipboard=function(a){var b=$(a.currentTarget),c=$("<input>");$("body").append(c),c.val(b.text().trim()).select(),document.execCommand("copy"),c.remove()},this.isTableInitialized=function(a){return $.fn.DataTable.isDataTable($(a))},this.init=function(){b.showLoader(),this.eventListData=null,o.virtuals.getCouponByCode(m.params.couponCode).then(function(a){b.hideLoader();var c=null;if(!a.success)return q.logError("Unable to get coupon details: "+JSON.stringify(a.error)),void r.goBack();if(null==a.data||null==a.data.CouponCode)return void r.goBack();c=a.data,r.couponDetails=r.parseCouponDetails(c);for(var d=[],e=0;e<c.Odds.length;e++)d.push(r.parseOdd(c.Odds[e]));r.eventListData=d})},r.init(),a.$watch(function(){return k.hasValidLogin()},function(a,b){r.userLoggedIn=a}),a.$on("onRepeatLast",function(a,b,c){"couponEventList"==c.onLastRepeat&&(r.isTableInitialized("#couponEvents")&&$("#couponEvents").dataTable().api().destroy(),$("#couponEvents").DataTable({ordering:!1,paging:!1,searching:!1,info:!1})),"couponIframeCombinationList"==c.onLastRepeat&&(r.isTableInitialized("#couponCombinations")&&$("#couponCombinations").dataTable().api().destroy(),$("#couponCombinations").DataTable({ordering:!1,paging:!1,searching:!1,info:!1}))})}])}(),legendTitles={running:"running",systemEvaluation:"system-evaluation",positive:"winning",partialWon:"partial-won",negative:"lost",cancelled:"cancelled",cashout:"cashout",reopened:"reopened",refused:"refused",userEvaluation:"user-evaluation",unknown:"unknown",promotion:"promotion",reopened:"reopened"},parseLegendTitle=function(a){return"<i class='coupon-status-icon coupon-status-icon-"+a+"'></i>"},function(){angular.module("authenticatedBetSearch",[]).factory("betSearchService",["$q","$sessionStorage","platformApiService","$filter","authService",function(a,b,c,d,e){return{getSearchParams:function(){return b.betSearchParams?b.betSearchParams:{}},setSearchParams:function(a){b.betSearchParams=a},searchBets:function(){var d=a.defer();b.betSearchParams||d.reject("No search parameters found");var e=b.betSearchParams,f=moment(e.fromDate,"DD/MM/YYYY").format(),g=moment(e.toDate,"DD/MM/YYYY").hours(23).minutes(59).seconds(59).milliseconds(999).format(),h=(e.user==-1||0==e.user,e.couponCode?e.couponCode:""),i=null,j=e.filterBySettlement;i=e.user==-1||0==e.user?e.agent:e.user;var k={Parameters:[{ParameterName:"CouponCode",ParameterValue:h},{ParameterName:"ExternalUserId",ParameterValue:i},{ParameterName:"BrandId",ParameterValue:globalSettings.BrandID},{ParameterName:"CouponStatusId",ParameterValue:e.outcome},{ParameterName:"FromDate",ParameterValue:f},{ParameterName:"ToDate",ParameterValue:g},{ParameterName:"SearchBySettlementDate",ParameterValue:j},{ParameterName:"IncludeUsers",ParameterValue:!0}]};return k.Parameters.forEach(function(a,b){"CouponCode"===a.ParameterName&&_.isEmpty(a.ParameterValue)&&k.Parameters.splice(b,1),"CouponStatusId"===a.ParameterName&&0==a.ParameterValue&&k.Parameters.splice(b,1)}),c.report.getSqlReports(k).then(function(a){d.resolve(a)}),d.promise},parseLegendTitle:function(a){return parseLegendTitle(a)},parseRecord:function(a){var b=(e.getUserData().currency.CurrencySymbol,a.IsLive?"L":""),c=a.CouponCode,f=d("currencyFormat")(a.Stake,2),g=a.UserName||"-",h="-";if(null!=a.CouponDate&&""!=a.CouponDate){var i=new Date(a.CouponDate);h=moment(i).format("DD/MM/YYYY, HH:mm:ss")}var j="-";if(null!=a.PaymentDate&&""!=a.PaymentDate){var i=new Date(a.PaymentDate);j=moment(i).format("DD/MM/YYYY, HH:mm:ss")}var k="-",l=0;k=null!=a.BetFinalState?a.BetFinalState==-1?this.parseLegendTitle(legendTitles.running):0==a.BetFinalState?this.parseLegendTitle(legendTitles.systemEvaluation):1==a.BetFinalState?this.parseLegendTitle(legendTitles.positive):2==a.BetFinalState?this.parseLegendTitle(legendTitles.partialWon):3==a.BetFinalState?this.parseLegendTitle(legendTitles.negative):4==a.BetFinalState?a.Won?this.parseLegendTitle(legendTitles.voided):this.parseLegendTitle(legendTitles.cancelled):5==a.BetFinalState?this.parseLegendTitle(legendTitles.cashout):6==a.BetFinalState?this.parseLegendTitle(legendTitles.promotion):this.parseLegendTitle(legendTitles.unknown):1==a.CouponStatusId?this.parseLegendTitle(legendTitles.running):2==a.CouponStatusId?this.parseLegendTitle(legendTitles.negative):3==a.CouponStatusId?this.parseLegendTitle(legendTitles.positive):4==a.CouponStatusId?this.parseLegendTitle(legendTitles.cancelled):5==a.CouponStatusId?this.parseLegendTitle(legendTitles.systemEvaluation):6==a.CouponStatusId?this.parseLegendTitle(legendTitles.refused):7==a.CouponStatusId?this.parseLegendTitle(legendTitles.userEvaluation):8==a.CouponStatusId?this.parseLegendTitle(legendTitles.reopened):this.parseLegendTitle(legendTitles.unknown),a.Won&&a.Won>0&&(l=a.Won),l=d("currencyFormat")(l,2);var m="";a.IsAgentSettled&&(m='<i class="fa fa-check-circle betPaid"></i>');var n=a.Remark||"-",o=a.RemarkDate?moment(a.RemarkDate).format("DD/MM/YYYY, HH:mm:ss"):"-";if(globalSettings.Sports_EnableRebet&&globalSettings.Sports_EnableRebetInBetList){var p='<button class="btn btn-rebet" data-couponcode="'+a.CouponCode+'"><i class="fa fa-refresh"></i> <span>'+locale.sports.coupon.combinationSet.rebet+"</span></button>";return this.agentPayCouponPermission(e.getUserData().userType)?[b,c,h,j,f,k,l,m,p,g,n,o]:[b,c,h,j,f,k,l,p,g,n,o]}return this.agentPayCouponPermission(e.getUserData().userType)?[b,c,h,j,f,k,l,m,g,n,o]:[b,c,h,j,f,k,l,g,n,o]},agentPayCouponPermission:function(a){if(""==globalSettings.AgentPayCouponUserTypes)return!1;var b=globalSettings.AgentPayCouponUserTypes.split(","),c=$.grep(b,function(b){return b==a});return c.length>0}}}]).controller("BetSearchController",["$scope","$rootScope","$sessionStorage","$localStorage","$location","$filter","$state","betSearchService","authService","sportsApiService","loggingService","helperService","getDescendantsList","betSearchHelpersService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=this;$.fn.dataTable.moment("DD/MM/YYYY, HH:mm:ss");var p=i.getUserData(),q=h.getSearchParams(),r=[];this.betSearchTitle=locale.account.userAreaMenu.betSearchTitle,this.betSearchIcon="fa-list",this.isAgent=i.isAgent(),this.showAgentLabel=!1,this.descendantsList=[],o.AllUsers,this.outcomeList=[{value:null,description:locale.common.all},{value:1,description:locale.account.betSearch.outcomeOptions.placed},{value:2,description:locale.account.betSearch.outcomeOptions.losers},{value:3,description:locale.account.betSearch.outcomeOptions.winnings},{value:4,description:locale.account.betSearch.outcomeOptions.cancelled}],this.agent=p.userID,this.couponCode=q.couponCode||"",this.user=null,this.outcome=+q.outcome||null,this.period=q.period||1,this.fromDate=q.fromDate||moment().subtract(7,"day").format("DD/MM/YYYY"),this.toDate=q.toDate||moment().format("DD/MM/YYYY"),this.filterBySettlement=q.filterBySettlement||!1,this.minDate=moment().startOf("year").year(2005).toDate(),this.maxDate=moment().toDate(),this.rebetCoupon=function(a){b.showLoader(),j.coupon.rebetCoupon(a,globalSettings.CurrentLanguage).then(function(a){b.hideLoader(),a.success?(d.couponData=a.data.BetCoupon,d.couponLocalId=(new Date).getTime().toString().substring(3)+""+Math.floor(100*Math.random()+1),window.top.location.href="/sports"):k.logError("Unable to rebet this coupon")})},this.isBetweenDates=function(a,b,c){if(moment(c,"DD/MM/YYYY").isSame(moment(a,"DD/MM/YYYY"))||moment(c,"DD/MM/YYYY").isSame(moment(b,"DD/MM/YYYY")))return!0;var d=moment(c,"DD/MM/YYYY").isBetween(moment(a,"DD/MM/YYYY"),moment(b,"DD/MM/YYYY"));return d},this.setLimitSearchDates=function(a){var b,c,d,e;"From"==a?(b=o.fromDate,d=o.toDate,c=moment(o.fromDate,"DD/MM/YYYY").add(globalSettings.Account_BetSearch_MonthLimit,"month").format("DD/MM/YYYY"),moment(d,"DD/MM/YYYY").isBefore(b,"DD/MM/YYYY")&&(o.toDate=b,d=b),e=o.isBetweenDates(b,c,d),e||(o.toDate=c),o.toDate=moment(c,"DD/MM/YYYY").isAfter(moment())?moment().format("DD/MM/YYYY"):c):(c=o.toDate,d=o.fromDate,b=moment(o.toDate,"DD/MM/YYYY").subtract(globalSettings.Account_BetSearch_MonthLimit,"month").format("DD/MM/YYYY"),moment(d,"DD/MM/YYYY").isAfter(c,"DD/MM/YYYY")&&(o.fromDate=c,d=c),e=o.isBetweenDates(b,c,d),e||(o.fromDate=b))},this.searchColumns=[{title:"",class:"center"},{title:locale.account.betSearch.coupon},{title:locale.common.date,class:"center"},{title:locale.account.betSearch.dateOfResult,class:"center"},{title:locale.account.betSearch.amount,class:"right"},{title:locale.account.betSearch.result,class:"center"},{title:locale.account.betSearch.winning,class:"right"},{title:locale.common.user,class:"center"},{title:locale.account.betSearch.remark,class:"center"},{title:locale.account.betSearch.remarkDate,class:"center"}];var s=7;if(h.agentPayCouponPermission(i.getUserData().userType)&&(this.searchColumns.splice(7,0,{title:locale.account.betSearch.paid,class:"center"}),s=8),globalSettings.Sports_EnableRebet&&globalSettings.Sports_EnableRebetInBetList&&this.searchColumns.splice(s,0,{title:"",class:"center rebet"}),this.searchResults=[],this.loading=!1,this.stringSort=function(a,b){return a.trim()<b.trim()?-1:a.trim()>b.trim()?1:0},this.parseUserListRecord=function(a){return o.AllUsers=n.createAllUsersRecord(a),n.parseUserListRecord(a)},this.onPeriodChanged=function(){newRange=n.handlePeriodChange(o.period),newRange[0]&&(o.fromDate=newRange[0]),newRange[1]&&(o.toDate=newRange[1])},this.isAgentsPage=function(){return e.absUrl().indexOf(globalSettings.CurrentLanguage+"/agents")>-1},this.resetForm=function(){o.agent=p.userID,o.couponCode="",o.outcome=null,o.period=1,o.fromDate=moment().subtract(7,"day").format("DD/MM/YYYY"),o.toDate=moment().format("DD/MM/YYYY"),o.filterBySettlement=!1},this.rebetCoupon=function(){var a=$("#searchResults").dataTable().api().row(this).selector.rows;if(a){var c=a.attributes[1].value;b.showLoader(),j.coupon.rebetCoupon(c,globalSettings.CurrentLanguage).then(function(a){b.hideLoader(),a.success&&null!=a.data.BetCoupon?(d.couponData=a.data.BetCoupon,d.couponLocalId=(new Date).getTime().toString().substring(3)+""+Math.floor(100*Math.random()+1),window.location.href="/sports"):13==a.data.ResponseStatus?l.showErrorMessage(locale.account.betSearch.rebetExpired).done():1==a.data.ResponseStatus?l.showErrorMessage(locale.account.betSearch.rebetNotFound).done():l.showErrorMessage(locale.account.betSearch.unableToRebet).done()})}},this.openCouponDetails=function(){var c=$("#searchResults").dataTable().api().row(this).data();if(c){var d=c[1],e=r.filter(function(a){if(a.CouponCode===d)return a})[0].ExternalUserId;switch(g.current.name){case"agentsBetSearch":g.go("agentsBetSearchCouponDetails",{couponCode:d+","+e});break;case"shopBetSearch":g.go("shopBetSearchCouponDetails",{couponCode:d+","+e});break;default:a.isPokerShares?g.go("accountBetSearchCouponDetails",{couponCode:d+","+e,pokerpool:c[10]}):g.go("accountBetSearchCouponDetails",{couponCode:d+","+e})}a.$apply(),b.showLoader()}},this.isTableInitialized=function(){return $.fn.DataTable.isDataTable($("#searchResults"))},this.getDTLocaleUrl=function(){return n.getDTLocaleUrl()},this.searchBets=function(){1!=o.loading&&(h.setSearchParams({period:parseInt(o.period),fromDate:o.fromDate,toDate:o.toDate,couponCode:o.couponCode,outcome:o.outcome,filterBySettlement:o.filterBySettlement,agent:o.agent,user:null==o.user?p.userID:o.user}),o.searchResults=[],r=[],b.showLoader(),o.loading=!0,h.searchBets().then(function(a){if(a.success){var d=a.data.Data;angular.copy(d,r);for(var e=0,g=0,i=0;i<d.length;i++){var j=d[i];e+=j.Stake,null!=j.Won&&j.Won>0&&(g+=j.Won),o.searchResults.push(h.parseRecord(j))}o.isTableInitialized()&&$("#searchResults").dataTable().api().destroy(),$("#searchResults").dataTable({dom:'<"top"if>rt<"bottom"pl><"clear">',oLanguage:{sLengthMenu:"Rows per page _MENU_"},data:o.searchResults,columns:o.searchColumns,pageLength:10,order:[[2,"desc"]],bSort:!1,stateSave:!0,stateSaveCallback:function(a,b){c.betSearchSettings=JSON.stringify(b)},stateLoadCallback:function(){if(c.betSearchSettings)return JSON.parse(c.betSearchSettings)},language:{url:o.getDTLocaleUrl()},footerCallback:function(){var a=this.api();$(a.column(3).footer()).html('<span style="font-weight:bold;">'+locale.common.total+"</span>"),$(a.column(4).footer()).html(f("currencyFormat")(e,2)),$(a.column(5).footer()).html('<span style="font-weight:bold;">'+locale.common.total+"</span>"),$(a.column(6).footer()).html(f("currencyFormat")(g,2))},drawCallback:function(){$("#searchResults tbody tr td:not(.rebet)").off("click"),$("#searchResults tbody tr td:not(.rebet)").on("click",o.openCouponDetails),globalSettings.Sports_EnableRebet&&globalSettings.Sports_EnableRebetInBetList&&($("#searchResults tbody tr td.rebet button").off("click"),$("#searchResults tbody tr td.rebet button").on("click",o.rebetCoupon))}})}else console.error("Error occurred while searching for bets: "+JSON.stringify(a.error));o.loading=!1,b.hideLoader()}))},this.searchBets(),i.getAgentType(i.getUserData().userType)!=i.agentTypes.masterAgent&&i.getAgentType(i.getUserData().userType)!=i.agentTypes.superAgent||(o.showAgentLabel=!0),i.isAgent()&&i.getAgentType(i.getUserData().userType)!=i.agentTypes.cashier){if(!m.success||!m.data)return void k.logError("Unable to get user agents: "+JSON.stringify(m.error));o.descendantsList=o.parseUserListRecord(m.data),o.descendantsList.sort(function(a,b){var c=a.FirstName.toUpperCase(),d=b.FirstName.toUpperCase();return c<d?-1:c>d?1:0}),o.descendantsList.splice(0,0,o.AllUsers)}}])}(),function(){angular.module("betSearchHelpers.service",[]).service("betSearchHelpersService",["authService",function(a){return{handlePeriodChange:function(a){var b,c;switch(a){case"2":b=moment().format("DD/MM/YYYY"),c=moment().format("DD/MM/YYYY");break;case"3":b=moment().startOf("isoWeek").format("DD/MM/YYYY"),c=moment().endOf("isoWeek").format("DD/MM/YYYY");break;case"4":b=moment().startOf("month").format("DD/MM/YYYY"),c=moment().endOf("month").format("DD/MM/YYYY");break;case"5":b=moment().subtract(1,"day").format("DD/MM/YYYY"),c=moment().subtract(1,"day").format("DD/MM/YYYY");break;case"6":b=moment().subtract(1,"week").startOf("isoWeek").format("DD/MM/YYYY"),c=moment().subtract(1,"week").endOf("isoWeek").format("DD/MM/YYYY");break;case"7":b=moment().subtract(1,"month").startOf("month").format("DD/MM/YYYY"),c=moment().subtract(1,"month").endOf("month").format("DD/MM/YYYY");break;default:b=void 0,c=void 0}return[b,c]},parseUserListRecord:function(b){var c=[];if(b.HasChildren)for(var d=0;d<b.Children.length;d++){var e=b.Children[d],f={FirstName:e.Name,LastName:e.Surname,UserName:e.Username,ID:e.TpsUserId,IDUser:" ["+e.TpsUserId+"] ",Type:a.getAgentType(e.UserTypeCode)};c.push(f)}return c},createAllUsersRecord:function(a){return{ID:a.TpsUserId,FirstName:"All users"}},getDTLocaleUrl:function(){var a="//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/";switch(globalSettings.CurrentLanguage){case"es":return a+"Spanish.json";case"it":return a+"Italian.json";case"pt":return a+"Portuguese-Brasil.json";case"ro":return a+"Romanian.json";default:return a+"English.json"}}}}])}(),function(){var a=angular.module("authenticatedCouponDetails",[]);a.controller("CouponDetailsController",["$scope","$rootScope","$window","$location","$timeout","$localStorage","$q","couponService","cashoutService","helperService","$filter","authService","betSearchService","$uiRouterGlobals","$state","sportsApiService","platformApiService","loggingService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=this,t=n.params.couponCode.split(",")[0];if(this.couponDetailsTitle=locale.account.betSearch.couponDetails,this.couponDetailsIcon="fa-list",this.isVirtuals=!1,this.userData=l.getUserData(),this.userLoggedIn=l.hasValidLogin(),this.currencySymbol=this.userData?this.userData.currency.CurrencySymbol:"",this.cashoutRequested=i.isInPendingList(null,t),this.cashoutData=null,this.cashoutInProgress=!1,this.cashoutRefreshInProgress=!1,this.allowCashout=!0,this.allowStyledCashout=!1,this.winningsImageData=null,this.winningsImageTable=null,null!=globalSettings.Sports_CashOutBlackList&&l.isAgent()){var u=_.map(globalSettings.Sports_CashOutBlackList.split(","),$.trim);_.includes(u,l.getUserData().userType)&&(s.allowCashout=!1,s.allowStyledCashout=!0)}this.showPrintBtn=null!=l.getUserData()&&l.getUserData().isAgent,this.isPrinted=!1,this.goBack=function(){switch(o.current.name){case"accountBetSearchCouponDetails":o.go("accountBetSearch",{});break;case"agentsBetSearchCouponDetails":o.go("agentsBetSearch",{});break;case"shopBetSearchCouponDetails":o.go("shopBetSearch",{});break;case"accountStatementSearchCouponDetails":o.go("accountStatementSearch",{});break;case"shopStatementSearchCouponDetails":o.go("shopStatementSearch",{})}},this.parseCouponDetails=function(a){return a.HasMaxWithholdingTax=a.MaxWithholdingTax>0,a.HasMinWithholdingTax=a.MinWithholdingTax>0,a.HasBonus=a.MaxBonus>0,a.HasTurnoverTax=a.TurnoverTax>0,a.MaxPotentialWin=k("currencyFormat")(a.NetStakeMaxWin+a.MaxBonus,2),a.StakeCombinationTxt=a.HasTurnoverTax?a.StakeGross.toFixed(2)+" - "+a.TurnoverTax.toFixed(2)+" = "+k("currencyFormat")(a.Stake,2):k("currencyFormat")(a.StakeGross,2),a.StakeNet=k("currencyFormat")(a.Stake,2),a.Stake=k("currencyFormat")(a.StakeGross,2),a.TurnoverTax=a.HasTurnoverTax?k("currencyFormat")(a.TurnoverTax,2):0,a.MinBonus=k("currencyFormat")(a.MinBonus,2),a.MaxBonus=k("currencyFormat")(a.MaxBonus,2),a.MinWinCombinationTxt=a.HasTurnoverTax?a.NetStakeMinWin.toFixed(2)+" - "+a.MinWithholdingTax.toFixed(2)+" = "+k("currencyFormat")(a.MinWinNet,2):k("currencyFormat")(a.MinWinNet,2),a.MinWin=k("currencyFormat")(a.MinWin,2),a.NetStakeMinWin=k("currencyFormat")(a.NetStakeMinWin,2),a.MinWinNet=k("currencyFormat")(a.MinWinNet,2),a.MinWithholdingTax=a.HasMinWithholdingTax?k("currencyFormat")(a.MinWithholdingTax,2):0,a.MaxWinCombinationTxt=a.HasTurnoverTax?a.NetStakeMaxWin.toFixed(2)+" - "+a.MaxWithholdingTax.toFixed(2)+" = "+k("currencyFormat")(a.MaxWinNet,2):k("currencyFormat")(a.MaxWinNet,2),a.MaxWin=k("currencyFormat")(a.MaxWin,2),a.NetStakeMaxWin=k("currencyFormat")(a.NetStakeMaxWin,2),a.MaxWinNet=k("currencyFormat")(a.MaxWinNet,2),a.MaxWithholdingTax=a.HasMaxWithholdingTax?k("currencyFormat")(a.MaxWithholdingTax,2):0,a.TotalTaxedTxt=k("currencyFormat")(a.TotalTaxed,2),a.WinningsCombinationTxt=a.Won?a.TotalTaxed>0?k("currencyFormat")(a.Won,2)+"(Tax: "+a.TotalTaxedTxt+")":k("currencyFormat")(a.Won,2):"-",a.Winnings=a.Won?k("currencyFormat")(a.Won,2):"-",a.CombinationGroups=$(a.Groupings).each(function(a,b){var c=k("currencyFormat")(b.Combinations*b.Stake.toFixed(3),2);b.StakeTxt=b.Combinations+" X "+b.Stake.toFixed(2)+" = "+c,b.MinBonus=k("currencyFormat")(b.MinBonus,2),b.MaxBonus=k("currencyFormat")(b.MaxBonus,2),b.MinWin=k("currencyFormat")(b.NetStakeMinWin,2),b.MaxWin=k("currencyFormat")(b.NetStakeMaxWin,2)}),null!=a.BetFinalState?a.BetFinalState==-1?a.StatusTxt=locale.account.betSearch.running:0==a.BetFinalState?a.StatusTxt=locale.account.betSearch.systemEvaluation:1==a.BetFinalState?a.StatusTxt=locale.account.betSearch.positive:2==a.BetFinalState?a.StatusTxt=locale.account.betSearch.couponStatus.partialWon:3==a.BetFinalState?a.StatusTxt=locale.account.betSearch.negative:4==a.BetFinalState?a.Won?a.StatusTxt=locale.account.betSearch.couponStatus.voided:a.StatusTxt=locale.account.betSearch.couponStatus.cancelled:5==a.BetFinalState?a.StatusTxt=locale.account.betSearch.couponStatus.cashout:6==a.BetFinalState?a.StatusTxt=locale.account.betSearch.couponStatus.promotion:a.StatusTxt=locale.account.betSearch.unknown:1==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.running:2==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.negative:3==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.positive:4==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.cancelled:5==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.systemEvaluation:6==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.refused:7==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.userEvaluation:8==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.reopened:a.StatusTxt=locale.account.betSearch.unknown,
s.showPrintBtn=!(1!=a.CouponStatusId||!s.showPrintBtn),a.RebetEnabled=!1,globalSettings.Sports_EnableRebet&&$(a.Odds).each(function(b,c){if("Unset"==c.Result)return a.RebetEnabled=!0,!1}),a.showPayOrCancelButton=!0,(1!=m.agentPayCouponPermission(s.userData.userType)||null==a.Won||parseFloat(a.Won)<=0||3!=a.CouponStatusId&&4!=a.CouponStatusId&&6!=a.CouponStatusId)&&(a.showPayOrCancelButton=!1),a},this.parseOdd=function(a){var b=""==a.OnLineCode||null==a.OnLineCode?"--":a.OnLineCode,c=a.IDEvent,d="L"==a.EventCategory?"L":"",e=a.EventDate,f=a.SportName;f+=null!=a.CategoryName?" - "+a.CategoryName:"",f+=" - "+a.Championship,f+=" - "+a.EventName;var g=a.MarketName,h=a.SelectionName;h+=1==a.OnlyRegularTime?" "+locale.sports.coupon.combinationSet.onlyRegularTimeShort:"";var i=a.OddValue?a.OddValue.toFixed(2).toString():"-",j=a.UnboostedOddValue?a.UnboostedOddValue.toFixed(2).toString():"-",k=s.parseResult(a),l=a.FixedOdd?"B":"";globalSettings.SiteContentURL+"/images/couponDetails/";return{onLineCode:b,IDEvent:c,isLive:d,eventDate:e,eventName:f,marketName:g,selectionName:h,oddValue:i,unboostedOddValue:j,result:k[0],isBanker:l,resultImgColor:k[1].length>0?'<span class="image-result '+k[1]+' "><span></span><span></span></span>':"",allResults:k[2],showAllResults:k[3],purchasedShares:100*a.PurchasedShares,markup:a.Markup}},this.parseResult=function(a){var b="",c="";a.Win==-1?(b=locale.account.betSearch.legendBlue,c="blue"):0==a.Win?(b=locale.account.betSearch.legendRed,c="red"):1==a.Win?(b=locale.account.betSearch.legendGreen,c="green"):3==a.Win?(b=locale.account.betSearch.legendBlueRed,c="blue_red"):4==a.Win?(b=locale.account.betSearch.legendBlueGreen,c="blue_green"):a.Win==-2&&(b=locale.account.betSearch.legendRunning,c="running");var d="",e=!1,f="";try{if("Unset"!=a.Result){var g="";if(a.Results.length>1){g=a.Results[0].Value+" - "+a.Results[1].Value;for(var h=0,i=0;i<a.Results.length;i+=2)f+='<div class="rowContainer"><div class="divHeader">'+a.Results[i].Family+'</div><div class="divContent">'+a.Results[i].Value+"-"+a.Results[i+1].Value+"</div></div>",h++;h>1?e=!0:f="",d=2==a.IDSport||3==a.IDSport||9==a.IDSport||11==a.IDSport||13==a.IDSport||14==a.IDSport||17==a.IDSport||19==a.IDSport||20==a.IDSport||22==a.IDSport||28==a.IDSport||83==a.IDSport?g:1==a.IDSport||6==a.IDSport||12==a.IDSport||29==a.IDSport||59==a.IDSport||252==a.IDSport||253==a.IDSport||254==a.IDSport?a.Results.length>3?g+"</br>("+a.Results[2].Value+" - "+a.Results[3].Value+")":g+"</br>("+a.Results[0].Value+" - "+a.Results[1].Value+")":4==a.IDSport||16==a.IDSport||60==a.IDSport?g+"</br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+", "+a.Results[6].Value+" - "+a.Results[7].Value+")":26==a.IDSport?g+"</br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+", "+a.Results[6].Value+" - "+a.Results[7].Value+", "+a.Results[8].Value+" - "+a.Results[9].Value+")":5==a.IDSport||23==a.IDSport?a.Results.length>11?g+"</br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+", "+a.Results[6].Value+" - "+a.Results[7].Value+", "+a.Results[8].Value+" - "+a.Results[9].Value+", "+a.Results[10].Value+" - "+a.Results[11].Value+")":a.Results.length>7?g+"</br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+", "+a.Results[6].Value+" - "+a.Results[7].Value+")":g+"</br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+")":b}else d=b}}catch(a){d=b}return[d,c,f,e]},this.copyToClipboard=function(a){var b=$(a.currentTarget),c=$("<input>");$("body").append(c),c.val(b.text().trim()).select(),document.execCommand("copy"),c.remove()},this.printCoupon=function(a){s.isPrinted||(s.isPrinted=!0,e(function(){s.isPrinted=!1}.bind(this),4e3),globalSettings.Sports_PrintCouponCopy&&null==localStorage.couponCopy?showCopyConfirmationDialog(url):h.printCoupon(a,s.couponDetails.UserId,!1))},this.rebetCoupon=function(a){b.showLoader(),p.coupon.rebetCoupon(a,globalSettings.CurrentLanguage).then(function(a){b.hideLoader(),a.success&&(f.couponData=a.data.BetCoupon,f.couponLocalId=(new Date).getTime().toString().substring(3)+""+Math.floor(100*Math.random()+1),window.location.href="/sports")})},this.expandCoupon=function(a){c.open("/expand-coupon?couponCode="+a,"_blank","height=700,width=1100,scrollbars=yes,status=no,toolbar=no,menubar=no,location=no")},this.payOrCancelBet=function(a,c){b.showLoader(),p.coupon.payOrCancelCoupon(a,c,s.couponDetails.UserId).then(function(a){if(b.hideLoader(),1==a.data.ResponseStatus){var d=locale.account.betSearch.cancelledPayment;c&&(d=locale.account.betSearch.betPaid),j.showSuccessMessage(d).done(),p.coupon.getCouponByCode(n.params.couponCode,globalSettings.CurrentLanguage).then(function(a){s.couponDetails=s.parseCouponDetails(a.data)})}else j.showErrorMessage(locale.sports.coupon.statusCode[a.data.ResponseStatus]).done()})},this.settleBet=function(a){b.showLoader(),s.couponDetails.awaitingSettlement=!0,q.gamingVendors.sportsbook.cashoutCoupon(a,"").then(function(a){return b.hideLoader(),s.couponDetails.awaitingSettlement=!1,a.success?(j.showSuccessMessage(a.userMsg).done(),void p.coupon.getCouponByCode(n.params.couponCode,globalSettings.CurrentLanguage).then(function(a){s.couponDetails=s.parseCouponDetails(a.data)})):void r.logError("Unable to settle bet: "+a.error,a.userMsg)})},this.parseGetCouponResponse=function(a){var b=null;if(!a.success)return r.logError("Unable to get coupon details: "+JSON.stringify(a.error)),void s.goBack();if(null==a.data||null==a.data.CouponCode)return q.gamingVendors.sportsbook.checkCouponRefundStatus(n.params.couponCode).then(function(a){a.success?a.data.IsRefunded?j.showInfoMessage(locale.sports.coupon.verifyCoupon.couponRefunded).done():j.showInfoMessage(locale.sports.coupon.verifyCoupon.couponInReview).done():j.showErrorMessage(locale.sports.coupon.verifyCoupon.couponNotFound).done()}),void s.goBack();b=a.data,s.couponDetails=s.parseCouponDetails(b);for(var c=[],d=0;d<b.Odds.length;d++)c.push(s.parseOdd(b.Odds[d]));s.eventListData=c},this.parseCashoutValueResponse=function(a){s.cashoutData=a,s.cashoutRefreshInProgress=!1,311===a.responseCode&&(s.allowCashout=!1)},this.onRefreshCashoutClicked=function(a){s.cashoutRequested=i.isInPendingList(null,a),s.cashoutRequested||s.cashoutRefreshInProgress||(s.cashoutRefreshInProgress=!0,i.getCashoutValue(a).then(s.parseCashoutValueResponse))},this.onCashoutClicked=function(a){if(s.cashoutRequested=i.isInPendingList(null,a),!s.cashoutRequested&&globalSettings.Sports_EnableCashOut&&null!=s.cashoutData&&s.cashoutData.cashoutAvailable&&s.allowCashout){if(!s.userLoggedIn)return void j.showErrorMessage(locale.common.cashout.loginRequired).done();var b=s.cashoutData.tax>0?locale.common.cashout.cashoutValue+": <br>"+s.cashoutData.displayValue+" ("+locale.sports.coupon.couponOdds.tax+": "+s.cashoutData.displayTax+") = "+s.cashoutData.displayNetValue:locale.common.cashout.cashoutValue+": "+s.cashoutData.displayValue;j.showInfoMessage(b,null,!0,locale.common.cancel,!0,locale.common.proceed).then(function(){s.cashoutInProgress=!0,i.cashout([s.cashoutData.serverData],s.couponDetails.UserId).then(function(a){return s.cashoutInProgress=!1,a.success?(a.cashoutAccepted||j.showInfoMessage(a.userMessage).done(),void(s.cashoutData=null)):(304==a.responseCode&&(s.cashoutData.value=a.value,s.cashoutData.displayValue=a.displayValue,s.cashoutData.currency=a.currency),void j.showErrorMessage(a.userMessage).done())})}).done()}},this.isTableInitialized=function(a){return $.fn.DataTable.isDataTable($(a))},b.showLoader(),this.eventListData=null,this.pokerpool=!1,a.isPokerShares&&"true"==n.params.pokerpool?(this.pokerpool=!0,p.coupon.getPokerCouponByCode(n.params.couponCode,globalSettings.CurrentLanguage).then(function(a){var c=null;if(!a.success)return r.logError("Unable to get coupon details: "+JSON.stringify(a.error)),b.hideLoader(),void s.goBack();if(null==a.data||null==a.data.CouponCode)return b.hideLoader(),void s.goBack();c=a.data,s.couponDetails=s.parseCouponDetails(c);for(var d=[],e=0;e<c.Odds.length;e++)d.push(s.parseOdd(c.Odds[e]));s.eventListData=d,b.hideLoader()})):p.coupon.getCouponByCode(n.params.couponCode,globalSettings.CurrentLanguage).then(function(a){b.hideLoader(),s.parseGetCouponResponse(a),globalSettings.Sports_EnableCashOut&&!s.cashoutRequested&&a.data.BetFinalState==-1&&i.getCashoutValue(t).then(function(a){s.parseCashoutValueResponse(a)})}),a.$watch(function(){return l.hasValidLogin()},function(a,b){s.userLoggedIn=a}),a.$on("onRepeatLast",function(a,b,c){"couponEventList"==c.onLastRepeat&&(s.isTableInitialized("#couponEvents")&&$("#couponEvents").dataTable().api().destroy(),$("#couponEvents").DataTable({ordering:!1,paging:!1,searching:!1,info:!1})),"couponIframeCombinationList"==c.onLastRepeat&&(s.isTableInitialized("#couponCombinations")&&$("#couponCombinations").dataTable().api().destroy(),$("#couponCombinations").DataTable({ordering:!1,paging:!1,searching:!1,info:!1}))}),a.$on("cashoutService:cashoutRejected:"+t,function(a,b){s.cashoutRequested=!1,i.getCashoutValue(t).then(s.parseCashoutValueResponse)}),a.$on("cashoutService:pendingListUpdated",function(a){s.cashoutRequested=i.isInPendingList(null,t)})}])}(),legendTitles={running:"running",systemEvaluation:"system-evaluation",positive:"winning",partialWon:"partial-won",negative:"lost",voided:"voided",cancelled:"cancelled",cashout:"cashout",reopened:"reopened",refused:"refused",userEvaluation:"user-evaluation",unknown:"unknown",promotion:"promotion",reopened:"reopened"},parseLegendTitle=function(a){return"<i class='coupon-status-icon coupon-status-icon-"+a+"'></i>"},function(){angular.module("authenticatedChangePassword",[]).controller("ChangePasswordController",["$scope","$rootScope","$state","authService","platformApiService","helperService","loggingService",function(a,b,c,d,e,f,g){var h=this,i=e.security;this.currentPassword="",this.newPassword="",this.confirmNewPassword="",this.Password={Min:6,Max:15},this.validationErrorPassword=null,this.validatePassword=function(){var b={Password:h.newPassword};i.validatePassword(b).then(function(b){return b.success?(h.validationErrorPassword=null,void a.ChangePasswordForm.NewPassword.$setValidity("invalidPasswordServer",!0)):(g.logError(b.error),h.validationErrorPassword=null!=b.Result&&b.Result.length>0?b.Result[0]:b.userMsg,void a.ChangePasswordForm.NewPassword.$setValidity("invalidPasswordServer",!1))})},this.submitForm=function(){var a={CurrentPassword:h.currentPassword,NewPassword:h.newPassword};i.postChangePassword(a).then(function(a){if(!a.success){var c=f.handlePlatformError(a);return c||f.showErrorMessage(a.userMsg).done(),void g.logError("Unable to change password: "+a.error,a.userMsg)}f.showSuccessMessage("Password Changed").done();var e=d.getUserData().userName,i="PCHANG"==d.getUserStatus()?"/":null;d.clearUserData(),b.$broadcast("loginRequest",e,h.newPassword,i)})}}])}(),function(){angular.module("authenticatedChangePhoneNumber",[]).controller("ChangePhoneNumberController",["$scope","$rootScope","$window","$q","platformApiService","helperService","$timeout","loggingService","authService",function(a,b,c,d,e,f,g,h,i){var j=this;if(!globalSettings.Account_MobileEditability||i.hasVerifyAccountData()&&"Verified"==i.getVerifyAccountData().type)return void(window.location.href="/");var k=e.user,l=e.security;a.forms={},this.userData=null,this.phoneVerification=!1,this.alreadyRegistered=!1,this.completeCallback,this.limitExceeded=!1,this.changePhoneNumberOption="none",this.registeredOnMultipleAccounts=!1,this.currentMobileNumber=null,this.mobileExtension="+"+globalSettings.Account_LoginPrefix,this.mobile=null,this.verifyData=i.getVerifyAccountData(),this.getCurrentMobileNumber=function(){k.getCurrentUserProfile().then(function(a){if(a.success){j.userData=a.data;var b=null;a.data.PhoneContactDetails.length||(a.data.PhoneContactDetails[0]={PhoneContactTypeCode:"MB",Id:0,ContactNumber:null});for(var c=0;c<a.data.PhoneContactDetails.length;c++)"MB"==a.data.PhoneContactDetails[c].PhoneContactTypeCode&&(b=a.data.PhoneContactDetails[c]);null!=b&&(j.currentMobileNumber=b.ContactNumber)}})},this.cleanMobileNumber=function(a){return f.cleanMobileNumber(a)},this.validationErrorMobileNumber=null,this.onUserTypeValidateMobileNumber=function(a){var b=d.defer();if(j.mobile&&""!==j.mobile){var c={PhoneContactTypeCode:"MB",Prefix:j.mobileExtension,Number:f.cleanMobileNumber(j.mobile)};return j.registeredOnMultipleAccounts=!1,l.validateMobileNumber(c).then(function(c){return c.success?(j.validationErrorMobileNumber=null,j.registeredOnMultipleAccounts=!1,a&&a.txtMobile&&a.txtMobile.$setValidity("invalidMobileNumberServer",!0),void b.resolve(!0)):(j.registeredOnMultipleAccounts=!1,20215===c.responseCode?(h.logError(c.error),j.validationErrorMobileNumber=null!=c.result&&c.result.length>0?c.result[0]:c.userMsg,a&&a.txtMobile&&a.txtMobile.$setValidity("invalidMobileNumberServer",!1),b.resolve(!1)):20214===c.responseCode||20216===c.responseCode?(j.validationErrorMobileNumber=null,j.registeredOnMultipleAccounts=!0,a&&a.txtMobile&&a.txtMobile.$setValidity("invalidMobileNumberServer",!0),b.resolve(!0)):(h.logError(c.error),j.validationErrorMobileNumber=null!=c.result&&c.result.length>0?c.result[0]:c.userMsg,a&&a.txtMobile&&a.txtMobile.$setValidity("invalidMobileNumberServer",!1),b.resolve(!1)),b.promise)}),b.promise}},this.getChangePhoneNumberOption=function(){globalSettings.General_EnableOTPbySms&&(b.showLoader(".change-phone-number-wrapper",null,0),l.getChangePhoneNumberOption().then(function(a){b.hideLoader(".change-phone-number-wrapper"),j.changePhoneNumberOption=a.data}))},this.onInit=function(){j.getChangePhoneNumberOption(),j.getCurrentMobileNumber()},j.onInit(),this.resetForm=function(){j.onInit()},this.backToChangePhoneNumber=function(){j.alreadyRegistered=!1},this.submitForm=function(){var a=j.mobileExtension+f.cleanMobileNumber(j.mobile);j.currentMobileNumber!=a?j.onUserTypeValidateMobileNumber().then(function(b){b&&j.performChecks(function(){j.alreadyRegistered=!1;for(var b=!1,c=0;c<j.userData.PhoneContactDetails.length;c++)"HM"==j.userData.PhoneContactDetails[c].PhoneContactTypeCode?null!=j.userData.PhoneContactDetails[c].ContactNumber&&""!=j.userData.PhoneContactDetails[c].ContactNumber||(b=!0):"MB"==j.userData.PhoneContactDetails[c].PhoneContactTypeCode&&(j.userData.PhoneContactDetails[c].ContactNumber=a);b&&(j.userData.PhoneContactDetails=j.userData.PhoneContactDetails.filter(function(a){return"HM"!=a.PhoneContactTypeCode}));var d="",e="";j.limitExceeded=!1,k.updateCurrentUserProfile(j.userData).then(function(a){if(a.success)d+=locale.account.phoneNumber.phoneNumberUpdated;else{if(20805!=a.responseCode){for(var b=0;b<a.Result.length;b++)e+=a.Result[b],b<a.Result.length-1&&(e+="<br/><br/>");return void f.showErrorMessage(e).done()}j.limitExceeded=!0}"BySms"===j.changePhoneNumberOption?j.phoneVerification=!0:f.showSuccessMessage(d).done()})})}):(errorMsg=locale.account.phoneVerification.popup.samePhoneNumber,f.showErrorMessage(errorMsg).done())},this.performChecks=function(a){j.registeredOnMultipleAccounts?(j.completeCallback=a,j.alreadyRegistered=!0):a()}}])}(),function(){angular.module("authenticatedEditProfile",[]).controller("EditProfileController",["$scope","$rootScope","$q","platformApiService","helperService","loggingService","authService",function(a,b,c,d,e,f,g){function h(a){var b=Math.floor(a/60),c=a-60*b,d=b?b+"h ":"";return d+(c?c+"m":"")}function i(a,b){var c=a.Name?a.Name.toUpperCase():a.DisplayName.toUpperCase(),d=b.Name?b.Name.toUpperCase():b.DisplayName.toUpperCase();return c<d?-1:c>d?1:0}function j(){var a=(new Date).getYear()-18,b=$.map($(Array(a+1)),function(a,b){return b+1900}),c=$.map($(Array(12)),function(a,b){return b+1}),d=$.map($(Array(31)),function(a,b){return b+1});l.years=b,l.days=d,l.months=c}function k(a){switch(globalSettings.Account_Editability.toUpperCase()){case"ALWAYS":return!0;case"ONE-TIME":return""===a||null===a||void 0===a;case"OFF":default:return!1}}var l=this,m=d.user,n=d.location,o=d.security,p=d.gamingVendors;this.jsonSecurityQuestion=[{Id:"FATHERFNAME",Name:"Father's first name"},{Id:"MOTHERNAME",Name:"Mother's maiden name"},{Id:"PETNAME",Name:"Name of your pet"},{Id:"BIRTHPLACE",Name:"Place of birth"},{Id:"FRSTCARTYPE",Name:"Type of your first car"}],this.userData=null,this.registrationCountries=[],this.countries=[],this.states=[],this.provinces=[],this.cities=[],this.citizenshipStates=[],this.citizenshipProvinces=[],this.citizenshipCities=[],this.telephoneExtensions=[],this.siteDiscoveryMethods=[],this.emailLanguages=[],this.securityQuestions=[],this.currencies=[],this.depositLimitPeriods=[],this.isProfileInfoUpdated=!1,this.isWinningNotificationUpdated=!1,this.firstName="",this.lastName="",this.gender=null,this.country=null,this.state=null,this.province=null,this.city=null,this.town="",this.address="",this.postalCode="N/A",this.dateOfBirth=null,this.citizenship=null,this.citizenshipState=null,this.citizenshipProvince=null,this.citizenshipCity=null,this.taxCode="",this.titleCode="",this.selectedYear=null,this.selectedMonth=null,this.selectedDay=null,this.email="",this.telephone=null,this.mobile=null,this.emailLanguage=null,this.username="",this.securityQuestion=null,this.securityAnswer="",this.currency=null,this.promoCode="",this.refCode="",this.bannerTag="",this.sessionTimeout,this.sessionTimeoutSliderOptions={floor:10,ceil:240,step:10,showSelectionBar:!1,translate:h},this.realityCheckTimeout,this.realityCheckSliderOptions={floor:10,ceil:60,step:5,disabled:!1,showSelectionBar:!1,translate:h},this.depositLimitGoalsOriginal=null,this.depositLimitGoals=null,this.receiveEmails=!1,this.winNotificationSetting=!1,this.EnableResponsibleGaming=globalSettings.EnableResponsibleGaming,b.showLoader(),this.goToChangePhoneNumber=function(){g.isAgent()?$state.go("shopChangePhoneNumber"):$state.go("accountChangePhoneNumber")},this.checkFieldValueChange=function(a){"winNotificationSetting"!==a?l.isProfileInfoUpdated=!0:l.isWinningNotificationUpdated=!0},this.init=function(){j();var d=[o.getRegistrationCountries().then(function(a){a.data.sort(i),l.registrationCountries=a.data}),n.getAllCountries().then(function(a){a.data.sort(i),l.countries=a.data}),o.getEmailLanguages().then(function(a){a.data.sort(i),l.emailLanguages=a.data}),o.getSecurityQuestions().then(function(a){null===a.data[0].Name?l.securityQuestions=l.jsonSecurityQuestion:(a.data.sort(i),l.securityQuestions=a.data)}),o.getRegistrationCurrencies().then(function(a){a.data.sort(i),l.currencies=a.data})];globalSettings.Account_EnableWinNotificationSetting&&d.push(p.sportsbook.getWinNotificationSetting().then(function(a){l.winNotificationSetting=a.data.IsEnabled})),globalSettings.EnableRealityCheck&&d.push(m.getRealityCheckTimeoutLimits().then(function(a){a.success&&(l.realityCheckSliderOptions.floor=a.data.Minimum,l.realityCheckSliderOptions.ceil=a.data.Maximum,l.realityCheckTimeout=a.data.Default)})),globalSettings.EnableSessionTimeout&&d.push(m.getSessionTimeoutLimits().then(function(a){l.sessionTimeoutSliderOptions.floor=a.data.Minimum,l.sessionTimeoutSliderOptions.ceil=a.data.Maximum,l.sessionTimeout=a.data.Default})),c.all(d).then(function(){m.getCurrentUserProfile().then(function(c){if(b.hideLoader(),!c.success)return void f.logError("Unable to get user profile details: "+c.error);l.userData=c.data;var d=c.data.UserDetails,e=c.data.SecurityDetails,g=null,h=null,j=null,k=null;0===c.data.UserAddressDetails.length&&(c.data.UserAddressDetails[0]={AddressTypeCode:"MAIN",Id:0,City:null,CountryCode:null,Line1:null,Line2:null,PostalCode:null,Province:null,Region:null,Village:null});for(var m=0;m<c.data.UserAddressDetails.length;m++)"MAIN"==c.data.UserAddressDetails[m].AddressTypeCode?g=c.data.UserAddressDetails[m]:"BIRTH"==c.data.UserAddressDetails[m].AddressTypeCode&&(h=c.data.UserAddressDetails[m]);c.data.PhoneContactDetails.length||(c.data.PhoneContactDetails[0]={PhoneContactTypeCode:"HM",Id:0,ContactNumber:null},c.data.PhoneContactDetails[1]={PhoneContactTypeCode:"MB",Id:0,ContactNumber:null});for(var m=0;m<c.data.PhoneContactDetails.length;m++)"HM"==c.data.PhoneContactDetails[m].PhoneContactTypeCode?j=c.data.PhoneContactDetails[m]:"MB"==c.data.PhoneContactDetails[m].PhoneContactTypeCode&&(k=c.data.PhoneContactDetails[m]);l.username=d.Username,l.email=d.Email,l.firstName=d.Name,l.lastName=d.Surname,l.gender=d.GenderCode,l.dateOfBirth=null==d.BirthDate?null:moment(d.BirthDate,"YYYY-MM-DD").toDate(),l.emailLanguage=d.LanguageCode.toLowerCase(),l.currency=d.Currency,l.titleCode=d.TitleCode,l.securityQuestion=e.SecurityQuestionCode,l.securityAnswer=e.SecurityAnswer,null!=g&&(l.country=g.CountryCode,l.state=g.Region,l.province=g.Province,l.town="ITA"==l.country?g.City:null,l.city="ITA"==l.country?null:g.City,l.address=g.Line1,l.postalCode=g.PostalCode),null!=h&&(l.citizenship=h.CountryCode,l.citizenshipState=h.Region,l.citizenshipProvince=h.Province,l.citizenshipCity=h.City),null!=j&&(l.telephone=j.ContactNumber),null!=k&&(l.mobile=k.ContactNumber);for(var m=0;m<c.data.ExtraDetails.length;m++)if("ReferenceCode"==c.data.ExtraDetails[m].PropertyName)l.refCode=c.data.ExtraDetails[m].PropertyValue;else if("PromotionalCode"==c.data.ExtraDetails[m].PropertyName)l.promoCode=c.data.ExtraDetails[m].PropertyValue;else if("BannerTag"==c.data.ExtraDetails[m].PropertyName)l.bannerTag=c.data.ExtraDetails[m].PropertyValue||"",l.userData.ExtraDetails[m].PropertyValue=l.bannerTag;else if("SSNumber"==c.data.ExtraDetails[m].PropertyName)l.taxCode=c.data.ExtraDetails[m].PropertyValue;else if("ReceiveMarketingMessages"==c.data.ExtraDetails[m].PropertyName)l.receiveEmails="true"==c.data.ExtraDetails[m].PropertyValue;else if("RealityCheckTimeout"==c.data.ExtraDetails[m].PropertyName){var o=c.data.ExtraDetails[m].PropertyValue==-1;l.realityCheckSliderOptions.disabled=o,l.realityCheckTimeout=o?l.realityCheckSliderOptions.ceil:c.data.ExtraDetails[m].PropertyValue}else"SessionTimeout"==c.data.ExtraDetails[m].PropertyName&&(l.sessionTimeout=c.data.ExtraDetails[m].PropertyValue);l.country&&l.state&&n.getStateCities(l.country,l.state).then(function(a){a.data.sort(i),l.cities=a.data}),l.country&&n.getCountryStates(l.country).then(function(a){a.data.sort(i),l.states=a.data}),a.$broadcast("rzSliderForceRender")})})},this.init(),this.onCountryChanged=function(){l.citizenship=l.country,l.cities=[],l.states=[],l.state=null,l.province=null,l.city=null,l.getStatesForCountry(l.country)},this.getStatesForCountry=function(a){l.states=[],n.getCountryStates(a).then(function(a){a.data.sort(i),l.states=a.data})},this.onStateChanged=function(){l.cities=[],l.city="",l.getCitiesForCountryAndState(l.country,l.state)},this.getCitiesForCountryAndState=function(a,b){l.cities=[],n.getStateCities(a,b).then(function(a){a.data.sort(i),l.cities=a.data})},this.formItemEditability_UserDetails=function(a){return!(!l.userData||!("Name"!==a&&"Surname"!==a||("Name"===a||"Surname"===a)&&globalSettings.Account_NameSurnameEditability))&&k("GenderCode"===a&&"U"===l.userData.UserDetails[a]?void 0:l.userData.UserDetails[a])},this.formItemEditability_UserAddress=function(a){return!!l.userData&&k(l.userData.UserAddressDetails[l.userData.UserAddressDetails.length-1][a])},this.formItemEditability_UserTelephone=function(){if(l.userData){var a=l.userData.PhoneContactDetails.find(function(a){return"HM"===a.PhoneContactTypeCode});return k(a?a.ContactNumber:void 0)}return!1},this.resetForm=function(){l.init()},this.updateCurrentUserProfile=function(a){var b=c.defer();return m.updateCurrentUserProfile(a).then(function(a){return a.success?void b.resolve(a):(f.logError("Unable to update current User Profile: "+a.error),void b.resolve(a))}),b.promise},this.updateWinNotificationSetting=function(a){var b=c.defer();return p.sportsbook.setWinNotificationSetting(a).then(function(a){return a.success?void b.resolve(a):(f.logError("Unable to update Win Notification Setting: "+a.error),void b.resolve(a))}),b.promise},this.submitForm=function(){!l.realityCheckSliderOptions.disabled&&l.realityCheckTimeout>l.sessionTimeout&&e.showErrorMessage("Session timeout must be greeter or equal to Reality check").done();var a=[];if(l.isProfileInfoUpdated){var b=angular.copy(l.userData);b.UserDetails.BirthDate=l.selectedDay&&l.selectedMonth&&l.selectedYear?l.selectedYear+"-"+l.selectedMonth+"-"+l.selectedDay:l.dateOfBirth,b.UserDetails.Email=l.email,b.UserDetails.Surname=l.lastName,b.UserDetails.Name=l.firstName,b.UserDetails.GenderCode=l.gender,b.UserDetails.LanguageCode=l.emailLanguage,b.UserDetails.CountryCode=l.country,b.SecurityDetails.SecurityQuestionCode=l.securityQuestion?l.securityQuestion:"QST1",b.SecurityDetails.SecurityAnswer=l.securityAnswer?l.securityAnswer:"Not Provided";for(var d=0;d<b.UserAddressDetails.length;d++)if("MAIN"==b.UserAddressDetails[d].AddressTypeCode){b.UserAddressDetails[d].CountryCode=l.country,b.UserAddressDetails[d].Region=l.state,b.UserAddressDetails[d].Province=l.province,b.UserAddressDetails[d].City=l.city,b.UserAddressDetails[d].Line1=l.address,b.UserAddressDetails[d].PostalCode=l.postalCode;break}if(null!=l.telephone&&""!=l.telephone){var f=b.PhoneContactDetails.findIndex(function(a){return"HM"===a.PhoneContactTypeCode});f<0?b.PhoneContactDetails.push({ContactNumber:l.telephone,PhoneContactTypeCode:"HM",PhoneContactTypeDescription:"Home"}):b.PhoneContactDetails[f].ContactNumber=l.telephone}else b.PhoneContactDetails=b.PhoneContactDetails.filter(function(a){return"HM"!=a.PhoneContactTypeCode});if(l.mobile){var g=b.PhoneContactDetails.findIndex(function(a){return"MB"===a.PhoneContactTypeCode});g<0?b.PhoneContactDetails.push({ContactNumber:l.mobile,PhoneContactTypeCode:"MB",PhoneContactTypeDescription:"Mobile"}):b.PhoneContactDetails[g].ContactNumber=l.mobile}var h=_.findIndex(b.ExtraDetails,function(a){return"RealityCheckTimeout"===a.PropertyName});h>-1&&(b.ExtraDetails[h].PropertyValue=l.realityCheckSliderOptions.disabled?-1:l.realityCheckTimeout),h=_.findIndex(b.ExtraDetails,function(a){return"SessionTimeout"===a.PropertyName}),h>-1&&(b.ExtraDetails[h].PropertyValue=l.sessionTimeout),h=_.findIndex(b.ExtraDetails,function(a){return"ReceiveMarketingMessages"===a.PropertyName}),h>-1&&(b.ExtraDetails[h].PropertyValue=l.receiveEmails),a.push(l.updateCurrentUserProfile(b))}var i="",j="";if(globalSettings.Account_EnableWinNotificationSetting&&l.isWinningNotificationUpdated){var k={Enable:l.winNotificationSetting};a.push(l.updateWinNotificationSetting(k))}c.all(a).then(function(a){var c=a[0];if(!c.success)for(var d=0;d<c.Result.length;d++)j+=c.Result[d],d<c.Result.length-1&&(j+="<br/><br/>");if(globalSettings.Account_EnableWinNotificationSetting&&l.isWinningNotificationUpdated){var f={};if(f=l.isProfileInfoUpdated?a[1]:a[0],f.success)i+=l.isProfileInfoUpdated?locale.account.userProfile.profileUpdated:locale.account.userProfile.winningNotificationUpdated;else for(var d=0;d<f.Result.length;d++)j+=f.Result[d],d<f.Result.length-1&&(j+="<br/><br/>")}else i+=locale.account.userProfile.profileUpdated;l.isProfileInfoUpdated=!1,l.isWinningNotificationUpdated=!1,""!=i&&(e.showSuccessMessage(i).done(),l.isProfileInfoUpdated&&(l.userData=b,l.dateOfBirth=new Date(b.UserDetails.BirthDate))),""!=j&&e.showErrorMessage(j).done()})}}])}(),function(){angular.module("authenticatedFundTransfer",[]).controller("FundTransferController",["$uiRouterGlobals","$state","$location","$localStorage",function(a,b,c,d){var e=this;this.selectedTabId=null,this.tabsData=[{id:"interAccount",title:locale.account.fundTransfer.interAccountTab,html:"interAccount.html"},{id:"interAccountNew",title:locale.account.fundTransfer.interAccountNewTab,html:"interAccountNew.html"}],this.onClick=function(a){d.fundTransferTab=a,e.redirectTo(a)},this.redirectTo=function(a){e.selectedTabId!==a&&(e.selectedTabId=a),b.go("shopTransferType",{transferType:a})},this.init=function(){var b=a.params.transferType;if(b)e.selectedTabId=b;else{var c=d.fundTransferTab;c?e.redirectTo(c):e.onClick(e.tabsData[0].id)}},e.init()}])}(),function(){angular.module("authenticatedInterAccount",[]).controller("InterAccountController",["$scope","$rootScope","$sessionStorage","$state","$filter","platformApiService","authService","helperService","loggingService",function(a,b,c,d,e,f,g,h,i){var j=this,k=f.finance;f.user;this.users=[],this.inputPattern="es"==globalSettings.CurrentLanguage||"it"==globalSettings.CurrentLanguage?"[0-9]+([,][0-9]{1,2})?":"[0-9]+([.][0-9]{1,2})?",this.user=null,this.transferType=0,this.statusType="active",this.amount=null,this.userBalances=null,this.totalUserBalance=0,this.userCreditBalance=null,this.getTransferCandidates=function(){j.users=[];var a="";a="active"==j.statusType?"ACT|PCHANG":"INACT|UNCONF|CONF|SUSP|BLOCK|CLSD";var b=!0,c=!1,d=!1;k.getTransferCandidates(a,b,c,d).then(function(a){if(!a.success)return void i.logError("Error occurred while getting transfer candidates: "+a.error,a.userMsg);for(var b=0;b<a.data.length;b++)j.users.push(j.parseRecord(a.data[b]));j.users.sort(firstBy(function(a,b){return j.stringSort(a.name,b.name)}).thenBy(function(a,b){return j.stringSort(a.surname,b.surname)}).thenBy(function(a,b){return a.userId-b.userId}).thenBy(function(a,b){return j.stringSort(a.type,b.type)}).thenBy(function(a,b){return a.balance-b.balance})),j.users.length>0&&(j.user=j.users[0],j.onUserChanged())})},this.stringSort=function(a,b){return a.trim()<b.trim()?-1:a.trim()>b.trim()?1:0},this.onUserChanged=function(){if(j.userBalances=null,j.totalUserBalance=0,j.userCreditBalance=null,null!=j.user){k.getSubAccountBalance(j.user.userId).then(function(a){if(!a.success)return void i.logError("Error occurred while getting sub agent user balance: "+a.error);var b=a.data;angular.forEach(b,function(a){a.Name=a.Name.replace(" Account","");for(var b in locale.account.cashier.accounts){var c=a.Name[0].toLowerCase()+a.Name.slice(1);b===c&&(a.Name=locale.account.cashier.accounts[b])}}),j.userBalances=b,angular.forEach(j.userBalances,function(a){j.totalUserBalance+=parseFloat(a.Balance)})});var a=g.getAgentType(g.getUserData().userType);if(a==g.agentTypes.superAgent){var b={userId:j.user.userId};k.getCreditBalance(b).then(function(a){return a.success?void(j.userCreditBalance=a.data):void i.logError("Unable to get Credit Balance: "+a.error,a.userMsg)})}}},this.parseRecord=function(a){var b={userId:a.UserId,name:a.Name,surname:a.Surname,username:a.Username,amount:a.Balance,balance:e("currencyFormat")(a.Balance,2)};return b.displayText=b.name+" "+b.surname+" ["+b.userId+" - "+b.username+"]  ("+b.balance+")",b},this.resetForm=function(){this.getTransferCandidates(),j.user=j.users.length>0?j.users[0]:null,j.transferType=0,j.statusType="active",j.amount=null},this.resetSelectedUser=function(){j.user=null,j.userBalances=null},this.changeStatus=function(){this.resetSelectedUser(),this.getTransferCandidates()},this.transferFunds=function(){if(null!=j.user){var a={UserId:j.user.userId,Amount:j.amount||0};0==j.transferType?k.transferTo(a).then(function(a){return a.success?(d.go(".",null,{reload:!0}),void h.showSuccessMessage(locale.account.fundTransfer.transferSuccess).done()):void i.logError("Error occurred while transferring funds to user: "+a.error,a.userMsg)}):1==j.transferType&&(null==j.userCreditBalance||a.Amount<=Math.abs(j.userCreditBalance)?k.transferFrom(a).then(function(a){return a.success?(d.go(".",null,{reload:!0}),void h.showSuccessMessage(locale.account.fundTransfer.withdrawalSuccess).done()):void i.logError("Error occurred while transferring funds from user: "+a.error,a.userMsg)}):h.showErrorMessage(locale.account.fundTransfer.notEnoughFunds).done())}else h.showErrorMessage(locale.account.fundTransfer.noUser).done()},this.getTransferCandidates()}])}(),function(){angular.module("authenticatedInterAccountNew",[]).factory("pagerService",[function(){function a(a,b,c){b=b||1,c=c||10;var d,e,f=Math.ceil(a/c);f<=10?(d=1,
e=f):b<=6?(d=1,e=10):b+4>=f?(d=f-9,e=f):(d=b-5,e=b+4);var g=(b-1)*c,h=Math.min(g+c-1,a-1),i=function(){for(var a=[d],b=d;b<e;)a.push(b+=1);return b>e?a.slice(0,-1):a};return{totalItems:a,currentPage:b,pageSize:c,totalPages:f,startPage:d,endPage:e,startIndex:g,endIndex:h,pages:i()}}var b={};return b.getPager=a,b}]).controller("InterAccountNewController",["$scope","$rootScope","$sessionStorage","$state","$compile","$filter","$q","CashierHelperFunctions","pagerService","platformApiService","authService","helperService","loggingService","$localStorage",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a){var b={UserId:a,NewPassword:x.password};z.changePassword(b).then(function(a){if(!a.success){var b=l.handlePlatformError(a);return b||l.showErrorMessage(a.userMsg).done(),void m.logError("Unable to change password:"+JSON.stringify(a.error))}l.showSuccessMessage(a.userMsg).done()}).catch(function(a){m.logError("Unable to change password: "+JSON.stringify(a)),hideLoader()})}function p(){return"string"==typeof x.loggedInUserBalance?isNaN(x.loggedInUserBalance.replace(/,/g,""))?0:parseFloat(x.loggedInUserBalance.replace(/,/g,"")):x.loggedInUserBalance}function q(a){var b=r(a);return b&&b.Balance<1e4?parseInt(b.Balance):1e4}function r(a){var b=x.fullUsersData.find(function(b){return b.UserId===a});return b||{UserId:a,Name:""}}function s(){var a=0,b=[];return _.forEach(x.users,function(a){b.push(a)}),a=_.maxBy(b,function(a){return a.amount}).amount}function t(b,c,d){var g=d?null:b.UserId;x.getAgentCreditBalance(g).then(function(g){var h=B.generateSwalMarkupIntAcc(b.Name,c,A,f("numberTruncate")(b.Balance||"0.00"),g,x.idList.length),i=e(h)(a);l.showMessageWithHtml(i,!0,locale.common.cancel,!0,locale.common.proceed,null,"cashier-sweet-alert").then(function(a){if(a){var e="All"===x.popupBalance?s():x.popupBalance||0,f="All"===x.popupBalance,h=d?{UserIds:x.selectedUsersIds,Amount:e,CapToBalance:f}:{UserId:b.UserId,Amount:e,CapToBalance:f};c?u(h,d):v(h,d,g)}}).catch(function(a){}).done()})}function u(a,b){y[b?"transferToMany":"transferTo"](a).then(function(a){return a.success?(d.go(".",null,{reload:!0}),void l.showSuccessMessage(locale.account.fundTransfer.transferSuccess).done()):void m.logError("Error occurred while transferring funds to user: "+a.error,a.userMsg)})}function v(a,b,c){null==c||a.Amount<=Math.abs(c)?y[b?"transferFromMany":"transferFrom"](a).then(function(a){return a.success?(d.go(".",null,{reload:!0}),void l.showSuccessMessage(locale.account.fundTransfer.withdrawalSuccess).done()):void m.logError("Error occurred while transferring funds from user: "+a.error,a.userMsg)}):l.showErrorMessage(locale.account.fundTransfer.notEnoughFunds).done()}function w(){x.selectedUsersIds=[];var a=[];_.forEach(x.fullUsersData,function(b){b.Checked&&a.push(b.UserId)}),x.selectedUsersIds=a}var x=this,y=j.finance,z=j.user,A=k.getUserData().currency.CurrencySymbol,B=h,C=n.interaccountTablePageSize;this.users=[],this.fullUsersData=[],this.setToTableUserData=[],this.selectedUsersIds=[],this.checkboxes=[],this.pager={},this.pageSizes=[5,10,15,25,50,75,100],this.pageSize=C?Number(C):10,this.searchText=null,this.idList=[],this.loggedInAgentType=k.getAgentType(k.getUserData().userType),this.inputPattern="es"==globalSettings.CurrentLanguage||"it"==globalSettings.CurrentLanguage?"[0-9]+([,][0-9]{1,2})?":"[0-9]+([.][0-9]{1,2})?",this.user=null,this.transferType=0,this.statusType="active",this.amount=null,this.userBalances=null,this.totalUserBalance=0,this.loggedInUserBalance=0,this.popupBalance=0,this.inputType="text",this.getTransferCandidates=function(){x.users=[],x.fullUsersData=[];var a="";a="active"==x.statusType?"ACT|PCHANG":"INACT|UNCONF|CONF|SUSP|BLOCK|CLSD";var b=!0,c=!1;j.finance.getPlaySource("web").then(function(a){x.loggedInUserBalance=f("numberTruncate")(parseFloat(+a.data[0].Balance).toFixed(2))});var d=y.getTransferCandidates(a,b,c,!1,!0),e=y.getTransferCandidates(a,b,c,!0,!1);g.all([d,e]).then(function(a){var b=a[0],c=a[1],d=[];if(!b.success||!c.success)return void m.logError("Error occurred while getting transfer candidates: "+a.error,a.userMsg);b.data.forEach(function(a){d.push(a)}),c.data.forEach(function(a){d.push(a)});for(var e=0;e<d.length;e++)x.users.push(x.parseRecord(d[e])),d[e].Checked=!1,x.fullUsersData.push(d[e]);x.users.sort(firstBy(function(a,b){return x.stringSort(a.name,b.name)}).thenBy(function(a,b){return x.stringSort(a.surname,b.surname)}).thenBy(function(a,b){return a.userId-b.userId}).thenBy(function(a,b){return x.stringSort(a.type,b.type)}).thenBy(function(a,b){return a.balance-b.balance})),x.users.length>0&&(x.user=x.users[0],x.getUserDetails()),x.setPage(1)})},this.resetSelectedUser=function(){x.user=null,x.userBalances=null},this.changeStatus=function(){this.resetSelectedUser(),this.getTransferCandidates()},this.stringSort=function(a,b){return a.trim()<b.trim()?-1:a.trim()>b.trim()?1:0},this.showUnloadAllBalances=function(){return x.loggedInAgentType!==k.agentTypes.superAgent},this.getUserDetails=function(){y.getSubAccountBalance(x.user.userId).then(function(a){if(!a.success)return void m.logError("Error occurred while getting sub agent user balance: "+a.error);var b=a.data;angular.forEach(b,function(a){a.Name=a.Name.replace(" Account","");for(var b in locale.account.cashier.accounts){var c=a.Name[0].toLowerCase()+a.Name.slice(1);b===c&&(a.Name=locale.account.cashier.accounts[b])}}),x.userBalances=b,angular.forEach(x.userBalances,function(a){x.totalUserBalance+=parseFloat(a.Balance)})})},this.getAgentCreditBalance=function(a){var b=g.defer();if(x.loggedInAgentType==k.agentTypes.superAgent&&a){var c={userId:a};y.getCreditBalance(c).then(function(a){a.success?b.resolve(a.data):(m.logError("Unable to get Credit Balance: "+a.error,a.userMsg),b.resolve())})}else b.resolve();return b.promise},this.parseRecord=function(a){var b={userId:a.UserId,name:a.Name,surname:a.Surname,username:a.Username,amount:a.Balance,balance:f("currencyFormat")(a.Balance,2)};return b.displayText=b.name+" "+b.surname+" ["+b.userId+" - "+b.username+"]  ("+b.balance+")",b},this.setPage=function(a){n.interaccountTablePageSize=x.pageSize,x.pager=i.getPager(x.fullUsersData.length,a,x.pageSize),x.page=a||10,a<1||a>x.pager.totalPages||(x.setToTableUserData=x.fullUsersData.slice(x.pager.startIndex,x.pager.endIndex+1))},a.$watch(function(){return x.searchText},function(a,b){if(null===a)return x.pager=i.getPager(x.fullUsersData.length,1,x.pageSize),void(x.setToTableUserData=x.fullUsersData.slice(x.pager.startIndex,x.pager.endIndex+1));var c=f("filter")(x.fullUsersData,a);x.pager=i.getPager(c.length,x.page,x.pageSize),x.setToTableUserData=c.slice(x.pager.startIndex,x.pager.endIndex+1)}),this.toggleCheckboxes=function(){var a=x.fullUsersData.filter(function(a){return a.Checked}),b=[];_.forEach(a,function(a){b.push(a.UserId)}),angular.copy(b,x.idList)},this.disableSelectAll=function(){var a=x.fullUsersData.filter(function(a){return a.Checked});return!x.fullUsersData.length||a.length===x.fullUsersData.length},this.disableUnselectAll=function(){var a=x.fullUsersData.filter(function(a){return a.Checked});return!x.fullUsersData.length||a.length<1},this.toggleInputType=function(){return"password"===x.inputType?x.inputType="text":x.inputType="password"},this.toggleAllCheckboxes=function(a){_.forEach(x.fullUsersData,function(b){b.Checked=a}),x.toggleCheckboxes()},this.resetPassword=function(b){x.password="";var c=x.fullUsersData.find(function(a){return a.UserId===b}),d=B.generateSwalResetPasswordIntAcc(c.UserId),f=e(d)(a);l.showMessageWithHtml(f,!0,locale.common.cancel,!0,locale.common.proceed,null,"cashier-sweet-alert").then(function(a){a&&o(b)}).catch(function(a){}).done()},this.quickFillBalance=function(a){x.popupBalance=a},this.updateBalance=function(a,b){return f("currencyFormat")(a+b,2)},this.loadUnloadBalance=function(a,b,c){c&&w(),x.popupBalance=b?k.getAgentType(k.getUserData().userType)===k.agentTypes.superAgent?0:p():q(a),t(r(a),b,c)},this.getTransferCandidates()}])}(),function(){angular.module("authenticatedManageUsers",[]).factory("manageUsersService",["$q","$sessionStorage","$filter","platformApiService","authService",function(a,b,c,d,e){var f=d.user;return{searchUsers:function(a){return f.getUserList(a)},parseRecord:function(a,b,d){null==b&&(d=0);var e=[],f=a.LastBetDate?moment(a.LastBetDate,"YYYY-MM-DDTHH:mm:ss").format("DD/MM/YYYY HH:mm:ss"):"",g={id:a.TpsUserId,userId:a.TpsUserId,name:a.Name,surname:a.Surname,username:a.Username,userType:a.UserTypeCode,credit:a.UserCredit,balance:c("currencyFormat")(a.UserBalance,2),lastBetDate:f,parent:b,indent:d,collapsed:!1};if(g.displayText=g.name+" "+g.surname+" ["+g.userId+"] ("+g.balance+")",e.push(g),a.HasChildren)for(var h=0;h<a.Children.length;h++)$.merge(e,this.parseRecord(a.Children[h],g,d+1));return e}}}]).controller("ManageUsersController",["$scope","$rootScope","$sessionStorage","$location","$state","$window","manageUsersService","authService","loggingService","helperService",function(a,b,c,d,e,f,g,h,i,j){var k=this;this.users=[],this.user=null,this.searchType=0,this.agentsOnly=!1,this.searchResults=[],this.canRegisterSubAccountPlayers=h.getCanRegisterSubAccountPlayers(),this.gridExpandFormatter=function(a,b,c,d,e){c=c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");var f="<span style='display:inline-block;height:1px;width:"+15*e.indent+"px'></span>",g=k.gridDataView.getIdxById(e.id);return k.searchResults[g+1]&&k.searchResults[g+1].indent>k.searchResults[g].indent?e.collapsed?f+"<i class='fa fa-caret-right toggle' aria-hidden='true'></i>&nbsp;"+c:f+"<i class='fa fa-caret-down toggle' aria-hidden='true'></i>&nbsp;"+c:f+"<span class='toggle'></span>&nbsp;"+c},this.gridExpandFilter=function(a){if(null!=a.parent)for(var b=a.parent;b;){if(b.collapsed)return!1;b=b.parent}return!0},this.buttonFormatter=function(a,b,c,d,e){var f="<button type='button' class='transferButton' data-userid='"+e.id+"'>"+locale.account.manageUsers.transfer+"</button>";return f},this.grid=null,this.gridDataView=null,this.gridOptions={editable:!1,forceFitColumns:!0,multiSelect:!1,showHeaderRow:!0,syncColumnCellResize:!0,autoHeight:!0},this.gridColumns=[{id:"userId",field:"userId",name:locale.account.manageUsers.id,formatter:k.gridExpandFormatter},{id:"surname",field:"surname",name:locale.account.manageUsers.surname},{id:"name",field:"name",name:locale.account.manageUsers.name},{id:"userType",field:"userType",name:locale.account.manageUsers.userType},{id:"balance",field:"balance",name:locale.account.manageUsers.balance},{id:"lastBetDate",field:"lastBetDate",name:locale.account.manageUsers.lastBet}];var l={InitialTpsUserId:h.getUserData().userID,Recursive:!0,DirectDescendantsOnly:!1,AgentsOnly:!0};g.searchUsers(l).then(function(a){if(!a.success)return void i.logError("Error occurred while searching for users: "+a.error,a.userMsg);var b=g.parseRecord(a.data);b.sort(firstBy(function(a,b){return k.stringSort(a.name,b.name)}).thenBy(function(a,b){return k.stringSort(a.surname,b.surname)}).thenBy(function(a,b){return a.userId-b.userId}).thenBy(function(a,b){return a.balance-b.balance})),k.users=b,k.user=a.data.TpsUserId}),this.stringSort=function(a,b){return a.trim()<b.trim()?-1:a.trim()>b.trim()?1:0},this.bindTransferButtons=function(){$(".transferButton").on("click",function(a){var b=$(this).data("userid");null!=b&&b.toString().trim().length!=-1&&(a.preventDefault(),e.go("agentsTransfer",{userId:b}))})},this.resetForm=function(){k.user=k.users.length>0?h.getUserData().userID:null,k.searchType=0,k.agentsOnly=!1},this.goToRegister=function(){j.goToUmbracoPage("register")},this.searchUsers=function(){var a={InitialTpsUserId:k.user||"",Recursive:0==k.searchType,DirectDescendantsOnly:1==k.searchType,AgentsOnly:k.agentsOnly};g.searchUsers(a).then(function(a){return a.success?(k.searchResults=g.parseRecord(a.data),$(".manageUsersTable").width($(".manageUsersContainer").width()-1),k.gridDataView=new Slick.Data.DataView,k.gridDataView.beginUpdate(),k.gridDataView.setItems(k.searchResults),k.gridDataView.setFilter(k.gridExpandFilter),k.gridDataView.endUpdate(),k.grid=new Slick.Grid("#searchResults",k.gridDataView,k.gridColumns,k.gridOptions),k.grid.autosizeColumns(),k.grid.onClick.subscribe(function(a,b){if($(a.target).hasClass("toggle")){var c=k.gridDataView.getItem(b.row);c&&(c.collapsed?c.collapsed=!1:c.collapsed=!0,k.gridDataView.updateItem(c.id,c)),a.stopImmediatePropagation()}}),k.gridDataView.onRowCountChanged.subscribe(function(a,b){k.grid.updateRowCount(),k.grid.render()}),k.gridDataView.onRowsChanged.subscribe(function(a,b){k.grid.invalidateRows(b.rows),k.grid.render()}),void $(window).resize(function(){$(".manageUsersTable").width($(".manageUsersContainer").width()-1),k.grid.resizeCanvas()})):void console.error("Error occurred while searching for users: "+JSON.stringify(a.error))})}}])}(),function(){angular.module("authenticatedMessageCentre",[]).factory("messageService",["$q","$sessionStorage","platformApiService","$filter",function(a,b,c,d){var e=c.user;return{getSearchParams:function(){return b.messageSearchParams?b.messageSearchParams:{}},setSearchParams:function(a){b.messageSearchParams=a},searchMessages:function(){var c=a.defer();b.messageSearchParams||c.reject("No search parameters found");var d=b.messageSearchParams,f=d.fromDate.split("/").filter(Boolean),g=[f[2],f[1],f[0]].join("-"),h=g+"T00:00:00"+moment.tz(moment.tz.guess()).format("Z"),i=d.toDate.split("/").filter(Boolean),j=[i[2],i[1],i[0]].join("-"),k=j+"T23:59:59"+moment.tz(moment.tz.guess()).format("Z"),l={from:encodeURIComponent(h),to:encodeURIComponent(k),state:d.state>-1?d.state:null,title:d.title.trim().length>0?d.title:null,rowsPerPage:999999,pageNumber:1};return e.searchMessages(l).then(function(a){c.resolve(a)}),c.promise},parseRecord:function(a){return[a.Id,a.Priority,a.State,a.MessageDirection,moment.tz(moment(a.SentOnDate).format(),moment.tz.guess()).format("DD/MM/YYYY"),moment.tz(moment(a.SentOnDate).format(),moment.tz.guess()).format("HH:mm"),a.Title]}}}]).controller("MessageController",["$scope","$rootScope","$sessionStorage","$state","$sce","messageService","authService","loggingService",function(a,b,c,d,e,f,g,h){var i=this;$.fn.dataTable.moment("DD/MM/YYYY, HH:mm:ss");var j=f.getSearchParams();this.messageStatusList=[{value:-1,description:locale.common.all},{value:0,description:locale.account.userAreaMenu.messageCenter.statusOptions.read},{value:1,description:locale.account.userAreaMenu.messageCenter.statusOptions.unread}],this.state=j.state||-1,this.title=j.title||"",this.period=j.period||1,this.fromDate=j.fromDate||moment().subtract(7,"day").format("DD/MM/YYYY"),this.toDate=j.toDate||moment().format("DD/MM/YYYY"),this.minDate=moment().startOf("year").year(2005).toDate(),this.maxDate=moment().toDate(),this.searchColumns=[{title:locale.account.userAreaMenu.messageCenter.id,class:"left"},{title:locale.account.userAreaMenu.messageCenter.priority,class:"center",render:function(a,b,c,d){var e=locale.account.shopWebsite.accountStatement.messages.priorityType[a].toLowerCase(),f=locale.account.shopWebsite.accountStatement.messages.priorityType[a];return'<i class="priority priority-'+e+'" title="'+f+'">'+("obligatory"==e?"! !":"!")+"</i>"}},{title:locale.common.status,class:"center",render:function(a,b,c,d){var e="",f=locale.account.userAreaMenu.messageCenter.statusOptions.read;return 0==a&&(e=" unRead",f=locale.account.userAreaMenu.messageCenter.statusOptions.unread),'<i class="fa fa-circle'+(0!=a?"-o":"")+e+'" title="'+f+'" aria-hidden="true"></i>'}},{title:locale.account.shopWebsite.accountStatement.messages.inOut,class:"center",render:function(a,b,c,d){if(!globalSettings.Enable2WayMessaging)return"";var e="fa-inbox",f="Operator To User";switch(a){case 0:e="fa-inbox",f="Operator to User";break;case 1:e="fa-paper-plane-o",f="User to Operator";break;case 2:e="fa-sticky-note-o",f="System to User"}return'<i class="fa '+e+'" title="'+f+'" aria-hidden="true"></i>'}},{title:locale.common.date,class:"center"},{title:locale.common.time,class:"left"},{title:locale.account.shopWebsite.accountStatement.messages.subject,class:"left"}],this.searchResults=[],this.onPeriodChanged=function(){switch(i.period){case"2":i.fromDate=moment().format("DD/MM/YYYY"),i.toDate=moment().format("DD/MM/YYYY");break;case"3":i.fromDate=moment().startOf("week").format("DD/MM/YYYY"),i.toDate=moment().endOf("week").format("DD/MM/YYYY");break;case"4":i.fromDate=moment().startOf("month").format("DD/MM/YYYY"),i.toDate=moment().endOf("month").format("DD/MM/YYYY");break;case"5":i.fromDate=moment().subtract(1,"day").format("DD/MM/YYYY"),i.toDate=moment().subtract(1,"day").format("DD/MM/YYYY");break;case"6":i.fromDate=moment().subtract(1,"week").startOf("week").format("DD/MM/YYYY"),i.toDate=moment().subtract(1,"week").endOf("week").format("DD/MM/YYYY");break;case"7":i.fromDate=moment().subtract(1,"month").startOf("month").format("DD/MM/YYYY"),i.toDate=moment().subtract(1,"month").endOf("month").format("DD/MM/YYYY")}},this.resetForm=function(){i.state=j.state||-1,i.title=j.title||"",i.period=j.period||1,i.fromDate=j.fromDate||moment().subtract(7,"day").format("DD/MM/YYYY"),i.toDate=j.toDate||moment().format("DD/MM/YYYY")},this.isTableInitialized=function(){return $.fn.DataTable.isDataTable($("#searchResults"))},this.getDTLocaleUrl=function(){var a="//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/";switch(globalSettings.CurrentLanguage){case"es":return a+"Spanish.json";case"it":return a+"Italian.json";case"pt":return a+"Portuguese-Brasil.json";case"ro":return a+"Romanian.json";default:return a+"English.json"}},this.searchMessages=function(){f.setSearchParams({period:i.period,fromDate:i.fromDate,toDate:i.toDate,state:i.state,title:i.title}),i.searchResults=[],b.showLoader(),f.searchMessages().then(function(g){if(!g.success)return h.logError("Error occurred while searching for messages: "+JSON.stringify(g.error),g.userMsg),void b.hideLoader();for(var j=g.data,k=0;k<j.Messages.length;k++)j.Messages[k].Title=e.getTrustedHtml(j.Messages[k].Title),i.searchResults.push(f.parseRecord(j.Messages[k]));i.isTableInitialized()&&$("#searchResults").dataTable().api().destroy(),$("#searchResults").dataTable({dom:'<"top"if>rt<"bottom"pl><"clear">',oLanguage:{sLengthMenu:"Rows per page _MENU_"},data:i.searchResults,columns:i.searchColumns,pageLength:10,order:[[2,"desc"]],bSort:!1,stateSave:!0,stateSaveCallback:function(a,b){c.messageSearchSettings=JSON.stringify(b)},stateLoadCallback:function(a){if(c.messageSearchSettings)return JSON.parse(c.messageSearchSettings)},language:{url:i.getDTLocaleUrl()},drawCallback:function(b){$("#searchResults").dataTable().api().column(3).visible(globalSettings.Enable2WayMessaging),$("#searchResults tbody tr").off("click"),$("#searchResults tbody tr").on("click",function(){var b=$("#searchResults").dataTable().api().row(this).data();if(b){var c="";switch(d.current.name){case"accountMessages":c="accountMessageDetails";break;case"agentsMessages":c="agentsMessageDetails";break;case"shopMessages":c="shopMessageDetails"}a.$apply(function(){d.go(c,{messageId:b[0],ret:"search"})})}})}}),b.hideLoader()})},g.hasValidLogin()&&this.searchMessages()}])}(),function(){angular.module("authenticatedMessageDetails",[]).controller("MessageDetailsController",["$q","$uiRouterGlobals","$rootScope","$scope","$state","platformApiService","authService","helperService","loggingService",function(a,b,c,d,e,f,g,h,i){var j=this,k=f.user;this.messageDetails=[],this.showReplyMessage=!1,this.message="",this.getMessageDetails=function(a){k.getMessageDetails(a).then(function(a){if(!a.success)return void console.error("Error occurred while getting message details: "+JSON.stringify(a.error));if(null==a.data)return void console.error("No message details available for message id: "+JSON.stringify(a.error));var b=!1;0==a.data.MessageDirection&&(b=!0),j.messageDetails={id:a.data.Id,dateSent:moment.tz(moment(a.data.SentOnDate).format(),moment.tz.guess()).format("DD/MM/YYYY, HH:mm:ss"),dateRead:0!==a.data.State?moment.tz(moment(a.data.ReadOnDate).format(),moment.tz.guess()).format("DD/MM/YYYY, HH:mm:ss"):moment(new Date).format("DD/MM/YYYY, HH:mm:ss"),priority:locale.account.shopWebsite.accountStatement.messages.priorityType[a.data.Priority],subject:a.data.Title,message:a.data.Contents,isOperatorToUser:0==a.data.MessageDirection},0===a.data.State&&k.markMessageAsRead(a.data.Id)})},this.goBack=function(){var a=b.params.ret;if(null!=a&&"overview"==a){var c="";switch(e.current.name){case"accountMessageDetails":c="accountMessagesOverview";break;case"agentsMessageDetails":c="agentsMessagesOverview";break;case"shopMessageDetails":c="shopMessagesOverview"}e.go(c,{})}else{var c="";switch(e.current.name){case"accountMessageDetails":c="accountMessages";break;case"agentsMessageDetails":c="agentsMessages";break;case"shopMessageDetails":c="shopMessages"}e.go(c,{})}},this.deleteMessage=function(a){var b='<div class="message-box info"><div class="icon"><i class="fa fa-info-circle"></i></div><div class="contentMessage">'+locale.account.shopWebsite.accountStatement.messages.deleteConfirmation+"</div></div>";h.showMessageWithHtml(b,!0,locale.common.no,!0,locale.common.yes).then(function(){c.showLoader(),k.deleteMessage(a).then(function(a){return a.success?void j.goBack():(i.logError("Unable to get messages: "+a.error,a.userMsg),void c.hideLoader())})},function(a){})},this.openReply=function(){j.showReplyMessage=!0},this.resetForm=function(){j.message="",j.showReplyMessage=!1},this.replyMessage=function(){var a={MessageSubject:"RE: "+j.messageDetails.subject,MessageContent:j.message,PreviousMessageId:j.messageDetails.id};k.sendMessage(a).then(function(a){return a.success?(j.resetForm(),void h.showSuccessMessage(locale.account.shopWebsite.accountStatement.messages.sentSuccess,null,!1,null,!1,null,function(){d.$apply(function(){j.goBack()})}).done()):void i.logError("Unable to send message: "+a.error,a.userMsg)})},this.init=function(){if(g.hasValidLogin()){var a=b.params.messageId;j.getMessageDetails(a)}},this.init()}])}(),function(){angular.module("authenticatedMessageOverview",[]).controller("MessageOverviewController",["$q","$rootScope","$scope","$state","$sce","platformApiService","authService","loggingService","helperService",function(a,b,c,d,e,f,g,h,i){var j=this,k=f.user;this.redirectPage=function(a,b){switch(a){case"searchmessages":var c="";switch(d.current.name){case"accountMessagesOverview":c="accountMessages";break;case"agentsMessagesOverview":c="agentsMessages";break;case"shopMessagesOverview":c="shopMessages"}d.go(c,{});break;case"newmessages":var c="";switch(d.current.name){case"accountMessagesOverview":c="accountNewMessage";break;case"agentsMessagesOverview":c="agentsNewMessage";break;case"shopMessagesOverview":c="shopNewMessage"}d.go(c,{});break;case"messagedetails":var c="";switch(d.current.name){case"accountMessagesOverview":c="accountMessageDetails";break;case"agentsMessagesOverview":c="agentsMessageDetails";break;case"shopMessagesOverview":c="shopMessageDetails"}d.go(c,{messageId:b,ret:"overview"})}},this.maxMessages=20,this.numberOfMessages=-1,this.allMessages=[],this.getAllMessages=function(){var b=a.defer();return k.getAllMessages().then(function(a){if(!a.success)return void h.logError("Unable to get messages: "+a.error,a.userMsg);var c=a.data;angular.forEach(c,function(a){switch(a.Title=e.getTrustedHtml(a.Title),a.PriorityClass=locale.account.shopWebsite.accountStatement.messages.priorityType[a.Priority].toLowerCase(),a.PriorityTitle=locale.account.shopWebsite.accountStatement.messages.priorityType[a.Priority],a.InOutClass="fa-inbox",a.InOutTitle="Operator To User",a.MessageDirection){case 0:a.InOutClass="fa-inbox",a.InOutTitle="Operator to User";break;case 1:a.InOutClass="fa-paper-plane-o",a.InOutTitle="User to Operator";break;case 2:a.InOutClass="fa-sticky-note-o",a.InOutTitle="System to User"}}),c.sort(function(a,b){return moment(b.SentOnDate)-moment(a.SentOnDate)}),j.allMessages=c.slice(0,j.maxMessages),j.numberOfMessages=j.allMessages.length,b.resolve()}),b.promise},this.deleteMessage=function(a){var c='<div class="message-box info"><div class="icon"><i class="fa fa-info-circle"></i></div><div class="contentMessage">'+locale.account.shopWebsite.accountStatement.messages.deleteConfirmation+"</div></div>";i.showMessageWithHtml(c,!0,locale.common.no,!0,locale.common.yes).then(function(){b.showLoader(),k.deleteMessage(a).then(function(a){return a.success?void j.getAllMessages().then(function(){b.hideLoader()}):(h.logError("Unable to get messages: "+a.error,a.userMsg),void b.hideLoader())})},function(a){}).done()},this.init=function(){g.hasValidLogin()&&(b.showLoader(),j.getAllMessages().then(function(){b.hideLoader()}))},this.init()}])}(),function(){angular.module("authenticatedSendNewMessage",[]).controller("SendNewMessageController",["$q","$rootScope","$scope","$state","platformApiService","authService","helperService","loggingService",function(a,b,c,d,e,f,g,h){var i=this;if(!globalSettings.Enable2WayMessaging){var j="";switch(d.current.name){case"accountNewMessage":j="accountMessagesOverview";break;case"agentsNewMessage":j="agentsMessagesOverview";break;case"shopNewMessage":j="shopMessagesOverview"}d.go(j,{})}var k=e.user;this.subject="",this.template=null,this.message="",this.messageTemplateList=[],this.getMessageTemplates=function(){k.getMessageTemplates().then(function(a){return a.success?void(a.data.length>0&&(i.messageTemplateList=a.data)):void h.logError("Unable to get message templates: "+a.error,a.userMsg)})},this.onTemplateChanged=function(){var a=$.grep(i.messageTemplateList,function(a){return a.Code==i.template});a.length>0&&(i.subject=a[0].Subject,i.message=a[0].Content)},this.resetForm=function(){i.template=null,i.subject="",i.message=""},this.sendMessage=function(){var a={MessageSubject:i.subject,MessageContent:i.message};k.sendMessage(a).then(function(a){return a.success?(i.resetForm(),void g.showSuccessMessage(locale.account.shopWebsite.accountStatement.messages.sentSuccess,null,!1,null,!1,null,function(){c.$apply(function(){var a="";switch(d.current.name){case"accountNewMessage":a="accountMessagesOverview";break;case"agentsNewMessage":a="agentsMessagesOverview";break;case"shopNewMessage":a="shopMessagesOverview"}d.go(a,{})})}).done()):void h.logError("Unable to send message: "+a.error,a.userMsg)})},this.init=function(){f.hasValidLogin()&&i.getMessageTemplates()},this.init()}])}(),function(){angular.module("depositMethodData",[]).controller("depositMethodDataController",["$state","$rootScope","$locale","platformApiService","paymentProviderService","$sce","$location","$scope","$interval","helperService","$anchorScroll","loggingService","umbracoApiService","$sessionStorage","authService","currencyService","$localStorage","websiteApiService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(){for(var a=(new Date).getFullYear(),b=a+13,c=[],d=a;d<=b;d++)c.push(d);return c}var t=this;d.finance;this.email="",this.userID=o.getUserData().userID,this.iFrameSrc=null,this.Amount=null,this.linkLabel=null,this.UserSecureId="",this.userAccountId="",this.accountChanger=!0,this.showingAmount=!1,this.showingIframe=!1,this.depositChannels={},this.selectedChannel=null,this.paymentMethodPlatformCallBack=h.selectedApi,this.paymentMethodDataCallBack=null,this.checkFees=!1,this.fees=0,this.isDepositProcessing=!1,this.currencySymbol="",this.amountInputVisible=!1,this.isAmountValid=!1,this.showMinAmountError=!1,this.showMaxAmountError=!1,this.mxPollInterval=null,this.mxPollCounter=0,this.mxPolling=!1,this.mxSuccess=!1,this.mxTimeout=!1,this.depositLoading=!1,this.depositStatusMessage={},this.depositPollInterval=null,this.depositPollCounter=0,this.depositPolling=!1,this.years=[],this.currentYear=(new Date).getFullYear(),this.currentMonth=(new Date).getMonth()+1,this.months=c.DATETIME_FORMATS.MONTH,this.ccinfo={cardType:void 0},this.amolePinProcessStage=!1,this.userPhonenumber=null,t.years=s(),e.getUserEmail().then(function(a){a.success||l.logError("Unable to get user eMail : "+a.error),t.email=a.data.UserDetails.Email,"AmoleWalletDeposit"===t.paymentMethodPlatformCallBack.Identifier&&(t.userPhonenumber=a.data.PhoneContactDetails[0].ContactNumber.replace(/^(.{0})(.{3})(.*)$/,"$1+$2 $3"),t.ccinfo.cardNumber=a.data.PhoneContactDetails[0].ContactNumber,t.ccinfo.month="",t.ccinfo.year="")}),this.amolePinRequest=function(){b.showLoader(),d.paymentVendors.amole.authorizeDeposit({MobileNumber:t.ccinfo.cardNumber}).then(function(a){return b.hideLoader(),a.success?(t.amolePinProcessStage=!0,void j.showSuccessMessage(locale.account.paymentMethods.pendingApprovals.pinDisc).done()):void l.logError(a.error,a.userMsg)})};var u=JSON.parse(globalSettings.Account_QuickCashDelimiters.replaceAll("'",'"')),v=u[t.paymentMethodPlatformCallBack.Identifier]||u.defaultDeposit;if(this.quickValues=_.uniq(_.remove(v,function(a){return!isNaN(a)})),this.setAmount=function(a){this.Amount=a,t.checkFees&&this.getFeeBands()},this.setDelimiterAmount=function(a,b){a&&(b.$setDirty(),t.setAmount(a))},this.depositStatus=function(a,b){t.depositPollCounter=0,t.depositPolling=!0,t.depositPollInterval=i(function(){t.depositPollCounter++,r.paymentVendors.depositStatus(a,b).then(function(a){t.depositStatusMessage.type=a.data.Status,t.depositStatusMessage.amount=a.data.Amount,t.depositStatusMessage.hideAmount=!0,t.depositPollCounter>=globalSettings.Account_DepositPollCountLimit&&(i.cancel(t.depositPollInterval),t.depositPolling=!1),t.mapDepositStatus()})},globalSettings.Account_DepositPollInterval)},this.mapDepositStatus=function(){switch(this.depositLoading=!1,t.depositStatusMessage.type){case"Complete":this.depositPolling=!1,i.cancel(t.depositPollInterval),t.depositStatusMessage.buttons=[{btnText:"RETURN TO HOMEPAGE",primaryBtn:!0,redirectUrl:"/sports/s"},{btnText:"PROCEED TO VIRTUAL LEAGUE",primaryBtn:!1,redirectUrl:"/virtuals"}],t.depositStatusMessage.title="DEPOSIT OF "+t.depositStatusMessage.amount+" IS SUCCESSFUL",t.depositStatusMessage.icon="SUCCESS";break;case"Pending":t.depositPollCounter<globalSettings.Account_DepositPollCountLimit?this.depositLoading=!0:(t.depositStatusMessage.descriptions=["We are still checking the status of the transaction and will notify you in 5 minutes.","You may also check the status in account statement."],t.depositStatusMessage.buttons=[{btnText:"CHECK STATUS IN ACCOUNT STATEMENT",primaryBtn:!0,redirectUrl:"/account/ac/statementsearch"},{btnText:"PROCEED TO HOME PAGE",primaryBtn:!1,redirectUrl:"/sports/s"}],t.depositStatusMessage.title="DEPOSIT OF "+t.depositStatusMessage.amount+" IS PROCESSING",t.depositStatusMessage.icon="PROCESSING");break;case"Failed":this.depositPolling=!1,i.cancel(t.depositPollInterval),t.depositStatusMessage.descriptions=["Please try again. If any amount is deducted it should be credited back as the processing time of your bank. Please reach out to your bank for any queries."],t.depositStatusMessage.buttons=[{btnText:"PLEASE TRY AGAIN",primaryBtn:!0,redirectUrl:"/account/ac/deposit"}],t.depositStatusMessage.title="DEPOSIT OF "+t.depositStatusMessage.amount+" FAILED",t.depositStatusMessage.icon="ERROR";break;default:i.cancel(t.depositPollInterval)}},this.navigateTo=function(a){window.location.href=a},this.gaDepositTrack=function(){d.paymentVendors.paymentMethods.hasPerformedDeposit().then(function(a){j.createDataLayerEvent({event:"user-add-funds",userID:o.getUserData().userID,fundAmount:storageService.getData("lastDeposit"),firstDeposit:a.success?!a.data.HasPerformedDeposit:void 0})})},"InterswitchWebpayDirectDeposit"==t.paymentMethodPlatformCallBack.Identifier||"Paystack"==t.paymentMethodPlatformCallBack.Identifier){var w=g.search().transactionId?g.search().transactionId:g.search().txReference,x=g.search().transactionTypeId?g.search().transactionTypeId:g.search().txTypeId;w&&x&&(this.depositLoading=!0,this.depositStatus(w,x)),n.lastDeposit&&globalSettings.Tracking_EnableDataLayer&&"Paystack"==t.paymentMethodPlatformCallBack.Identifier&&j.setValueToDataLayer("lastDeposit",n.lastDeposit);
}if("GTPay"==t.paymentMethodPlatformCallBack.Identifier){var y=g.search().txStatusCode,z=g.search().txStatusMessage,A="";if(y){switch(y){case"00":case"0":y="success",A="Your Transaction was successful. <br>Reason : "+(z?z:"unknown")+"<br>",n.lastDeposit&&globalSettings.Tracking_EnableDataLayer&&j.setValueToDataLayer("lastDeposit",n.lastDeposit),t.gaDepositTrack();break;case"-99":y="info",A="Your Transaction is in process. <br>Reason : "+(z?z:"unknown")+"<br>";break;default:y="error",A="Your Transaction was not successful. <br>Reason : "+(z?z:"unknown")+"<br>"}h.onTransferComplete(A,z,null,y)}}var B=function(a){var c="",d=function(){var a=g.path();g.url(a)},f="info";t.mxPollCounter=0,t.mxPolling=!0,0==t.mxPollCounter&&b.showLoader(),t.mxPollInterval=i(function(){t.mxPollCounter++,e.depositStaus(C).then(function(a){switch(b.hideLoader(),a.data.TransactionStatus.toLowerCase()){case"complete":i.cancel(t.mxPollInterval),t.mxPolling=!1,t.mxSuccess=!0,t.mxTimeout=!1,f="success",c="Deposit Transaction: "+C+" has been successful.<br> Your Betking wallet has been successfully credited </br>",h.onTransferComplete(c,z,null,f,!1,d);break;case"pending":t.mxSuccess=!1,t.mxTimeout=!1,reponse="info",c="Your deposit is still Pending. We are checking for update. ",1==t.mxPollCounter&&h.onTransferComplete(c,z,null,f,!0);break;case"failed":i.cancel(t.mxPollInterval),t.mxPolling=!1,t.mxSuccess=!1,t.mxTimeout=!1,f="error",c="Deposit Transaction: "+C+" has failed. Please try again.<br> If any amount is debited from your Telebirr account, it will be credited back. <br>",h.onTransferComplete(c,z,null,f,!1,d)}t.mxPollCounter>=globalSettings.Account_TelebirrPollCountLimit&&(i.cancel(t.mxPollInterval),t.mxPolling=!1,t.mxSuccess=!1,t.mxTimeout=!0,f="info",c="Your deposit is still in progress. We will notify you when it is complete. <br> You can also check status in Account Statement.",h.onTransferComplete(c,z,null,f,!1,d))})},globalSettings.Account_TelebirrPollInterval)};if("TeleBirrDeposit"==t.paymentMethodPlatformCallBack.Identifier&&null!=g.search().id){var C=g.search().id;B(C)}switch(this.depositEnabled=function(a){if(!a.success){a.error||l.logError(a.error);var b=j.handlePlatformError(a);b||j.showErrorMessage(a.userMsg).done(),h.canceled(a.userMsg)}},this.getFeeBands=function(){""===t.Amount||void 0===t.Amount?t.fees=0:e.getFeeBands(t.paymentMethodPlatformCallBack.Identifier,t.Amount).then(function(a){t.fees=a.data.Tariff})},t.paymentMethodPlatformCallBack.Identifier){case"GTPay":e.isDepositEnabledGTPay().then(function(a){t.depositEnabled(a)});break;case"InterswitchWebpayDirectDeposit":e.isDepositEnabledInterswitch().then(function(a){t.depositEnabled(a)}),this.showingAmount=!0;break;case"Paystack":e.getPaymentChannels().then(function(a){t.depositChannels=a.data.channels,t.selectedChannel=globalSettings.Account_PaymentChannel?globalSettings.Account_PaymentChannel:a.data.channels[0]});break;case"InterswitchBankDeposit":case"InterswitchATMTransferDeposit":case"InterswitchQuickTellerWeb":this.showingAmount=!1;break;case"MpesaDepositOffline":this.showingAmount=!0}this.getDepositPaymentMethodCallBack=function(){return r.paymentVendors.getAllDepositPaymentMethods()},this.processDeposit=function(){t.getDepositPaymentMethodCallBack().then(function(a){m.desktop.getDepositMethodList().then(function(b){var c=_.find(a.data,{Identifier:t.paymentMethodPlatformCallBack.Identifier}),d=_.find(b.data,{PaymentId:t.paymentMethodPlatformCallBack.Identifier});if(c.IsEnabled&&"offline"!=d.Status&&"disabled"!=d.Status)t.performDeposit();else{t.isDepositProcessing=!0;var e=t.getUnavailablePaymentMethodMessage(d.PaymentTitle||c.Name);j.showInfoMessage(e).done().then(function(){g.path("/ac/deposit")})}})})},this.getUnavailablePaymentMethodMessage=function(a){return locale.account.paymentMethods.deposit.depositDisablePaymentMethod.replace("{method}",a)},this.performDeposit=function(){n.lastDeposit=t.Amount;var a={};a.amount=t.Amount,a.identifier=t.paymentMethodPlatformCallBack.Identifier,a.selectedChannel=t.selectedChannel,a.returnUrl=g.absUrl().split("?")[0],a.amoleObj=t.ccinfo,t.isDepositProcessing=!0,e.registerDepositWithCallBack(a).then(function(a){if(b.hideLoader(),t.isDepositProcessing=!1,"CBEDeposit"!=t.paymentMethodPlatformCallBack.Identifier)if(a.success&&a.data)if("Paystack"!=t.paymentMethodPlatformCallBack.Identifier&&"GTPay"!=t.paymentMethodPlatformCallBack.Identifier&&"InterswitchWebpayDirectDeposit"!=t.paymentMethodPlatformCallBack.Identifier&&t.gaDepositTrack(),"AmoleCardDeposit"==t.paymentMethodPlatformCallBack.Identifier||"AmoleWalletDeposit"==t.paymentMethodPlatformCallBack.Identifier)j.showSuccessMessage(locale.account.paymentMethods.amole.depositSuccess).done(),t.gaDepositTrack(),window.history.back();else if("MSUDeposit"==t.paymentMethodPlatformCallBack.Identifier)$("#output_frame").load(function(a){try{var b=document.getElementById("output_frame").contentWindow.location.href;b&&(t.showingIframe=!1)}catch(a){if("SecurityError"!==a.name)throw a}}),t.iFrameSrc=f.trustAsResourceUrl(a.data),t.showingIframe=!0,t.gaDepositTrack();else if("MpesaDepositOnline"==t.paymentMethodPlatformCallBack.Identifier){if(!a.data.TransactionId)return void j.showErrorMessage(locale.account.paymentMethods.deposit.genericError).done();t.gaDepositTrack();var c=a.data.TransactionId;t.mxPollCounter=0,t.mxPolling=!0,t.mxPollInterval=i(function(){t.mxPollCounter++,d.paymentVendors.mpesaExpress.transactionStatus(c).then(function(a){if(a.success&&a.data&&"complete"===a.data.TransactionStatus.toLowerCase())i.cancel(t.mxPollInterval),t.mxPolling=!1,t.mxSuccess=!0,t.mxTimeout=!1,"1903"===globalSettings.BrandID&&"UNCONF"===o.getUserStatus()&&(o.setUserStatus("ACT"),o.setVerifyAccountStatus("Verified"));else if(a.success&&a.data&&"failed"===a.data.TransactionStatus.toLowerCase()){i.cancel(t.mxPollInterval),t.mxPolling=!1,t.mxSuccess=!1,t.mxTimeout=!1;var b=t.getPollingErrorMessage(a.data.ResultCode);j.showErrorMessage(b).done()}else t.mxPollCounter>=globalSettings.Account_MpesaExpressPollCountLimit&&(i.cancel(t.mxPollInterval),t.mxPolling=!1,t.mxSuccess=!1,t.mxTimeout=!0)})},globalSettings.Account_MpesaExpressPollInterval)}else{if("GTPay"==t.paymentMethodPlatformCallBack.Identifier)var e=$('<form name="iFramePayments" id="iFramePayments" action="'+globalSettings.Deposit_GTBankURL+'" method="post" target="_self"></form>');else if("Paystack"==t.paymentMethodPlatformCallBack.Identifier)var e=$('<form name="iFramePayments" id="iFramePayments" action="'+a.data.authorization_url+'" method="post" target="_self"></form>');else if("TeleBirrDeposit"==t.paymentMethodPlatformCallBack.Identifier)var e=$('<form name="iFramePayments" id="iFramePayments" action="'+a.data.Url+'" method="get" target="_self"></form>');else var e=$('<form name="iFramePayments" id="iFramePayments" action="'+a.data.IFrameUrl+'" method="post" target="_self" ></form>');for(property in a.data)e.append($("<input>").attr({type:"hidden",name:property,value:a.data[property]}));e.appendTo("#divIFrame"),e.submit()}else if("MpesaDepositOnline"==t.paymentMethodPlatformCallBack.Identifier)j.showErrorMessage(locale.account.paymentMethods.deposit.genericError).done();else{a.error&&l.logError(a.error||a.userMsg,a.error&&a.userMsg);var g=j.handlePlatformError(a);g||j.showErrorMessage(a.userMsg).done()}else if(a.success){t.gaDepositTrack();var h=t.cbeSuccessHTMLString.replace("#TRANSFERCODE#",a.data.TransferCode);j.showMessageWithHtml(h,!1,null,!0,locale.common.ok.toUpperCase(),function(a){t.setAmount(t.paymentMethodPlatformCallBack.MinimumLimit.Amount),window.history.back()})}else{if(a.data&&"HARD_CHECK_AW_EXCEPTION"===a.data.ErrorCode){var k=locale.account.paymentMethods.paymentGeneralErrorCodes.HARD_CHECK_AW_EXCEPTION+"</br></br>";return _.each(a.data.ErrorDetails,function(a,b,c){var d="";d=a.includes('href="{{contactUs}}"')?a.replace('href="{{contactUs}}"','href="'+t.contactUsUrl+'"'):a,errorTitle=locale.account.paymentMethods.rejectedErrorType[b],k=k+(errorTitle?errorTitle+" - ":"")+d+"</br>"}),void j.showMessageWithHtml(k,!1,null,!1,null)}var m=locale.account.paymentMethods.paymentGeneralErrorCodes[a.data.ErrorCode];m||(m=locale.account.paymentMethods.paymentGeneralErrorCodes.INTERNAL_SERVER_ERROR),m.includes("{MaximumWithdrawalLimit}")&&(m=m.replace("{MaximumWithdrawalLimit}",a.data.ErrorDetails.MaximumWithdrawalLimit)),m.includes("{TransactionAmount}")&&(m=m.replace("{TransactionAmount}",a.data.ErrorDetails.TransactionAmount)),m.includes("{CurrentScore}")&&(m=m.replace("{CurrentScore}",a.data.ErrorDetails.CurrentScore)),m.includes("{MinimumLimit}")&&(m=m.replace("{MinimumLimit}",$filter("currency")(a.data.ErrorDetails.MinimumLimit,o.getUserData().currency.CurrencySymbol,2))),m.includes("{MaximumLimit}")&&(m=m.replace("{MaximumLimit}",$filter("currency")(a.data.ErrorDetails.MaximumLimit,o.getUserData().currency.CurrencySymbol,2))),m.includes("{MaximumDailyLimit}")&&(m=m.replace("{MaximumDailyLimit}",$filter("currency")(a.data.ErrorDetails.MaximumDailyLimit,o.getUserData().currency.CurrencySymbol,2))),m.includes("{MaximumAttempts}")&&(m=m.replace("{MaximumAttempts}",a.data.ErrorDetails.MaximumAttempts)),j.showMessageWithHtml(m,!1,null,!0,locale.common.ok,function(a){t.setAmount(t.paymentMethodPlatformCallBack.MinimumLimit.Amount)})}})},this.getDepositMethodsDataCallback=function(a){m.desktop.getDepositMethodData(t.paymentMethodPlatformCallBack.Identifier).then(function(b){if(!b.success)return void l.logError(a.error,a.userMsg);var c=q.userData;c&&(b.data.Content=b.data.Content.replace("USERID",c.userID)),t.paymentMethodDataCallBack=b.data,"MpesaDepositOffline"===t.paymentMethodPlatformCallBack.Identifier&&(t.checkFees=!0)})},"Deposit"===h.transferType&&t.getDepositMethodsDataCallback(),this.paymentInputInit=function(){t.Amount=t.paymentMethodPlatformCallBack.MinimumLimit.Amount},this.cbeProcessPerformDeposit=function(a){t.cbeSuccessHTMLString=a,t.performDeposit()},this.setCurrencySymbol=function(){var a=o.getUserData().currency.Currency||n.SportsbookGlobalVariable.CurrencyId;t.currencySymbol=p.getCurrencySymbol(a)},this.showAmountInput=function(){t.amountInputVisible||(t.amountInputVisible=!0,t.Amount=null,t.validateAmount())},this.hideAmountInput=function(){t.amountInputVisible=!1},this.validateAmount=function(){null==t.Amount||isNaN(t.Amount)?(t.isAmountValid=!1,t.showMinAmountError=!1,t.showMaxAmountError=!1):t.Amount<t.paymentMethodPlatformCallBack.MinimumLimit.Amount?(t.isAmountValid=!1,t.showMinAmountError=!0,t.showMaxAmountError=!1):t.Amount>t.paymentMethodPlatformCallBack.MaximumLimit.Amount?(t.isAmountValid=!1,t.showMinAmountError=!1,t.showMaxAmountError=!0):(t.isAmountValid=!0,t.showMinAmountError=!1,t.showMaxAmountError=!1)},this.amountBtnClicked=function(a){t.hideAmountInput(),t.setAmount(a),t.validateAmount()},this.goToHomePage=function(){window.location.href="/"},this.goToContactUs=function(){window.location.href="/help/general-help/contact-us/"},this.setCurrencySymbol(),this.getPollingErrorMessage=function(a){var b=locale.account.paymentMethods.mpesaExpress.pollingErrorCodes[a];return b||(b=locale.account.paymentMethods.deposit.genericError),b},k(),b.selectedApi=h.selectedApi}]).directive("creditCardType",function(){var a={require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(b){return a.depositMethodDataCtrl.ccinfo.cardType=/^5[1-5]/.test(b)?"Mastercard":/^4/.test(b)?"VISA":/^3[47]/.test(b)?"AMEX":/^6011|65|64[4-9]|622(1(2[6-9]|[3-9]\d)|[2-8]\d{2}|9([01]\d|2[0-5]))/.test(b)?"Discover":/^(?:3(?:0[0-5]|[68][0-9])[0-9]{11})$/.test(b)?"Dinners":/^(?:(?:2131|1800|35\d{3})\d{11})$/.test(b)?"JCB":null,b})}};return a})}(),function(){angular.module("authenticatedMoneyTransfer",["depositMethodData","withdrawMethodData","withdrawBankProfileMethodData","moneyTransfer.service"]).controller("moneyTransferController",["$scope","$rootScope","$state","$uiRouterGlobals","platformApiService","$location","helperService","transferType","$timeout","loggingService","moneyTransferService","umbracoApiService","paymentProviderService","websiteApiService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=this,p=e.paymentVendors.paymentMethods;e.finance;this.ImageResourceURL=globalSettings.ImageResourceURL,this.ImagePath=a.ImagePath,this.currencySymbol="",this.depositExtraDatails=[],this.withdrawalExtraDetails=[],this.API=[],this.pendingWithdrawals=[],this.bannerData=[],this.amoleApprovedWithdrawals,a.transferType=h;var q="Deposit"===a.transferType?"accountDeposit":"accountWithdraw";a.selectedApi=null,this.disableMsg=function(b){var c=b.PaymentTitle||b.Name;return"Deposit"===a.transferType?locale.account.paymentMethods.deposit.depositDisablePaymentMethod.replace("{method}",c):locale.account.paymentMethods.withdrawal.withdrawalDisablePaymentMethod.replace("{method}",c)},this.onApiSelected=function(b){var e="";switch(d.current.name){case"shopDeposit":case"shopWithdraw":e="Deposit"===a.transferType?"shopDepositPaymentMethod":"shopWithdrawPaymentMethod";break;case"accountDeposit":case"accountWithdraw":e="Deposit"===a.transferType?"accountDepositPaymentMethod":"accountWithdrawPaymentMethod"}e&&c.go(e,{paymentMethod:b.Identifier})},this.getPaymentsLocaleStrings=function(){l.desktop.getPaymentsContentStrings(globalSettings.CurrentLanguage).then(function(a){return a.success?void(o.pendingDeposits={title:a.data.cBEPendingDepositsTitle,disclaimer:a.data.cBEPendingDepositsDisclaimer,amountLabel:a.data.cBEPendingDepositsAmountLabel,transferCodeLabel:a.data.cBEPendingDepositsTransferCodeLabel,dateLabel:a.data.cBEPendingDepositsDateLabel,questionDisclaimer:a.data.cBEPendingDepositsQuestionDisclaimer,buttonText:a.data.cBEPendingDepositsButtonText,cBESuccessDepositMessage:a.data.cBESuccessDepositMessage,cBESuccessWithdrawal:a.data.cBESuccessWithdrawalMessage,revertedPendingDepositMessage:a.data.cBEPendingDepositRevertedMessage,generalErrorMessageFieldRequired:a.data.generalErrorMessageFieldRequired,generalDepositErrorMessageAmountLess:a.data.generalDepositErrorMessageAmountLess,generalWithdrawalErrorMessageAmountLess:a.data.generalWithdrawalErrorMessageAmountLess,generalDepositErrorMessageAmountGreater:a.data.generalDepositErrorMessageAmountGreater,generalWithdrawalErrorMessageAmountGreater:a.data.generalWithdrawalErrorMessageAmountGreater}):void j.logError(a.error,a.userMsg)})},this.cancelApprovalWithdrawal=function(a){e.paymentVendors.amole.cancelWithdrawal({TransactionIdentifier:a}).then(function(a){return a.success?(g.showSuccessMessage(locale.account.paymentMethods.pendingApprovals.pendingWithdrawalSuccess).done(),void o.fetchApprovedAmoleWithdrawals()):void j.logError(a.error,a.userMsg)})},this.getAmoleApprovalPin=function(a,c){b.showLoader(),o.amoleApprovedWithdrawals[c].Toggle=!o.amoleApprovedWithdrawals[c].Toggle,e.paymentVendors.amole.authorizationWithdrawal({TransactionIdentifier:a}).then(function(a){return b.hideLoader(),a.success?void g.showSuccessMessage(locale.account.paymentMethods.pendingApprovals.pinDisc).done():void j.logError(a.error,a.userMsg)})},this.finalizeWithdrawal=function(a,c,d){b.showLoader();var f={PIN:a,Amount:c,TransactionIdentifier:d};e.paymentVendors.amole.finalizeWithdrawal(f).then(function(a){return b.hideLoader(),a.success?(g.showSuccessMessage(a.userMsg||locale.account.paymentMethods.pendingApprovals.transactionSuccessful),void o.fetchApprovedAmoleWithdrawals()):void j.logError(a.error,a.userMsg)})},this.fetchApprovedAmoleWithdrawals=function(){e.paymentVendors.amole.fetchApprovedAmoleWithdrawals().then(function(a){return a.success?void(o.amoleApprovedWithdrawals=a.data.approvedTransactionsRequestModels):void j.logError(a.error,a.userMsg)})},this.getNavigatePaymentUrl=function(){return"WithdrawalLoadBalancer"===a.selectedApi.Identifier?"/account":q},this.navigateToPaymentMethods=function(){c.go(o.getNavigatePaymentUrl())},a.onTransferComplete=function(a,b,c,d,e,f){k.onTransferComplete(a,b,c,d,e,f)},this.getUmbracoExtraDetailsForDepositPage=function(){l.desktop.getDepositExtraDetails(globalSettings.CurrentLanguage).then(function(a){return a.success?void(o.depositExtraDatails=a.data):void j.logError(a.error,a.userMsg)})},this.getAllDepositPaymentMethodsCallback=function(){return n.paymentVendors.getAllDepositPaymentMethods().then(function(b){if(!b.success)return void j.logError(b.error,b.userMsg);if(!(b.data.length>0))return void g.showErrorMessage(locale.account.paymentMethods.noPaymentAvailable).done();if(globalSettings.Account_CeilMinimumLimit&&b.data.forEach(function(a){a.MinimumLimit.Amount=Math.ceil(a.MinimumLimit.Amount)}),o.API=b.data,o.currencySymbol=b.data[0].MinimumLimit.CurrencySymbol,o.getAllPendingWithdrawals(),c.current.name!==q)for(var e=0;e<b.data.length;e++)if(d.params.paymentMethod==b.data[e].Identifier){a.selectedApi=b.data[e];break}l.desktop.getDepositMethodList().then(function(a){if(!a.success)return void j.logError(a.error,a.userMsg);if(o.API=_.map(o.API,function(b){var c=_.find(a.data,{PaymentId:b.Identifier});return c&&"offline"!==c.Status&&void 0!==b.IsEnabled&&!b.IsEnabled&&(c.Status="disabled"),_.extend(b,c)}),globalSettings.Account_EnableDepositDefaultRedirection){if(1===o.API.length)return void o.onApiSelected(o.API[0]);for(var b=0;b<o.API.length;b++)if(o.API[b].IsDefault===!0){o.onApiSelected(o.API[b]);break}}var c=["AmoleWalletDeposit","CBEDeposit","TeleBirrDeposit"],d=o.API.map(function(a){return a.Identifier});d.some(function(a){return _.includes(c,a)})&&o.getPaymentsLocaleStrings(),o.API.forEach(function(a){a.IsEnabled&&_.includes(c,a.Identifier)&&("AmoleWalletDeposit"===a.Identifier&&o.fetchApprovedAmoleWithdrawals(),"CBEDeposit"===a.Identifier&&o.fetchPendingDeposits(),"TeleBirrDeposit"===a.Identifier&&o.pendingDepositTransactions())})})})},this.getUmbracoExtraDetailsForWithdrawalPage=function(){l.desktop.getWithdrawalExtraDetails(globalSettings.CurrentLanguage).then(function(a){return a.success?void(o.withdrawalExtraDetails=a.data):void j.logError(a.error,a.userMsg)})},this.getUmbracoBannerList=function(){l.desktop.getPaymentBannersList().then(function(a){return a.success?(o.bannerData=a.data,void i(function(){o.initialiseBanner()},200)):void j.logError(a.error,a.userMsg)})},this.getAllWithdrawalPaymentMethodsCallback=function(){return n.paymentVendors.getAllWithdrawalPaymentMethods().then(function(b){if(!b.success)return void j.logError(b.error,b.userMsg);if(!(b.data.length>0))return void g.showErrorMessage(locale.account.paymentMethods.noPaymentAvailable).done();globalSettings.Account_CeilMinimumLimit&&b.data.forEach(function(a){a.MinimumLimit.Amount=Math.ceil(a.MinimumLimit.Amount),a.MaximumLimit.Amount=a.MaximumLimit.Amount.toFixed()}),o.API=b.data,o.currencySymbol=b.data[0].MinimumLimit.CurrencySymbol;var e=["AmoleWithdrawal","CBEWithdrawal","WithdrawalLoadBalancer","TeleBirrWithdrawal"];if(b.data.forEach(function(a){a.IsEnabled&&_.includes(e,a.Identifier)&&("WithdrawalLoadBalancer"!==a.Identifier&&o.fetchApprovedAmoleWithdrawals(),"CBEWithdrawal"===a.Identifier&&o.fetchPendingDeposits(),"TeleBirrWithdrawal"===a.Identifier&&o.pendingDepositTransactions(),o.getPaymentsLocaleStrings())}),o.getAllPendingWithdrawals(),c.current.name!==q)for(var f=0;f<b.data.length;f++)if(d.params.paymentMethod==b.data[f].Identifier){a.selectedApi=b.data[f];break}l.desktop.getWithdrawalMethodList().then(function(a){if(!a.success)return void j.logError(a.error,a.userMsg);if(o.API=_.map(o.API,function(b){var c=_.find(a.data,{PaymentId:b.Identifier});return c&&"offline"!==c.Status&&void 0!==b.IsEnabled&&!b.IsEnabled&&(c.Status="disabled"),_.extend(b,c)}),globalSettings.Account_EnableWithdrawalDefaultRedirection){if(1===o.API.length)return void o.onApiSelected(o.API[0]);for(var b=0;b<o.API.length;b++)if(o.API[b].IsDefault===!0){o.onApiSelected(o.API[b]);break}}})})},this.PendingWithdrawalsRequestModel=new gamingAppModels.PendingWithdrawalsRequestModel,this.getAllPendingWithdrawals=function(){globalSettings.Payment_EnableWithdrawalReversal&&(o.PendingWithdrawalsRequestModel.PageNumber=null,o.PendingWithdrawalsRequestModel.PageSize=null,p.getAllPendingWithdrawals(o.PendingWithdrawalsRequestModel).then(function(a){return a.success?void(o.pendingWithdrawals=a.data):void j.logError(a.error,a.userMsg)}))},this.CancelWithdrawalRequestModel=new gamingAppModels.CancelWithdrawalRequestModel,this.cancelRequestedWithdrawal=function(b,c){o.CancelWithdrawalRequestModel.TransactionId=b,o.CancelWithdrawalRequestModel.TransactionTypeId=c,p.requestACancelPendingWithdrawal(o.CancelWithdrawalRequestModel).then(function(b){return b.success?(o.getAllPendingWithdrawals(),void a.onTransferComplete(locale.account.paymentMethods.withdrawal.transaction+" "+b.data.TransactionId+" "+locale.account.paymentMethods.withdrawal.wasSuccessfullyReverted,b.userMsg,null,"success")):void j.logError(b.error,b.userMsg)})},this.fetchPendingDeposits=function(){m.fetchPendingDeposits().then(function(a){if(a.success&&a.data&&a.data.Transactions){var b=a.data.Provider;a.data.Transactions.sort(function(a,b){var c=new Date(a.CreatedAt).getTime(),d=new Date(b.CreatedAt).getTime();return c<d?1:-1}),null==o.pendingDepositApprovals&&(o.pendingDepositApprovals=[]),a.data.Transactions.forEach(function(a){a.Toggle=!0,a.Provider=b,o.pendingDepositApprovals.push(a)}),o.pendingDepositApprovals.length&&(o.hasPendingDepositList=!0)}})},this.cancelDepositTransaction=function(a){var b={TransactionID:a};m.cancelDepositTransaction(b).then(function(a){a.success&&(g.showSuccessMessage(o.pendingDeposits.revertedPendingDepositMessage),o.fetchPendingDeposits())})},this.pendingDepositTransactions=function(){m.pendingTransactions().then(function(a){if(a.success&&a.data&&a.data.Transactions){var b=a.data.Provider;a.data.Transactions.sort(function(a,b){var c=new Date(a.CreatedAt).getTime(),d=new Date(b.CreatedAt).getTime();return c<d?1:-1}),null==o.pendingDepositApprovals&&(o.pendingDepositApprovals=[]),a.data.Transactions.forEach(function(a){a.Toggle=!0,a.Provider=b,a.CreatedAt=a.CreatedOn,a.TransferCode=a.Id,o.pendingDepositApprovals.push(a)}),o.pendingDepositApprovals.length&&(o.hasPendingDepositList=!0)}})},this.hideDepositTransaction=function(a){var b=o.pendingDepositApprovals.findIndex(function(b){return b.Id==a});o.pendingDepositApprovals.splice(b,1)},this.initialiseBanner=function(){var a=$("#paymentBanner");a.owlCarousel("destroy"),a.find(".owl-item").remove(),o.bannerData.length>0?(a.owlCarousel({animateOut:"slideOutLeft",animateIn:"slideInRight",responsive:!0,items:1,loop:!0,margin:10,autoplay:!0,autoplayTimeout:6e3,autoplayHoverPause:!0,dots:!0,touchDrag:!1,mouseDrag:!1}),$(".owl-carousel").css("display","block")):$(".owl-carousel").css("display","none")},a.$watch(function(){return $("#paymentBanner").width()},function(a,b){if(b!=a){var c=$("#paymentBanner").width(),d=parseFloat($("#paymentBanner").css("max-width")),e=parseFloat($("#paymentBanner").css("max-height")),f=e/d;$("#paymentBanner").height(c*f)}}),this.redirectPage=function(a){f.path(a)},this.depositLimitData=null,o.getUmbracoBannerList(),"Deposit"===a.transferType?o.getAllDepositPaymentMethodsCallback().then(function(){o.getUmbracoExtraDetailsForDepositPage()}):"Withdraw"===a.transferType&&(o.userDepositLimitExcedded=!1,o.getAllWithdrawalPaymentMethodsCallback().then(function(){o.getUmbracoExtraDetailsForWithdrawalPage()}))}])}(),function(){angular.module("moneyTransfer.service",[]).factory("moneyTransferService",["$state","$injector","$location",function(a,b,c){return{onTransferComplete:function(c,d,e,f,g,h){var i=b.get("helperService"),j=b.get("loggingService"),k="info-circle";switch(f){case"success":k="check-circle-o",j.scriptLog(d,null,j.logLevels.info);break;case"info":k="info-circle",j.scriptLog(d,null,j.logLevels.info);break;case"error":k="exclamation-triangle",j.logError(d,c)}g?i.showMessageWithLoader(f,c,k):i.showMessage(f,c,k,null,null,null,null,h).done(),null!=e&&a.go(e)},getDepositRedirectionURL:function(){return a.href(globalSettings.DepositRedirection,{},{absolute:!0})},getWithdrawalRedirectionURL:function(){return a.href(globalSettings.WithdrawalRedirection,{},{absolute:!0})}}}]).factory("paymentProviderService",["platformApiService","websiteApiService","authService","$q","$location","$rootScope",function(a,b,c,d,e,f){return{getUserEmail:function(){var b=d.defer();return a.user.getCurrentUserProfile().then(function(a){return a.success?b.resolve(a):(loggingService.logError("Unable to get user eMail : "+a.error),b.resolve())}),b.promise},isDepositEnabledGTPay:function(){return a.paymentVendors.gtPay.isDepositEnabled()},isDepositEnabledInterswitch:function(){return a.paymentVendors.interswitch.depositEnabled()},getPaymentChannels:function(){return a.paymentVendors.paystack.getPaymentChannels()},getFeeBands:function(b,c){return a.paymentVendors.safariCom.getFeeBands(b,c)},registerDepositWithCallBack:function(c){switch(c.identifier){case"GTPay":return this.GTPayRegisterDepositRequestModel=new gamingAppModels.GTPayRegisterDepositRequestModel,this.GTPayRegisterDepositRequestModel.Amount=c.amount,this.GTPayRegisterDepositRequestModel.ReturnURL=e.absUrl().split("?")[0],a.paymentVendors.gtPay.registerDeposit(this.GTPayRegisterDepositRequestModel);case"InterswitchWebpayDirectDeposit":return this.InterswitchWebPayDirectDepositRequestBindingModel=new gamingAppModels.InterswitchWebPayDirectDepositRequestBindingModel,this.InterswitchWebPayDirectDepositRequestBindingModel.Amount=c.amount,this.InterswitchWebPayDirectDepositRequestBindingModel.SiteRedirectUrl=e.absUrl().split("?")[0],a.paymentVendors.interswitch.registerWebPayDirect(this.InterswitchWebPayDirectDepositRequestBindingModel);case"Paystack":return this.PaystackDepositBindingModel=new gamingAppModels.PaystackDepositBindingModel,this.PaystackDepositBindingModel.Amount=c.amount,this.PaystackDepositBindingModel.CallbackUrl=e.absUrl().split("?")[0],this.PaystackDepositBindingModel.Channels=c.selectedChannel,a.paymentVendors.paystack.registerDeposit(this.PaystackDepositBindingModel);case"MpesaDepositOnline":return a.paymentVendors.mpesaExpress.registerDeposit(c.amount);case"MSUDeposit":var c={Amount:c.amount,ReturnURL:c.returnUrl};return a.paymentVendors.msu.registerDeposit(c);case"AmoleCardDeposit":case"AmoleWalletDeposit":f.showLoader();var c={CardNumber:c.amoleObj.cardNumber,Amount:c.amount,ExpirationDate:c.amoleObj.month+c.amoleObj.year,PIN:c.amoleObj.pin,PaymentMethod:c.identifier,CardType:c.cardType||"Unknown"};return a.paymentVendors.amole.performDeposit(c);case"CBEDeposit":return b.payments.cbe.requestTransferCode({Amount:c.amount});case"TeleBirrDeposit":var c={Amount:(Math.round(100*c.amount)/100).toFixed(2),RedirectUrl:e.absUrl().split("?")[0]};return b.payments.telebirr.generateUrl(c)}},registerWithdrawWithCallBack:function(c,d){switch(d){case"BankTransfer":return this.BankTransferWithdrawRequestBindingModel=new gamingAppModels.BankTransferWithdrawRequestBindingModel,this.BankTransferWithdrawRequestBindingModel.Amount=c.Amount,this.BankTransferWithdrawRequestBindingModel.Bank=c.Bank,this.BankTransferWithdrawRequestBindingModel.AccountNumber=c.AccNum,this.BankTransferWithdrawRequestBindingModel.AccountHolder=c.Name,this.BankTransferWithdrawRequestBindingModel.SortCode=c.SortCode,this.BankTransferWithdrawRequestBindingModel.SwiftCode=c.Swift,this.BankTransferWithdrawRequestBindingModel.RoutingNo=c.RoutingNo,this.BankTransferWithdrawRequestBindingModel.IBANCode=c.IBAN,a.paymentVendors.bankTransfer.registerWithdraw(this.BankTransferWithdrawRequestBindingModel);case"InterswitchQuickTellerWithdrawal":if(globalSettings.Account_EnableWithdrawalBankProfile){var e={Amount:c.Amount,BankTransferDetailsId:c.BankTransferDetailsId,PaymentMethod:c.PaymentMethod};return a.paymentVendors.interswitch.registerInterswitchWithdrawal(e)}var f={Amount:c.Amount,PaymentMethod:c.PaymentMethod,AccountNumberForQuicktellerWithdrawal:c.AccountNumberForQuicktellerWithdrawal,BankIdForQuicktellerWithdrawal:c.BankIdForQuicktellerWithdrawal};return a.paymentVendors.interswitch.registerWithdraw(f);case"Paystack":return this.PaystackWithdrawalRequestBindingModel=new gamingAppModels.PaystackWithdrawalRequestBindingModel,this.PaystackWithdrawalRequestBindingModel.Amount=c.Amount,this.PaystackWithdrawalRequestBindingModel.AccountNumber=c.AccNum,this.PaystackWithdrawalRequestBindingModel.BankCode=c.BankCode,a.paymentVendors.paystack.registerWithdrawal(this.PaystackWithdrawalRequestBindingModel);case"MpesaWithdrawal":return this.MpesaWithdrawalRequestBindingModel=new gamingAppModels.MpesaWithdrawalRequestBindingModel,this.MpesaWithdrawalRequestBindingModel.Remarks="sample string 1",this.MpesaWithdrawalRequestBindingModel.Amount=c.Amount,a.paymentVendors.safariCom.registerWithdrawal(this.MpesaWithdrawalRequestBindingModel);case"ZenithBankCIB":if(globalSettings.Account_EnableWithdrawalBankProfile){var e={Amount:c.Amount,BankDetailsID:c.BankTransferDetailsId};return a.paymentVendors.zenith.registerZenithWithdrawalBankDetails(e)}var f={Amount:c.Amount,BeneficiaryAccount:c.AccNum,BeneficiaryBankCode:c.BankId};return a.paymentVendors.zenith.registerWithdrawal(f);case"AmoleWithdrawal":return b.payments.amole.registerWithdrawal(c);case"CBEWithdrawal":return b.payments.cbe.registerWithdrawal({Amount:c.Amount});default:return}},cancelDepositTransaction:function(a){return b.payments.cbe.cancelDepositTransaction(a)},fetchPendingDeposits:function(){return b.payments.cbe.fetchPendingDeposits()},depositStaus:function(a){return b.payments.telebirr.depositStaus(a)},pendingTransactions:function(){return b.payments.telebirr.pendingTransactions()},withdrawalStatus:function(a,c){return b.paymentVendors.endpoints.withdrawalStatus(a,c)},depositStatus:function(a,c){return b.paymentVendors.endpoints.depositStatus(a,c)}}}])}(),function(){angular.module("withdrawBankProfileMethodData",["bankProfile.service"]).controller("withdrawBankProfileMethodDataController",["$filter","$rootScope","$state","$q","authService","websiteApiService","platformApiService","paymentProviderService","bankProfileService","currencyService","$sce","$location","$timeout","$scope","helperService","$anchorScroll","loggingService","umbracoApiService","$interval",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t=this,u=locale.account.paymentMethods.withdrawal.withdrawFastProcess,v=locale.account.paymentMethods.withdrawal.changeDetailsDisc,w=locale.account.paymentMethods.withdrawal.emailHTML,x=locale.account.paymentMethods.withdrawal.saveProfilePrimHTML,y=locale.account.paymentMethods.withdrawal.saveProfileSecHTML,z=locale.account.paymentMethods.withdrawal.changeProfileHTML,A='<div class="couponConfirmation"><div class="contentMessage"><div class="messageContent"><i class="fa fa-exclamation-triangle" style="font-size:50px;justify-content:center;display:flex;"></i></br></br><span class="message text-left">'+locale.account.editProfile.saveWithdrawalBankProfile.swapProfilesMessage+"</span></div></div></div>",B='<div class="couponConfirmation"><div class="contentMessage"><div class="messageContent"><i class="fa fa-university" style="font-size:50px;justify-content:center;display:flex;"></i></br></br><span class="message text-left">',C="</span></div></div></div>";this.email="",this.showingAmount=!0,this.showBankProfiles=!0,this.UserSecureId="",this.userAccountId="",this.linkLabel=null,this.accountChanger=!0,this.depositChannels={},this.selectedChannel=null,this.paymentMethodPlatformCallBack=n.selectedApi,this.paymentMethodDataCallBack=null,this.showProfileChange=!1,this.checkboxEl=!1,this.bankDetails={},this.nubanNumber="",this.BankCode="",this.selectedBank=t.selectedBank,this.paymentMethod="",this.Amount=null,this.Bank="",this.AccNum="",this.Name="",this.SortCode="",this.RoutingNo="",this.Swift="",this.IBAN="",this.fees=0,this.profiles=[],this.profile={},this.holderName="",this.accountNumber="",this.ibanCode="",this.routingNumber="",this.sortCode="",this.swiftCode="",this.secondaryProfile=!1,this.disclaimer=v,this.allowedProfiles=0,this.showAwaitingAproval=!1,this.depositRatio=0,this.withdrawalWin=0,
this.isUserAboveThreshold=!1,this.checkWithdrawalOfDeposit=!0,this.htmlTextWithDepRto=locale.account.paymentMethods.withdrawal.autoWithdrawalDisc,this.isAgent=e.isAgent(),this.contactUsUrl="/help/general-help/contact-us/",this.showAcceptingTraffic=!1,this.isDisabledBtn=!1,this.originalMaxLimit=0,this.isYNotWholeBalanceDisc=!0,this.withdrawalLoading=!1,this.withdrawalStatusMessage={},this.withdrawalPollInterval=null,this.withdrawalPollCounter=0,this.withdrawalPolling=!1,this.bankProfileLoading=!1,this.bankProfileStatusMessage={},this.bankProfileStatusPollInterval=null,this.bankProfileStatusPollCounter=0,this.bankProfileStatusPolling=!1,h.getUserEmail().then(function(a){a.success||q.logError(w+a.error),t.email=a.data.UserDetails.Email});var D=JSON.parse(globalSettings.Account_QuickCashDelimiters.replaceAll("'",'"')),E=D[t.paymentMethodPlatformCallBack.Identifier]||D.defaultWithdrawal;this.quickValues=_.uniq(_.remove(E,function(a){return!isNaN(a)})),this.setAmount=function(a,b){if(a){if(b.AmountValue.$setDirty(),t.Amount=a,t.checkWithdrawalOfDeposit&&!t.isUserAboveThreshold&&t.Amount>t.withdrawalWin&&!t.isAgent)return void b.AmountValue.$setValidity("withdrawableMaxAmount",!1);b.AmountValue.$setValidity("withdrawableMaxAmount",!0)}},this.isBalanceOrWithdrawableBalance=function(a){var b=t.checkWithdrawalOfDeposit?t.isUserAboveThreshold?a:t.withdrawalWin:a;return b=t.paymentMethodPlatformCallBack.MaximumLimit.Amount<b?t.paymentMethodPlatformCallBack.MaximumLimit.Amount:b,b=b<t.paymentMethodPlatformCallBack.MinimumLimit.Amount?t.paymentMethodPlatformCallBack.MaximumLimit.Amount:b},this.profileChanged=function(){if(t.profile.Verification&&1===t.profile.Verification.VerificationStatusID?t.showAwaitingAproval=!0:t.showAwaitingAproval=!1,t.profile.Redirect)t.redirectProfileManagment();else if(t.profile.Secondary)return t.showProfileChange=!0,t.disclaimer=u,t.secondaryProfile=!0,void(t.showBankProfiles=!1);t.secondaryProfile&&!t.profile.Secondary&&(t.disclaimer=v,t.showBankProfiles=!0),t.profile.Default?t.showProfileChange=!1:t.showProfileChange=!0},this.performSimpleWithdraw=function(){if(t.isDisabledBtn=!0,b.showLoader(".Centralbody"),t.showBankProfiles){var a=t.setPaymentObject(),c=t.profile.BankName,d=t.getSelectedBankList();t.checkboxEl?(t.checkboxEl=!1,t.swapBankProfile(t.profile).then(function(e){e?t.validatePaymentBankWithProfile(d,c)?t.postWithdrawal(a):o.showStickyMessage("success",z,3e3):b.hideLoader(".Centralbody")})):t.validatePaymentBankWithProfile(d,c)?t.postWithdrawal(a):o.showStickyMessage("success",z,3e3)}else o.showMessageWithHtml(B+x+"("+locale.account.editProfile.saveWithdrawalBankProfile.bankName+": "+t.selectedBank.BankName+", "+locale.account.editProfile.saveWithdrawalBankProfile.bankAccountNumber+": "+t.nubanNumber+")"+y+C,!0,locale.common.cancel,!0,locale.common.proceed).then(function(){t.saveProfileAndWithdraw()},function(a){b.hideLoader(".Centralbody"),t.isDisabledBtn=!1}).done()},this.saveProfileAndWithdraw=function(){b.hideLoader(".Centralbody");var a={AccountNumber:t.nubanNumber,BankCode:t.selectedBank.BankCode,Default:t.checkboxEl};i.saveNewBankProfile(a,!0,!0).then(function(a){t.bankProfileLoading=!0,t.isDisabledBtn=!1,a?(i.setSaveBankAccStatus(!0),t.checkBankProfileStatus(a),t.showBankProfiles=!0):t.bankProfileLoading=!1},function(a){})},this.checkBankProfileStatus=function(a){t.bankProfileStatuPollCounter=0,t.bankProfileStatusPolling=!0,t.bankProfileStatusPollInterval=s(function(){t.bankProfileStatusPollCounter++,g.paymentVendors.bankTransfer.getBankProfileById(a).then(function(b){t.mapBankProfileStatus(b.data.Verification,a)})},globalSettings.Account_BankProfileStatusPollInterval)},this.mapBankProfileStatus=function(a,b){switch(a.VerificationStatusCode){case"PENDING":t.bankProfileStatusPollCounter>=globalSettings.Account_BankProfileStatusPollCountLimit&&(s.cancel(t.bankProfileStatusPollInterval),t.bankProfileLoading=!1,t.bankProfileStatusPolling=!1,t.postWithdrawal({Amount:t.Amount,BankTransferDetailsId:b,PaymentMethod:t.paymentMethodPlatformCallBack.Identifier}),t.amount=0);break;case"REJECTED":s.cancel(t.bankProfileStatusPollInterval),this.bankProfileStatusPolling=!1,t.bankProfileLoading=!1,t.bankProfileStatusMessage.type="Rejected",t.bankProfileStatusMessage.icon="ERROR",t.bankProfileStatusMessage.title="The bank account could not be added due to "+a.DeclineReason,t.bankProfileStatusMessage.descriptions=["Please try again by adding another bank account where name is same as Betking first and last name"],t.bankProfileStatusMessage.buttons=[{btnText:"PLEASE ADD ANOTHER BANK",primaryBtn:!0,action:function(){t.profile={},t.selectedBank=null,t.nubanNumber=null,t.showBankProfiles=!1,t.bankProfileStatusMessage={}}},{btnText:"PROCEED TO HOMEPAGE",primaryBtn:!1,redirectUrl:"/sports/s"}];break;case"VERIFIED":s.cancel(t.bankProfileStatusPollInterval),this.bankProfileStatusPolling=!1,t.bankProfileLoading=!1,t.bankProfileStatusMessage.loading=!0,t.bankProfileStatusMessage.type="Success",t.bankProfileStatusMessage.icon="SUCCESS",t.bankProfileStatusMessage.title="Bank Account has been added successfully",t.bankProfileStatusMessage.descriptions=["We are now processing your withdrawal"],setTimeout(function(){t.postWithdrawal({Amount:t.Amount,BankTransferDetailsId:b,PaymentMethod:t.paymentMethodPlatformCallBack.Identifier})},1e3),t.amount=0;break;default:this.bankProfileStatusPolling=!1,t.bankProfileLoading=!1,s.cancel(t.bankProfileStatusPollInterval)}},this.setPaymentObject=function(){return{Amount:t.Amount,PaymentMethod:t.paymentMethodPlatformCallBack.Identifier,AccountNumberForQuicktellerWithdrawal:t.nubanNumber,BankIdForQuicktellerWithdrawal:t.selectedBank?t.selectedBank.Id:null,BankTransferDetailsId:t.profile.Id,BankDetailsID:t.profile.Id,BankProfileId:t.profile.Id}},this.getSelectedBankList=function(){return i.bankLists},this.validatePaymentBankWithProfile=function(a,b){var c=!1;return a.forEach(function(a){a.BankName!==b&&a.BankCode!==b||(c=!0)}),c},this.postWithdrawal=function(a){t.bankProfileStatusMessage={},"WithdrawalLoadBalancer"===t.paymentMethodPlatformCallBack.Identifier?(b.hideLoader(),t.postLoadBalancedWithdrawal(a)):t.postSBADWithdrawal(a)},this.postSBADWithdrawal=function(a){h.registerWithdrawWithCallBack(a,t.paymentMethodPlatformCallBack.Identifier).then(function(a){if(t.isDisabledBtn=!1,b.hideLoader(".Centralbody"),!a.success){if(a.error){if("InterswitchQuickTellerWithdrawal"===t.paymentMethodPlatformCallBack.Identifier&&8===a.responseCode){var c=JSON.parse(a.userMsg),d='<div class="popup-title">'+locale.account.paymentMethods.rejectedPopupTitle+"</div>",f="";for(var g in c){var h="";h=c[g].includes('href="{{contactUs}}"')?c[g].replace('href="{{contactUs}}"','href="'+t.contactUsUrl+'"'):c[g],errorTitle=locale.account.paymentMethods.rejectedErrorType[g],f=f+'<span class="message rem1">'+errorTitle+" - "+h+"</span></br></br>"}var i='<div style="display: flex"><div class="icon"><i class="fa fa-exclamation-triangle" style="padding-right:20px;align-items:center;"></i></div>'+f+"</div>",j='<div class="couponConfirmation"><div class="messageContent">'+d+i+"</div></div>";return void o.showMessage("error",j).done()}q.logError(a.error,a.responseCode||a.userMsg,a.error&&a.userMsg)}var k=o.handlePlatformError(a);return void(k||o.showErrorMessage(a.userMsg).done())}o.showSuccessMessage(a.userMsg+" "+locale.account.paymentMethods.interswitch.newSuccessfullMessage).done(),o.createDataLayerEvent({event:"user-withdraw-funds",userID:e.getUserData().userID,withdrawAmount:t.Amount,accountEmpty:n.authCtrl.balances[0].Balance-t.Amount===0}),window.history.back()})},this.postLoadBalancedWithdrawal=function(a){var b={Amount:a.Amount,BeneficiaryBankDetailsId:a.BankTransferDetailsId},c=_.find(this.bankDetails,function(a){return t.selectedBank&&t.selectedBank.BankCode?t.selectedBank.BankCode===a.BankCode:t.profile.BankCode===a.BankCode});if(c&&0==c.IsAvailable){var d=function(){t.isDisabledBtn=!1},e="Payout to "+c.BankName+" accounts may take up to 24 hours due to delays from the bank. Feel free to discontinue and make your withdrawal using another bank account that belongs to you.";o.showMessage("info",e,"info-circle",!0,locale.common.cancel,!0,"Proceed",d).then(function(a){t.processWithdrawal(b)})}else this.processWithdrawal(b)},this.processWithdrawal=function(c){this.withdrawalLoading=!0,f.paymentVendors.registerLoadbalancerWithdrawal(c).then(function(c){if(t.isDisabledBtn=!1,b.hideLoader(".Centralbody"),c.success){var d="";if(globalSettings.Account_PaymentMaxLimitAllowed.enabled&&globalSettings.Account_PaymentMaxLimitAllowed.withdrawalDailyAttempts){var f=globalSettings.Account_PaymentMaxLimitAllowed.withdrawalDailyAttempts.targetValue-(globalSettings.Account_PaymentMaxLimitAllowed.withdrawalDailyAttempts.currentValue+1),g=" You have exhausted your withdrawal limit for the day. Not to worry, withdraw again tomorrow. Keep Kinging!",h=" You have "+f+" withdrawals left for the day. Keep Kinging!";d=f<=0?g:h}t.withdrawalStatus(c.data,d),o.createDataLayerEvent({event:"user-withdraw-funds",userID:e.getUserData().userID,withdrawAmount:t.Amount,accountEmpty:n.authCtrl.balances[0].Balance-t.Amount===0})}else{if(t.withdrawalPolling=!1,t.withdrawalLoading=!1,c.data&&"HARD_CHECK_AW_EXCEPTION"===c.data.ErrorCode){var i='<div class="popup-title">'+locale.account.paymentMethods.rejectedPopupTitle+"</div>",j="";_.each(c.data.ErrorDetails,function(a,b,c){var d="";d=a.includes('href="{{contactUs}}"')?a.replace('href="{{contactUs}}"','href="'+t.contactUsUrl+'"'):a,errorTitle=locale.account.paymentMethods.rejectedErrorType[b],j=j+'<span class="message rem1">'+(errorTitle?errorTitle+" - ":"")+d+"</span></br></br>"}),t.profile={BankName:locale.account.editProfile.saveWithdrawalBankProfile.titleSecondary,AccountNumber:"",BankCode:"SecProfile",Id:-1,Secondary:!0,UserFriendlyName:""},t.profileChanged();var k='<div style="display: flex"><div class="icon"><i class="fa fa-exclamation-triangle" style="padding-right:20px;align-items:center;"></i></div>'+j+"</div>",l='<div class="couponConfirmation"><div class="messageContent">'+i+k+"</div></div>";return void o.showMessage("error",l).done()}var m=locale.account.paymentMethods.paymentGeneralErrorCodes[c.data.ErrorCode];m||(m=locale.account.paymentMethods.paymentGeneralErrorCodes.INTERNAL_SERVER_ERROR),m.includes("{MaximumWithdrawalLimit}")&&(m=m.replace("{MaximumWithdrawalLimit}",c.data.ErrorDetails.MaximumWithdrawalLimit)),m.includes("{TransactionAmount}")&&(m=m.replace("{TransactionAmount}",c.data.ErrorDetails.TransactionAmount)),m.includes("{CurrentScore}")&&(m=m.replace("{CurrentScore}",c.data.ErrorDetails.CurrentScore)),m.includes("{MinimumLimit}")&&(m=m.replace("{MinimumLimit}",a("currencyFormat")(c.data.ErrorDetails.MinimumLimit,2))),m.includes("{MaximumLimit}")&&(m=m.replace("{MaximumLimit}",a("currencyFormat")(c.data.ErrorDetails.MaximumLimit,2))),o.showMessage("error",m,"exclamation-triangle",!1,"",!1,"").done()}})},this.withdrawalStatus=function(a,b){t.withdrawalPollCounter=0,t.withdrawalPolling=!0,t.withdrawalPollInterval=s(function(){t.withdrawalPollCounter++,f.paymentVendors.withdrawalStatus(a.TransactionId,a.TransactionTypeId).then(function(a){t.withdrawalStatusMessage.type=a.data.Status,t.withdrawalStatusMessage.time=a.data.EstimatedMinutesToComplete,t.withdrawalStatusMessage.info=b,t.withdrawalPollCounter>=globalSettings.Account_WithdrawalPollCountLimit&&(s.cancel(t.withdrawalPollInterval),t.withdrawalPolling=!1),t.mapWithdrawalStatus()})},globalSettings.Account_WithdrawalPollInterval)},this.mapWithdrawalStatus=function(){switch(this.withdrawalLoading=!1,t.withdrawalStatusMessage.type){case"AwaitingInfo":s.cancel(t.withdrawalPollInterval),this.withdrawalPolling=!1,t.withdrawalStatusMessage.descriptions=["We need some information from you before releasing your withdrawal. Kindly check your instant messages for more details."],t.withdrawalStatusMessage.buttons=[{btnText:"CHECK STATUS IN INSTANT MESSAGE",primaryBtn:!0,redirectUrl:"/account/ac/messages/overview"},{btnText:"PROCEED TO HOME PAGE",primaryBtn:!1,redirectUrl:"/sports/s"}],t.withdrawalStatusMessage.title="Withdrawal is in process",t.withdrawalStatusMessage.icon="WAIT";break;case"Complete":this.withdrawalPolling=!1,s.cancel(t.withdrawalPollInterval),t.withdrawalStatusMessage.amount=t.formatCurrency(this.Amount),t.withdrawalStatusMessage.buttons=[{btnText:"PROCEED TO HOMEPAGE",primaryBtn:!0,redirectUrl:"/sports/s"}],t.withdrawalStatusMessage.title="Withdrawal Successful",t.withdrawalStatusMessage.descriptions=["Congratulations King! Your withdrawal has been completed. Please check your Bank account statement."],t.withdrawalStatusMessage.icon="SUCCESS";break;case"ManualQueue":s.cancel(t.withdrawalPollInterval),this.withdrawalPolling=!1,t.withdrawalStatusMessage.descriptions=["We need to verify this withdrawal request.","It may take up to 24 hours to verify and complete it. Please wait for a while, we will notify you when it is done."],t.withdrawalStatusMessage.buttons=[{btnText:"CHECK STATUS IN ACCOUNT STATEMENT",primaryBtn:!0,redirectUrl:"/account/ac/statementsearch"},{btnText:"PROCEED TO HOME PAGE",primaryBtn:!1,redirectUrl:"/sports/s"}],t.withdrawalStatusMessage.title="Withdrawal is in process",t.withdrawalStatusMessage.icon="WAIT",console.log(t.withdrawalStatusMessage);break;case"Pending":case"Processing":t.withdrawalPollCounter<globalSettings.Account_WithdrawalPollCountLimit?this.withdrawalLoading=!0:(t.withdrawalStatusMessage.descriptions=["We have sent the withdrawal but your bank is taking a bit longer to respond.","It may take up to 15 minutes to complete. Please wait, we will notify you once it is done."],t.withdrawalStatusMessage.buttons=[{btnText:"CHECK STATUS IN ACCOUNT STATEMENT",primaryBtn:!0,redirectUrl:"/account/ac/statementsearch"},{btnText:"PROCEED TO HOME PAGE",primaryBtn:!1,redirectUrl:"/sports/s"}],t.withdrawalStatusMessage.title="Withdrawal is in Process",t.withdrawalStatusMessage.icon="WAIT");break;case"Rejected":if(this.withdrawalPolling=!1,s.cancel(t.withdrawalPollInterval),globalSettings.Account_PaymentMaxLimitAllowed.enabled&&globalSettings.Account_PaymentMaxLimitAllowed.withdrawalDailyAttempts){var a=globalSettings.Account_PaymentMaxLimitAllowed.withdrawalDailyAttempts.targetValue-globalSettings.Account_PaymentMaxLimitAllowed.withdrawalDailyAttempts.currentValue,b=" You have exhausted your withdrawal limit for the day. Not to worry, withdraw again tomorrow. Keep Kinging!",c=" You have "+a+" withdrawals left for the day. Keep Kinging!";t.withdrawalStatusMessage.info=a<=0?b:c}t.withdrawalStatusMessage.buttons=[{btnText:"PLEASE TRY AGAIN",primaryBtn:!0,redirectUrl:"/account/ac/withdraw"}],t.withdrawalStatusMessage.title="Withdrawal Rejected",t.withdrawalStatusMessage.icon="ERROR";break;default:s.cancel(t.withdrawalPollInterval)}},this.navigateTo=function(a,b){void 0==a&&null==a||(window.location.href=a),b&&b()},this.getWithdrawMethodsDataCallback=function(a){r.desktop.getWithdrawalMethodData(t.paymentMethodPlatformCallBack.Identifier).then(function(b){return b.success?void(t.paymentMethodDataCallBack=b.data):void q.logError(a.error,a.userMsg)})},this.getBankProfiles=function(a){i.profiles?t.populateUIAndDropdown(i.profiles,a):g.paymentVendors.bankTransfer.getBankTransferDetails().then(function(b){b.success?t.populateUIAndDropdown(i.parseProfiles(b.data),a):o.showErrorMessage(errorMsg||userMsg)})},this.populateUIAndDropdown=function(a,b){var c=[];a&&a.forEach(function(a){3!==a.Verification.VerificationStatusID&&c.push(a),b?a.Id==b&&(t.profile=a,t.profileChanged()):a.Default&&(t.profile=a,t.profileChanged())}),t.profiles=c,0===c.length&&(t.disclaimer=u,t.showBankProfiles=!1),g.paymentVendors.bankTransfer.checkAllowedBankProfiles().then(function(a){t.allowedProfiles=a.data,t.allowedProfiles>i.enabledProfiles&&t.profiles.push({BankName:locale.account.editProfile.saveWithdrawalBankProfile.titleSecondary,AccountNumber:"",BankCode:"SecProfile",Id:-1,Secondary:!0,UserFriendlyName:""})})},this.swapBankProfile=function(a){var c=d.defer();return o.showMessageWithHtml(A,!0,locale.common.cancel,!0,locale.common.ok).then(function(b){i.swapBankProfile(a).then(function(a){a||c.resolve(!1),a&&(t.getBankProfiles(),c.resolve(!0))})}).catch(function(a){b.hideLoader(".Centralbody")}).done(),c.promise},this.getBankDetails=function(){g.paymentVendors.bankInformation.getBankList().then(function(a){if(a.success)i.bankLists=a.data,t.bankDetails=a.data;else{q.logError(a.error);var b=o.handlePlatformError(a);b||o.showErrorMessage(a.userMsg).done()}})},this.getDepositRatio=function(){g.finance.getUserWithdrawalConfiguration().then(function(b){b.success?(t.checkWithdrawalOfDeposit=b.data.CheckWithdrawalOfDeposit,t.depositRatio=a("number")(100*b.data.Ratio,2),t.withdrawalWin=b.data.WithdrawalWin,t.isUserAboveThreshold=b.data.UserAboveThreshold):(t.depositRatio=0,t.withdrawalWin=0),t.htmlTextWithDepRto=locale.account.paymentMethods.withdrawal.autoWithdrawalDisc.replace("{withdrawable balance}",t.formatCurrency(t.withdrawalWin))})},this.getMaxLimit=function(a){return(t.Amount||a.AmountValue.$modelValue||a.AmountValue.$viewValue)&&(a.AmountValue.$setDirty(),parseFloat(a.AmountValue.$modelValue||a.AmountValue.$viewValue)>parseFloat(t.originalMaxLimit)?(a.AmountValue.$setValidity("max",!1),a.AmountValue.$setValidity("withdrawableMaxAmount",!0)):(a.AmountValue.$setValidity("max",!0),parseFloat(a.AmountValue.$modelValue||a.AmountValue.$viewValue)>parseFloat(t.paymentMethodPlatformCallBack.MaximumLimit.Amount)?a.AmountValue.$setValidity("withdrawableMaxAmount",!1):a.AmountValue.$setValidity("withdrawableMaxAmount",!0))),t.paymentMethodPlatformCallBack.MaximumLimit.Amount},this.getMinLimit=function(a){return t.Amount&&(parseFloat(a.AmountValue.$modelValue)<parseFloat(t.paymentMethodPlatformCallBack.MinimumLimit.Amount)?a.AmountValue.$setValidity("min",!1):a.AmountValue.$setValidity("min",!0)),t.paymentMethodPlatformCallBack.MinimumLimit.Amount},this.formatCurrency=function(a){return j.smartFormatNumber(t.paymentMethodPlatformCallBack.MinimumLimit.Currency,"string"==typeof a?parseFloat(a):a,2)},this.withdrawableFormaterCurrency=function(a){return t.checkWithdrawalOfDeposit?(t.isYNotWholeBalanceDisc=a>=t.withdrawalWin,t.isUserAboveThreshold?t.formatCurrency(a):t.formatCurrency(Math.min(a,t.withdrawalWin))):t.formatCurrency(a)},"Withdraw"===n.transferType&&(t.originalMaxLimit=t.paymentMethodPlatformCallBack.MaximumLimit.Amount,t.getBankProfiles(),t.getBankDetails(),t.getWithdrawMethodsDataCallback(),t.isAgent?t.withdrawalWin=t.paymentMethodPlatformCallBack.MaximumLimit.Amount:t.getDepositRatio(),"WithdrawalLoadBalancer"===t.paymentMethodPlatformCallBack.Identifier&&f.paymentVendors.getAcceptingTraffic().then(function(a){a.success&&!a.data.AcceptingTraffic&&(t.showAcceptingTraffic=!0)})),p()}])}(),function(){angular.module("withdrawMethodData",["bankProfile.service"]).controller("withdrawMethodDataController",["$state","$q","platformApiService","paymentProviderService","bankProfileService","$sce","$location","$timeout","$scope","helperService","$anchorScroll","loggingService","umbracoApiService","authService","websiteApiService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=this;this.email="",this.userID=n.getUserData().userID,this.linkLabel=null,this.UserSecureId="",this.userAccountId="",this.accountChanger=!0,this.showingAmount=!1,this.depositChannels={},this.selectedChannel=null,this.paymentMethodPlatformCallBack=i.selectedApi,this.paymentMethodDataCallBack=null,this.showingbankDetails=!1,this.showingAmount=!1,this.checkboxEl=!1,this.bankDetails={},this.nubanNumber="",this.BankCode="",this.selectedBank=p.selectedBank,this.paymentMethod="",this.Amount=null,this.Bank="",this.AccNum="",this.Name="",this.SortCode="",this.RoutingNo="",this.Swift="",this.IBAN="",this.fees=0,this.accountTypes=[{id:1,name:"primary"},{id:2,name:"secondary"}],this.accountType=null,this.ccinfo={cardNumber:void 0},this.userPhonenumber,this.profiles=[],this.profile={},this.holderName="",this.accountType="",this.accountNumber="",this.ibanCode="",this.routingNumber="",this.sortCode="",this.swiftCode="",this.isWithdrawalProcessing=!1,this.originalMaxLimit=0;var q=JSON.parse(globalSettings.Account_QuickCashDelimiters.replaceAll("'",'"')),r=q[p.paymentMethodPlatformCallBack.Identifier]||q.defaultWithdrawal;if(this.quickValues=_.uniq(_.remove(r,function(a){return!isNaN(a)})),this.setAmount=function(a){this.Amount=a,"MpesaWithdrawal"===p.paymentMethodPlatformCallBack.Identifier&&this.getFeeBands()},this.setDelimiterAmount=function(a,b){a&&(b.$setDirty(),p.setAmount(a))},globalSettings.Payment_CheckUserDataUponWithdraw&&c.user.getCurrentUserProfile().then(function(a){var b=a.data.UserDetails,c=a.data.UserAddressDetails[0];c&&b.Name&&b.Surname&&b.Email&&b.GenderCode&&b.BirthDate&&c.CountryCode&&c.Region&&c.City&&c.Line1||j.showMessageWithHtml('<table><tr><td><i class="fa fa-university" aria-hidden="true"></i></td><td><span>'+locale.account.paymentMethods.completeUserDataBeforeWithdrawal+"</span></td></tr></table>",!0,locale.common.cancel,!0,locale.common.proceed,void 0,"user-data-check-popup",void 0).then(function(){window.location.href="ac/editprofile"},function(){window.history.back()})}),d.getUserEmail().then(function(a){a.success||l.logError("Unable to get user eMail : "+a.error),p.email=a.data.UserDetails.Email,"AmoleWithdrawal"===p.paymentMethodPlatformCallBack.Identifier&&(p.userPhonenumber=a.data.PhoneContactDetails[0].ContactNumber.replace(/^(.{0})(.{3})(.*)$/,"$1+$2 $3"),p.ccinfo.cardNumber=a.data.PhoneContactDetails[0].ContactNumber)}),this.profileChange=function(a){p.readonlyProfile=!0;var b=_.findIndex(p.profiles,function(b){return b.UserFriendlyName===a});p.profiles[b].state===-1&&j.showErrorMessage(locale.account.editProfile.saveWithdrawalBankProfile.profileStillUnderEvaluation),p.holderName=p.profiles[b].AccountHolderName,p.accountNumber=p.profiles[b].AccountNumber,p.bank||(p.bank={}),p.bank.Name=p.profiles[b].BankName,p.ibanCode=p.profiles[b].IBANCode,p.routingNumber=p.profiles[b].RoutingNumber,p.sortCode=p.profiles[b].SortCode,p.swiftCode=p.profiles[b].SwiftCode,p.accountType=p.profiles[b].UserFriendlyName},this.getWithdrawalPaymentMethodCallBack=function(){return o.paymentVendors.getAllWithdrawalPaymentMethods()},this.getUnavailablePaymentMethodMessage=function(a){return locale.account.paymentMethods.withdrawal.withdrawalDisablePaymentMethod.replace("{method}",a)},this.processWithdrawal=function(){p.getWithdrawalPaymentMethodCallBack().then(function(a){m.desktop.getWithdrawalMethodList().then(function(b){var c=_.find(a.data,{Identifier:p.paymentMethodPlatformCallBack.Identifier}),d=_.find(b.data,{PaymentId:p.paymentMethodPlatformCallBack.Identifier});if(c.IsEnabled&&"offline"!=d.Status&&"disabled"!=d.Status)p.performSimpleWithdraw();else{var e=p.getUnavailablePaymentMethodMessage(d.PaymentTitle||c.Name);j.showInfoMessage(e).done().then(function(){g.path("/ac/withdraw")})}})})},this.performSimpleWithdraw=function(){var a,b,c={};switch(p.paymentMethodPlatformCallBack.Identifier){case"AmoleWithdrawal":c={Amount:p.Amount,ContactNumber:p.ccinfo.cardNumber};break;case"BankTransfer":c={Amount:p.Amount,Bank:p.Bank,AccNum:p.AccNum,Name:p.Name,SortCode:p.SortCode,RoutingNo:p.RoutingNo,Swift:p.Swift,IBAN:p.IBAN};break;case"InterswitchQuickTellerWithdrawal":b=e.bankLists,a=p.profile.BankName,c={Amount:p.Amount,PaymentMethod:p.paymentMethodPlatformCallBack.Identifier,AccountNumberForQuicktellerWithdrawal:p.nubanNumber,BankIdForQuicktellerWithdrawal:p.selectedBank?p.selectedBank.Id:null,BankTransferDetailsId:p.profile.Id};break;case"Paystack":c={AccNum:p.AccNum,BankCode:p.selectedBank.Id,Amount:p.Amount};break;case"MpesaWithdrawal":c={Amount:p.Amount};break;case"ZenithBankCIB":b=e.bankLists,a=p.profile.BankName,c={AccNum:p.AccNum,BankId:p.selectedBank.Id,BankProfileId:p.profile.Id,Amount:p.Amount};break;case"CBEWithdrawal":default:c={Amount:p.Amount}}p.checkboxEl?(p.checkboxEl=!1,p.swapBankProfile(p.profile).then(function(d){d&&(p.validatePaymentBankWithProfile(b,a)?p.postWithdrawal(c):j.showErrorMessage(locale.account.editProfile.saveWithdrawalBankProfile.bankNotAcceptedError).done())})):globalSettings.Account_EnableWithdrawalBankProfile?p.validatePaymentBankWithProfile(b,a)?p.postWithdrawal(c):j.showErrorMessage(locale.account.editProfile.saveWithdrawalBankProfile.bankNotAcceptedError).done():p.postWithdrawal(c)},this.validatePaymentBankWithProfile=function(a,b){var c=!1;return a.forEach(function(a){a.Name!==b&&a.BankCode!==b||(c=!0)}),c},this.postWithdrawal=function(a){p.isWithdrawalProcessing=!0,d.registerWithdrawWithCallBack(a,p.paymentMethodPlatformCallBack.Identifier).then(function(a){if(p.isWithdrawalProcessing=!1,"CBEWithdrawal"!=p.paymentMethodPlatformCallBack.Identifier&&"AmoleWithdrawal"!==p.paymentMethodPlatformCallBack.Identifier){if(!a.success){a.error&&l.logError(a.error,a.responseCode||a.userMsg,a.error&&a.userMsg);var b=j.handlePlatformError(a);return void(b||j.showErrorMessage(a.userMsg).done())}var c=locale.account.paymentMethods.interswitch.newSuccessfullMessage;j.showSuccessMessage(c).done(),j.createDataLayerEvent({event:"user-withdraw-funds",userID:n.getUserData().userID,withdrawAmount:p.Amount,accountEmpty:i.authCtrl.balances[0].Balance-p.Amount===0}),window.history.back(),i.accepted(a.userMsg,a.error)}else if(a.success)"AmoleWithdrawal"===p.paymentMethodPlatformCallBack.Identifier?(j.showSuccessMessage(locale.account.paymentMethods.pendingApprovals.successWithdrawal).done(),j.createDataLayerEvent({event:"user-withdraw-funds",userID:n.getUserData().userID,withdrawAmount:p.Amount,accountEmpty:i.authCtrl.balances[0].Balance-p.Amount===0}),window.history.back(),i.accepted(a.userMsg,a.error)):j.showMessageWithHtml(p.cbeSuccessHTMLString,!1,null,!0,locale.common.ok.toUpperCase(),function(a){window.history.back(),p.setAmount(p.paymentMethodPlatformCallBack.MinimumLimit.Amount)});else{if(a.data&&"HARD_CHECK_AW_EXCEPTION"===a.data.ErrorCode){var d=locale.account.paymentMethods.paymentGeneralErrorCodes.HARD_CHECK_AW_EXCEPTION+"</br></br>";return _.each(a.data.ErrorDetails,function(a,b,c){var e="";e=a.includes('href="{{contactUs}}"')?a.replace('href="{{contactUs}}"','href="'+p.contactUsUrl+'"'):a,errorTitle=locale.account.paymentMethods.rejectedErrorType[b],d=d+(errorTitle?errorTitle+" - ":"")+e+"</br>"}),void j.showMessageWithHtml(d,!1,null,!1,null)}var e=locale.account.paymentMethods.paymentGeneralErrorCodes[a.data.ErrorCode];e||(e=locale.account.paymentMethods.paymentGeneralErrorCodes.INTERNAL_SERVER_ERROR),e.includes("{MaximumWithdrawalLimit}")&&(e=e.replace("{MaximumWithdrawalLimit}",a.data.ErrorDetails.MaximumWithdrawalLimit)),e.includes("{TransactionAmount}")&&(e=e.replace("{TransactionAmount}",a.data.ErrorDetails.TransactionAmount)),e.includes("{CurrentScore}")&&(e=e.replace("{CurrentScore}",a.data.ErrorDetails.CurrentScore)),e.includes("{MinimumLimit}")&&(e=e.replace("{MinimumLimit}",$filter("currency")(a.data.ErrorDetails.MinimumLimit,n.getUserData().currency.CurrencySymbol,2))),e.includes("{MaximumLimit}")&&(e=e.replace("{MaximumLimit}",$filter("currency")(a.data.ErrorDetails.MaximumLimit,n.getUserData().currency.CurrencySymbol,2))),e.includes("{MaximumDailyLimit}")&&(e=e.replace("{MaximumDailyLimit}",$filter("currency")(a.data.ErrorDetails.MaximumDailyLimit,n.getUserData().currency.CurrencySymbol,2))),e.includes("{MaximumAttempts}")&&(e=e.replace("{MaximumAttempts}",a.data.ErrorDetails.MaximumAttempts)),j.showMessageWithHtml(e,!1,null,!0,locale.common.ok.toUpperCase(),function(a){p.setAmount(p.paymentMethodPlatformCallBack.MinimumLimit.Amount)})}})},this.getWithdrawMethodsDataCallback=function(a){m.desktop.getWithdrawalMethodData(p.paymentMethodPlatformCallBack.Identifier).then(function(b){return b.success?void(p.paymentMethodDataCallBack=b.data):void l.logError(a.error,a.userMsg)})},this.sanitizeProfiles=function(a){var b=[];return a?(a.forEach(function(a){0!==a.state&&b.push(a)}),a.length>0&&0===b.length?j.showInfoMessage(locale.account.editProfile.saveWithdrawalBankProfile.pendingApprovalStopWithdrawal):b=_.orderBy(b,["Order"],["asc"])):j.showInfoMessage(locale.account.editProfile.saveWithdrawalBankProfile.missingBankAccoutDetails),b},this.getBankProfiles=function(){e.profiles?(p.profiles=p.sanitizeProfiles(e.profiles),p.populateDropdown()):c.paymentVendors.bankTransfer.getBankTransferDetails().then(function(a){a.success?(p.profiles=p.sanitizeProfiles(e.parseProfiles(a.data)),p.populateDropdown()):j.showErrorMessage(errorMsg||userMsg)})},this.populateDropdown=function(){p.accountType||p.profiles&&0!=p.profiles.length&&(p.profiles.length>1?(p.profiles=_.orderBy(p.profiles,["Order"],["asc"]),p.profiles.length>2&&(p.profiles=_.uniqBy(p.profiles,"UserFriendlyName")),p.profile=p.profiles[0]):1===p.profiles.length&&(p.profile=p.profiles[0]),p.profileChange(p.profile.UserFriendlyName))},this.showProfileChange=!1,this.swapBankProfile=function(a){var c=b.defer(),d='<div class="couponConfirmation"><div class="contentMessage"><div class="messageContent"><i class="fa fa-exclamation-triangle" style="font-size:50px;justify-content:center;display:flex;"></i></br></br><span class="message text-left">'+locale.account.editProfile.saveWithdrawalBankProfile.swapProfilesMessage+"</span></div></div></div>";return j.showMessageWithHtml(d,!0,locale.common.cancel,!0,locale.common.confirm).then(function(){e.swapBankProfile(a).then(function(a){a||c.resolve(!1),a&&(p.getBankProfiles(),c.resolve(!0))})}),c.promise},this.getFeeBands=function(){""===p.Amount||void 0===p.Amount?p.fees=0:d.getFeeBands(p.paymentMethodPlatformCallBack.Identifier,this.Amount).then(function(a){p.fees=a.data.tariff})},this.getMaxLimit=function(a){return(p.Amount||a.AmountValue.$modelValue||a.AmountValue.$viewValue)&&(a.AmountValue.$setDirty(),parseFloat(a.AmountValue.$modelValue||a.AmountValue.$viewValue)>parseFloat(p.originalMaxLimit)?(a.AmountValue.$setValidity("max",!1),a.AmountValue.$setValidity("withdrawableMaxAmount",!0)):(a.AmountValue.$setValidity("max",!0),parseFloat(a.AmountValue.$modelValue||a.AmountValue.$viewValue)>parseFloat(p.paymentMethodPlatformCallBack.MaximumLimit.Amount)?a.AmountValue.$setValidity("withdrawableMaxAmount",!1):a.AmountValue.$setValidity("withdrawableMaxAmount",!0))),p.paymentMethodPlatformCallBack.MaximumLimit.Amount},this.getMinLimit=function(a){return p.Amount&&(parseFloat(a.AmountValue.$modelValue)<parseFloat(p.paymentMethodPlatformCallBack.MinimumLimit.Amount)?a.AmountValue.$setValidity("min",!1):a.AmountValue.$setValidity("min",!0)),p.paymentMethodPlatformCallBack.MinimumLimit.Amount},this.paymentInputInit=function(){p.Amount=p.paymentMethodPlatformCallBack.MinimumLimit.Amount},this.cbeProcessPerformWithdrawal=function(a){p.isWithdrawalProcessing=!0,p.cbeSuccessHTMLString=a,p.processWithdrawal()},"Withdraw"===i.transferType){switch(p.originalMaxLimit=p.paymentMethodPlatformCallBack.MaximumLimit.Amount,p.paymentMethodPlatformCallBack.Identifier){case"ZenithBankCIB":case"InterswitchQuickTellerWithdrawal":p.showingbankDetails=!0,p.showingAmount=!0;break;case"Paystack":d.getPaymentChannels().then(function(a){p.depositChannels=a.data.channels,p.selectedChannel=a.data.channels[0]})}globalSettings.Account_EnableWithdrawalBankProfile&&(p.showingbankDetails=!1,p.getBankProfiles()),p.getWithdrawMethodsDataCallback()}k()}])}(),function(){angular.module("cardDeposit.service",[]).factory("cardDepositService",["websiteApiService","platformApiService","authService","$rootScope","$q",function(a,b,c,e,f){return{transactionStatuses:{Initializing:0,Created:1,AwaitingUserInput:2,AwaitingConfirmation:3,Success:4,Failed:5,Pending:6},transactionInstance:null,depositDetails:{},userData:{},genericErrorMessage:function(){return"An error has occurred during the deposit. Please try again."},broadcastDepositDetails:function(){e.$broadcast("depositDetails",this.depositDetails)},parseApiError:function(a){return a?locale.account.paymentMethods.paymentGeneralErrorCodes.paystack[a.errorCode]:this.genericErrorMessage;
},parsePaystackError:function(a){return{success:!1,errorMessage:a&&a.message?a.message:this.genericErrorMessage}},clearDepositDetails:function(){this.depositDetails={depositAmount:0,paymentIdentifier:"",transactionRefId:0,transactionStatus:this.transactionStatuses.Initializing,displayData:null,errorMessage:null}},beginDeposit:function(a,b,c){var e=this;this.clearDepositDetails(),this.updateDepositDetails("depositAmount",b),this.updateDepositDetails("paymentIdentifier",a),this.transactionInstance=null,this.registerDeposit(a,b,c).then(function(c){c.success||(e.updateDepositDetails("errorMessage",e.parseApiError(c.data)),e.updateDepositDetails("transactionStatus",e.transactionStatuses.Failed),d.resolve());var f=c.transactionRefId;e.createTransaction(f,b).then(function(b){b.success?(e.transactionInstance=b.transaction,e.processDeposit(a,f,!0).then(function(a){a.success?(e.updateDepositDetails("transactionRefId",f),e.updateDepositDetails("transactionStatus",e.transactionStatuses.Created)):(e.updateDepositDetails("errorMessage",a.errorMessage),e.updateDepositDetails("transactionStatus",e.transactionStatuses.Failed))})):(e.parsePaystackError(b.error),e.processDeposit(a,f,!1,b.errorMessage).then(function(){e.updateDepositDetails("errorMessage",b.errorMessage),e.updateDepositDetails("transactionStatus",e.transactionStatuses.Failed),d.resolve()}))})})},executeDeposit:function(a,b,c){var d=this;this.depositDetails&&this.transactionInstance||(this.updateDepositDetails("errorMessage",this.genericErrorMessage),this.updateDepositDetails("transactionStatus",UserJourneyDepositStatus.Failed)),c?this.authenticateCard(this.transactionInstance,c).then(function(a){d.updateDepositDetailsFromPaystackFnCall(a)}):this.chargeCard(this.transactionInstance,a,b).then(function(a){d.updateDepositDetailsFromPaystackFnCall(a)})},updateDepositDetailsFromPaystackFnCall:function(a){var b=this;a.success||this.confirmDeposit(this.depositDetails.paymentIdentifier,this.depositDetails.transactionRefId).then(function(a){b.parseConfirmDepositResponse(a)}),"auth"===a.chargeResult.status?(this.updateDepositDetails("displayData",a.chargeResult.data),this.updateDepositDetails("message",a.chargeResult.message),this.updateDepositDetails("transactionStatus",this.transactionStatuses.AwaitingUserInput)):this.confirmDeposit(this.depositDetails.paymentIdentifier,this.depositDetails.transactionRefId).then(function(a){b.parseConfirmDepositResponse(a)})},finalizeDeposit:function(a,b){var c=this;this.depositDetails&&this.transactionInstance||(this.updateDepositDetails("errorMessage",this.genericErrorMessage),this.updateDepositDetails("transactionStatus",c.transactionStatuses.Failed)),this.confirmDeposit(this.depositDetails.paymentIdentifier,this.depositDetails.transactionRefId,a,b).then(function(a){c.parseConfirmDepositResponse(a,b)})},registerDeposit:function(b,c,d){var e=f.defer(),g={Amount:c,PaymentMethod:b,IsCardSaved:d};return a.payments.paystack.registerDeposit(g).then(function(a){a&&a.data.Success&&a.data.TransactionID?e.resolve({success:!0,transactionRefId:a.data.TransactionID}):e.resolve(a)}),e.promise},createTransaction:function(a,b){var d=f.defer();this.userData=c.getUserData();const e={key:globalSettings.Account_PaystackDeposit.publicKey,email:this.userData.userID+"@kingmakers.com",amount:(100*b).toFixed(2),ref:a,currency:this.userData.currency.Currency,channels:["card"]};return Paystack.Transaction.request(e).then(function(a){a?d.resolve({success:!0,transaction:a}):d.resolve({success:!1})}),d.promise},updateDepositDetails:function(a,b){this.depositDetails[a]=b,"transactionStatus"===a&&this.broadcastDepositDetails()},processDeposit:function(b,c,d,e){var g=f.defer(),h={PaymentMethod:b,TransactionID:c,IsSuccess:d,FailReason:e||null};return a.payments.paystack.processDeposit(h).then(function(a){a&&a.data.Success?g.resolve({success:!0,data:a}):g.resolve({success:!1,data:a})}),g.promise},confirmDeposit:function(b,c,d,e){var g=f.defer(),h={PaymentMethod:b,TransactionID:c,IsSuccess:!d,FailReason:e||null};return a.payments.paystack.confirmDeposit(h).then(function(a){g.resolve(a)}),g.promise},chargeDeposit:function(b,c,d){var e=f.defer(),g=this,h={Amount:c,PaymentMethod:b,CreditCardDetailsID:d};return a.payments.paystack.chargeDeposit(h).then(function(a){a.data&&a.data.Success&&a.data.TransactionID?e.resolve({success:!0,transactionRefId:a.data.TransactionID}):e.resolve({success:!1,error:g.parseApiError()})}),e.promise},checkDepositStatus:function(b,c){var d=f.defer();return a.payments.paystack.checkDepositStatus(b,c).then(function(a){a.data&&a.data.TransactionStatus?d.resolve({success:!0,transactionStatus:a.data.TransactionStatus}):d.resolve({success:!1})}),d.promise},chargeCard:function(a,b,c){var d=f.defer(),e={number:b.cardNumber.toString(),cvv:b.cvv.toString(),month:b.expiryMonth.toString(),year:b.expiryYear.toString()};return c&&(e.pin=c),a.setCard(e).then(function(b){a.chargeCard().then(function(a){a?d.resolve({success:!0,chargeResult:a}):d.resolve({success:!1,data:a})})}),d.promise},authenticateCard:function(a,b){var c=f.defer();return a.authenticateCard(b).then(function(a){a?c.resolve({success:!0,chargeResult:a}):c.resolve({success:!1,data:a})}),c.promise},requeryTransaction:function(a){var b=f.defer();return a.requery().then(function(a){a?b.resolve({success:!0,requeryResult:a}):b.resolve({success:!1,data:a})}),b.promise},listenForBankAuthUpdates:function(){var a=this;this.transactionInstance||(this.updateDepositDetails("errorMessage",this.genericErrorMessage),this.updateDepositDetails("transactionStatus",this.transactionStatuses.Failed),d.resolve({success:!1})),this.transactionInstance.listenFor3DSCharge(function(b,c){a.depositDetails&&a.transactionInstance&&b&&b.data&&a.transactionInstance.id.toString()===b.data.trans&&a.confirmDeposit(a.depositDetails.paymentIdentifier,a.depositDetails.transactionRefId).then(function(b){a.parseConfirmDepositResponse(b)}),c()})},parseConfirmDepositResponse:function(a,b){return a&&a.success?void(400===a.data.TransactionStatus?(this.updateDepositDetails("transactionStatus",this.transactionStatuses.Success),this.transactionInstance=null):600===a.data.TransactionStatus?(this.updateDepositDetails("errorMessage",b||a.data.ThirdPartyMessage||this.genericErrorMessage),this.updateDepositDetails("transactionStatus",this.transactionStatuses.Failed),this.transactionInstance=null):(this.transactionInstance=null,this.updateDepositDetails("transactionStatus",this.transactionStatuses.Failed))):(this.transactionInstance=null,this.updateDepositDetails("errorMessage",this.genericErrorMessage),void this.updateDepositDetails("transactionStatus",this.transactionStatuses.Failed))},getMaximumCreditCards:function(){var a=f.defer();return b.finance.getMaxNumberOfSavedAccounts().then(function(b){a.resolve(b?b.data:0)}),a.promise},getSavedCreditCards:function(a){var c=this,d=f.defer();return b.paymentVendors.bankInformation.getVendorCreditCardDetails(a).then(function(a){a.data&&void 0!==a.data||(c.savedCreditCards=[],d.resolve([]));var b=[];a.data.forEach(function(a){b.push({id:a.ID,isDeleted:a.IsDeleted,isEnabled:a.IsEnabled,cardIssuer:a.CardIssuer,type:a.Type,createdOn:new Date(a.CreatedOn),expiryDate:a.ExpiryDate,lastDigits:a.LastDigits,token:a.Token})}),c.savedCreditCards=b,d.resolve({data:b})}),d.promise},disableSavedCreditCard:function(a){var c=this,d=f.defer();return b.paymentVendors.bankInformation.deleteVendorCreditCardDetails(a.id).then(function(b){if(b&&b.success){var e=c.savedCreditCards.indexOf(a);e>-1&&(c.savedCreditCards.splice(e,1),d.resolve({success:!0,data:c.savedCreditCards}))}else d.resolve({success:!1,error:"An error has occurred \n Could not remove saved credit card. Please try again."})}),d.promise},executeSavedCardDeposit:function(a,b,c){var d=this;this.clearDepositDetails(),this.updateDepositDetails("depositAmount",b),this.updateDepositDetails("paymentIdentifier",a),this.updateDepositDetails("transactionStatus",d.transactionStatuses.Initializing),this.transactionInstance=null,this.chargeDeposit(a,b,c).then(function(a){a.success?(d.updateDepositDetails("transactionRefId",a.transactionRefId),d.updateDepositDetails("transactionStatus",d.transactionStatuses.AwaitingConfirmation)):(d.updateDepositDetails("errorMessage",a.errorMessage),d.updateDepositDetails("transactionStatus",d.transactionStatuses.Failed))})},checkSavedCardDepositStatus:function(){var a=this,b=f.defer(),c=this.depositDetails;return c||(this.updateDepositDetails("errorMessage",this.genericErrorMessage),this.updateDepositDetails("transactionStatus",this.transactionStatuses.Failed),b.resolve({success:!1})),this.checkDepositStatus(c.paymentIdentifier,c.transactionRefId).then(function(c){c.success&&(600===c.transactionStatus?(a.updateDepositDetails("errorMessage",a.genericErrorMessage),a.updateDepositDetails("transactionStatus",a.transactionStatuses.Failed),b.resolve({success:!1})):400===c.transactionStatus&&(a.updateDepositDetails("transactionStatus",a.transactionStatuses.Success),b.resolve({success:!0})))}),b.promise}}}])}(),function(){angular.module("authenticatedJourneyDeposit",["cardDeposit.service","momoDeposit.service"]).controller("depositDataJourneyController",["$sce","$scope","$rootScope","$state","$window","$location","umbracoApiService","authService","loggingService","currencyService","cardDepositService","momoDepositService","platformApiService","websiteApiService","helperService","$sessionStorage","$interval","$uiRouterGlobals",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(){C.isRegisterUser?c.showLoader(".content","pop-up-card"):c.showLoader(".accountDepositContainer","payments")}function t(){C.isRegisterUser?c.hideLoader(".content","pop-up-card"):c.hideLoader(".accountDepositContainer","payments")}function u(){c.selectedApi&&c.selectedApi.MinimumLimit?(C.minAmount=c.selectedApi.MinimumLimit.Amount,C.maxAmount=c.selectedApi.MaximumLimit.Amount):n.paymentVendors.getAllDepositPaymentMethods().then(function(a){a.data.forEach(function(a){a.Identifier===C.paymentMethodPlatformCallBack.Identifier&&(C.minAmount=a.MinimumLimit.Amount,C.maxAmount=a.MaximumLimit.Amount)})})}function v(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=!0;null!==a[c].token&&""!==a[c].token&&a[c].token||(e=!1),a[c].isEnabled||(e=!1),e&&b.push(a[c])}return b}function w(b){C.depositMethod===C.depositMethods.cardDetails?(C.userInputExtraMessage=null,"pin"===b.displayData.auth?(A(),C.userInputMessageTitle=locale.account.registerWithDepositJourney.otpContent.title,C.userInputMessage=locale.account.registerWithDepositJourney.otpContent.message,C.pinInputShow=!0,C.otpInputShow=!1,C.depositStep=C.depositSteps.depositVendorOTP):"otp"===b.displayData.auth?(A(),C.userInputMessageTitle=locale.account.registerWithDepositJourney.otpContent.title,C.userInputMessage=locale.account.registerWithDepositJourney.otpContent.pinMessage,C.pinInputShow=!1,C.otpInputShow=!0,C.depositStep=C.depositSteps.depositVendorOTP):"3DS"===b.displayData.auth&&(C.bankAuthUrl=a.trustAsResourceUrl(k.depositDetails.message),C.depositStep=C.depositSteps.depositAuthIframe,k.listenForBankAuthUpdates())):(C.userInputMessageTitle=locale.account.registerWithDepositJourney.otpContent.verifyYourTransaction,C.userInputMessage=b.displayData.message,C.userInputExtraMessage=b.displayData.message_dial,"pop"===b.displayData.type?(C.showVerifyTransaction=!0,C.depositStep=C.depositSteps.popupWarningMsg,y()):"registration_token"===b.displayData.type&&(A(),C.pinInputShow=!1,C.otpInputShow=!0,C.depositStep=C.depositSteps.depositVendorOTP))}function x(){var a={RequestTypeOption:3,Data:{Username:C.getPhoneExtensionOnly()+C.getMobileNumberOnly()}};m.security.regenerateTokenForService(a).then(function(a){a.success||o.showErrorMessage(a.error).done()})}function y(){z(),this.isPolling=!0;var a=globalSettings.Account_PaystackDeposit;if(C.depositMethod===C.depositMethods.cardDetails)var b=k,c=a?a.cardRepeatDepositPollInterval:1e3,d=a?a.cardRepeatDepositPollAttempts:5;else var b=l,c=a?a.momoPollInterval:5e3,d=a?a.momoPollAttempts:36;var e=q(function(){C.pollCount++,C.pollCount>d?C.depositMethod===C.depositMethods.cardDetails?(z(e),b.updateDepositDetails("transactionStatus",b.transactionStatuses.Pending)):(q.cancel(e),z(e),b.finalizeDeposit(!1)):C.depositMethod===C.depositMethods.cardDetails?b.checkSavedCardDepositStatus().then(function(a){a&&(q.cancel(e),z(e))}):b.checkDepositStatus().then(function(a){!a.success||400!==a.transactionStatus&&600!==a.transactionStatus||(q.cancel(e),z(e),b.finalizeDeposit(!1))})},c);C.depositStatusPoll=e}function z(a){a&&q.cancel(a),C.depositStatusPoll&&(C.depositStatusPoll=null,C.isPolling=!1,C.pollCount=0)}function A(){C.verificationCode=null}function B(){var a=document.createElement("script");a.type="text/javascript",a.src=globalSettings.Account_PaystackDeposit.checkoutJsUrl,$("head").append(a)}var C=this;this.quickValues=[10,20,50,100,1e3],this.userDetails=h.getUserData(),this.balance=0,this.amount=null,this.ccNumber=null,this.expireDate=null,this.cvv=null,this.saveCardDetails=!0,this.paymentMethodPlatformCallBack=b.selectedApi,this.depositMethods={vendorSpecific:0,cardDetails:1},this.depositSteps={depositAuthIframe:5,otpVerification:4,popupWarningMsg:3,depositInput:0,depositVendorOTP:1,depositUserMsgPage:2},this.msgStates={success:0,error:1,pending:2},this.depositMethod=C.depositMethods.vendorSpecific,this.msgState=C.msgStates.success,this.depositStep=C.depositSteps.depositInput,this.depositListState="shopDepositPaymentMethod"===r.current.name?"shopDeposit":"accountDeposit",this.withdrawalListState="shopDepositPaymentMethod"===r.current.name?"shopWithdraw":"accountWithdraw",this.showingSavedCards=!0,this.selectedCard=null,this.selectedCardId=null,this.pollCount=0,this.isPolling=!1,this.depositStatusPoll=null,this.iconClass="fa fa-refresh",this.userMessage="",this.verificationCode=null,this.pinInputShow=!1,this.otpInputShow=!1,this.newCardDetails=null,this.forms={},this.bankAuthUrl=null,this.isRegisterUser=!(!c.selectedApi||"register"!==c.selectedApi.source),this.selectedCard=null,this.savedCreditCards=[],this.maximumCreditCards=0,this.userInputMessageTitle=null,this.userInputMessage=null,this.userInputExtraMessage=null,this.minAmount=0,this.maxAmount=0,this.canPaymentMethodChangeData={},this.showVerifyTransaction=!1,this.goBack=function(a){C.isRegisterUser?c.$emit("GoBack",null):C.depositListState&&d.go(C.depositListState,a)},this.gaDepositTrack=function(){m.paymentVendors.paymentMethods.hasPerformedDeposit().then(function(a){o.createDataLayerEvent({event:"user-add-funds",userID:h.getUserData().userID,fundAmount:p.lastDeposit,firstDeposit:a.success?!a.data.HasPerformedDeposit:void 0})})},this.morePaymentOptions=function(){C.canPaymentMethodChangeData={},n.payments.paystack.canPaymentMethodChange().then(function(a){if(!a.success)return void i.logError("Unable to check if user can change payment method: "+a.error);if(a.data.Success||!a.data.LastDepositMethod){var b=C.depositMethod===C.depositMethods.cardDetails?k:l;b.disableLastDepositAutoRedirect=!0,C.goBack({disableLastDepositAutoRedirect:!0})}else C.canPaymentMethodChangeData={currentBalance:a.data.CurrentBalance,balanceThreshold:a.data.MinimumAmountThreshold},C.depositStep=C.depositSteps.popupWarningMsg})},this.getBalance=function(){C.iconClass="fa fa-spinner fa-spin",m.finance.getPlaySource("web").then(function(a){return C.iconClass="fa fa-refresh",a.success?void angular.forEach(a.data,function(a){a.IsMain&&(C.balance=a.Balance)}):void i.logError("Unable to get user balances: "+a.error)}).catch(function(a){C.balance="---",C.iconClass="fa fa-refresh"})},this.getFullMobileNumber=function(){const a=C.userDetails.userName;return"+"+a.substring(0,3)+" "+a.substring(3,5)+" "+a.substring(5,8)+" "+a.substring(8)},this.getPhoneExtensionOnly=function(){return C.userDetails.userName.substring(0,3)},this.getMobileNumberOnly=function(){return C.userDetails.userName.substring(3)},this.getUnavailablePaymentMethodMessage=function(a){return locale.account.paymentMethods.deposit.depositDisablePaymentMethod.replace("{method}",a)},this.beginDeposit=function(){n.paymentVendors.getAllDepositPaymentMethods().then(function(a){var b=_.find(a.data,{Identifier:C.paymentMethodPlatformCallBack.Identifier});g.desktop.getDepositMethodData(C.paymentMethodPlatformCallBack.Identifier).then(function(a){if(b.IsEnabled&&a.data&&"online"==a.data.Status){p.lastDeposit=C.Amount;var c=C.paymentMethodPlatformCallBack.Identifier,d=C.amount;if(s(),C.depositMethod===C.depositMethods.cardDetails)if(C.showingSavedCards&&C.selectedCard){var e=C.selectedCard.id;k.executeSavedCardDeposit(c,d,e)}else{var g=C.saveCardDetails;k.beginDeposit(c,d,g)}else l.beginDeposit(c,d)}else{var h=C.getUnavailablePaymentMethodMessage(C.paymentMethodPlatformCallBack.PaymentTitle||C.paymentMethodPlatformCallBack.Name);o.showInfoMessage(h).done().then(function(){f.path("/ac/deposit")})}})})},this.verifyOTP=function(){return C.verificationCode===C.tempOTP},this.goToPage=function(a){a?window.location.href=a:C.depositStep=C.depositSteps.depositInput},this.goToState=function(a){a?d.go(a):C.depositStep=C.depositSteps.depositInput},this.getDepositMethodsDataCallback=function(){g.desktop.getDepositMethodData(C.paymentMethodPlatformCallBack.Identifier).then(function(a){if(!a.success)return void i.logError(a.error,a.userMsg);for(key in a.data){var b=!0;for(key2 in C.paymentMethodPlatformCallBack)key2===key&&(b=!1,C.paymentMethodPlatformCallBack[key2]=a.data[key]);b&&(C.paymentMethodPlatformCallBack[key]=a.data[key])}})},this.userExtraDetailsInput=function(a){C.depositStep=C.depositSteps.depositInput,s();var b=C.depositMethod===C.depositMethods.cardDetails?k:l;a?(b.depositDetails&&"pin"===b.depositDetails.displayData.auth&&b.executeDeposit(C.newCardDetails,C.verificationCode,null),b.depositDetails&&"otp"===b.depositDetails.displayData.auth&&b.executeDeposit(C.newCardDetails,null,C.verificationCode)):b.finalizeDeposit(!0,"The one time pin is required to process the deposit")},this.executeDeposit=function(a,b){var c=k.depositDetails;C.newCardDetails=C.parseCardDetails(),c&&C.newCardDetails&&k.executeDeposit(C.newCardDetails,a,b)};var D=c.$on("depositDetails",function(a,b){if(b)switch(b.transactionStatus){case k.transactionStatuses.Created:s(),C.depositMethod===C.depositMethods.cardDetails?C.executeDeposit():l.executeDeposit();break;case k.transactionStatuses.AwaitingUserInput:t(),w(b);break;case k.transactionStatuses.AwaitingConfirmation:y();break;case k.transactionStatuses.Pending:t(),z(),C.msgState=C.msgStates.pending,C.userMessage=locale.account.registerWithDepositJourney.depositUserMsgPage.pending.message.replace("<b></b>","<b>"+C.formatCurrency(C.amount)+"</b>"),C.depositStep=C.depositSteps.depositUserMsgPage;break;case k.transactionStatuses.Success:t(),C.getBalance(),z(),C.msgState=C.msgStates.success,C.userMessage=locale.account.registerWithDepositJourney.depositUserMsgPage.success.message.replace("<b></b>","<b>"+C.formatCurrency(C.amount)+"</b>"),C.depositStep=C.depositSteps.depositUserMsgPage,C.gaDepositTrack();break;case k.transactionStatuses.Failed:t(),C.userMessage=b.errorMessage,z(),C.msgState=C.msgStates.error,C.depositStep=C.depositSteps.depositUserMsgPage}});b.$on("$destroy",D),this.getPollingMessage=function(){const a=k.depositDetails.depositAmount;return"Your request to add <b>"+C.formatCurrency(a)+"</b > to your account has been sent to your payment provider."},this.formatCurrency=function(a){return j.smartFormatNumber(C.userDetails.currency.Currency,"string"==typeof a?parseFloat(balance):a,2)},this.parseCardDetails=function(){if(C.forms.deposit_form&&C.forms.deposit_form.$valid)return{cardNumber:C.forms.deposit_form.ccn.$viewValue,cvv:C.forms.deposit_form.cvvn.$viewValue,expiryMonth:C.forms.deposit_form.expd.$viewValue.split("/")[0],expiryYear:C.forms.deposit_form.expd.$viewValue.split("/")[1]}},this.afterOTPPage=function(){"PaystackCardDeposit"===C.paymentMethodPlatformCallBack.Identifier?("UNCONF"==C.userDetails.userStatus&&(h.setUserStatus("ACT"),C.userDetails.userStatus="ACT"),C.depositMethod=C.depositMethods.cardDetails,k.getMaximumCreditCards().then(function(a){C.maximumCreditCards=a,k.getSavedCreditCards("Paystack").then(function(a){a.data.length?(C.savedCreditCards=v(a.data),C.savedCreditCards&&C.savedCreditCards.length?C.showSavedCards():C.showNewCardForm()):C.showNewCardForm()})})):(C.depositMethod=C.depositMethods.vendorSpecific,l.mobileNumber=C.getMobileNumberOnly(),l.prefixNumber=C.getPhoneExtensionOnly()),C.depositStep=C.depositSteps.depositInput},this.showDeleteConfirmSavedCards=function(a){a&&(this.selectedCardToDelete=a),this.showDeleteSaveCardError=!0,C.depositStep=C.depositSteps.popupWarningMsg},this.confirmDisableCard=function(a){this.showDeleteSaveCardError=!1,C.depositStep=C.depositSteps.depositInput,a&&(s(),k.disableSavedCreditCard(C.selectedCardToDelete).then(function(a){a&&a.success?(C.selectedCardToDelete=null,C.savedCreditCards=v(a.data),C.selectedCard=C.savedCreditCards[0],C.savedCreditCards&&C.savedCreditCards.length?C.showSavedCards():C.showNewCardForm()):o.showErrorMessage(a.error).done()}))},this.closePopupMsg=function(){C.showVerifyTransaction=!1,C.depositStep=C.depositSteps.depositInput},this.setSelectedCard=function(a){C.selectedCard=a},this.isCardSelected=function(a){return!!C.selectedCard&&C.selectedCard.id===a.id},this.showSavedCards=function(){C.showingSavedCards=!0,C.selectedCard=C.savedCreditCards[0]},this.showNewCardForm=function(){C.showingSavedCards=!1,C.selectedCard=null},this.closedUserInputViaThirdParty=function(){q.cancel(subscription),C.stopDepositStatusPoll(),l.finalizeDeposit(!1)},this.init=function(){B(),C.getBalance(),C.getDepositMethodsDataCallback(),u(),"UNCONF"==C.userDetails.userStatus&&"PaystackCardDeposit"==C.paymentMethodPlatformCallBack.Identifier?(x(),C.depositStep=C.depositSteps.otpVerification):C.afterOTPPage()},C.init()}])}(),function(){angular.module("momoDeposit.service",[]).factory("momoDepositService",["websiteApiService","authService","$rootScope","$q",function(a,b,c,e){return{transactionStatuses:{Initializing:0,Created:1,AwaitingUserInput:2,AwaitingConfirmation:3,Success:4,Failed:5,Pending:6},paymentMethodsDepositIdentifier:{PaystackCard:"PaystackCardDeposit",PaystackMomoAirtel:"PaystackMomoAirtelDeposit",PaystackMomoMTN:"PaystackMomoMTNDeposit",PaystackMomoVodafone:"PaystackMomoVodafoneDeposit"},mobileNumber:"",prefixNumber:"",transactionInstance:null,depositDetails:{},userData:{},updateDepositDetails:function(a,b){this.depositDetails[a]=b,"transactionStatus"===a&&this.broadcastDepositDetails()},broadcastDepositDetails:function(){c.$broadcast("depositDetails",this.depositDetails)},genericErrorMessage:"An error has occurred during the deposit. Please try again.",parseApiError:function(a){return{success:!1,errorMessage:a&&a.error?locale.account.paymentMethods.paystack.pollingErrorCodes[a.ErrorCode]:this.genericErrorMessage}},parsePaystackError:function(a){return{success:!1,errorMessage:a&&a.message?a.message:this.genericErrorMessage}},clearDepositDetails:function(){this.depositDetails={depositAmount:0,paymentIdentifier:"",transactionRefId:0,transactionStatus:this.transactionStatuses.Initializing,displayData:null,errorMessage:null}},beginDeposit:function(a,b){var c=this;this.clearDepositDetails(),this.updateDepositDetails("depositAmount",b),this.updateDepositDetails("paymentIdentifier",a),this.updateDepositDetails("transactionStatus",this.transactionStatuses.Initializing),this.transactionInstance=null,this.registerDeposit(a,b).then(function(d){if(!d.success)return c.updateDepositDetails("errorMessage",d.errorMessage),void c.updateDepositDetails("transactionStatus",c.transactionStatuses.Failed);var e=d.transactionRefId;c.createTransaction(e,b).then(function(b){b.success?(c.transactionInstance=b.transaction,c.processDeposit(a,e,!0).then(function(a){return a.success?(c.updateDepositDetails("transactionRefId",e),void c.updateDepositDetails("transactionStatus",c.transactionStatuses.Created)):(c.updateDepositDetails("errorMessage",a.errorMessage),void c.updateDepositDetails("transactionStatus",c.transactionStatuses.Failed))})):(c.parsePaystackError(b.error),c.processDeposit(a,e,!1,b.errorMessage).then(function(){c.updateDepositDetails("errorMessage",b.errorMessage),c.updateDepositDetails("transactionStatus",c.transactionStatuses.Failed)}))})})},executeDeposit:function(a,b){var c=this;return this.depositDetails&&this.transactionInstance?void this.chargeMobileMoney(this.transactionInstance,this.depositDetails.paymentIdentifier,a,b).then(function(a){a.success||c.confirmDeposit(c.depositDetails.paymentIdentifier,c.depositDetails.transactionRefId).then(function(a){c.parseConfirmDepositResponse(a)}),a.chargeResult.data.display&&a.chargeResult.data.display.type?(c.updateDepositDetails("displayData",a.chargeResult.data.display),c.updateDepositDetails("transactionStatus",c.transactionStatuses.AwaitingUserInput)):c.depositDetails.paymentIdentifier===c.paymentMethodsDepositIdentifier.PaystackMomoAirtel&&a.chargeResult.data.display&&0===a.chargeResult.data.display.length?(c.updateDepositDetails("displayData",{type:"pop",message:locale.account.registerWithDepositJourney.depositUserMsgPage.completeInfo}),c.updateDepositDetails("transactionStatus",c.transactionStatuses.AwaitingUserInput)):(c.updateDepositDetails("displayData",null),c.updateDepositDetails("transactionStatus",c.transactionStatuses.AwaitingConfirmation))}):(this.updateDepositDetails("errorMessage",this.genericErrorMessage),void this.updateDepositDetails("transactionStatus",this.transactionStatuses.Failed))},listenForChargeUpdates:function(){var a=this;this.transactionInstance||(this.updateDepositDetails("errorMessage",this.genericErrorMessage),this.updateDepositDetails("transactionStatus",this.transactionStatuses.Failed),d.resolve({success:!1})),this.transactionInstance.listenForMobileMoneyCharge(function(b,c){a.depositDetails&&a.transactionInstance&&a.transactionInstance.id.toString()===b.data.trans&&a.confirmDeposit(a.depositDetails.paymentIdentifier,a.depositDetails.transactionRefId).then(function(b){a.parseConfirmDepositResponse(b)}),c()})},checkDepositStatus:function(){var a=e.defer();return this.depositDetails?this.getDepositStatus(this.depositDetails.paymentIdentifier,this.depositDetails.transactionRefId).then(function(b){a.resolve(b)}):(this.updateDepositDetails("errorMessage",this.genericErrorMessage),this.updateDepositDetails("transactionStatus",scope.transactionStatuses.Failed),a.resolve({success:!1,error:"An error has occurred"})),a.promise},finalizeDeposit:function(a,b){var c=this;return this.depositDetails&&this.transactionInstance?void this.confirmDeposit(this.depositDetails.paymentIdentifier,this.depositDetails.transactionRefId,a,b).then(function(a){c.parseConfirmDepositResponse(a,b)}):(this.updateDepositDetails("errorMessage",this.genericErrorMessage),void this.updateDepositDetails("transactionStatus",c.transactionStatuses.Failed))},registerDeposit:function(b,c){var d=e.defer(),f={Amount:c,PaymentMethod:b,IsCardSaved:!1};return a.payments.paystack.registerDeposit(f).then(function(a){a&&a.data.Success&&a.data.TransactionID?d.resolve({success:!0,transactionRefId:a.data.TransactionID}):d.resolve(a)}),d.promise},processDeposit:function(b,c,d,f){var g=e.defer(),h={PaymentMethod:b,TransactionID:c,IsSuccess:d,FailReason:f||null};return a.payments.paystack.processDeposit(h).then(function(a){a&&a.data.Success?g.resolve({success:!0,data:a}):g.resolve({success:!1,data:a})}),g.promise},confirmDeposit:function(b,c,d,f){var g=e.defer(),h={PaymentMethod:b,TransactionID:c,IsSuccess:!d,FailReason:f||null};return a.payments.paystack.confirmDeposit(h).then(function(a){g.resolve(a)}),g.promise},parseConfirmDepositResponse:function(a,b){return a&&a.success?void(400===a.data.TransactionStatus?(this.updateDepositDetails("transactionStatus",this.transactionStatuses.Success),this.transactionInstance=null):600===a.data.TransactionStatus?(this.updateDepositDetails("errorMessage",b||a.data.ThirdPartyMessage||this.genericErrorMessage),this.updateDepositDetails("transactionStatus",this.transactionStatuses.Failed),this.transactionInstance=null):(this.transactionInstance=null,this.updateDepositDetails("transactionStatus",this.transactionStatuses.Pending))):(this.transactionInstance=null,this.updateDepositDetails("errorMessage",this.genericErrorMessage),void this.updateDepositDetails("transactionStatus",this.transactionStatuses.Failed))},getDepositStatus:function(b,c){var d=e.defer();return a.payments.paystack.checkDepositStatus(b,c).then(function(a){a.data&&a.data.TransactionStatus?d.resolve({success:!0,transactionStatus:a.data.TransactionStatus}):d.resolve({success:!1})}),d.promise},createTransaction:function(a,c){var d=e.defer();this.userData=b.getUserData();var f={key:globalSettings.Account_PaystackDeposit.publicKey,email:this.userData.userID+"@kingmakers.com",amount:(100*c).toFixed(2),ref:a,currency:this.userData.currency.Currency,channels:["mobile_money"]};return Paystack.Transaction.request(f).then(function(a){a?d.resolve({success:!0,transaction:a}):d.resolve({success:!1})}),d.promise},chargeMobileMoney:function(a,b,c,d){var f,g=e.defer(),h=this,i="+"+this.prefixNumber+this.mobileNumber;switch(b){case this.paymentMethodsDepositIdentifier.PaystackMomoAirtel:f="TGO";break;case this.paymentMethodsDepositIdentifier.PaystackMomoMTN:f="MTN";break;case this.paymentMethodsDepositIdentifier.PaystackMomoVodafone:f="VOD";break;default:f=""}var j={provider:f,phoneNumber:i,pin:c||null,otp:d||null};try{a.chargeMobileMoney(j).then(function(a){g.resolve({success:!0,chargeResult:a})})}catch(a){g.resolve(h.parsePaystackError())}return g.promise}}}])}(),function(){angular.module("moneyPaymentTransfer.service",[]).factory("moneyPaymentTransferService",["$q","platformApiService","loggingService","umbracoApiService","helperService","$uiRouterGlobals","$state","websiteApiService",function(a,b,c,d,e,f,g,h){return{getAllDepositPaymentMethodsCallback:function(b){var i=a.defer(),j=[],k=null,l=null,m=null;return h.paymentVendors.getAllDepositPaymentMethods().then(function(a){if(a.success||(c.logError(a.error,a.userMsg),i.resolve({success:!1})),a.data.length>0?(globalSettings.Account_CeilMinimumLimit&&a.data.forEach(function(a){a.MinimumLimit.Amount=Math.ceil(a.MinimumLimit.Amount)}),j=a.data,m=a.data[0].MinimumLimit.CurrencySymbol):(e.showErrorMessage(locale.account.paymentMethods.noPaymentAvailable).done(),i.resolve({success:!1})),g.current.name!==b)for(var h=0;h<a.data.length;h++)if(f.params.paymentMethod==a.data[h].Identifier){l=a.data[h];break}d.desktop.getDepositMethodList().then(function(a){if(a.success||(c.logError(a.error,a.userMsg),i.resolve({success:!1})),j=_.map(j,function(b){return _.extend(b,_.find(a.data,{PaymentId:b.Identifier}))}),globalSettings.Account_EnableDepositDefaultRedirection)if(1===j.length)k(j[0]);else for(var b=0;b<j.length;b++)if(j[b].IsDefault===!0){k(j[b]);break}i.resolve({success:!0,API:j,selectedApi:l,onApiSelected:k,currencySymbol:m})})}),i.promise}}}])}(),function(){angular.module("authenticatedUserJourneyMoneyTransfer",["withdrawMobileMoney","moneyTransfer.service"]).controller("userJourneyMoneyTransferController",["$scope","$rootScope","$state","$uiRouterGlobals","$stateParams","platformApiService","$location","loggingService","helperService","umbracoApiService","transferType","websiteApiService","moneyTransferService","authService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=this,p="Deposit"===a.transferType||"Deposit"===a.$resolve.transferType?"accountDeposit":"accountWithdraw";f.paymentVendors.paymentMethods;this.API=[],this.currencySymbol="",this.depositLimitData=null,this.paymentsExtraDatails=[],this.pendingWithdrawals=[],this.mobileNumber="",this.showLoading=!0,this.isKYCVerified=null,a.selectedApi=null,a.transferType=k,a.onTransferComplete=function(a,b,c,d){m.onTransferComplete(a,b,c,d)},this.disableMsg=function(b){var c=b.PaymentTitle||b.Name;return"Deposit"===a.transferType?locale.account.paymentMethods.deposit.depositDisablePaymentMethod.replace("{method}",c):locale.account.paymentMethods.withdrawal.withdrawalDisablePaymentMethod.replace("{method}",c);
},this.navigateTo=function(a,b){a&&b?c.go(b,{paymentMethod:a.Identifier}):c.go(p)},this.navigateToPaymentMethods=function(){c.transitionTo(p,{checkForRedirect:!1})},this.redirectPage=function(a){g.path(a)},this.getUmbracoExtraDetailsForPayments=function(){var b=j.desktop.getDepositExtraDetails;"Withdraw"===a.transferType&&(b=j.desktop.getWithdrawalExtraDetails),b(globalSettings.CurrentLanguage).then(function(a){return a.success?void(o.paymentsExtraDatails=a.data):void h.logError(a.error,a.userMsg)})},this.onApiSelected=function(c){var e="";switch(d.current.name){case"shopDeposit":case"shopWithdraw":e="Deposit"===a.transferType?"shopDepositPaymentMethod":"shopWithdrawPaymentMethod";break;case"accountDeposit":case"accountWithdraw":e="Deposit"===a.transferType?"accountDepositPaymentMethod":"accountWithdrawPaymentMethod";break;case"accountDepositPaymentMethod":e="Deposit"===a.transferType?"accountDepositPaymentMethod":"accountWithdrawPaymentMethod"}e&&(b.selectedApi=c,b.selectedApi.source="deposit",o.navigateTo(c,e))},this.getAllWithdrawalPaymentMethodsCallback=function(){l.paymentVendors.getAllWithdrawalPaymentMethods().then(function(b){if(!b.success)return void h.logError(b.error,b.userMsg);if(!(b.data.length>0))return void i.showErrorMessage(locale.account.paymentMethods.noPaymentAvailable).done();if(globalSettings.Account_CeilMinimumLimit&&b.data.forEach(function(a){a.MinimumLimit.Amount=Math.ceil(a.MinimumLimit.Amount)}),o.API=b.data,o.currencySymbol=b.data[0].MinimumLimit.CurrencySymbol,c.current.name!==p)for(var f=0;f<b.data.length;f++)if(d.params.paymentMethod==b.data[f].Identifier){a.selectedApi=b.data[f];break}j.desktop.getWithdrawalMethodList().then(function(a){return a.success?(o.API=_.map(o.API,function(b){var c=_.find(a.data,{PaymentId:b.Identifier});return c&&"offline"!==c.Status&&void 0!==b.IsEnabled&&!b.IsEnabled&&(c.Status="disabled"),_.extend(b,c)}),void l.payments.paystack.getUserLastDepositMethod().then(function(a){if(!a.success)return o.showLoading=!1,void h.logError(a.error,a.userMsg);if(o.showLoading=!1,e.checkForRedirect)switch(a.data.LastDepositMethod){case"PaystackMomoMTNDeposit":o.onApiSelected(o.API[_.findIndex(o.API,{Identifier:"PaystackMomoMTNWithdrawal"})]);break;case"PaystackMomoVodafoneDeposit":o.onApiSelected(o.API[_.findIndex(o.API,{Identifier:"PaystackMomoVodafoneWithdrawal"})]);break;case"PaystackMomoAirtelDeposit":o.onApiSelected(o.API[_.findIndex(o.API,{Identifier:"PaystackMomoAirtelWithdrawal"})]);break;default:return}})):void h.logError(a.error,a.userMsg)})})},this.checkKYC=function(){l.registration.checkKYCStatus().then(function(b){o.showLoading=!1,"VERF"===b.data.Code?("Deposit"===a.transferType?o.getAllDepositPaymentMethodsCallback():"Withdraw"===a.transferType&&o.getAllWithdrawalPaymentMethodsCallback(),o.isKYCVerified=!0):o.isKYCVerified=!1}).catch(function(a){o.showLoading=!1,o.isKYCVerified=!1})},this.getAllDepositPaymentMethodsCallback=function(){l.paymentVendors.getAllDepositPaymentMethods().then(function(b){if(!b.success)return void h.logError(b.error,b.userMsg);if(!(b.data.length>0))return void i.showErrorMessage(locale.account.paymentMethods.noPaymentAvailable).done();if(globalSettings.Account_CeilMinimumLimit&&b.data.forEach(function(a){a.MinimumLimit.Amount=Math.ceil(a.MinimumLimit.Amount)}),o.API=b.data,o.currencySymbol=b.data[0].MinimumLimit.CurrencySymbol,c.current.name!==p)for(var f=0;f<b.data.length;f++)if(d.params.paymentMethod==b.data[f].Identifier){a.selectedApi=b.data[f];break}j.desktop.getDepositMethodList().then(function(a){return a.success?(o.API=_.map(o.API,function(b){var c=_.find(a.data,{PaymentId:b.Identifier});return c&&"offline"!==c.Status&&void 0!==b.IsEnabled&&!b.IsEnabled&&(c.Status="disabled"),_.extend(b,c)}),void("accountDepositPaymentMethod"===d.current.name||"shopDepositPaymentMethod"===d.current.name||e.disableLastDepositAutoRedirect?o.showLoading=!1:l.payments.paystack.getUserLastDepositMethod().then(function(a){if(!a.success)return o.showLoading=!1,void h.logError(a.error,a.userMsg);if(o.showLoading=!1,a.data)switch(a.data.LastDepositMethod){case"PaystackMomoVodafoneDeposit":o.onApiSelected(o.API[_.findIndex(o.API,{Identifier:"PaystackMomoVodafoneDeposit"})]);break;case"PaystackMomoMTNDeposit":o.onApiSelected(o.API[_.findIndex(o.API,{Identifier:"PaystackMomoMTNDeposit"})]);break;case"PaystackMomoAirtelDeposit":o.onApiSelected(o.API[_.findIndex(o.API,{Identifier:"PaystackMomoAirtelDeposit"})]);break;case"PaystackCardDeposit":o.onApiSelected(o.API[_.findIndex(o.API,{Identifier:"PaystackCardDeposit"})]);break;default:return}}))):void h.logError(a.error,a.userMsg)})})},this.getWalletMobileNumber=function(){return phoneNumber=n.getUserData().userName,"+"+phoneNumber.substring(0,3)+" "+phoneNumber.substring(3)},o.getUmbracoExtraDetailsForPayments(),o.mobileNumber=o.getWalletMobileNumber(),f.security.isKYCCheckEnabled().then(function(b){b.data===!0?o.checkKYC():(o.isKYCVerified=!0,"Deposit"===a.transferType?o.getAllDepositPaymentMethodsCallback():"Withdraw"===a.transferType&&o.getAllWithdrawalPaymentMethodsCallback())})}])}(),function(){angular.module("withdrawMobileMoney",["bankProfile.service"]).controller("withdrawMobileMoneyController",["$rootScope","$state","$filter","websiteApiService","$scope","$interval","helperService","loggingService","umbracoApiService","authService","currencyService","platformApiService","$location",function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=this,o=l.finance;this.paymentMethodPlatformCallBack=e.selectedApi,this.paymentMethodDataCallBack=null,this.Amount=null,this.depositRatio=0,this.withdrawalWin=0,this.showWhyNotAllBalanceDesc=!1,this.checkWithdrawalOfDeposit=!1,this.isUserAboveThreshold=!1,this.htmlTextWithDepRto=locale.account.paymentMethods.withdrawal.autoWithdrawalDisc,this.showErrorMsg=!1,this.showSuccessMsg=!1,this.errorMessage="",this.successMessage="",this.formProcessing=!1,this.mobileNumber="",this.balanceRefreshInterval=null,this.iconClass="fa fa-refresh",this.minWithdrawalAmount=0,this.maxWithdrawalLimitReached=!1,this.withdrawalBalance=0,this.isYNotWholeBalanceDisc=!0,this.getMobileNumber=function(){const a=j.getUserData().userName;return"+"+a.substring(0,3)+" "+a.substring(3,5)+" "+a.substring(5,8)+" "+a.substring(8)},this.validateifMaxLimitReached=function(a){n.Amount>n.paymentMethodPlatformCallBack.MaximumLimit.Amount?n.showMaxWithdrawalLimitReached=!0:n.showMaxWithdrawalLimitReached=!1};var p=globalSettings.Deposit_IncrementAmountValues.split(",").map(function(a){return parseFloat(a,10)});this.quickValues=_.uniq(_.remove(p,function(a){return!isNaN(a)})),this.setAmount=function(a,b){b.AmountValue.$setDirty(),n.Amount?n.Amount=n.Amount+a:n.Amount=a,n.validateifMaxLimitReached(b)},this.formatCurrency=function(a){return k.smartFormatNumber(n.paymentMethodPlatformCallBack.MinimumLimit.Currency,"string"==typeof a?parseFloat(a):a,2)},this.isBalanceOrWithdrawableBalance=function(a,b){return n.withdrawalBalance=n.paymentMethodPlatformCallBack.MaximumLimit.Amount<a?n.paymentMethodPlatformCallBack.MaximumLimit.Amount:a,n.checkWithdrawalOfDeposit&&n.isUserAboveThreshold?(0===n.withdrawalBalance&&b.AmountValue.$setValidity("max",!1),n.setWithdrawalMinAmount(n.withdrawalBalance),n.withdrawalBalance):n.checkWithdrawalOfDeposit&&!n.isUserAboveThreshold?(n.withdrawalBalance=n.paymentMethodPlatformCallBack.MaximumLimit.Amount<n.withdrawalWin?n.paymentMethodPlatformCallBack.MaximumLimit.Amount:n.withdrawalWin,0===n.withdrawalBalance&&b.AmountValue.$setValidity("max",!1),n.setWithdrawalMinAmount(n.withdrawalBalance),n.withdrawalBalance):n.checkWithdrawalOfDeposit?void 0:(0===n.withdrawalBalance?b.AmountValue.$setValidity("max",!1):b.AmountValue.$setValidity("max",!0),n.setWithdrawalMinAmount(n.withdrawalBalance),n.withdrawalBalance)},this.setWithdrawalMinAmount=function(a){0!==a&&(n.minWithdrawalAmount=n.paymentMethodPlatformCallBack.MinimumLimit.Amount)},this.getUnavailablePaymentMethodMessage=function(a){return locale.account.paymentMethods.withdrawal.withdrawalDisablePaymentMethod.replace("{method}",a)},this.performWithdrawal=function(a){n.formProcessing=!0;var b={Amount:n.Amount,PaymentMethod:n.paymentMethodPlatformCallBack.Identifier};d.paymentVendors.getAllWithdrawalPaymentMethods().then(function(a){var c=_.find(a.data,{Identifier:n.paymentMethodPlatformCallBack.Identifier});i.desktop.getWithdrawalMethodData(n.paymentMethodPlatformCallBack.Identifier).then(function(a){if(c.IsEnabled&&a.data&&"online"==a.data.Status)n.processWithdrawal(b);else{n.formProcessing=!1;var d=n.getUnavailablePaymentMethodMessage(n.paymentMethodPlatformCallBack.PaymentTitle||n.paymentMethodPlatformCallBack.Name);g.showInfoMessage(d).done().then(function(){m.path("/ac/withdraw")})}})})},this.processWithdrawal=function(a){d.payments.paystack.registerMomoWithdrawal(a).then(function(a){if(a.success)n.formProcessing=!1,n.successMessage=locale.account.paymentMethods.withdrawal.successWithdrawalMessageFirstPart+" <b>"+n.formatCurrency(n.Amount)+"</b> "+locale.account.paymentMethods.withdrawal.successWithdrawalMessageSecondPart+" "+n.getUserPaymentProvider(n.paymentMethodPlatformCallBack.Identifier)+" Momo Wallet",n.showSuccessMsg=!0,g.createDataLayerEvent({event:"user-withdraw-funds",userID:j.getUserData().userID,withdrawAmount:n.Amount,accountEmpty:e.authCtrl.balances[0].Balance-n.Amount===0});else{if(n.showErrorMsg=!0,n.formProcessing=!1,a.data&&"HARD_CHECK_AW_EXCEPTION"===a.data.ErrorCode)return void _.each(a.data.ErrorDetails,function(a,b,c){a.includes('href="{{contactUs}}"')?n.errorMessage=a.replace('href="{{contactUs}}"','href="'+n.contactUsUrl+'"'):n.errorMessage=a});n.errorMessage=locale.account.paymentMethods.paymentGeneralErrorCodes.paystack[a.data.ErrorCode],n.errorMessage||(n.errorMessage=locale.account.paymentMethods.paymentGeneralErrorCodes.INTERNAL_SERVER_ERROR),n.errorMessage.includes("{MaximumWithdrawalLimit}")&&(n.errorMessage=n.errorMessage.replace("{MaximumWithdrawalLimit}",a.data.ErrorDetails.MaximumWithdrawalLimit)),n.errorMessage.includes("{TransactionAmount}")&&(n.errorMessage=n.errorMessage.replace("{TransactionAmount}",a.data.ErrorDetails.TransactionAmount)),n.errorMessage.includes("{CurrentScore}")&&(n.errorMessage=n.errorMessage.replace("{CurrentScore}",a.data.ErrorDetails.CurrentScore)),n.errorMessage.includes("{MinimumLimit}")&&(n.errorMessage=n.errorMessage.replace("{MinimumLimit}",c("currencyFormat")(a.data.ErrorDetails.MinimumLimit,2))),n.errorMessage.includes("{MaximumLimit}")&&(n.errorMessage=n.errorMessage.replace("{MaximumLimit}",c("currencyFormat")(a.data.ErrorDetails.MaximumLimit,2)))}})},this.getWithdrawMethodsDataCallback=function(a){i.desktop.getWithdrawalMethodData(n.paymentMethodPlatformCallBack.Identifier).then(function(b){return b.success?(n.paymentMethodDataCallBack=b.data,void(n.paymentMethodPlatformCallBack.MaximumLimit.Amount=Math.round(n.paymentMethodPlatformCallBack.MaximumLimit.Amount))):void h.logError(a.error,a.userMsg)})},this.getBalance=function(){n.iconClass="fa fa-spinner fa-spin",o.getPlaySource("web").then(function(a){if(n.iconClass="fa fa-refresh",!a.success)return void h.logError("Unable to get user balances: "+a.error);n.userBalances=[];var b=a.data,c=0;angular.forEach(b,function(a){null!=a.Credit&&$.isNumeric(a.Credit)&&(c+=parseFloat(a.Credit)),a.Name=a.Name.replace(" Account",""),globalSettings.Header_ShowBalance&&a.IsMain&&n.userBalances.push({name:a.Name,balance:a.Balance});for(var b in locale.account.cashier.accounts){var d=a.Name[0].toLowerCase()+a.Name.slice(1);b===d&&(a.Name=locale.account.cashier.accounts[b])}}),c>0&&b.push({Id:"credit",Name:locale.account.balance.credit,Balance:c}),angular.copy(b,n.balances)}).catch(function(a){var b={hasLoadingError:!0};n.userBalances=[b],n.iconClass="fa fa-refresh"})},this.withdrawableFormaterCurrency=function(a){return n.checkWithdrawalOfDeposit?(n.isYNotWholeBalanceDisc=a>=n.withdrawalWin,n.isUserAboveThreshold?n.formatCurrency(a):n.formatCurrency(Math.min(a,n.withdrawalWin))):n.formatCurrency(a)},this.getDepositRatio=function(){l.finance.getUserWithdrawalConfiguration(n.paymentMethodPlatformCallBack.Identifier).then(function(a){a.success?(n.checkWithdrawalOfDeposit=a.data.CheckWithdrawalOfDeposit,n.depositRatio=c("number")(100*a.data.Ratio,2),n.withdrawalWin=a.data.WithdrawalWin,n.isUserAboveThreshold=a.data.UserAboveThreshold):(n.depositRatio=0,n.withdrawalWin=0),n.htmlTextWithDepRto=locale.account.paymentMethods.withdrawal.autoWithdrawalDisc.replace("{withdrawable balance}",n.formatCurrency(n.withdrawalWin))})},this.toggleWhyNotAllBalanceDesc=function(){n.showWhyNotAllBalanceDesc=!n.showWhyNotAllBalanceDesc},this.goBack=function(){window.history.back()},this.backToHomePage=function(){window.location.href="/"},this.getUserPaymentProvider=function(a){var b;switch(a){case"PaystackMomoAirtelWithdrawal":b="Airtel";break;case"PaystackMomoMTNWithdrawal":b="MTN";break;default:b="Vodafone"}return b},n.mobileNumber=n.getMobileNumber(),n.getWithdrawMethodsDataCallback(),n.getDepositRatio(),n.getBalance()}])}(),function(){angular.module("accountOpenBets",[]).factory("openBetsService",["$q","sportsApiService","cashoutService",function(a,b,c){var d={getRecentBets:function(){var c=a.defer();return b.coupon.getCouponsListNoDate(1,parseInt(globalSettings.Sports_MyBetsCouponCount+1),!1,globalSettings.CurrentLanguage,globalSettings.BrandID).then(function(a){for(var b=0,e=0;e<a.data.Coupons.length;e++)if(1===a.data.Coupons[e].CouponStatusId)a.data.Coupons.splice(e,1);else if(b++,b>=4)break;for(var f=[],g=0;g<4;g++)d.getCouponByCode(a.data.Coupons[g],!1,f,c);c.resolve(f)}),c.promise},getOpenBets:function(){var c=a.defer();return b.coupon.getCouponsListNoDate(2,parseInt(globalSettings.Sports_MyBetsCouponCount+1),!0,globalSettings.CurrentLanguage,globalSettings.BrandID).then(function(a){if(a.success){var b=a.data,e=[],f=!1;if(b&&b.Coupons.length>0){for(var g=0;g<b.Coupons.length;g++)g<globalSettings.Sports_MyBetsCouponCount?d.getCouponByCode(b.Coupons[g],!0,e):f=!0;c.resolve({openBets:e,hasMoreOpenBets:f})}}else console.error("Error occurred while getting the open bets: "+JSON.stringify(a.error))}),c.promise},getCouponByCode:function(a,c,e){b.coupon.getCouponByCode(a.CouponCode,"en").then(function(a){if(a.success&&a.data.CouponCode){var b=new Date(a.data.CouponDate);a.data.CouponDate=b,c&&d.getCashoutValue(a),e.push(a.data)}})},getCashoutValue:function(a){globalSettings.Sports_EnableCashOut&&c.getCashoutValue(a.data.CouponCode).then(function(b){a.data.cashoutResponse=b})}};return d}]).controller("OpenBetsPageController",["$scope","openBetsService","sportsApiService","authService","$state","cashoutService","helperService","$rootScope","$localStorage",function(a,b,c,d,e,f,g,h,i){var j=this;a.recentBets,a.openBets,a.hasMoreOpenBets,this.cashoutInProgress=!1,globalSettings.Sports_EnableAccountOpenBets||e.go("accountHome"),this.goToBetSearch=function(){e.go("accountBetSearch")},this.getRecentBets=function(){h.showLoader(".recent-bets-container",null,0),b.getRecentBets().then(function(b){a.recentBets=b,h.hideLoader(".recent-bets-container")})},this.getCashoutValueRefresh=function(a){a.cashoutRefreshInProgress=!0,f.getCashoutValue(a.CouponCode).then(function(b){a.cashoutResponse=b,a.cashoutRefreshInProgress=!1})},this.getOpenBets=function(){h.showLoader(".open-bets-container",null,0),b.getOpenBets().then(function(b){a.openBets=b.openBets,a.hasMoreOpenBets=b.hasMoreOpenBets,h.hideLoader(".open-bets-container")})},this.onCashoutClicked=function(a){var b=f.isInPendingList(null,a.CouponCode);if(!b&&globalSettings.Sports_EnableCashOut){if(!d.hasValidLogin())return void g.showErrorMessage(locale.common.cashout.loginRequired).done();var c=locale.common.cashout.cashoutValue+": "+a.cashoutResponse.displayValue;g.showInfoMessage(c,null,!0,locale.common.cancel,!0,locale.common.proceed).then(function(){a.cashoutResponse.cashoutInProgress=!0,f.cashout([a.cashoutResponse.serverData],a.UserId).then(function(b){return a.cashoutResponse.cashoutInProgress=!1,b.success?(j.getOpenBets(),delete a.cashoutResponse,b.cashoutAccepted||g.showInfoMessage(b.userMessage).done(),void(j.cashoutData=null)):(304==b.responseCode&&(a.cashoutResponse.value=b.value,a.cashoutResponse.displayValue=b.displayValue,a.cashoutResponse.currency=b.currency),void g.showErrorMessage(b.userMessage).done())})}).done()}},this.rebetCoupon=function(a){h.showLoader(),c.coupon.rebetCoupon(a,globalSettings.CurrentLanguage).then(function(a){h.hideLoader(),a.success&&(i.couponData=a.data.BetCoupon,i.couponLocalId=(new Date).getTime().toString().substring(3)+""+Math.floor(100*Math.random()+1),window.location.href="/sports")})},this.couponDetailView=function(a){null==a||a.length<=0||c.coupon.getCouponByCodeNoCheck(a,globalSettings.CurrentLanguage).then(function(b){if(b.success&&null!=b.data&&0!=b.data.CouponId){var c="/coupon-details-iframe/?couponCode="+a;$.fancybox({modal:!1,showCloseButton:!0,hideOnContentClick:!1,hideOnOverlayClick:!0,width:925,height:533,type:"iframe",padding:0,margin:0,fitToView:!1,autoSize:!1,href:c,afterShow:function(){var a='<div class="fancybox-custom-content panel panel-custom no-brand-footer"> <div class="panel-heading w-icon"> <h3 class="panel-title"> <i class="fa fa-list fa-fw"></i> <span>'+locale.account.betSearch.couponDetailsGeneric.toUpperCase()+"</span> </h3> </div></div>";$(".fancybox-outer").prepend(a)}})}else g.showErrorMessage(locale.sports.coupon.verifyCoupon.invalidCouponCode).done()})},d.hasValidLogin()&&(this.getOpenBets(),this.getRecentBets())}])}(),function(){angular.module("authenticatedOTP",[]).controller("OTPController",["$scope","$window","platformApiService","helperService","authService",function(a,b,c,d,e){var f=this;a.locale=b.locale,a.globalSettings=b.globalSettings,this.mobileExtension=this.mobileExtension?this.mobileExtension.replace("+",""):null,this.otpTypes={resetPassword:2,registration:3,changePhoneNumber:4,verifyPhoneNumber:5},this.verificationCode=null,this.resendPin=function(a){var b={RequestTypeOption:f.otpType,Data:{}};switch(f.otpType){case f.otpTypes.resetPassword:case f.otpTypes.registration:b.Data={Username:f.username};break;case f.otpTypes.changePhoneNumber:case f.otpTypes.verifyPhoneNumber:var g=e.getUserData(),h=g?g.userID:null;b.Data={UserId:h,Mobile:f.mobileExtension+d.cleanMobileNumber(f.mobileNumber)}}c.security.regenerateTokenForService(b).then(function(b){return b.success?(f.verificationCode=null,a.$setPristine(),void d.showInfoMessage(locale.account.otp.pinResent).done()):void(20805==b.responseCode?d.showErrorMessage(locale.account.otp.limitExceeded).done():d.showErrorMessage(b.error).done())})},this.completeVerification=function(a){if(f.verificationCode){var b={OneTimePassword:f.verificationCode,Username:f.username,VerifyOTPOption:f.otpType||f.otpTypes.verifyPhoneNumber};c.security.validateOneTimePassword(b).then(function(b){if(!b.success){var c=locale.account.otp.errors[b.responseCode];return c||(c=b.error),d.showErrorMessage(c).done(),f.verificationCode=null,void a.$setPristine()}f.onOtpVerified({verificationCode:f.verificationCode})})}},this.redirect=function(a){window.parent.location.href=a}}])}(),function(){angular.module("authenticatedPhoneVerification",[]).controller("PhoneVerificationController",["$rootScope","$scope","authService","platformApiService","guardianApiService","$sessionStorage","$state","$location",function(a,b,c,d,e,f,g,h){var i=this,j=d.security,k=d.user;window.top.location.href.toLowerCase().indexOf("phoneverification")>-1&&$(".unverified-account-tooltip").css("display","none"),this.phoneVerification=!1,this.alreadyRegistered=!1,this.resendCodeVerification=!1,this.verifyPhoneNumber,this.limitExceeded=!1,this.userData=null,this.currentMobileNumber=null,this.getCurrentMobileNumber=function(){a.showLoader(null,null,0),k.getCurrentUserProfile().then(function(b){if(a.hideLoader(),b.success){i.userData=b.data;var c=null;b.data.PhoneContactDetails.length||(b.data.PhoneContactDetails[1]={PhoneContactTypeCode:"MB",Id:0,ContactNumber:null});for(var d=0;d<b.data.PhoneContactDetails.length;d++)"MB"==b.data.PhoneContactDetails[d].PhoneContactTypeCode&&(c=b.data.PhoneContactDetails[d]);null!=c&&(i.currentMobileNumber=c.ContactNumber,i.verifyPhoneNumber?i.resendCodeVerification=!0:null==f.multipleUnconfirmedUsers?window.location.href="/":("true"==f.multipleUnconfirmedUsers?i.alreadyRegistered=!0:"false"==f.multipleUnconfirmedUsers?i.verifyPhoneNumber():window.location.href="/",delete f.multipleUnconfirmedUsers))}})},this.verifyPhoneNumber=function(){var a={UserId:i.userData.UserDetails.UserId,Mobile:i.currentMobileNumber};i.limitExceeded=!1,j.startVerificationBySMS(a).then(function(a){if(!a.success){if(20805!=a.responseCode)return;i.limitExceeded=!0}i.alreadyRegistered=!1,i.resendCodeVerification=!1,i.phoneVerification=!0})},this.cancel=function(){window.top.location.href="/"},this.contactSupport=function(){window.top.location.href="/help/general-help/contact-us/"},this.logout=function(){c.clearUserData(),i.popupShouldBeShown=!1},this.onInit=function(){i.getCurrentMobileNumber()},i.onInit()}]).controller("PhoneVerificationContentController",["$scope","$location","$rootScope","authService","platformApiService","$interval","$state",function(a,b,c,d,e,f,g){var h=this,i=e.security;switch(window.top.location.href.toLowerCase().indexOf("phoneverification")>-1&&$(".unverified-account-tooltip").css("display","none"),a.forms={},this.otpCodeLength=globalSettings.General_OTPCodeLength,this.resendCodeInterval=null,this.resendCodeNumOfSeconds=60,this.resendCodeTimer=0,this.OTPOption,this.OTPOptionAfterResend=void 0,this.username,this.mobileNumber,this.hasResentCode=!1,this.avoidCallsWithSameCode="",this.fullCode={},this.otpCodeLength){case 4:this.fullCode={char1:"",char2:"",char3:"",char4:""};break;case 5:this.fullCode={char1:"",char2:"",char3:"",char4:"",char5:""};break;case 6:default:this.fullCode={char1:"",char2:"",char3:"",char4:"",char5:"",char6:""}}this.invalidCode=!1,this.limitExceeded,this.cancel=function(){window.top.location.href="/"},this.calculateCountdown=function(){h.resendCodeInterval=f(function(){h.resendCodeTimer=h.resendCodeTimer-1,h.resendCodeTimer<=0&&f.cancel(h.resendCodeInterval)},1e3)},this.resendCode=function(){var a={RequestTypeOption:h.OTPOption,Data:{}};switch(h.OTPOption){case 2:case 3:a.Data={Username:h.username};break;case 4:case 5:a.Data={UserId:d.getUserData().userID,Mobile:h.mobileNumber}}i.regenerateTokenForService(a).then(function(a){return a.success?(h.limitExceeded=!1,h.resendCodeTimer=h.resendCodeNumOfSeconds,h.calculateCountdown(),h.clearCode(),void(h.hasResentCode=!0)):void(20805==a.responseCode&&(h.limitExceeded=!0))})},this.clearCode=function(){_.forEach(Object.keys(h.fullCode),function(a){h.fullCode[a]=""}),$("input[name='char1']").focus()},this.pasteFromClipboard=function(a){var b=a.originalEvent.clipboardData.getData("text/plain");if(b){b=b.trim().replace("-","");var c=0;_.forEach(Object.keys(h.fullCode),function(a){h.fullCode[a]=b.charAt(c),c++}),$("input[name='char6']").focus()}},this.onKey=function(a){var b=$(a.currentTarget),c=a.which||a.keyCode;8===c||37===c?(b.prevAll("input").first().focus(),b.prevAll("input").first().select()):(39===c||c>=48&&c<=90||c>=96&&c<=111||c>=186&&c<=222)&&""!=b.val()&&(b.nextAll("input").first().focus(),b.nextAll("input").first().select()),h.verifyCode()},this.verifyCode=function(){var a=!0,b="";if(_.forEach(h.fullCode,function(c){a&&(c.length>0?(a=!0,b+=c):a=!1)}),a&&h.avoidCallsWithSameCode!==b){h.avoidCallsWithSameCode=b;var e={Username:h.username,OneTimePassword:b,VerifyOTPOption:h.hasResentCode&&void 0!==h.OTPOptionAfterResend?h.OTPOptionAfterResend:h.OTPOption};c.showLoader(".verification-container",null,0),i.validateOneTimePassword(e).then(function(a){return c.hideLoader(".verification-container"),a.success?(h.invalidCode=!1,void(2==h.OTPOption?window.location.href="/reset-password?username="+h.username+"&otp="+b:3==h.OTPOption?d.hasValidLogin()?(d.setUserStatus("ACT"),d.setVerifyAccountStatus("Verified"),window.top.location.href="/"):c.$broadcast("registrationCompleted"):4==h.OTPOption?(d.setUserStatus("ACT"),d.setVerifyAccountStatus("Verified"),d.isAgent()?g.go("shopChangePhoneNumber",null,{reload:!0}):g.go("accountChangePhoneNumber",null,{reload:!0})):5==h.OTPOption&&(d.setUserStatus("ACT"),d.setVerifyAccountStatus("Verified"),window.top.location.href="/"))):void(h.invalidCode=!0)})}},this.onInit=function(){h.resendCodeTimer=h.resendCodeNumOfSeconds,h.calculateCountdown()},h.onInit()}]).controller("PhoneVerificationPopupController",["$rootScope","$scope","authService","guardianApiService","$location","helperService","$sessionStorage","platformApiService",function(a,b,c,d,e,f,g,h){var i=this,j=h.security;return window.top.location.href.toLowerCase().indexOf("phoneverification")>-1&&$(".unverified-account-tooltip").css("display","none"),this.verifyData=c.getVerifyAccountData(),null==i.verifyData?void(top.window.location.href="/"):(this.goToPage=function(a){a.startsWith("/help/")?top.window.location.href=a:c.isAgent()?top.window.location.href="/shop/sh/"+a:top.window.location.href="/account/ac/"+a},void(this.verifyExistingPhoneNumber=function(){var a={PhoneContactTypeCode:"MB",Prefix:null,Number:i.verifyData.mobileNumber};j.validateMobileNumber(a).then(function(a){a.success||(20215===a.responseCode||(20214===a.responseCode?g.multipleUnconfirmedUsers="true":20216===a.responseCode&&(g.multipleUnconfirmedUsers="false")),c.isAgent()?top.window.location.href="/shop/sh/phoneverification":top.window.location.href="/account/ac/phoneverification")})}))}])}(),function(){angular.module("authenticatedPrintOdds",[]).factory("PrintDataResolver",["sportsApiService","$q",function(a,b){var c={listSportsEvents:function(c,d){var e=c;null==e&&(e="0");var f,g,h=d;return null==h?(f=a.feed.getPrematchTournamentsBySport(globalSettings.CurrentLanguage,"4",e),g=a.feed.getOutrightTournamentsBySport(globalSettings.CurrentLanguage,"4",e)):(f=a.feed.getPrematchTournamentsBySportByRange(globalSettings.CurrentLanguage,"4",e,h),g=a.feed.getOutrightTournamentsBySportByRange(globalSettings.CurrentLanguage,"4",e,h)),b.all([f,g])},listEventsOdds:function(b,c){if(null!=b)return null==c?a.feed.listEventsOdds(globalSettings.CurrentLanguage,"4",b):a.feed.listEventsOddsByRange(globalSettings.CurrentLanguage,"4",c,b)},listPrintOdds:function(b,c,d,e,f,g,h,i,j,k){if("fast"==b){if("sport"==c)return null==k||0==k.trim().length?a.feed.listPrintOddsFastSport(globalSettings.CurrentLanguage,"4",f,e):a.feed.listPrintOddsFastSportByRange(globalSettings.CurrentLanguage,"4",f,e,k);if("tournament"==c)return null==k||0==k.trim().length?a.feed.listPrintOddsFastTournament(globalSettings.CurrentLanguage,"4",f,"false",e):a.feed.listPrintOddsFastTournamentByRange(globalSettings.CurrentLanguage,"4",f,"false",k,e)}else if("standard"==b){if("markets"==d)return f=f.split(".").join("_"),null==k||0==k.trim().length?a.feed.listPrintOddsStandardMarket(globalSettings.CurrentLanguage,"4",f,g,e):a.feed.listPrintOddsStandardMarketByRange(globalSettings.CurrentLanguage,"4",f,g,k,e);if("area"==d)return null==k||0==k.trim().length?a.feed.listPrintOddsStandardArea(globalSettings.CurrentLanguage,"4",f,g,e):a.feed.listPrintOddsStandardAreaByRange(globalSettings.CurrentLanguage,"4",f,g,h,j,e)}}};return c}]).controller("PrintOddsFastController",["$scope","$location",function(a,b){var c=function(a){for(var b=[],c=0;c<a;c++){var d=new Date;d.setDate(d.getDate()+c),b.push({value:c,text:d})}return b},d=function(a,b){for(var c=[],d=0;d<a.length;d+=b)c.push(a.slice(d,d+b));return c};this.datesList=d(c(20),5),this.selectAllDates=function(a){var b=$(a.currentTarget),c=$("#divDatesPDF").find("input[type='checkbox']");$(c).prop("checked")?($(c).parents(".date").removeClass("checked"),$(c).prop("checked",!1)):($(c).parents(".date").addClass("checked"),$(c).prop("checked",!0));var d=$("#divDatesPDF").find("input[type='checkbox']").length,e=$("#divDatesPDF").find("input[type='checkbox']:checked").length;d!=e?b.removeClass("checked"):b.addClass("checked")},this.selectDate=function(a){var b=$(a.currentTarget),c=$(".selectAll"),d=b.find("input[type='checkbox']");$(d).prop("checked")?($(d).parents(".date").removeClass("checked"),$(d).prop("checked",!1)):($(d).parents(".date").addClass("checked"),$(d).prop("checked",!0));var e=$("#divDatesPDF").find("input[type='checkbox']").length,f=$("#divDatesPDF").find("input[type='checkbox']:checked").length;e!=f?c.removeClass("checked"):c.addClass("checked")},this.selectRadioButton=function(a){var b=$(a.currentTarget);b.find("input[type='radio']").prop("checked",!0)},this.fastPrint=function(){var a="sport",b="",c="0",d=$("input[name='selectPrintType']:checked").val();if("FootballFast"==d){b="1",c="531";var e=$("input[name='selectFastType']:checked").val();"italian"==e&&(b="835",a="tournament")}else"BasketballFast"==d?(b="2",c="633"):"TennisFast"==d&&(b="5",c="667");var f="";$("input:checkbox[name=datesPDF]:checked").each(function(){f+=$(this).val()+","}),f.length>0&&(f=f.substring(0,f.length-1));var g="html";window.open("/print-odds-"+g+"/"+g+"?printType=fast&categoryType="+a+"&areaMarkets=area&eventIds="+b+"&areaMarketIds="+c+"&orderByDate=false&pageLayout=landscape&fontSize=normal&printLogo=nologo&dateRange="+f,"stampaQuote_"+Math.random(),"resizable=no, toolbar=no, status=yes, dependent=no, scrollbars=1, width=550, height=370")}}]).controller("PrintOddsStandardController",["$scope","PrintDataResolver","$sessionStorage","$localStorage","$rootScope","$uiRouterGlobals","helperService",function(a,b,c,d,e,f,g){var h=this;this.eventChecked=!1,this.oddsSelection=!1,this.eventsBack=!1,this.eventsSelection=!1,this.sportsSelection=!1,this.datesSelection=!0,this.sportEventsMatchesData,this.sportEventsOutrightsData,this.availableSports;var i=function(a){for(var b=[],c=0;c<a;c++){var d=new Date;d.setDate(d.getDate()+c),b.push({value:c,text:d})}return b},j=function(a,b){for(var c=[],d=0;d<a.length;d+=b)c.push(a.slice(d,d+b));return c};this.datesList=j(i(20),5),this.selectAllDates=function(a){var b=$(a.currentTarget);$("#HdateRange").val("");var c=$("#divDatesPDF").find("input[type='checkbox']");$(c).prop("checked")?($(c).parents(".date").removeClass("checked"),$(c).prop("checked",!1)):($(c).parents(".date").addClass("checked"),$(c).prop("checked",!0));var d=$("#divDatesPDF").find("input[type='checkbox']").length,e=$("#divDatesPDF").find("input[type='checkbox']:checked").length;d!=e?b.removeClass("checked"):b.addClass("checked"),h.updateDateRange()},this.selectDate=function(a){var b=$(a.currentTarget),c=$(".selectAll");$("#HdateRange").val("");var d=b.find("input[type='checkbox']");$(d).prop("checked")?($(d).parents(".date").removeClass("checked"),$(d).prop("checked",!1)):($(d).parents(".date").addClass("checked"),$(d).prop("checked",!0));var e=$("#divDatesPDF").find("input[type='checkbox']").length,f=$("#divDatesPDF").find("input[type='checkbox']:checked").length;e!=f?c.removeClass("checked"):c.addClass("checked"),h.updateDateRange()},this.selectRadioButton=function(a){var b=$(a.currentTarget);b.find("input[type='radio']").prop("checked",!0)},this.viewSportsEvents=function(a){var b=$(a.currentTarget).find("input[type='radio']");b.prop("checked",!0);var c=b.val();"FootballPDF"==c?h.updateSportsEvents(1):"SportsPDF"==c&&h.updateSportsEvents(null)},this.backToSports=function(){$("#HidIDSport").val(""),h.updateSportsEvents(void 0)},this.goToOddsSection=function(){var a="",b="";if($("#sportsEvents input[type='checkbox']:checked").each(function(){a+=$(this).attr("id")+",",b+=$(this).attr("id")+"~"+$(this).attr("data-categoryName")+"~"+$(this).attr("data-tourName")+"|"}),a=a.substring(0,a.length-1),b=b.substring(0,b.length-1),h.showGroupsCustom(null),a){if(null==d.printOddsSavedTemplates){var e=6;d.printOddsSavedTemplates=[{templateName:locale.account.printOdds.defaultSettings,groupBy:"Event",oddsSelection:"Custom",pageLayout:"landscape",fontSize:"normal",printLogo:"nologo",odds:[]}];for(var f={},i=0;i<e;i++)d.printOddsSavedTemplates.push(f);
}c.tournamntIdsNames=b,h.viewEventsOdds(a,!0),window.location.pathname.includes("/fixtures/")?h.showLogoSelection=!1:h.showLogoSelection=!0}else g.showErrorMessage(locale.account.printOdds.noTournamentSelected).done()},this.unSelectAll=function(a){$($(a).find("input[name='radioOddTypeCustom'][type='checkbox']")).prop("checked",!1),$($(a).find("input[name='radioOddTypeCustom'][type='checkbox']")).parent().parent().removeClass("checked"),$($(a).find("input[name='radioOddTypeCustom'][type='checkbox']")).parents(".eventGroup").find(".eventCategory").removeClass("checked"),$($(a).find("input[name='radioOddTypeGroups'][type='radio']")).prop("checked",!1)},this.updateDateRange=function(){var a=$("#HidIDSport").val();""!=a?h.updateSportsEvents(a):h.updateSportsEvents(null)},this.uncheckOtherTypes=function(a){var b=$(a.currentTarget),c=b.attr("data-marketType");"outrights"==c?($(".chkCustomMarkets").prop("checked",!1),$(".chkCustomMarkets").parent().parent().removeClass("checked"),$(".chkCustomMarkets").parents(".eventGroup").find(".eventCategory").removeClass("checked")):"markets"==c&&($(".chkCustomOutrights").prop("checked",!1),$(".chkCustomOutrights").parent().parent().removeClass("checked"),$(".chkCustomOutrights").parents(".eventGroup").find(".eventCategory").removeClass("checked"))},this.selectAllGroups=function(a,b){var c=$(a.currentTarget);c.parents(".panel").find("input[type='checkbox']").each(function(a,b){if($(this).parents(".inner-content:visible").length>0){var c=$(b);c.prop("checked",!1),c.parent().parent().removeClass("checked")}}),c.parents(".panel").find(".eventCategory .chkSelectCheckbox").each(function(a,b){if($(this).parents(".eventGroup:visible").length>0){var c=$(b);c.parent().removeClass("checked"),c.children("span").first().text(locale.common.selectAll)}});var d="prematch"==b?"outright":"prematch";c.parents(".panel").find("."+d+" .btnSelectAll").removeClass("checked"),c.parents(".panel").find("."+d+" .btnSelectAll").children("span").first().text(locale.common.selectAll),c.hasClass("checked")?(c.removeClass("checked"),c.children("span").first().text(locale.common.selectAll)):(c.parents(".panel").find("."+b+" input[type='checkbox']").each(function(a,b){if($(this).parents(".inner-content:visible").length>0){var c=$(b);c.prop("checked",!0),c.parent().parent().addClass("checked")}}),c.parents(".panel").find("."+b+" .eventCategory .chkSelectCheckbox").each(function(a,b){if($(this).parents(".eventGroup:visible").length>0){var c=$(b);c.parent().addClass("checked"),c.children("span").first().text(locale.common.unSelectAll)}}),c.addClass("checked"),c.children("span").first().text(locale.common.unSelectAll))},this.categorySelectAll=function(a,b){var c=$(a.currentTarget).find(".chkSelectCheckbox"),d=c.data("cbxgroup");c.parent().hasClass("checked")?($("input[name='"+d+"']").each(function(a,b){var c=$(b);c.prop("checked",!1),c.parent().parent().removeClass("checked")}),c.parent().removeClass("checked")):($("input[name='"+d+"']").each(function(a,b){var c=$(b);c.prop("checked",!0),c.parent().parent().addClass("checked")}),c.parent().addClass("checked"));var e="prematch"==b?"outright":"prematch";c.parents(".panel").find("."+e+" input[type='checkbox']").each(function(a,b){if($(this).parents(".inner-content:visible").length>0){var c=$(b);c.prop("checked",!1),c.parent().parent().removeClass("checked")}}),c.parents(".panel").find("."+e+" .eventCategory .chkSelectCheckbox").each(function(a,b){if($(this).parents(".eventGroup:visible").length>0){var c=$(b);c.parent().removeClass("checked"),c.children("span").first().text(locale.common.selectAll)}}),c.parents(".panel").find("."+e+" .btnSelectAll").removeClass("checked"),c.parents(".panel").find("."+e+" .btnSelectAll").children("span").first().text(locale.common.selectAll)},this.marketSelectAll=function(a){var b=$(a.currentTarget).find(".chkSelectCheckbox"),c=b.data("cbxgroup");b.parent().hasClass("checked")?($("input[id='"+c+"']").each(function(a,b){var c=$(b);c.prop("checked",!1),c.parent().parent().removeClass("checked")}),b.parent().removeClass("checked")):($("input[id='"+c+"']").each(function(a,b){var c=$(b);c.prop("checked",!0),c.parent().parent().addClass("checked")}),b.parent().addClass("checked"))},this.addChecked=function(a,b){var c=$(a.currentTarget).find(".chkSelectCheckbox"),d=c.data("cbxgroup");c.parent().hasClass("checked")?(c.find("input[name='"+d+"']").prop("checked",!1),c.parent().removeClass("checked")):(c.find("input[name='"+d+"']").prop("checked",!0),c.parent().addClass("checked"));var e=$("input[name='"+d+"']").length,f=$("input[name='"+d+"']:checked").length,g=$(".chkSelectCheckbox[name='"+d+"']");e===f?g.parent().addClass("checked"):g.parent().hasClass("checked")&&g.parent().removeClass("checked");var h="prematch"==b?"outright":"prematch";c.parents(".panel").find("."+h+" input[type='checkbox']").each(function(a,b){if($(this).parents(".inner-content:visible").length>0){var c=$(b);c.prop("checked",!1),c.parent().parent().removeClass("checked")}}),c.parents(".panel").find("."+h+" .eventCategory .chkSelectCheckbox").each(function(a,b){if($(this).parents(".eventGroup:visible").length>0){var c=$(b);c.parent().removeClass("checked"),c.children("span").first().text(locale.common.selectAll)}}),c.parents(".panel").find("."+h+" .btnSelectAll").removeClass("checked"),c.parents(".panel").find("."+h+" .btnSelectAll").children("span").first().text(locale.common.selectAll)},this.addMarketChecked=function(a){var b=$(a.currentTarget).find(".chkSelectCheckbox"),c=b.data("cbxgroup");b.parent().hasClass("checked")?(b.find("input[type='checkbox'][id='"+c+"']").prop("checked",!1),b.parent().removeClass("checked")):(b.find("input[type='checkbox'][id='"+c+"']").prop("checked",!0),b.parent().addClass("checked"));var d=$("input[type='checkbox'][id='"+c+"']").length,e=$("input[type='checkbox'][id='"+c+"']:checked").length,f=$(".chkSelectCheckbox[name='"+c+"']");d===e?f.parent().addClass("checked"):f.parent().hasClass("checked")&&f.parent().removeClass("checked")},this.viewEvents=function(a){var b=$(a.currentTarget).find("input[type='radio']"),c=b.attr("id");h.updateSportsEvents(c)},this.updateSportsEvents=function(a){$("#HeventIds").val(""),delete c.tournamntIdsNames,$("#HidIDSport").val(a);var d="";$("input:checkbox[name=datesPDF]:checked").each(function(){d+=$(this).val()+","}),d.length>0?(d=d.substring(0,d.length-1),$("#HdateRange").val(d)):d=null,e.showLoader(),b.listSportsEvents(a,d).then(function(b){e.hideLoader(),h.oddsSelection=!1,h.eventsBack=!1,h.eventsSelection=!1,h.sportsSelection=!1,h.datesSelection=!0,null!=a?h.eventsSelection=!0:h.sportsSelection=!0,1!=a&&(h.eventsBack=!0),h.sportEventsMatchesData=b[0].data,h.sportEventsOutrightsData=b[1].data,h.availableSports=h.sportEventsMatchesData.Sports.concat(h.sportEventsOutrightsData.Sports)})},this.backToEvents=function(){$("#HdateRange").val(""),h.updateSportsEvents($("#HidIDSport").val())},this.viewPrint=function(){var a=$("#HeventIds").val(),b=$("#HdateRange").val(),c="",d=$("input[name='radioPDFOddsSelection']:checked").val(),e=$("input[name='radioPageLayout']:checked").val(),f=$("input[name='radioFontSize']:checked").val(),h=window.location.pathname.includes("/fixtures/")?"logo":$("input[name='radioPrintLogo']:checked").val(),i="false";"Date"==$("input[name='radioPDFGrouping']:checked").val()&&(i="true");var j="html";if("Custom"==d){if($("input[name='radioOddTypeCustom']:checked").each(function(){var a=$(this).attr("data-oddsTypeId"),a=$(this).attr("data-oddsTypeId").split("|").join("_");a=a.split(".").join("@"),c+=a+","}),c.length>0)return c=c.substring(0,c.length-1),void window.open("/print-odds-"+j+"/"+j+"?printType=standard&categoryType=event&areaMarkets=markets&eventIds="+a+"&areaMarketIds="+c+"&orderByDate="+i+"&pageLayout="+e+"&fontSize="+f+"&printLogo="+h+"&dateRange="+b,"stampaQuote_"+Math.random(),"resizable=no, toolbar=no, status=yes, dependent=no, scrollbars=1, width=550, height=370")}else{var k=$("input[name='radioOddTypeGroups']:checked").attr("id");if(k.length>0)return void window.open("/print-odds-"+j+"/"+j+"?printType=standard&categoryType=event&areaMarkets=area&eventIds="+a+"&areaMarketIds="+k+"&orderByDate="+i+"&pageLayout="+e+"&fontSize="+f+"&printLogo="+h+"&dateRange="+b,"stampaQuote_"+Math.random(),"resizable=no, toolbar=no, status=yes, dependent=no, scrollbars=1, width=550, height=370")}return g.showErrorMessage(locale.account.printOdds.noOddsSelected).done()},this.showGroupsCustom=function(a){if(null!=a){var b=$(a.currentTarget).find("input[type='radio']");b.prop("checked",!0)}var c=$("input[name='radioPDFOddsSelection']:checked").val();void 0!=c&&""!=c||($("#rdbPDFCustom").prop("checked",!0),c="Custom"),"Groups"==c?($("#rdbPDFCustom").prop("checked",!1),$(".divPDFGroups").animate({opacity:1},100,function(){$(".divPDFCustom").animate({opacity:0},100,function(){$(".divPDFCustom").css("display","none"),$(".divPDFGroups").css("display","block")})})):($("#rdbPDFGroups").prop("checked",!1),$(".divPDFCustom").animate({opacity:1},100,function(){$(".divPDFGroups").animate({opacity:0},100,function(){$(".divPDFGroups").css("display","none"),$(".divPDFCustom").css("display","block")})}))},showError=function(a){a=a.match("<error>(.+?)</error>")[1],a&&($(".sportsSelection").css("display","none"),$(".eventsSelection").css("display","none"),$("#errorMsg").css("display","block"),$("#errorMsg .PanelMessageText").html(a))},this.showSaveTemplateDialog=function(){for(var b=!1,c=0;c<d.printOddsSavedTemplates.length;c++){var e=d.printOddsSavedTemplates[c];if(!e.templateName){b=!0;break}}if(b){var f='<div class="templateConfirmation"><div class="contentMessage"><div class="messageContent"><span class="message text-left">'+locale.account.printOdds.templateConfirmationMessage+'</span></div><input type="text" name="templateName" placeholder="'+locale.account.printOdds.templateName+'" /></div></div>';g.showMessageWithHtml(f,!0,locale.common.cancel,!0,locale.account.printOdds.saveTemplate).then(function(){a.$apply(function(){h.saveTemplate($("input[name='templateName']").val())})}).done()}else g.showErrorMessage(locale.account.printOdds.exceededTemplates).done()},this.saveTemplate=function(a){for(var b=0;b<d.printOddsSavedTemplates.length;b++){var c=d.printOddsSavedTemplates[b];if(!c.templateName){var e=$("input[name='radioPDFGrouping']:checked").val(),f=$("input[name='radioPDFOddsSelection']:checked").val(),g=$("input[name='radioPageLayout']:checked").val(),h=$("input[name='radioFontSize']:checked").val(),i=window.location.pathname.includes("/fixtures/")?"logo":$("input[name='radioPrintLogo']:checked").val(),j=[];if("Custom"==f)$("input[name='radioOddTypeCustom']:checked").each(function(){var a=$(this).attr("data-oddsTypeId");j.push(a)});else{var k=$("input[name='radioOddTypeGroups']:checked").attr("id");k.length>0&&j.push(k)}""==a&&(a="Template "+b);var l={templateName:a,groupBy:e,oddsSelection:f,pageLayout:g,fontSize:h,printLogo:i,odds:j};d.printOddsSavedTemplates[b]=l;break}}},this.removeTemplate=function(a){d.printOddsSavedTemplates.splice(a,1);var b={};d.printOddsSavedTemplates.push(b)},this.loadTemplate=function(a){var b=d.printOddsSavedTemplates[a];if($('input[name="radioPDFGrouping"][value="'+b.groupBy+'"]').prop("checked",!0),$("input[name='radioPDFOddsSelection']:checked").val()!=b.oddsSelection&&($('input[name="radioPDFOddsSelection"][value="'+b.oddsSelection+'"]').prop("checked",!0),h.showGroupsCustom(null)),$('input[name="radioPageLayout"][value="'+b.pageLayout+'"]').prop("checked",!0),$('input[name="radioFontSize"][value="'+b.fontSize+'"]').prop("checked",!0),$('input[name="radioPrintLogo"][value="'+b.printLogo+'"]').prop("checked",!0),h.unSelectAll("div"),"Custom"==b.oddsSelection)for(var c=0;c<b.odds.length;c++){var e=$('input[name="radioOddTypeCustom"][data-oddsTypeId="'+b.odds[c]+'"]');e.prop("checked",!0),e.parent().parent().addClass("checked");var f=$("input[type='checkbox'][id='"+e.attr("id")+"']").length,g=$("input[type='checkbox'][id='"+e.attr("id")+"']:checked").length,i=$(".chkSelectCheckbox[name='"+e.attr("id")+"']");f===g?i.parent().addClass("checked"):i.parent().hasClass("checked")&&i.parent().removeClass("checked")}else b.odds.length>0&&$('input[name="radioOddTypeGroups"][id="'+b.odds[0]+'"]').prop("checked",!0)};var k=function(a){return angular.forEach(a.AreasMarkets,function(a){angular.forEach(a.Markets,function(a){1==a.OddsType.IsOutright?a.MarketType="outrights":a.MarketType="markets";var b="",c="";if(void 0!=a.OddsType.IDGroup){var d="",e="",f="";angular.forEach(a.Markets,function(g){g.OddAttribute.SpecialValue!=e&&(d=g.OddAttribute.Spread,e=g.OddAttribute.SpecialValue,f=g.OddAttribute.SpecialValueDisplay,b=b+f+", ",c=c+a.OddsType.IDGroupMarketType+"|"+(null!=d?d:e)+",")}),""!=b&&(b=b.substring(0,b.length-2),b=" ("+b+")",c=c.substring(0,c.length-1))}""==c&&(c=a.OddsType.IDGroupMarketType+"|"+a.SpecialBetValue),a.SpecialValues=b,a.SpecialValuesURL=c})}),a};this.viewEventsOdds=function(a,c){$("#HeventIds").val(a),h.printOddsSavedTemplates=d.printOddsSavedTemplates;var f=$("#HdateRange").val();""==f&&(f=null),e.showLoader(),b.listEventsOdds(a,f).then(function(a){e.hideLoader(),h.datesSelection=!1,h.oddsSelection=!0,h.eventsSelection=!1,h.sportsSelection=!1,h.eventOddsData=k(a.data),h.showCancelButton=c})};var l=f.params;null==l.eventIds?(this.eventsSelection=!0,this.datesSelection=!0,this.sportsSelection=!1,$(".eventGroup").css("display","block"),$("#btnBack").css("display","block"),b.listSportsEvents(1,null).then(function(a){h.sportEventsMatchesData=a[0].data,h.sportEventsOutrightsData=a[1].data,h.availableSports=h.sportEventsMatchesData.Sports.concat(h.sportEventsOutrightsData.Sports)})):($(".eventGroup").css("display","none"),this.viewEventsOdds(l.eventIds,!1))}]).controller("PrintOddsController",["$scope","PrintDataResolver","dataPrintOdds","$rootScope","$filter","$timeout","$transition$",function(a,b,c,d,e,f,g){var h=this;c.data.OrderByDate=JSON.parse(g.params().orderByDate),c.data.PageLayout=g.params().pageLayout,c.data.FontSize=g.params().fontSize,c.data.PrintLogo=g.params().printLogo,a.getBorderStlye=function(a,b){var c={};return a&&(c["border-left"]="2px solid black"),b&&(c["border-right"]="2px solid black"),c},this.stringSort=function(a,b){return a.trim()<b.trim()?-1:a.trim()>b.trim()?1:0},this.getDayOfYear=function(a){var b=new Date(a),c=new Date(b.getFullYear(),0,0),d=b-c,e=864e5,f=Math.floor(d/e);return f};var i=function(a){var b=1,c=24;a.dimensioneCarattere=9,"small"==a.FontSize?a.dimensioneCarattere=7:"large"==a.FontSize&&(a.dimensioneCarattere=11);var d=0;if(1!=a.AM[0].CO){a.OrderByDate||a.AM[0].IT.sort(firstBy(function(a,b){return h.getDayOfYear(e("amDateFormat")(a.ID,"YYYY-MM-DD"))-h.getDayOfYear(e("amDateFormat")(b.ID,"YYYY-MM-DD"))}).thenBy(function(a,b){return h.stringSort(a.CN,b.CN)}).thenBy(function(a,b){return h.stringSort(a.TN,b.TN)}).thenBy(function(a,b){return h.stringSort(e("amDateFormat")(a.ID,"HH:mm"),e("amDateFormat")(b.ID,"HH:mm"))}).thenBy(function(a,b){return h.stringSort(a.IN,b.IN)})),a.AM[0].AllMarketsCount=0,angular.forEach(a.AM[0].AM,function(b){var c=!1,e=null!=b.OT.IG,f=0!=b.OT.TT;e&&f&&(c=!0);var g=b.MK.length;c&&(g+=parseInt(b.SC),d+=parseInt(b.SC)),d+=b.MK.length,b.colspanCount=g,a.AM[0].AllMarketsCount=a.AM[0].AllMarketsCount+g}),a.countCol=d,a.AM[0].AllMarketsCount>c&&(b=Math.ceil(a.AM[0].AllMarketsCount/c)),a.AM[0].FormatMarkets=[],a.AM[0].FormatSelections=[];for(var f=0;f<b;f++)a.AM[0].FormatMarkets[f]=[],a.AM[0].FormatSelections[f]=[];angular.forEach(a.AM[0].AM,function(b){var d=0,e=[],f=[];if(e.push({colspanCount:b.colspanCount,oddId:b.OT.OI,oddName:b.OT.ON}),angular.forEach(b.MK,function(a,c){a.HasSpread=!1,a.oddId=b.OT.OI;var e=!1,g=null!=b.OT.IG,h=0!=b.OT.TT;if(g&&h&&(e=!0),e)if(d+=1,1==parseInt(b.SC))1==d&&(a.HasSpread=!0,f.push({spread:!0}));else{var i=b.MK.length/parseInt(b.SC);1==d&&(a.HasSpread=!0,f.push({spread:!0})),d==i&&(d=0)}a.hasBorder=!1,0==c&&(a.hasBorder=!0),f.push(a)}),f.length<=c){for(var g=0;g<a.AM[0].FormatSelections.length;g++)if(a.AM[0].FormatSelections[g].length+f.length<=c){$.merge(a.AM[0].FormatMarkets[g],e),$.merge(a.AM[0].FormatSelections[g],f);break}}else{var h=_.chunk(f,c);$.merge(a.AM[0].FormatSelections,h);for(var i=[],g=0;g<h.length;g++){var j=[];j.push({colspanCount:h[g].length,oddId:e[0].oddId,oddName:e[0].oddName+" - "+locale.account.printOdds.selectionPart.replace("{0}",g+1).replace("{1}",h.length)}),i.push(j)}$.merge(a.AM[0].FormatMarkets,i);for(var g=0;g<a.AM[0].FormatSelections.length;g++)0==a.AM[0].FormatSelections[g].length&&(a.AM[0].FormatSelections.push(a.AM[0].FormatSelections[g]),a.AM[0].FormatSelections.splice(g,1),a.AM[0].FormatMarkets.push(a.AM[0].FormatMarkets[g]),a.AM[0].FormatMarkets.splice(g,1))}});for(var f=0;f<a.AM[0].FormatSelections.length;f++){var g=a.AM[0].FormatSelections[f],i=a.AM[0].FormatMarkets[f];if(0==g.length)a.AM[0].FormatSelections.splice(f,1),a.AM[0].FormatMarkets.splice(f,1),f-=1;else if(g.length<c)for(var j=f+1;j<a.AM[0].FormatSelections.length;j++){var k=a.AM[0].FormatSelections[j];a.AM[0].FormatMarkets[j];if(g.length+k.length<=c){$.merge(a.AM[0].FormatSelections[j],g),a.AM[0].FormatSelections.splice(f,1),$.merge(a.AM[0].FormatMarkets[j],i),a.AM[0].FormatMarkets.splice(f,1);break}}}for(var f=0;f<a.AM[0].FormatSelections.length;f++){var g=a.AM[0].FormatSelections[f];a.AM[0].FormatSelections[f]=g.filter(function(a){return void 0==a.spread})}var l="",m="";angular.forEach(a.AM,function(d){angular.forEach(d.IT,function(f){f.IsPreviousDate=!1;var g=e("amDateFormat")(f.ID,"dddd DD MMMM");m!=g&&(m=g,f.IsPreviousDate=!0),f.IsPreviousItem=!1,l!=f.TN+" "+f.CN&&(l=f.TN+" "+f.CN,f.IsPreviousItem=!0),f.FormatOddAttributes=[];for(var h=0;h<b;h++)f.FormatOddAttributes[h]=[];angular.forEach(d.AM,function(b){var d,g=[],h=null!=b.OT.IG;d=h?f.OC.filter(function(a){return a.OT.IG==b.OT.IG&&a.SB==b.SB})[0]:f.OC.filter(function(a){return a.OT.ON==b.OT.ON&&a.SB==b.SB})[0];var i=0,j=0,k=!0;if(angular.forEach(b.MK,function(c,f){var h=angular.copy(c);h.SpreadStatus="",h.OddAttributeStatus="";var l=!1,m=null!=b.OT.IG,n=0!=b.OT.TT;if(m&&n&&(l=!0),l)if(i+=1,1==parseInt(b.SC))1==i&&(void 0!=d&&d.MO.length>0?(j=d.MO[0].OA.VD,h.SpreadStatus="specialValue",h.SpecialValue=d.MO[0].OA.VD):(k=!1,h.SpreadStatus="specialValueEmpty"),g.push({spread:!0}));else{var o=b.MK.length/parseInt(b.SC);1==i&&(void 0!=d&&d.MO.length>i-1?(j=d.MO[i-1].OA.VD,h.SpreadStatus="specialValueSC",h.SpecialValue=d.MO[i-1].OA.VD):(k=!1,h.SpreadStatus="specialValueSCEmpty"),g.push({spread:!0})),i==o&&(i=0)}else void 0!=d&&(j=d.MO[0].OA.VD);if(void 0!=d&&k){var p=d.MO.filter(function(a){return a.OA.ON==h.OA.ON&&a.OA.VD==j})[0];if(void 0==p)h.OddAttributeStatus="oddEmpty";else{var q=a.dimensioneCarattere;parseFloat(p.OT.OO)<100&&(q=a.dimensioneCarattere+1),h.OddAttributeStatus="oddAvailable",h.OddFontSize=q,h.OddValue=e("number")(p.OT.OO,2)}}else h.OddAttributeStatus="oddEmpty";h.hasBorder=!1,0==f&&(h.hasBorder=!0),g.push(h)}),g.length<=c){for(var l=0;l<f.FormatOddAttributes.length;l++)if(f.FormatOddAttributes[l].length+g.length<=c){$.merge(f.FormatOddAttributes[l],g);break}}else{var m=_.chunk(g,c);$.merge(f.FormatOddAttributes,m);for(var l=0;l<f.FormatOddAttributes.length;l++)0==f.FormatOddAttributes[l].length&&(f.FormatOddAttributes.push(f.FormatOddAttributes[l]),f.FormatOddAttributes.splice(l,1))}});for(var h=0;h<f.FormatOddAttributes.length;h++){var i=f.FormatOddAttributes[h];if(0==i.length)f.FormatOddAttributes.splice(h,1),h-=1;else if(i.length<c)for(var j=h+1;j<f.FormatOddAttributes.length;j++){var k=f.FormatOddAttributes[j];if(i.length+k.length<=c){$.merge(f.FormatOddAttributes[j],i),f.FormatOddAttributes.splice(h,1);break}}}for(var h=0;h<f.FormatOddAttributes.length;h++){var i=f.FormatOddAttributes[h];f.FormatOddAttributes[h]=i.filter(function(a){return void 0==a.spread})}})})}else angular.forEach(a.AM[0].AM,function(a){d+=1}),a.countCol=d,angular.forEach(a.AM,function(b){var c=0,d=1,f="";angular.forEach(b.IT,function(b){var g="";b.IsPreviousItem=!1,f!=b.TN+" "+b.CN&&(f=b.TN+" "+b.CN,b.IsPreviousItem=!0),c+=1,d=0==d?1:0,b.bgAlternate="",1==d&&(b.bgAlternate="background-color:#eee;");var h=[];angular.forEach(b.OC[0].MO,function(c){var d=[];d.IsPreviousEvent=!1,g!=b.IN&&(g=b.IN,d.IsPreviousEvent=!0),d.SpecialBetValue=c.SB,d.OddName=c.OA.ON,d.OddsCollection=[],angular.forEach(b.OC,function(b){var f=angular.copy(b);f.OddStatus="";var g=f.MO.filter(function(a){return a.SB==c.SB})[0];if(void 0==g)f.OddStatus="oddEmpty";else{var h=a.dimensioneCarattere;parseFloat(g.OT.OO)<100&&(h=a.dimensioneCarattere+1),f.OddStatus="oddAvailable",f.OddFontSize=h,f.OddValue=e("number")(g.OT.OO,2)}d.OddsCollection.push(f)}),h.push(d)}),b.FormatOddsCollection=h})});return a};0==c.data.AM.length?(a.fixturesPrintDate=null,a.printOddsData=null):(a.fixturesPrintDate=moment().format("DD/MM/YYYY HH:mm"),a.printOddsData=i(c.data)),f(function(){var a=window.document.styleSheets[0];a.insertRule("@page { size: "+c.data.PageLayout+"; }",a.cssRules.length),window.print(),globalSettings.DebugMode||window.close()}.bind(this),4e3)}]);Array.prototype.removeDuplicates=function(){var a=new Array;a:for(i=0;i<this.length;i++){for(var b=0;b<a.length;b++)if(a[b]==this[i])continue a;a[a.length]=this[i]}return a.sort(),a}}(),function(){angular.module("authenticatedProfileManagment",["bankProfile.service"]).controller("ProfileManagmentController",["$scope","bankProfileService","$location",function(a,b,c){var d=this;this.selectedTab=1,this.isAllowedBankAccInfo=!1;var e=c.search();e&&"bank"===e.prof&&globalSettings.Account_EnableWithdrawalBankProfile&&(d.selectedTab=2),this.reportTabs=[{id:1,title:"Personal Information"},{id:2,title:"Bank Account Info"}],this.onTabChange=function(a){d.selectedTab!==a&&globalSettings.Account_EnableWithdrawalBankProfile&&(d.selectedTab=a)},d.isAllowedBankAccInfo=b.isAllowedBankAccInfo}]).controller("bankProfileController",["$scope","$rootScope","$q","$location","$localStorage","authService","platformApiService","helperService","bankProfileService","$timeout",function(a,b,c,d,e,f,g,h,i,j){var k=this;this.accountTypes=[{id:1,name:"primary"},{id:2,name:"secondary"}],this.accountType=null,this.readonlyProfile=!0;var l=d.search();l&&"bank"===l.prof&&(k.readonlyProfile=!1),this.showProfiles=!0,this.profileAlt=null,this.allowedProfiles=null,this.enabledProfiles=null,this.bankDetails=[],this.bankName=null,this.accountNumber=null,this.bankNameAlter=null,this.profiles=[],this.profile={},this.username=null,this.showInfoPopup=function(){h.showInfoMessage(locale.account.editProfile.saveWithdrawalBankProfile.pendingBankAccountDetails)},this.saveProfile=function(){if(!k.accountNumber||!k.bankName.BankCode)return void h.showErrorMessage(locale.account.editProfile.saveWithdrawalBankProfile.errorMessage);var a={AccountNumber:k.accountNumber,BankCode:k.bankName.BankCode};b.showLoader(".editProfileButton","element-small",0),i.saveNewBankProfile(a,!1).then(function(a){b.hideLoader(".editProfileButton"),a&&(i.setSaveBankAccStatus(!0),k.profiles=i.profiles,k.adjustUI())})},this.adjustUI=function(){k.accountType||(k.profiles&&0!==k.profiles.length?k.profiles.length>=1&&(k.showProfiles=!0):k.showProfiles=!1)},this.switchToNewProfile=function(){k.showProfiles=!k.showProfiles},this.getBankName=function(a){i.bankLists.forEach(function(b){if(b.BankCode===a)return b.BankName})},this.swapProfile=function(a){i.swapBankProfile(a).then(function(a){a&&(k.profiles=i.profiles,k.adjustUI())})},this.validateShowProfile=function(a){if(3===a.Verification.VerificationStatusID){const b=new Date(a.Verification.StatusChangedDate);b.setHours(b.getHours()+48);const c=new Date;return c<b}return!!a.Enabled&&(2===a.Verification.VerificationStatusID||4===a.Verification.VerificationStatusID||1===a.Verification.VerificationStatusID)},this.editProfileInit=function(){g.paymentVendors.bankTransfer.checkAllowedBankProfiles().then(function(a){k.allowedProfiles=a.data}),i.bankLists?k.bankDetails=i.bankLists:g.paymentVendors.bankInformation.getBankList().then(function(a){a.success?(i.bankLists=a.data,k.bankDetails=a.data):h.showErrorMessage(errorMsg||userMsg)}),k.profiles=i.profiles,k.enabledProfiles=i.enabledProfiles,k.adjustUI()},k.editProfileInit()}])}(),function(){angular.module("authenticatedQuickCashier",[]).controller("CashierController",["$rootScope","$scope","platformApiService","loggingService",function(a,b,c,d){var e=this,f=c.finance,g=c.paymentVendors.paymentMethods;this.balances=null,this.apiParam="web",this.TransferTo=null,this.totalBalance=0,this.SourceWalletId=null,this.SourceWalletBalance=0,this.SourceWalletName="",this.TargetWalletId=null,this.TargetWalletName="",this.Amount=0,this.Currency="",this.CurrencySymbol="",this.MainWalletId=null,this.MainWalletName="",this.stepPosition=0,this.finalSteps=null,this.info={},this.hideEnterAmountStep3=!1,this.hideEnterAmountStep4=!1,this.inputAmountReadonly=!1,this.getTransferWallet=function(a,b,c){e.SourceWalletId=a,e.SourceWalletBalance=c,e.SourceWalletName=b,e.stepPosition=2,e.hideEnterAmountStep3=!1,e.inputAmountReadonly=!1,e.TargetWalletName="",e.TargetWalletId=0},this.getTransferUser=function(a,b){e.TargetWalletName=b,e.TargetWalletId=a,e.hideEnterAmountStep3=!1,e.inputAmountReadonly=!1,e.stepPosition=3,e.TargetWalletId!==e.MainWalletId&&e.SourceWalletId!==e.MainWalletId?(e.info.stepThreeTitle=locale.account.cashier.transferFrom+""+e.SourceWalletName+locale.common.to+e.MainWalletName,e.info.stepFourTitle=locale.account.cashier.transferFrom+""+e.MainWalletName+locale.common.to+e.TargetWalletName,e.finalSteps=!0,e.inputAmountReadonly=!1):(e.info.stepThreeTitle=locale.account.cashier.transferFrom+""+e.SourceWalletName+locale.acommon.to+e.MainWalletName,e.finalSteps=!1)},this.getTransferAmount=function(){e.Amount<=e.SourceWalletBalance?(e.inputAmountReadonly=!0,e.finalSteps===!1?(e.transferAmount(e.SourceWalletId,e.TargetWalletId),e.info.stepThreeTitle=e.CurrencySymbol+e.Amount+locale.account.cashier.successfullTransfer+e.TargetWalletName,e.hideEnterAmountStep3=!0,e.Amount=0):e.finalSteps===!0&&(e.transferAmount(e.SourceWalletId,e.MainWalletId),e.info.stepThreeTitle=e.CurrencySymbol+e.Amount+locale.account.cashier.successfullTransfer+e.MainWalletName,e.stepPosition=4,e.hideEnterAmountStep3=!0)):(e.hideEnterAmountStep3=!1,e.inputAmountReadonly=!1,e.info.stepThreeTitle=locale.account.cashier.amountNotValid)},this.getTransferAmountLastRow=function(){e.transferAmount(e.MainWalletId,e.TargetWalletId),e.info.stepFourTitle=e.CurrencySymbol+e.Amount+""+locale.account.cashier.successfullTransfer+e.TargetWalletName,e.Amount=0,e.stepPosition=5},this.transferAmount=function(a,b){var c=new gamingAppModels.TransferToAccountRequestModel;c.SourceAccountId=a,c.TargetAccountId=b,c.Amount=e.Amount,f.transferBalance(c).then(function(a){if(!a.success)return void d.logError("Unable to get user balances: "+a.error);var b=c.SourceAccountId,f=c.TargetAccountId,g=c.Amount;angular.forEach(e.balances,function(a){a.Id==b?a.Balance-=parseInt(g):a.Id==f&&(a.Balance+=parseInt(g))})})},this.changeVisibleAmount=function(){f.getPlaySource(e.apiParam).then(function(a){setTimeout(function(){e.balances=a.data,f.getPlaySource(e.apiParam).then(function(a){e.balances=a.data})},2500)})},a.showLoader(),g.getAllDepositPaymentMethods().then(function(a){e.Currency=a.data[0].MinimumLimit.Currency,e.CurrencySymbol=a.data[0].MinimumLimit.CurrencySymbol}),f.getPlaySource(e.apiParam).then(function(b){if(a.hideLoader(),!b.success)return void d.logError("Unable to get user balances: "+b.error);e.balances=b.data;for(var c=0;c<e.balances.length;c++)e.balances[c].IsMain===!0&&(e.MainWalletId=e.balances[c].Id,e.MainWalletName=e.balances[c].Name),e.totalBalance+=e.balances[c].Balance})}])}(),function(){angular.module("authenticatedActivate",[]).controller("ActivateController",["$rootScope","platformApiService","helperService","loggingService",function(a,b,c,d){var e=this,f=b.security,g=c.getUrlParameters(window.location.search);this.activationErrorMessage="",this.isActivated=!1,this.isActivationMode=void 0!==g.userid&&null!==g.userid&&""!==g.userid&&void 0!==g.checkcode&&null!==g.checkcode&&""!==g.checkcode,this.isResendMode=void 0!==g.userid&&null!==g.userid&&""!==g.userid&&"true"===g.resend,this.resendErrorMessage="",this.resendSeccusseded=!1,this.activate=function(){if(e.isActivationMode){var a={UserId:g.userid,CheckCode:g.checkcode};f.activateUser(a).then(function(a){if(e.isActivated=a.success,!a.success)return d.logError(locale.account.register.activationUnable+a.error),void(e.activationErrorMessage=a.userMsg)})}},this.gotoResend=function(){url=window.location.href,window.location.href=url.slice(0,url.indexOf("checkcode"))+"resend=true"},this.resendActivation=function(){var a={UserId:g.userid,ActivationUrl:c.getActivationLink(!1)};f.resendActivation(a).then(function(a){e.resendSeccusseded=a.success,a.success||(d.logError(locale.account.register.resendUnable+a.error),e.resendErrorMessage=a.userMsg)})},this.isActivationMode?this.activate():this.isResendMode&&this.resendActivation()}])}(),function(){angular.module("authenticatedRegister",[]).controller("RegisterController",["$scope","$rootScope","$location","$timeout","$cookies","languageChecker","authService","thirdPartyApiService","platformApiService","helperService","ngDialog","loggingService","$sessionStorage","currencyService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a,b){s.registerNewUser(a).then(function(c){if(c.success){globalSettings.TranferFundToNewUser&&q.transferFunds(c);var d={Username:globalSettings.Registration_QuickRegister?q.mobileExtension.replace("+","")+j.cleanMobileNumber(q.mobile):q.username};p(c.data.UserId),globalSettings.General_EnableOTPbySms&&"BySms"==q.activationOption&&!globalSettings.Registration_SkipOTP?(q.limitExceeded=!1,s.registerBySms(d).then(function(a){if(q.submitInProgress=!1,!a.success){if(20805!=a.responseCode)return;q.limitExceeded=!0}q.phoneVerification=!0,j.createDataLayerEvent({event:"registration-step-2",stepName:"OTP Validation"},!0)})):(q.submitInProgress=!1,q.username=globalSettings.Registration_QuickRegister?globalSettings.Account_LoginPrefix?a.PhoneContacts[0].Number:a.PhoneContacts[0].Prefix+a.PhoneContacts[0].Number:a.Username,j.showSuccessMessage(locale.account.manageUsers.newUserMessage).done(),q.registrationCompleted=!0)}else if(q.submitInProgress=!1,b&&20100===c.responseCode)j.showErrorMessage(locale.account.register.registrationFailedMessage.partOne+"<br>"+locale.account.register.registrationFailedMessage.partTwo+' <a href="../reset-password" target="_parent">'+locale.account.register.registrationFailedMessage.cta+"</a> "+locale.account.register.registrationFailedMessage.partThree).done();else{null!=c.userMsg?l.logError(locale.account.register.regUnable+c.error,c.userMsg):l.logError(locale.account.register.regUnable+"<br/><br/>"+c.Result[0],c.userMsg);var e=j.handlePlatformError(c);e||j.showErrorMessage(c.Result[0]+"<br/><br/>"+c.userMsg).done()}})}function p(a){j.createOptimoveEvent("onRegistration","userId",a.toString(),!0),globalSettings.Tracking_EnableDataLayer&&j.setValueToDataLayer("newReg",a)}var q=this,r=i.location,s=i.security,t=i.settings,u=i.finance,v=h.ipify,w=!1;if(g.hasValidLogin()&&!g.getCanRegisterSubAccountPlayers()&&!g.isAgent())return void j.goToUmbracoPage("account");if(a.forms={},this.phoneVerification=!1,this.limitExceeded=!1,this.alreadyRegistered=!1,this.registrationCompleted=!1,this.completeRegister,this.registerTabSelected=1,this.stepOneValid=!1,this.registeredOnMultipleAccounts=!1,this.hasActivationProcess=!0,this.activationOption="none",this.registrationCountries=[],this.countries=[],this.cities=[],this.states=[],this.telephoneExtensions=[],this.securityQuestions=[],this.currencies=[],this.depositLimitPeriods=[],this.NoDepositLimit={Id:0,Name:locale.account.editProfile.accountData.noLimit},this.depositLimitPattern="/^[1-9][0-9]*$/",this.inputValueLimits={Username:{Max:50,Min:6},Email:{Max:50,Min:5,Pattern:"^(?=.*?[@]).{5,}$"},
Password:{Max:15,Min:6,Pattern:"^\\S{6,15}$"},Firstname:{Pattern:"[a-zA-Z ]*"},Lastname:{Pattern:"[a-zA-Z ]*"}},this.showCitiesNotification=!1,this.firstName="",this.lastName="",this.gender="M",this.country=null,this.state=null,this.province=null,this.city="",this.showCitizenship=!1,this.citizenship=null,this.address="",this.postalCode="",this.dateOfBirth=null,this.SelectedYear=null,this.SelectedMonth=null,this.SelectedDay=null,this.taxCode="",this.showTaxCode=globalSettings.Registration_ShowTaxCode,this.turkishId="",this.email="",this.confirmEmail="",this.mobileExtension="+"+globalSettings.Account_LoginPrefix,this.mobile=null,this.username="",this.password="",this.confirmPassword="",this.currency=null,this.depositLimit=null,this.transfer=null,this.depositLimitPeriod=null,this.promoCode="",this.refCode="",this.siteDiscoveryMethod=null,this.confirmRegistration=!1,this.receiveEmails=!0,this.depositLimitEnableDisable=!1,this.securityQuestion=null,this.securityAnswer="",this.extraRegDict={},this.resendLink="",this.userID="",this.submitInProgress=!1,this.tooltipSelected="",this.showTooltip=function(a){q.tooltipSelected=a},this.hideTooltip=function(){q.tooltipSelected=""},this.contactSupport=function(){window.top.location.href="/help/general-help/contact-us/"},this.setTab=function(a,c){if(q.registerTabSelected!==a){var d=!0;2!==a||q.stepOneValid||(d=!1),d&&(2===a?(b.showLoader(".registerContent",null,0),s.validateUserName(q.username).then(function(d){if(!d.success)return b.hideLoader(".registerContent"),l.logError(d.error),q.validationErrorUserName=null!=d.Result&&d.Result.length>0?d.Result[0]:d.userMsg,c.txtUsername.$setValidity("invalidUserNameServer",!1),void q.validateStepOne(c);if(q.validationErrorUserName=null,c.txtUsername.$setValidity("invalidUserNameServer",!0),q.password==q.username)return b.hideLoader(".registerContent"),q.validationErrorPassword=locale.account.register.passwordSameAsUsername,c.txtPassword.$setValidity("invalidPasswordServer",!1),void q.validateStepOne(c);var e={Password:q.password};s.validatePassword(e).then(function(d){return d.success?(q.validationErrorPassword=null,c.txtPassword.$setValidity("invalidPasswordServer",!0),b.hideLoader(".registerContent"),q.registerTabSelected=a,void(w||(w=!0,j.createDataLayerEvent({event:"registration-step-2",stepName:"User Information"},!0)))):(b.hideLoader(".registerContent"),l.logError(d.error),q.validationErrorPassword=null!=d.Result&&d.Result.length>0?d.Result[0]+" "+locale.account.register.infoNotes.password:d.userMsg,c.txtPassword.$setValidity("invalidPasswordServer",!1),void q.validateStepOne(c))})})):q.registerTabSelected=a)}},this.validateStepOne=function(a){a.txtUsername.$valid&&a.txtPassword.$valid&&a.txtFirstName.$valid&&a.txtLastName.$valid?q.stepOneValid=!0:q.stepOneValid=!1},m.newReg&&(p(m.newReg),delete m.newReg),this.isAgentRegistration=!1,this.agentId,this.goToPrivacyPolicy=function(){window.open(globalSettings.Registration_PrivacyPolicyUrl,"_blank")},this.goToTermsAndConditions=function(){window.open(globalSettings.Registration_TermsAndConditionsUrl,"_blank")},this.onCountryChanged=function(){q.citizenship=q.country,q.onCitizenshipChanged(!0),q.cities=[],q.states=[],q.state=null,q.province=null,q.city="",q.getStatesForCountry(q.country)},this.onStateChanged=function(){q.cities=[],q.city="",q.getCitiesForCountryAndState(q.country,q.state)},this.validationErrorCity=null,this.onCityChanged=function(a){globalSettings.Registration_StateRegionVisible||r.getCountryCityValidation(q.country,q.city).then(function(b){return b.success?(q.validationErrorCity=null,void r.getCityState(q.country,q.city).then(function(a){return a.success?(q.state=a.data.Name,void q.getProvince()):(l.logError(a.error),void(q.state="N/A"))})):(l.logError(b.error),q.validationErrorCity=null!=b.Result&&b.Result.length>0?b.Result[0]:b.userMsg,a.ddlCity.$setValidity("invalidCityServer",!1),q.state=null,void(q.province=null))}),globalSettings.Registration_StateRegionVisible&&q.getProvince()},this.getProvince=function(){r.getCityProvince(q.country,q.city).then(function(a){return a.success?void(q.province=a.data.Name):(l.logError(a.error),void(q.province="N/A"))})},this.citySearchQuery=null,this.citySearch=function(a){if(!globalSettings.Registration_StateRegionVisible&&(q.cities=[],q.citySearchQuery!=a&&0!=a.length)){q.citySearchQuery=a;var b={CountryCode:q.country,CityName:q.citySearchQuery,MaxRecords:10};r.getCountryCitySearchResult(b).then(function(a){a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),q.cities=a.data,0==q.cities.length?q.showCitiesNotification=!0:q.showCitiesNotification=!1})}},this.getCitiesForCountryAndState=function(a,b){q.cities=[],r.getStateCities(a,b).then(function(a){a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),q.cities=a.data})},this.getStatesForCountry=function(a){q.states=[],r.getCountryStates(a).then(function(a){a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),q.states=a.data})},this.onCitizenshipChanged=function(a){s.getCitzenshipRequiredInfo(q.citizenship).then(function(b){return b.success?void(null==b.data||b.data.length<=0?a&&(q.showCitizenship=!1):a&&(q.showCitizenship=!0)):void l.logError(b.error)})},this.inputHasValidLength=function(a){return!a.hasOwnProperty("required")&&!a.hasOwnProperty("minlength")&&!a.hasOwnProperty("maxlength")},this.validationErrorUserName=null,this.onUserTypeValidateUserName=function(a,b){var c=$(a.currentTarget),d=c.val();d&&""!==d&&s.validateUserName(d).then(function(a){return a.success||400!==a.status?(q.validationErrorUserName=null,b.txtUsername.$setValidity("invalidUserNameServer",!0),void q.validateStepOne(b)):(l.logError(a.error),q.validationErrorUserName=null!=a.Result&&a.Result.length>0?a.Result[0]:a.userMsg,b.txtUsername.$setValidity("invalidUserNameServer",!1),void q.validateStepOne(b))})},this.cleanMobileNumber=function(a){return j.cleanMobileNumber(a)},this.validationErrorMobileNumber=null,this.onUserTypeValidateMobileNumber=function(a){if(q.mobile&&""!==q.mobile){var b={PhoneContactTypeCode:"MB",Prefix:q.mobileExtension,Number:j.cleanMobileNumber(q.mobile)};q.registeredOnMultipleAccounts=!1,s.validateMobileNumber(b).then(function(b){return b.success?(q.validationErrorMobileNumber=null,a.txtMobile.$setValidity("invalidMobileNumberServer",!0),void(q.registeredOnMultipleAccounts=!1)):(q.registeredOnMultipleAccounts=!1,void(20215===b.responseCode?(l.logError(b.error),q.validationErrorMobileNumber=null!=b.result&&b.result.length>0?b.result[0]:b.userMsg,a.txtMobile.$setValidity("invalidMobileNumberServer",!1)):20214===b.responseCode||20216===b.responseCode?(q.validationErrorMobileNumber=null,a.txtMobile.$setValidity("invalidMobileNumberServer",!0),q.registeredOnMultipleAccounts=!0):(l.logError(b.error),q.validationErrorMobileNumber=null!=b.result&&b.result.length>0?b.result[0]:b.userMsg,a.txtMobile.$setValidity("invalidMobileNumberServer",!1))))})}},this.validationErrorEmail=null,this.onUserTypeValidateEmail=function(a,b){var c=$(a.currentTarget),d=c.val();d&&""!==d&&s.validateEmailAddress(d).then(function(a){return a.success?(q.validationErrorEmail=null,void b.txtEmail.$setValidity("emailTaken",!0)):(l.logError(a.error),q.validationErrorEmail=null!=a.Result&&a.Result.length>0?a.Result[0]:a.userMsg,void b.txtEmail.$setValidity("emailTaken",!1))})},this.validationErrorPassword=null,this.onUserTypeValidatePassword=function(a,b){if(q.inputHasValidLength(b.txtPassword.$error)&&a&&""!==a){if(a==q.username)return q.validationErrorPassword=locale.account.register.passwordSameAsUsername,b.txtPassword.$setValidity("invalidPasswordServer",!1),void q.validateStepOne(b);var c={Password:a};s.validatePassword(c).then(function(a){return a.success?(q.validationErrorPassword=null,b.txtPassword.$setValidity("invalidPasswordServer",!0),void q.validateStepOne(b)):(l.logError(a.error),q.validationErrorPassword=null!=a.Result&&a.Result.length>0?a.Result[0]+" "+locale.account.register.infoNotes.password:a.userMsg,b.txtPassword.$setValidity("invalidPasswordServer",!1),void q.validateStepOne(b))})}},this.onDateLoad=function(){var a=(new Date).getYear()-18,b=$.map($(Array(a+1)),function(a,b){return b+1900}),c=$.map($(Array(12)),function(a,b){return b+1}),d=$.map($(Array(31)),function(a,b){return b+1});q.Years=b,q.Days=d,q.Months=c},this.onDateChanged=function(a){if(!q.SelectedDay||!q.SelectedMonth||!q.SelectedYear)return void(q.confirmRegistration=!1);var b=moment().subtract(18,"years").startOf("day"),c=q.SelectedMonth.toString().length>1?q.SelectedMonth.toString():"0"+q.SelectedMonth,d=q.SelectedDay.toString().length>1?q.SelectedDay.toString():"0"+q.SelectedDay,e=moment(q.SelectedYear+c+d,"YYYYMMDD").startOf("day");e.isValid()?(a.DOBregistDay.$setValidity("invalidDate",!0),e.isSameOrBefore(b)?(a.DOBregistDay.$setValidity("invalidAge",!0),q.confirmRegistration=!0):(a.DOBregistDay.$setValidity("invalidAge",!1),q.confirmRegistration=!1)):(a.DOBregistDay.$setValidity("invalidDate",!1),q.confirmRegistration=!1)},this.depositLimitChangeOption=function(a){0===q.depositLimitPeriod?(q.depositLimitEnableDisable=!0,a.txtDepositLimit.$setValidity("invalid",!0),q.depositLimit=0,q.depositLimitPattern="^[0-9]{1,7}$"):(q.depositLimitEnableDisable=!1,q.depositLimit=null,q.depositLimitPattern="^[1-9][0-9]*$")},a.registerAnotherUser=function(){window.location=window.location.href.replace(window.location.pathname,"")+"/shop/sh/messages/newuser"},this.transferFunds=function(a){if(g.isAgent&&q.transfer){var b={UserId:a.data.UserId,Amount:q.transfer||0};u.transferTo(b).then(function(a){return a.success?void j.showSuccessMessage(locale.account.fundTransfer.transferSuccess).done():void l.logError("Error occurred while transferring funds to user: "+a.error,a.userMsg)})}},this.verifyLocaleLanguage=function(){s.getEmailLanguages().then(function(a){var b=a.data,c=f.getLanguageByLocale(globalSettings.CurrentLocale),d=_.findIndex(b,["IsoCode",c.langIsoCode]);d===-1&&(globalSettings.CurrentLanguage=f.getLanguageByIsoCode(b[0].IsoCode).currLang,globalSettings.CurrentLocale=f.getLanguageByIsoCode(b[0].IsoCode).currLocale,globalSettings.LanguageIsoCode=f.getLanguageByIsoCode(b[0].IsoCode).langIsoCode)})},this.submitQuickForm=function(){if(q.verifyLocaleLanguage(),!q.submitInProgress){q.submitInProgress=!0,q.extraRegDict.ReceiveMarketingMessages=q.receiveEmails,q.promoCode&&(q.extraRegDict.PromotionalCode=q.promoCode);var a={Addresses:[{CountryCode:globalSettings.Registration_DefaultCountry,AddressTypeCode:"MAIN"}],PhoneContacts:[{PhoneContactTypeCode:"MB",Prefix:q.mobileExtension.replace("+",""),Number:j.cleanMobileNumber(q.mobile)}],ParentUserIdent:q.agentId,Password:q.password,PersonalQuestionCode:0==globalSettings.Account_ShowSecurityQuestion?"QST1":q.securityQuestion||"QST1",PersonalQuestionAnswer:0==globalSettings.Account_ShowSecurityQuestion?"Not Provided":q.securityAnswer||"Not Provided",DepositLimitAmount:q.depositLimit,DepositLimitPeriodId:q.depositLimitPeriod,BannerTag:e.get("KM_AFF_TRK"),ExtraRegistrationValues:q.extraRegDict,CurrencyISOCode:n.getCurrencyCode(m.SportsbookGlobalVariable.CurrencyId),CommunicationPrefferedLanguageISOCode:globalSettings.LanguageIsoCode};o(a,!0)}},this.submitForm=function(){q.verifyLocaleLanguage(),q.submitInProgress||(q.submitInProgress=!0,q.performChecks(function(){q.alreadyRegistered=!1,q.dateOfBirth=q.SelectedYear+"-"+q.SelectedMonth+"-"+q.SelectedDay,0==q.depositLimitPeriod&&(q.depositLimitPeriod=1),q.extraRegDict.ReceiveMarketingMessages=q.receiveEmails,q.promoCode&&(q.extraRegDict.PromotionalCode=q.promoCode),q.ResidenceCity=""===q.city?"N/A":q.city;var a=null;a=globalSettings.General_EnableOTPbySms&&"BySms"==q.activationOption?{Addresses:[{CountryCode:q.country,Region:q.state,AddressTypeCode:"MAIN"}],PhoneContacts:[{PhoneContactTypeCode:"MB",Prefix:q.mobileExtension,Number:j.cleanMobileNumber(q.mobile)}],ParentUserIdent:q.agentId,AccountActivationResendUrl:j.getActivationLink(!0),AccountActivationUrl:j.getActivationLink(!1),FirstName:q.firstName,LastName:q.lastName,DateOfBirth:q.dateOfBirth,Email:q.email,Username:q.username,Password:q.password,PersonalQuestionCode:0==globalSettings.Account_ShowSecurityQuestion?"QST1":q.securityQuestion||"QST1",PersonalQuestionAnswer:0==globalSettings.Account_ShowSecurityQuestion?"Not Provided":q.securityAnswer||"Not Provided",DepositLimitAmount:q.depositLimit,DepositLimitPeriodId:q.depositLimitPeriod,BannerTag:e.get("KM_AFF_TRK"),ExtraRegistrationValues:q.extraRegDict,CurrencyISOCode:n.getCurrencyCode(m.SportsbookGlobalVariable.CurrencyId),CommunicationPrefferedLanguageISOCode:globalSettings.LanguageIsoCode}:{Addresses:[{CountryCode:q.country,Province:q.province,Region:q.state,City:q.city||q.town,Line1:""===q.address?"N/A":q.address,PostalCode:""===q.postalCode?"N/A":q.postalCode,AddressTypeCode:"MAIN"}],PhoneContacts:[{PhoneContactTypeCode:"MB",Prefix:q.mobileExtension,Number:j.cleanMobileNumber(q.mobile)}],ParentUserIdent:q.agentId,AccountActivationResendUrl:j.getActivationLink(!0),AccountActivationUrl:j.getActivationLink(!1),FirstName:q.firstName,LastName:q.lastName,GenderCode:q.gender||"Not Provided",DateOfBirth:q.dateOfBirth,Citizenship:q.citizenship,Email:q.email,Username:q.username,Password:q.password,PersonalQuestionCode:q.securityQuestion||"QST1",PersonalQuestionAnswer:0==globalSettings.Account_ShowSecurityQuestion?"Not Provided":q.securityAnswer||"Not Provided",CurrencyISOCode:q.currency||n.getCurrencyCode(m.SportsbookGlobalVariable.CurrencyId),DepositLimitAmount:q.depositLimit,DepositLimitPeriodId:q.depositLimitPeriod,ReferenceCode:q.refCode,TaxCode:0==globalSettings.Registration_ShowTaxCode?"N/A":q.taxCode,BannerTag:e.get("KM_AFF_TRK"),ExtraRegistrationValues:q.extraRegDict,CommunicationPrefferedLanguageISOCode:globalSettings.LanguageIsoCode,SiteDiscoveryMethodCode:""},o(a)}))},this.clearForm=function(a){globalSettings.General_EnableOTPbySms?window.parent.jQuery.fancybox.close():(a.reset(),q.SelectedYear=null,q.SelectedMonth=null,q.SelectedDay=null,q.state=null,q.city="",q.gender="M",q.receiveEmails=!0)},a.$on("registrationCompleted",function(a){q.registrationCompleted=!0}),this.performChecks=function(a){globalSettings.General_EnableOTPbySms&&"BySms"===q.activationOption&&q.registeredOnMultipleAccounts?(q.completeRegister=a,q.alreadyRegistered=!0):a()},this.backToRegister=function(){q.submitInProgress=!1,q.alreadyRegistered=!1},this.detectUserCountry=function(){v.getFormattedIp("json").then(function(a){var b=a.data.ip,c=b.split("."),d=parseInt(c[0]).toString(16)+parseInt(c[1]).toString(16)+parseInt(c[2]).toString(16)+parseInt(c[3]).toString(16),e="0x"+d;r.getCountryByipAddress(e).then(function(a){for(var b=0;b<q.registrationCountries.length;b++)if(q.registrationCountries[b].Name===a.data.Name){q.country=a.data.ThreeLetterCode,q.citizenship=a.data.ThreeLetterCode,q.onCitizenshipChanged();break}q.getStatesForCountry(q.country)})})},a.openLoginDialog=function(){var a=k.open({template:"/partials/login/loginDialog.html",className:"loginForm",name:"LoginDialog",id:"LoginDialog",controller:"AuthController",controllerAs:"authCtrl"});loginDialogID=a.id},this.getActivationOption=function(){globalSettings.General_EnableOTPbySms?(b.showLoader(".registerContent",null,0),s.getActivationOption().then(function(a){b.hideLoader(".registerContent"),q.activationOption=a.data,q.loadData()})):q.loadData()},this.loadData=function(){globalSettings.Registration_QuickRegister||(q.getRegistrationCountries(),q.getAllCountries(),q.getRegistrationCurrencies(),"BySms"==q.activationOption&&globalSettings.Registration_SplitRegister||q.getSecurityQuestions()),q.getDepositLimitPeriods(),q.hasActivationProcess(),q.onDateLoad()},this.getRegistrationCountries=function(){s.getRegistrationCountries().then(function(a){a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),q.registrationCountries=a.data,q.registrationCountries.length>0&&(q.country=q.registrationCountries[0].IsoCode),""!=globalSettings.Registration_DefaultCountry?(q.country=globalSettings.Registration_DefaultCountry,q.citizenship=globalSettings.Registration_DefaultCountry,q.onCitizenshipChanged(),q.getStatesForCountry(q.country)):(q.onCountryChanged(),q.detectUserCountry())})},this.getAllCountries=function(){r.getAllCountries().then(function(a){a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),q.countries=a.data,q.countries.length>0&&(q.citizenship=q.countries[0].ThreeLetterCode)})},this.getSecurityQuestions=function(){s.getSecurityQuestions().then(function(a){null===a.data[0].Name?q.securityQuestions=q.jsonSecurityQuestion:(a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),q.securityQuestions=a.data,q.securityQuestions.length>0&&(q.securityQuestion=q.securityQuestions[0].Id))})},g.getCanRegisterSubAccountPlayers()){q.isAgentRegistration=!0;var x=g.getUserData();q.agentId=x.userID}this.getRegistrationCurrencies=function(){s.getRegistrationCurrencies().then(function(a){if(a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),q.currencies=a.data,q.currencies.length>0){q.currency=q.currencies[0].IsoCode;for(var b=q.isAgentRegistration?g.getUserData().currency.CurrencyCode:globalSettings.Registration_DefaultCurrency,c=0;c<q.currencies.length;c++)q.currencies[c].IsoCode===b&&(q.currency=q.currencies[c].IsoCode)}})},this.getDepositLimitPeriods=function(){s.getDepositLimitPeriods().then(function(a){a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),q.depositLimitPeriods=a.data,q.depositLimitPeriods.length>0&&(q.depositLimitPeriods.splice(0,0,q.NoDepositLimit),q.depositLimitPeriod=q.depositLimitPeriods[1].Id,q.depositLimitChangeOption())})},this.hasActivationProcess=function(){t.hasActivationProcess().then(function(a){a.success?q.hasActivationProcess=a.data:q.hasActivationProcess=!0})},this.goToPage=function(a){a=a.trim(),a&&(a.indexOf("http:/")==-1&&a.indexOf("https:/")==-1?c.url(a):window.location.href=a)},this.onInit=function(){d(function(){$(".registerContainer.registerIFrame .registerContent .register-banner-container").empty().html($(".registerContainer.registerIFrame .registerBannerContainer").html())},500),q.getActivationOption(),j.createDataLayerEvent({event:"registration-step-1",stepName:"Sign-In Details"},!0)},q.onInit()}]).controller("RegisterSuccessController",["$scope","$rootScope","platformApiService","authService","helperService",function(a,b,c,d,e){var f=this,g=c.security;this.activationOption="none",this.getActivationOption=function(){globalSettings.General_EnableOTPbySms&&(b.showLoader(".registerContent",null,0),g.getActivationOption().then(function(a){b.hideLoader(".registerContent"),f.activationOption=a.data}))},this.GoToPage=function(a){"deposit"==a?d.hasValidLogin()&&d.isAgent()?window.top.location.href="/shop/sh/deposit":window.top.location.href="/account/ac/deposit":window.top.location.href=a},this.onInit=function(){f.getActivationOption(),e.createDataLayerEvent({event:"registration-step-3",userID:d.getUserData().userID},!0)},f.onInit()}])}(),function(){angular.module("authenticatedSplitRegistration",[]).controller("SplitRegistrationController",["$scope","$rootScope","$q","$sessionStorage","$state","$cookies","umbracoApiService","platformApiService","loggingService","currencyService","helperService","loggingService","f2pGuardianApiService","websiteApiService","authService",function(a,b,c,d,e,f,g,h,i,j,k,i,l,m,n){var o=this,p=h.security;this.registrationSteps={mobileInput:0,userDetailsStepOne:1,userDetailsStepTwo:2,otpVerification:3,registrationSuccess:4},this.registrationStep=this.registrationSteps.mobileInput,this.userTypes={newUser:0,subAccountUser:1,f2pUser:2,existingUser:3},this.userType=null,this.isSubAccountRegistration="shopNewUser"===e.current.name,this.mobileExtension="+"+globalSettings.Account_LoginPrefix,this.mobileNumber=null,this.password=null,this.loginPassword=null,this.firstName=null,this.lastName=null,this.email=null,this.dateOfBirth=null,this.showDoBPicker=!1,this.states=[],this.state=null,this.ageVerification=!1,this.receiveInformation=!0,this.formValidation={mobileNumber:{min:10,max:11,pattern:globalSettings.Account_MobileRegex},email:{min:5,max:50,pattern:"^(?=.*?[@]).{5,}$"},password:{min:6,max:15,pattern:"^\\S{6,15}$"},firstName:{pattern:"[a-zA-Z ]*"},lastName:{pattern:"[a-zA-Z ]*"},dateOfBirth:{max:moment().subtract(18,"years").startOf("day").toISOString()}},this.cmsContent={},this.f2pToken=null,this.newUserId=null,this.validationInProgress=!1,this.registrationInProgress=!1,this.loginInProgress=!1,this.getCMSContent=function(){var a=c.defer();return g.desktop.getSplitRegistrationContent(globalSettings.CurrentLanguage).then(function(b){b.success?o.cmsContent=b.data:i.logError(b.error),a.resolve()}),a.promise},this.getStates=function(){var a=c.defer();return h.location.getCountryStates(globalSettings.Registration_DefaultCountry).then(function(b){return b.success?(b.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),o.states=b.data,o.state=o.states[0],void a.resolve()):(i.logError(b.error),void a.resolve())}),a.promise},this.getUsername=function(){return o.mobileExtension.replace("+","")+k.cleanMobileNumber(o.mobileNumber)},this.isHeaderVisible=function(){return!o.isSubAccountRegistration&&(o.registrationStep==o.registrationSteps.mobileInput||o.registrationStep==o.registrationSteps.userDetailsStepOne||o.registrationStep==o.registrationSteps.userDetailsStepTwo)},this.closeModal=function(){window.parent.jQuery.fancybox.close()},this.redirect=function(a){window.parent.location.href=a},this.validateMobileNumber=function(a){a.txtMobileNumber.$setValidity("invalidMobileNumberServer",!0),b.showLoader(".split-registration .content"),o.validationInProgress=!0;var c={PhoneContactTypeCode:"MB",Prefix:o.mobileExtension,Number:k.cleanMobileNumber(o.mobileNumber)};h.security.validateMobileNumber(c).then(function(c){if(b.hideLoader(".split-registration .content"),o.validationInProgress=!1,c.success)o.userType=o.isSubAccountRegistration?o.userTypes.subAccountUser:o.userTypes.newUser,o.registrationStep=o.registrationSteps.userDetailsStepOne;else{if(o.isSubAccountRegistration)return void a.txtMobileNumber.$setValidity("invalidMobileNumberServer",!1);switch(c.responseCode){case 20215:o.userType=o.userTypes.existingUser,o.registrationStep=o.registrationSteps.userDetailsStepOne;break;case 20301:o.userType=o.userTypes.f2pUser,o.registrationStep=o.registrationSteps.userDetailsStepOne;break;default:a.txtMobileNumber.$setValidity("invalidMobileNumberServer",!1)}}})},this.validationErrorEmail=null,this.validateEmailAddress=function(a){p.validateEmailAddress(o.email).then(function(b){return b.success?(o.validationErrorEmail=null,void a.txtEmail.$setValidity("emailTaken",!0)):(i.logError(b.error),o.validationErrorEmail=null!=b.Result&&b.Result.length>0?b.Result[0]:b.userMsg,void a.txtEmail.$setValidity("emailTaken",!1))})},this.validateDoB=function(a){o.showDoBPicker=!1,a.txtDateOfBirth.$setValidity("invalidDate",!0),a.txtDateOfBirth.$setValidity("invalidAge",!0);var b=moment().subtract(18,"years").startOf("day"),c=moment(o.dateOfBirth,"DD/MM/YYYY").startOf("day");c.isValid()?c.isSameOrBefore(b)||a.txtDateOfBirth.$setValidity("invalidAge",!1):a.txtDateOfBirth.$setValidity("invalidDate",!1)},this.validatePassword=function(a){a.txtPassword.$error.required||a.txtPassword.$error.pattern||h.security.validatePassword({Password:o.password}).then(function(b){return b.success?void a.txtPassword.$setValidity("invalidPasswordServer",!0):(i.logError(b.error),void a.txtPassword.$setValidity("invalidPasswordServer",!1))})},this.stepOneBtnClicked=function(){switch(o.userType){case o.userTypes.newUser:case o.userTypes.subAccountUser:a.forms.frmNewUserStepOne.$valid&&(o.registrationStep=o.registrationSteps.userDetailsStepTwo);break;case o.userTypes.f2pUser:a.forms.frmF2PUserStepOne.$valid&&o.getF2PUserDetails();break;case o.userTypes.existingUser:a.forms.frmExistingUserStepOne.$valid&&o.loginExistingUser()}},this.stepTwoBtnClicked=function(){switch(o.userType){case o.userTypes.newUser:a.forms.frmNewUserStepTwo.$valid&&o.registerNewUser();break;case o.userTypes.subAccountUser:a.forms.frmNewUserStepTwo.$valid&&o.registerSubAccountUser();break;case o.userTypes.f2pUser:a.forms.frmF2PUserStepTwo.$valid&&o.registerF2PUser()}},this.tabButtonClicked=function(a){if(!(o.validationInProgress||o.loginInProgress||o.registrationInProgress))if(1===a){if(o.registrationStep==o.registrationSteps.userDetailsStepOne)return;o.registrationStep=o.registrationSteps.userDetailsStepOne}else if(2===a){if(o.registrationStep==o.registrationSteps.userDetailsStepTwo)return;o.stepOneBtnClicked()}},this.resetFormFields=function(a){(null==a||a)&&(o.mobileNumber=null),o.userType=null,o.password=null,o.loginPassword=null,o.firstName=null,o.lastName=null,o.email=null,o.dateOfBirth=null,o.showDoBPicker=!1,o.state=o.states?o.states[0]:null,o.ageVerification=!1,o.receiveInformation=!0,o.f2pToken=null,o.newUserId=null},this.restartRegistration=function(a){null==a&&(a=!0),o.resetFormFields(a),o.registrationStep=o.registrationSteps.mobileInput},this.registerNewUser=function(){if(a.forms.frmNewUserStepOne.$valid&&a.forms.frmNewUserStepTwo.$valid){var c={FirstName:o.firstName,LastName:o.lastName,DateOfBirth:moment(o.dateOfBirth,"DD/MM/YYYY").format("YYYY-MM-DD"),Addresses:[{CountryCode:globalSettings.Registration_DefaultCountry,Region:o.state.Name,AddressTypeCode:"MAIN"}],Email:o.email,PhoneContacts:[{PhoneContactTypeCode:"MB",Prefix:o.mobileExtension.replace("+",""),Number:k.cleanMobileNumber(o.mobileNumber)}],Password:o.password,CurrencyISOCode:j.getCurrencyCode(d.SportsbookGlobalVariable.CurrencyId),ExtraRegistrationValues:{ReceiveMarketingMessages:o.receiveInformation},CommunicationPrefferedLanguageISOCode:globalSettings.LanguageIsoCode,PersonalQuestionCode:"QST1",PersonalQuestionAnswer:"Not Provided",BannerTag:f.get("KM_AFF_TRK")};b.showLoader(".split-registration .content"),o.registrationInProgress=!0,h.security.registerNewUser(c).then(function(a){if(!a.success){b.hideLoader(".split-registration .content"),o.registrationInProgress=!1,null!=a.userMsg?i.logError(locale.account.register.regUnable+a.error,a.userMsg):i.logError(locale.account.register.regUnable+"<br/><br/>"+a.Result[0],a.userMsg);var c=k.handlePlatformError(a);return void(c||k.showErrorMessage(a.Result[0]+"<br/><br/>"+a.userMsg).done())}o.newUserId=a.data.UserId,k.createOptimoveEvent("onRegistration","userId",o.newUserId,!0);var d={Username:o.getUsername()};h.security.registerBySms(d).then(function(a){return b.hideLoader(".split-registration .content"),o.registrationInProgress=!1,a.success?void(o.registrationStep=o.registrationSteps.otpVerification):void(20805==a.responseCode?k.showErrorMessage(locale.account.otp.limitExceeded).done():k.showErrorMessage(a.error).done())})})}},this.registerSubAccountUser=function(){if(a.forms.frmNewUserStepOne.$valid&&a.forms.frmNewUserStepTwo.$valid){var c=n.getUserData();if(c&&c.userID){var e={ParentUserIdent:c.userID,FirstName:o.firstName,LastName:o.lastName,DateOfBirth:moment(o.dateOfBirth,"DD/MM/YYYY").format("YYYY-MM-DD"),Addresses:[{CountryCode:globalSettings.Registration_DefaultCountry,Region:o.state.Name,AddressTypeCode:"MAIN"}],Email:o.email,PhoneContacts:[{PhoneContactTypeCode:"MB",Prefix:o.mobileExtension.replace("+",""),Number:k.cleanMobileNumber(o.mobileNumber)}],Password:o.password,CurrencyISOCode:j.getCurrencyCode(d.SportsbookGlobalVariable.CurrencyId),ExtraRegistrationValues:{ReceiveMarketingMessages:o.receiveInformation},CommunicationPrefferedLanguageISOCode:globalSettings.LanguageIsoCode,PersonalQuestionCode:"QST1",PersonalQuestionAnswer:"Not Provided",BannerTag:f.get("KM_AFF_TRK")};b.showLoader(".split-registration .content"),o.registrationInProgress=!0,m.user.registerNewSubAccountAgent(e).then(function(a){return b.hideLoader(".split-registration .content"),o.registrationInProgress=!1,a.success?(o.newUserId=a.data.UserId,k.createOptimoveEvent("onRegistration","userId",o.newUserId,!0),void(o.registrationStep=o.registrationSteps.registrationSuccess)):void i.logError("Unable to register subAccount user: "+a.data.ResponseCode,locale.account.splitRegistration.registrationError)})}}},this.onOTPVerified=function(){b.$broadcast("loginRequest",o.getUsername(),o.password,null,!1),o.registrationStep=o.registrationSteps.registrationSuccess},this.getF2PUserDetails=function(){o.loginInProgress=!0,b.showLoader(".split-registration .content"),l.auth.getToken(o.getUsername(),o.loginPassword,globalSettings.F2PBrandID).then(function(a){if(!a.success||!a.data){o.loginInProgress=!1,b.hideLoader(".split-registration .content");var c;return c="Invalid Credentials"===a.error.error_description?locale.login.invalidCredentials:"Exceeded maximum authentication failures"===a.error.error_description?locale.login.accountLocked:a.error.error_description,void i.logError("Unable to get F2P API token: "+JSON.stringify(a.error),c)}o.f2pToken=a.data.access_token,m.f2p.getF2PUserBasicDetails({token:o.f2pToken}).then(function(a){return o.loginInProgress=!1,b.hideLoader(".split-registration .content"),a.success?(o.firstName=a.data.FirstName,o.lastName=a.data.LastName,void(o.registrationStep=o.registrationSteps.userDetailsStepTwo)):void i.logError("Unable to get F2P user details: "+JSON.stringify(a.error))})})},this.registerF2PUser=function(){if(a.forms.frmF2PUserStepOne.$valid&&a.forms.frmF2PUserStepTwo.$valid){var c={token:o.f2pToken,firstName:o.firstName,lastName:o.lastName,state:o.state.Name,receiveMarketingMessages:o.receiveInformation};b.showLoader(".split-registration .content"),o.registrationInProgress=!0,m.f2p.registerF2PAccountIntoBetking(c).then(function(a){return b.hideLoader(".split-registration .content"),o.registrationInProgress=!1,a.success&&a.data&&a.data.IsSuccessfull?(o.newUserId=a.data.UserId,k.createOptimoveEvent("onRegistration","userId",o.newUserId,!0),b.$broadcast("loginRequest",o.getUsername(),o.loginPassword,null,!1),void(o.registrationStep=o.registrationSteps.registrationSuccess)):void i.logError("Unable to register F2P user: "+a.data.ResponseCode,locale.account.splitRegistration.registrationError)})}},this.loginExistingUser=function(){o.loginInProgress=!0,b.showLoader(".split-registration .content"),b.$broadcast("loginRequest",o.getUsername(),o.loginPassword,null,!1);var a=b.$on("loginCompleted",function(c,d){a(),d?o.redirect("/"):o.loginInProgress=!1,b.hideLoader(".split-registration .content")})},this.initFlowWatcher=function(){a.$watch(function(){return o.registrationStep},function(a,b){var c="",d="",e=null;switch(a){case o.registrationSteps.mobileInput:c="registration-step-1",d="User Mobile Number Input";break;case o.registrationSteps.userDetailsStepOne:switch(o.userType){case o.userTypes.newUser:c="registration-step-2-1",d="New User Details Step 1";break;case o.userTypes.subAccountUser:c="registration-step-2-1",d="New SubAccount User Details Step 1";break;case o.userTypes.f2pUser:c="registration-step-2-1",d="F2P User Details Step 1";break;case o.userTypes.existingUser:c="registration-step-2",d="Pre-Existing User Login"}break;case o.registrationSteps.userDetailsStepTwo:switch(o.userType){case o.userTypes.newUser:c="registration-step-2-2",d="New User Details Step 2";break;case o.userTypes.subAccountUser:c="registration-step-2-2",d="New SubAccount User Details Step 2";break;case o.userTypes.f2pUser:c="registration-step-2-2",d="F2P User Details Step 2"}break;case o.registrationSteps.otpVerification:c="registration-step-2-3",d="User OTP Verification";break;case o.registrationSteps.registrationSuccess:switch(o.userType){case o.userTypes.newUser:c="registration-step-3",d="New User Registration Successful",e=o.newUserId;break;case o.userTypes.subAccountUser:
c="registration-step-3",d="New SubAccount User Registration Successful",e=o.newUserId;break;case o.userTypes.f2pUser:c="registration-step-3",d="F2P User Registration Successful",e=o.newUserId}}c&&d&&(e?k.createDataLayerEvent({event:c,stepName:d,userID:e},!0):k.createDataLayerEvent({event:c,stepName:d},!0))})},this.init=function(){o.initFlowWatcher();var a=o.getCMSContent(),d=o.getStates();b.showLoader(".split-registration .content"),c.all([a,d]).then(function(){b.hideLoader(".split-registration .content")})},this.init()}])}(),function(){angular.module("authenticatedUpsellRegister",[]).controller("RegisterUpsellController",["$scope","$rootScope","$q","authService","loggingService","thirdPartyApiService","platformApiService","f2pGuardianApiService","websiteApiService","helperService","umbracoApiService","ngDialog",function(a,b,c,d,e,f,g,h,i,j,k,l){var m=this,n=g.location,o=g.security,p=f.ipify;return!d.hasValidLogin()||d.getCanRegisterSubAccountPlayers()||d.isAgent()?(this.f2pToken=a.ngDialogData&&a.ngDialogData.f2pToken||null,this.cmsContentData=[],a.forms={},this.registrationCompleted=!1,this.states=[],this.inputValueLimits={Firstname:{Pattern:"[a-zA-Z ]*"},Lastname:{Pattern:"[a-zA-Z ]*"}},this.firstName="",this.lastName="",this.f2pUserName=null,this.country=null,this.state=null,this.confirmRegistration=!1,this.receiveEmails=!0,this.submitInProgress=!1,this.errorMessage=null,this.detectUserCountry=function(){p.getFormattedIp("json").then(function(a){var b=a.data.ip,c=b.split("."),d=parseInt(c[0]).toString(16)+parseInt(c[1]).toString(16)+parseInt(c[2]).toString(16)+parseInt(c[3]).toString(16),e="0x"+d;n.getCountryByipAddress(e).then(function(a){for(var b=0;b<m.registrationCountries.length;b++)if(m.registrationCountries[b].Name===a.data.Name){m.country=a.data.ThreeLetterCode;break}m.getStatesForCountry(m.country)})})},this.getStatesForCountry=function(a){m.states=[],n.getCountryStates(a).then(function(a){a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),m.states=a.data,m.state=m.states[0]})},this.getRegistrationCountries=function(){var a=c.defer();return o.getRegistrationCountries().then(function(b){b.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),m.registrationCountries=b.data,m.registrationCountries.length>0&&(m.country=m.registrationCountries[0].IsoCode),""!=globalSettings.Registration_DefaultCountry?(m.country=globalSettings.Registration_DefaultCountry,m.getStatesForCountry(m.country)):m.detectUserCountry(),a.resolve()}),a.promise},this.getCMSContent=function(){var a=c.defer();return k.desktop.getUpsellRegisterContent(globalSettings.CurrentLanguage).then(function(b){b.success?m.cmsContentData=b.data:e.logError(b.error),a.resolve()}),a.promise},this.getF2PUserBasicDetails=function(){var a={token:m.f2pToken},b=c.defer();return i.f2p.getF2PUserBasicDetails(a).then(function(a){a.success&&(m.firstName=a.data.FirstName,m.lastName=a.data.LastName,m.f2pUserName=a.data.Username,isNaN(m.f2pUserName)||m.f2pUserName.startsWith(globalSettings.Account_LoginPrefix)&&(m.f2pUserName=m.f2pUserName.replace(globalSettings.Account_LoginPrefix,""))),b.resolve()}),b.promise},this.submitForm=function(){if(m.errorMessage=void 0,!m.submitInProgress){m.submitInProgress=!0;var a={token:m.f2pToken,firstName:m.firstName,lastName:m.lastName,state:m.state.Name};b.showLoader(".upsell-registration-details",null,0),i.f2p.registerF2PAccountIntoBetking(a).then(function(a){if(b.hideLoader(".upsell-registration-details"),!a.success){m.submitInProgress=!1,m.registrationCompleted=!1,$(".registerUpsellForm").removeClass("success"),m.errorMessage="Error! Registration was not completed",j.showErrorMessage(m.errorMessage);var c=l.getOpenDialogs();return void l.close(c[0])}m.registrationCompleted=!0,$(".registerUpsellForm").addClass("success")}).catch(function(a){m.submitInProgress=!1,console.log(a)})}},this.loadData=function(a){var d,e=m.getCMSContent(),f=m.getRegistrationCountries(),g=[e,f];a&&(d=m.getF2PUserBasicDetails(),g=[e,f,d]),b.showLoader(".upsell-registration-details",null,0),c.all(g).then(function(){b.hideLoader(".upsell-registration-details")})},this.onInit=function(){m.f2pToken?h.auth.validateToken(m.f2pToken).then(function(a){return!a.success||a.data&&!a.data.isValidated?void j.goToUmbracoPage("register"):void m.loadData(!0)}):m.loadData(!1)},void m.onInit()):void j.goToUmbracoPage("account")}]).controller("RegisterUpsellSuccessController",["$rootScope","helperService",function(a,b){var c=this;this.cmsContentData=[],this.f2pUserName,this.country=null,this.mobileExtension="+"+globalSettings.Account_LoginPrefix,this.mobile=null,this.password=null,this.errorMessage=null,this.formValidation={mobileNumber:{min:10,max:11,pattern:globalSettings.Account_MobileRegex}},this.login=function(){c.errorMessage=void 0,a.$broadcast("loginRequest",c.mobileExtension.replace("+","")+b.cleanMobileNumber(c.mobile),c.password,null,!1);var d=ngDialog.getOpenDialogs();ngDialog.close(d[0])},this.goToForgotPassword=function(){var a=ngDialog.getOpenDialogs();ngDialog.close(a[0]),b.goToUmbracoPage("reset-password")},this.onInit=function(){setTimeout(function(){c.mobile=c.f2pUserName},100)},c.onInit()}])}(),function(){angular.module("authenticatedUserJourneyRegister",["moneyPaymentTransfer.service"]).controller("RegisterUserJourneyController",["$q","$rootScope","$scope","$interpolate","$cookies","$sessionStorage","helperService","websiteApiService","platformApiService","currencyService","loggingService","moneyPaymentTransferService",function(a,b,c,d,e,f,g,h,i,j,k,l){var m=this,n=i.security;document.querySelector(".swal2-modal").style.zIndex=10001,document.querySelector(".swal2-overlay").style.zIndex=10001,this.mobileExtension="+"+globalSettings.Account_LoginPrefix,this.mobileNumber=null,this.password=null,this.states=[],this.state=null,this.formValidation={mobileNumber:{min:9,max:12,pattern:globalSettings.Account_MobileRegex}},this.ageVerification=!1,this.receiveInformation=!0,this.registrationSteps={mobileInput:0,namesInput:1,idInput:2,depositList:3,deposit:4,otpVerification:5,KYCWarning:6},this.registrationStep=this.registrationSteps.mobileInput,this.registrationInProgress=!1,this.newUserId=null,this.API=[],this.firstName=null,this.middleName=null,this.lastName=null,this.isGhana="1904"===globalSettings.BrandID,this.idType=null,this.idTypes=[],this.idValue=null,this.registrationDate=moment(),this.address=null,this.idNumberSetErrors=null,this.mobileNumberSetErrors=null,this.forms={mobile_input_form:{}},this.today=moment(),this.showOldVoter=void 0,this.onInit=function(){var c=m.getStates();b.showLoader("journey-registration",".content"),a.all([c]).then(function(){b.hideLoader("journey-registration",".content")}),m.getIdTypes()},b.$on("GoBack",function(){m.registrationStep=m.registrationSteps.depositList}),this.goToPage=function(a){$(".ngdialog-close").click(),window.location.href=a},this.getIdTypes=function(){m.idTypes=[],h.registration.getIdTypes().then(function(a){a.data.IDDocumentList.sort(function(a,b){var c=a.Id.toUpperCase(),d=b.Id.toUpperCase();return c<d?-1:c>d?1:0}),m.idTypes=a.data.IDDocumentList,m.isGhana&&(m.idTypes.unshift({Name:"Ghana Voter's ID",Id:"VOTERSID",Code:"VOTERSID"}),m.idTypes=m.idTypes.filter(function(a){return"NEWVOTERSID"!==a.Code&&"VOTERSCARD"!==a.Code}))})},this.onRegistrationDateChange=function(a){var b=moment(new Date(a)).isBefore(new Date("2020-06-29"));m.showOldVoter=b},this.checkIdType=function(){var a=m.idType.Code;return m.isGhana&&("VOTERSID"===a&&m.showOldVoter&&(a="VOTERSCARD"),"VOTERSID"!==a||m.showOldVoter||(a="NEWVOTERSID")),a},this.checkIdNumber=function(a){var b;b=a?a.idValue.$viewValue||m.idValue:m.idValue;const c=m.idType.Code;return m.isGhana&&"PASSPORT"===c&&(b="G"+b),b},this.validateType=function(a,b){"select"===b&&(m.showOldVoter=void 0);var c={IDDocumentValue:m.checkIdNumber(a),IDDocumentTypeCode:m.checkIdType()};h.registration.checkType(c).then(function(b){b.data.IsValid?(a.idValue.$setValidity("invalidIdValueServer",!0),m.idNumberSetErrors=null):(a.idValue.$setDirty(),a.idValue.$setValidity("invalidIdValueServer",!1),m.idNumberSetErrors=b.data.ValidationMessage)})},this.moveToRegistrationStep=function(a){this.registrationStep=a},this.changePage=function(a){if(m.registrationStep===m.registrationSteps.idInput)n.isKYCCheckEnabled().then(function(a){a.data===!0?setTimeout(function(){h.registration.checkKYCStatus().then(function(a){"VERF"===a.data.Code?(m.registrationStep=m.registrationSteps.depositList,m.loginInProgress=!0,b.showLoader("journey-registration",".content"),l.getAllDepositPaymentMethodsCallback("Deposit").then(function(a){return b.hideLoader("journey-registration",".content"),m.loginInProgress=!1,a.success?void(m.API=a.API):void k.logError(a.error)})):m.registrationStep=m.registrationSteps.KYCWarning}).catch(function(a){m.registrationStep=m.registrationSteps.KYCWarning})},5e3):(m.registrationStep=m.registrationSteps.depositList,m.loginInProgress=!0,b.showLoader("journey-registration",".content"),l.getAllDepositPaymentMethodsCallback("Deposit").then(function(a){return b.hideLoader("journey-registration",".content"),m.loginInProgress=!1,a.success?void(m.API=a.API):void k.logError(a.error)}))});else if(m.registrationStep===m.registrationSteps.depositList){for(var c=0;c<m.API.length;c++){var d=m.API[c];a===d.Identifier&&(b.selectedApi=d,b.selectedApi.source="register")}"PaystackCardDeposit"===a?m.registrationStep=m.registrationSteps.otpVerification:m.registrationStep=m.registrationSteps.deposit}else m.registrationStep===m.registrationSteps.otpVerification&&(m.registrationStep=m.registrationSteps.deposit)},this.getStates=function(){var b=a.defer();return i.location.getCountryStates(globalSettings.Registration_DefaultCountry).then(function(a){return a.success?(a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),m.states=a.data,m.state=m.states[0],void b.resolve()):(k.logError(a.error),void b.resolve())}),b.promise},this.validateMobileNumber=function(a){m.mobileNumber=g.cleanMobileNumber(m.mobileNumber),a.txtMobileNumber.$setValidity("invalidMobileNumberServer",!0),b.showLoader("journey-registration",".content"),m.validationInProgress=!0;var c={PhoneContactTypeCode:"MB",Prefix:m.mobileExtension,Number:m.mobileNumber};i.security.validateMobileNumber(c).then(function(c){if(b.hideLoader("journey-registration",".content"),m.validationInProgress=!1,c.success);else{if(m.isSubAccountRegistration)return void a.txtMobileNumber.$setValidity("invalidMobileNumberServer",!1);switch(c.responseCode){case 20215:m.userType=m.userTypes.existingUser,m.registrationStep=m.registrationSteps.userDetailsStepOne;break;default:a.txtMobileNumber.$setValidity("invalidMobileNumberServer",!1)}}})},this.validatePassword=function(a){a.txtPassword.$error.required||a.txtPassword.$error.pattern||i.security.validatePassword({Password:m.password}).then(function(b){return b.success?void a.txtPassword.$setValidity("invalidPasswordServer",!0):(k.logError(b.error),void a.txtPassword.$setValidity("invalidPasswordServer",!1))})},this.resetFormFields=function(a){(null==a||a)&&(m.mobileNumber=null),m.userType=null,m.password=null,m.loginPassword=null,m.state=m.states?m.states[0]:null,m.ageVerification=!1,m.receiveInformation=!0,m.newUserId=null},this.restartRegistration=function(a){null==a&&(a=!0),m.resetFormFields(a),m.registrationStep=m.registrationSteps.mobileInput},this.loginExistingUser=function(){m.loginInProgress=!0,b.showLoader("journey-registration",".content"),b.$broadcast("loginRequest",m.getUsername(),m.password,null,!1,!1);var a=b.$on("loginCompleted",function(d,e){a(),m.loginInProgress=!1,m.changePage(),c.transferType="Deposit",b.hideLoader("journey-registration",".content"),d.preventDefault()})},this.getUsername=function(){return m.mobileExtension.replace("+","")+m.mobileNumber},this.initFlowWatcher=function(){c.$watch(function(){return m.registrationStep},function(a,b){var c="",d="",e=null;switch(a){case m.registrationSteps.mobileInput:c="registration-step-1",d="User Mobile Number Input";break;case m.registrationSteps.depositList:c="registration-step-2-1",d="New User Details Step 1";break;case m.registrationSteps.deposit:c="registration-step-2-2",d="New User Details Step 2";break;case m.registrationSteps.otpVerification:c="registration-step-2-3",d="User OTP Verification";break;case m.registrationSteps.registrationSuccess:c="registration-step-3",d="New User Registration Successful",e=m.newUserId}c&&d&&(e?g.createDataLayerEvent({event:c,stepName:d,userID:e},!0):g.createDataLayerEvent({event:c,stepName:d},!0))})},this.registerNewUser=function(a){if(a.$valid){var c={};c.ReceiveMarketingMessages=m.receiveInformation,""!=m.promotionCode&&(c.PromotionalCode=m.promotionCode);var d=j.getCurrencyCode(f.SportsbookGlobalVariable?f.SportsbookGlobalVariable.CurrencyId:29),h={Addresses:[{CountryCode:globalSettings.Registration_DefaultCountry,Region:m.state.Name,AddressTypeCode:"MAIN",Line1:m.address}],PhoneContacts:[{PhoneContactTypeCode:"MB",Prefix:m.mobileExtension.replace("+",""),Number:m.mobileNumber}],Password:m.password,CurrencyISOCode:d,ExtraRegistrationValues:c,IDDocumentValue:m.checkIdNumber(),IDDocumentTypeCode:m.checkIdType(),FirstName:m.firstName+" "+m.middleName,LastName:m.lastName,BannerTag:e.get("KM_AFF_TRK")};b.showLoader("journey-registration",".content"),m.registrationInProgress=!0,i.security.registerNewUser(h).then(function(a){if(!a.success){b.hideLoader("journey-registration",".content"),m.registrationInProgress=!1,null!=a.userMsg?k.logError(locale.account.register.regUnable+a.error,a.userMsg):k.logError(locale.account.register.regUnable+"<br/><br/>"+a.Result[0],a.userMsg);var c=g.handlePlatformError(a);return void(c||g.showErrorMessage(a.Result[0]+"<br/><br/>"+a.userMsg).done())}m.newUserId=a.data.UserId,g.createOptimoveEvent("onRegistration","userId",m.newUserId,!0),m.loginExistingUser()})}},m.onInit()}])}(),function(){angular.module("authenticatedResetPassword",[]).controller("resetPasswordController",["$scope","$rootScope","$q","umbracoApiService","platformApiService","loggingService","helperService","loggingService","authService",function(a,b,c,d,e,f,g,f,h){var i=this;this.flowSteps={usernameInput:0,emailSent:1,otpVerification:2,createNewPassword:3,passwordUpdated:4},this.flowStep=this.flowSteps.usernameInput,this.username=null,this.password=null,this.confirmPassword=null,this.formValidation={password:{min:6,max:15,pattern:"^\\S{6,15}$"}},this.cmsContent={},this.token=null,this.otpData=null,this.isF2PUser=!1,this.requestResetInProgress=!1,this.passwordChangeInProgress=!1,this.getCMSContent=function(){var a=c.defer();return d.desktop.getResetPasswordContent(globalSettings.CurrentLanguage).then(function(b){b.success?i.cmsContent=b.data:f.logError(b.error),a.resolve()}),a.promise},this.closeModal=function(){window.parent.jQuery.fancybox.close()},this.redirect=function(a){a||(a="/"),window.parent.location.href=a},this.parseUsername=function(){i.username=g.parseUsername(i.username).value},this.validatePassword=function(a){i.validateConfirmPassword(a),a.txtPassword.$error.required||a.txtPassword.$error.pattern||e.security.validatePassword({Password:i.password}).then(function(b){return b.success?void a.txtPassword.$setValidity("invalidPasswordServer",!0):(f.logError(b.error),void a.txtPassword.$setValidity("invalidPasswordServer",!1))})},this.validateConfirmPassword=function(a){a.txtConfirmPassword.$error.required||(i.confirmPassword!==i.password?a.txtConfirmPassword.$setValidity("passwordMismatch",!1):a.txtConfirmPassword.$setValidity("passwordMismatch",!0))},this.requestPasswordReset=function(){var a={Username:null,PasswordResetPageUrl:window.location+"?token={0}"},c=g.parseUsername(i.username);c.isMobileNumber?(a.Username=c.mobilePrefix+c.mobileNumber,i.otpData={isMobileNumber:!0,username:c.mobilePrefix+c.mobileNumber,mobileExtension:c.mobilePrefix,mobileNumber:c.mobileNumber}):(a.Username=c.value,i.otpData=null),i.requestResetInProgress=!0,b.showLoader(".reset-password"),e.security.requestPasswordReset(a).then(function(a){return i.requestResetInProgress=!1,b.hideLoader(".reset-password"),a.success?(i.isF2PUser=a.data.HasF2PAccount,void(1==a.data.ResetPasswordMethod?i.flowStep=i.flowSteps.emailSent:(null===i.otpData&&(i.otpData={isMobileNumber:!1,username:c.value,mobileExtension:c.mobilePrefix,mobileNumber:c.mobileNumber}),i.flowStep=i.flowSteps.otpVerification))):void(20218==a.responseCode?g.showErrorMessage(locale.login.mobileNotVerified).done():20202==a.responseCode?g.showErrorMessage(locale.login.limitReached).done():20805==a.responseCode?g.showErrorMessage(locale.account.otp.limitExceeded).done():f.logError("Unable to request password reset: "+a.error,a.userMsg))})},this.onOTPVerified=function(a){i.otpData.verificationCode=a,i.flowStep=i.flowSteps.createNewPassword},this.updatePassword=function(){if(i.password&&i.password==i.confirmPassword)if(i.passwordChangeInProgress=!0,b.showLoader(".reset-password"),i.token){var a={ResetToken:i.token,NewPassword:i.password};e.security.completePasswordReset(a).then(function(a){return i.passwordChangeInProgress=!1,b.hideLoader(".reset-password"),a.success?void(i.flowStep=i.flowSteps.passwordUpdated):void f.logError(a.error,a.userMsg)})}else{var a={OneTimePassword:i.otpData.verificationCode,UserName:i.otpData.isMobileNumber?i.otpData.mobileExtension+i.otpData.mobileNumber:i.otpData.username,Password:i.password};e.security.completePasswordResetBySms(a).then(function(a){return i.passwordChangeInProgress=!1,b.hideLoader(".reset-password"),a.success?void(i.flowStep=i.flowSteps.passwordUpdated):void f.logError(a.error,a.userMsg)})}},a.$watch(function(){return h.hasValidLogin()},function(a){a&&i.redirect("/")}),this.init=function(){if(h.hasValidLogin())return void i.redirect("/");var a=g.getUrlParameters(window.location.search);a.token&&(i.flowStep=i.flowSteps.createNewPassword,i.token=decodeURIComponent(a.token)),b.showLoader(".reset-password"),i.getCMSContent().then(function(){b.hideLoader(".reset-password")})},this.init()}])}(),function(){angular.module("authenticatedStatementSearch",[]).factory("statementSearchService",["$sessionStorage","$filter","platformApiService","authService",function(a,b,c,d){var e=c.finance;return{getSearchParams:function(){return a.statementSearchParams?a.statementSearchParams:{}},setSearchParams:function(b){a.statementSearchParams=b},getAccountTypes:function(a){return e.getPlaySource(a)},getTransactionTypes:function(){return e.getTransactionTypes()},getTransactionTypesByAccount:function(a){return e.getTransactionTypesByAccount(a)},getSubTransactionTypes:function(a){return e.getSubTransactionTypes(a)},searchStatements:function(a){return e.getUserTransactions(a)},searchUserTransactions:function(a){return e.getUserTransactionsByUser(a)},getUserList:function(){var a={DirectDescendantsOnly:!1,Recursive:!0,AgentsOnly:!1,NonAgentsOnly:!1,UserStatusesFilterBy:null};return c.user.getUserList(a)},parseUserListRecord:function(a,b,c){null==b&&(c=0);var e=[],f=null,g=null;switch(a.UserStatus){case"DEL":g="Deleted";break;case"CLSD":g="Closed";break;case"REG":g="Registered";break;case"ACT":g="Active";break;case"INACT":g="Inactive";break;case"UNCONF":g="Unconfirmed";break;case"SUSP":g="Suspended";break;case"CONF":g="Confirmed";break;case"PCHANG":g="PasswordChanged";break;case"RTERMS":g="RefusedTerms";break;case"BLOCK":g="Blocked"}var h={name:a.Name,surname:a.Surname,username:a.Username,userId:a.TpsUserId,status:g,indent:c,type:d.getAgentType(a.UserTypeCode),parent:b};if(h.userId!=d.getUserData().userID&&e.push(h),a.HasChildren)for(var i=0;i<a.Children.length;i++)$.merge(e,this.parseUserListRecord(a.Children[i],h,c+1));for(var i=0;i<=e.length-1;i++)0==e[i].indent?f+=1:f;return f>0?e[0].collapsed=!1:e[0].collapsed=!0,e},parseRecord:function(a){var c=a.Description;null!=a.FurtherDetails&&a.FurtherDetails.toString().trim().length>0&&(c+=" ("+a.FurtherDetails+")");var d="-";null!=a.TransactionDate&&""!=a.TransactionDate&&(d=moment(a.TransactionDate).format("DD/MM/YYYY, HH:mm:ss"));var e=a.Amount>=0?b("currencyFormat")(a.Amount,2):"",f=a.Amount>=0?b("number")(a.Amount,2):"",g=a.Amount<0?b("currencyFormat")(a.Amount,2):"",h=a.Amount<0?b("number")(a.Amount,2):"",i=null!=a.RollingBalance?b("currencyFormat")(a.RollingBalance,2):"",j=null!=a.RollingBalance?b("number")(a.RollingBalance,2):"",k="",l="<i class='fa fa-circle'></i>",m="<i class='fa fa-times'></i>",n="<i class='fa fa-clock-o'></i>",o="<i class='fa fa-check'></i>";switch(a.TransactionStatusCode){case"QUEUED":case"MANUAL_PROCESSING":case"AWAITING_INFO":case"PENDING":case"VALIDATED":case"APPROVED":case"PROCESSING":case"ONHOLD":k=n;break;case"FAILED":case"REJECTED":case"VOID":case"CANCELLED":k=m;break;case"VIRTUAL":case"COMPLETE":k=o;break;default:k=l}return[a.Id,d,c,a.CouponCode,e,g,k,i,a.TransactionStatusCode,f,h,j]}}}]).controller("StatementSearchController",["$scope","$rootScope","$q","$location","$timeout","$sessionStorage","$filter","$state","statementSearchService","helperService","loggingService","authService","sportsApiService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=this;$.fn.dataTable.moment("DD/MM/YYYY, HH:mm:ss"),this.loading=!1,this.idAll=-99,this.apiParam="",this.userList=[],this.selectedUser=null,this.transactionTypes=[],this.subTransactionTypes=[],this.period=1,this.accountType=null,this.transactionType=null,this.subTransactionType=null,this.fromDate=moment().subtract(globalSettings.Account_TransactionListDefaultRangeInDays,"day").format("DD/MM/YYYY"),this.toDate=moment().format("DD/MM/YYYY"),this.minDate=moment().subtract(3,"months").toDate(),this.maxDate=moment().toDate(),this.searchDone=!1,this.getPlaySourceCode=function(){window.location.href.indexOf("/remote-cashier")>-1?n.apiParam="SHOPCLI":n.apiParam="WEB"},this.searchColumns=[{title:locale.account.statementSearch.resultColumns.id,class:"resId center",orderData:[0,1]},{title:locale.common.date,class:"resDate center"},{title:locale.account.statementSearch.resultColumns.description,class:"resDescription"},{title:locale.account.statementSearch.resultColumns.coupon,class:"resCoupon center"},{title:locale.account.statementSearch.resultColumns.credit,class:"resPositive right"},{title:locale.account.statementSearch.resultColumns.debit,class:"resNegative right"},{title:locale.account.statementSearch.resultColumns.status,class:"resStatus center"},{title:locale.account.statementSearch.resultColumns.balance,class:"resBalance right"}],this.searchResults=[],this.isAgent=!1,this.onAccountTypeChanged=function(){n.transactionTypes=[],n.transactionType=null,n.getTransactionTypesByAccount().then(function(){n.transactionTypes.length>0&&(n.transactionType=n.transactionTypes[0].Id)})},this.onTransactionTypeChanged=function(){},this.isPokerShares=function(){return a.isPokerShares},this.onPeriodChanged=function(){switch(n.period){case"2":n.fromDate=moment().format("DD/MM/YYYY"),n.toDate=moment().format("DD/MM/YYYY");break;case"3":n.fromDate=moment().startOf("isoWeek").format("DD/MM/YYYY"),n.toDate=moment().endOf("isoWeek").format("DD/MM/YYYY");break;case"4":n.fromDate=moment().startOf("month").format("DD/MM/YYYY"),n.toDate=moment().endOf("month").format("DD/MM/YYYY");break;case"5":n.fromDate=moment().subtract(1,"day").format("DD/MM/YYYY"),n.toDate=moment().subtract(1,"day").format("DD/MM/YYYY");break;case"6":n.fromDate=moment().subtract(1,"week").startOf("isoWeek").format("DD/MM/YYYY"),n.toDate=moment().subtract(1,"week").endOf("isoWeek").format("DD/MM/YYYY");break;case"7":n.fromDate=moment().subtract(1,"month").startOf("month").format("DD/MM/YYYY"),n.toDate=moment().subtract(1,"month").endOf("month").format("DD/MM/YYYY")}},this.init=function(){i.getUserList().then(function(a){n.userList=i.parseUserListRecord(a.data)});var a=i.getSearchParams();n.fromDate=a.fromDate||moment().subtract(globalSettings.Account_TransactionListDefaultRangeInDays,"day").format("DD/MM/YYYY"),n.toDate=a.toDate||moment().format("DD/MM/YYYY"),n.period=a.period?a.period:1,n.getPlaySourceCode(),n.getAccountTypes().then(function(){n.accountTypes.length>1?($("#trAccountType").css("display","flex"),n.accountType=a&&a.accountType?a.accountType:n.accountTypes[0].Id,n.getTransactionTypesByAccount().then(function(){n.transactionTypes.length>0&&(n.transactionType=a&&a.transactionType?a.transactionType:n.transactionTypes[0].Id,globalSettings.Account_AutoGenerateTransactionList&&n.searchStatements())})):($("#trAccountType").css("display","none"),n.getTransactionTypes().then(function(){n.transactionType=a&&a.transactionType?a.transactionType:n.transactionTypes[0].Id,globalSettings.Account_AutoGenerateTransactionList&&n.searchStatements()}))}),n.isAgent=getAgentType(l.getUserData().userType,l.agentTypes)===l.agentTypes.agent},this.getAccountTypes=function(){var a=c.defer();return i.getAccountTypes(n.apiParam).then(function(b){b.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),n.accountTypes=n.parseRecords(b.data),a.resolve()}),a.promise},this.parseRecords=function(a){var b=[];return angular.forEach(a,function(a){a.IsMain&&b.push({Id:a.Id,Description:a.Name})}),b},this.getTransactionTypes=function(){var a=c.defer();return i.getTransactionTypes().then(function(b){b.data.sort(function(a,b){var c=a.Description.toUpperCase(),d=b.Description.toUpperCase();return c<d?-1:c>d?1:0}),b.data.splice(0,0,{Id:n.idAll,Description:locale.account.userAreaMenu.searchCriteria.transactionTypeSelect}),n.transactionTypes=b.data,a.resolve()}),a.promise},this.getTransactionTypesByAccount=function(){var a=c.defer();return i.getTransactionTypesByAccount(n.accountType).then(function(b){b.data.sort(function(a,b){var c=a.Description.toUpperCase(),d=b.Description.toUpperCase();return c<d?-1:c>d?1:0}),b.data.splice(0,0,{Id:n.idAll,Description:locale.account.userAreaMenu.searchCriteria.transactionTypeSelect}),n.transactionTypes=b.data,a.resolve()}),a.promise},this.getSubTransactionTypes=function(){var a=c.defer();return i.getSubTransactionTypes(n.transactionType).then(function(b){null!=b.data&&(b.data.sort(function(a,b){var c=a.Description.toUpperCase(),d=b.Description.toUpperCase();return c<d?-1:c>d?1:0}),n.subTransactionTypes=b.data),a.resolve()}),a.promise},this.handleRowClick=function(){var c=$("#searchResults").dataTable().api().row(this).data(),d=c[3];if(c&&null!=c[3]&&!(c[3].trim().length<=0)){switch(h.current.name){case"shopStatementSearch":h.go("shopStatementSearchCouponDetails",{couponCode:d+","+l.getUserData().userID});break;default:a.isPokerShares?m.coupon.getCouponByCode(d,globalSettings.CurrentLanguage).then(function(a){var b=a.data.Odds[0];null!=b?h.go("accountStatementSearchCouponDetails",{couponCode:d+","+l.getUserData().userID,pokerpool:"false"}):h.go("accountStatementSearchCouponDetails",{couponCode:d+","+l.getUserData().userID,pokerpool:"true"})}):h.go("accountStatementSearchCouponDetails",{couponCode:d+","+l.getUserData().userID})}a.$apply(),b.showLoader()}},this.isTableInitialized=function(){return $.fn.DataTable.isDataTable($("#searchResults"))},this.getDTLocaleUrl=function(){var a="//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/";switch(globalSettings.CurrentLanguage){case"es":return a+"Spanish.json";case"it":return a+"Italian.json";case"pt":return a+"Portuguese-Brasil.json";case"ro":return a+"Romanian.json";default:return a+"English.json"}},this.resetForm=function(){n.period=1,n.accountType=null!=n.accountTypes?n.accountTypes[0].Id:null,n.transactionType=null!=n.transactionTypes?n.transactionTypes[0].Id:null,n.fromDate=moment().subtract(globalSettings.Account_TransactionListDefaultRangeInDays,"day").format("DD/MM/YYYY"),n.toDate=moment().format("DD/MM/YYYY"),n.accountTypes.length>1&&n.onAccountTypeChanged(),n.onTransactionTypeChanged()},this.compileTableWithResult=function(a){for(var b=g("orderBy")(a,[function(a){return moment(a.TransactionDate)},"Id"],!0),c=0,d=0,e=0;e<b.length;e++){var h=b[e].TransactionStatusCode;"VIRTUAL"!==h&&"REAL"!==h&&"COMPLETE"!==h&&"PENDING"!==h||(b[e].Amount>0?c+=b[e].Amount:d+=b[e].Amount),n.searchResults.push(i.parseRecord(b[e]))}n.isTableInitialized()&&$("#searchResults").dataTable().api().destroy(),$("#searchResults").dataTable({dom:'<"top"if>rt<"bottom"pl><"clear">',oLanguage:{sLengthMenu:locale.common.rowsPerPage+" _MENU_",sSearch:locale.common.toFind+": _INPUT_",sInfo:locale.common.showing+" _START_ "+locale.common.to.toLowerCase()+" _END_ "+locale.common.of.toLowerCase()+" _TOTAL_ "+locale.common.entries,sPaginate:{first:"First",last:"Last",next:"Next",previous:"Previous"}},pagingType:"numbers",columns:n.searchColumns,data:n.searchResults,pageLength:10,buttons:[],stateSave:!0,bSort:!1,stateSaveCallback:function(a,b){f.statementSearchSettings=JSON.stringify(b)},stateLoadCallback:function(a){if(f.statementSearchSettings)return JSON.parse(f.statementSearchSettings)},language:{url:n.getDTLocaleUrl()},rowCallback:function(a,b,c){null!=b[8]&&$(a).addClass(b[8].toLowerCase())},footerCallback:function(a,b,e,f,h){var i=this.api();$(i.column(3).footer()).html('<span style="font-weight:bold;">'+locale.common.total+"</span>"),$(i.column(4).footer()).html(g("currencyFormat")(c,2)),$(i.column(5).footer()).html(g("currencyFormat")(d,2))},drawCallback:function(a){$("#searchResults tbody tr").off("click"),$("#searchResults tbody tr").on("click",n.handleRowClick)}})},this.searchStatements=function(){if(1!=n.loading){n.loading=!0,i.setSearchParams({period:n.period,accountType:n.accountType,transactionType:n.transactionType,subTransactionType:n.subTransactionType,fromDate:n.fromDate,toDate:n.toDate}),n.searchResults=[];var a=[];a.push(n.accountType);var b=[],c=[];if(n.transactionType==n.idAll)for(var d=0;d<n.transactionTypes.length;d++){var e=n.transactionTypes[d];e.Id!=n.idAll&&b.push(e.Id)}else b.push(n.transactionType),c.push(n.subTransactionType);var f={MainTxTypesIdentifiers:b,SubTxTypesIdentifiers:[],DateFrom:moment(n.fromDate+" 00:00:00","DD/MM/YYYY HH:mm:ss").format(),DateTo:moment(n.toDate+" 23:59:59","DD/MM/YYYY HH:mm:ss").format()};n.accountTypes.length>1&&(f.AccountId=n.accountType),null!=n.selectedUser?(f.UserId=n.selectedUser.userId,i.searchUserTransactions(f).then(function(a){if(n.loading=!1,n.searchDone=!0,n.searchResults=[],!a.success){if(null!=a.Result&&a.Result.length>0){var b=j.handlePlatformError(a);b||j.showErrorMessage(a.Result[0]).done()}return void k.logError("Unable to get user account statement: "+a.error)}n.compileTableWithResult(a.data)})):i.searchStatements(f).then(function(a){if(n.loading=!1,n.searchDone=!0,n.searchResults=[],!a.success){if(null!=a.Result&&a.Result.length>0){var b=j.handlePlatformError(a);b||j.showErrorMessage(a.Result[0]).done()}return void k.logError("Unable to get user account statement: "+a.error)}n.compileTableWithResult(a.data)})}},this.export=function(){var a="";_.forEach(n.searchColumns,function(b){a+=b.title+","}),a=a.slice(0,-1),a+='\n"',a+=_.map(n.searchResults,function(a){return[a[0],a[1],a[2],a[3],a[9]?a[9]+" "+l.getUserData().currency.Currency:"",a[10]?a[10]+" "+l.getUserData().currency.Currency:"",a[8],a[11]?a[11]+" "+l.getUserData().currency.Currency:""].join('","')}).join('"\n"');const b=document.createElement("a");b.style.visibility="hidden",b.setAttribute("href",window.URL.createObjectURL(new Blob([a],{type:"text/csv;charset=utf-8;"}))),b.setAttribute("download","transactionlist-"+i.getSearchParams().fromDate+"-"+i.getSearchParams().toDate+".csv"),document.body.appendChild(b),b.click(),document.body.removeChild(b)},this.init()}])}(),function(){angular.module("shopAccountStatement",[]).controller("AccountStatementController",["$q","$rootScope","$state","platformApiService","umbracoApiService","authService","loggingService","$filter",function(a,b,c,d,e,f,g,h){var i=this,j=d.finance,k=d.report,l=d.user;d.gamingVendors.goldenRace;if(this.isLoggedIn=!1,this.agentType="",this.agentTypes=f.agentTypes,this.currencySymbol="",this.balances=null,
this.apiParam="",this.totalBalance=0,this.totalCredit=0,this.downloadLinks=[],this.getPlaySourceCode=function(){window.location.href.indexOf("/remote-cashier")>-1?i.apiParam="SHOPCLI":i.apiParam="WEB"},this.overviewColumns=[{title:locale.account.shopWebsite.accountStatement.overview.transID,class:"left"},{title:locale.account.shopWebsite.accountStatement.overview.availability,class:"right"},{title:locale.account.balance.credit,class:"right"},{title:locale.account.statementSearch.resultColumns.balance,class:"right"}],this.overviewResults=[],this.parseOverviewRecord=function(a){var b=locale.account.shopWebsite.accountStatement.overview.types[a.RowId],c=h("currencyFormat")(a.Availability,2),d=h("currencyFormat")(a.Credit,2),e=h("currencyFormat")(a.Balance,2);return[b,c,d,e]},this.accountType="",this.getAccountType=function(){var b=a.defer();return j.getAccountTypes().then(function(a){return a.success?(i.accountType=a.data[0].Code,void b.resolve()):(g.logError("Unable to get Account Type: "+a.error,a.userMsg),void b.resolve())}),b.promise},this.overviewStatements=function(){var b=a.defer();return i.overviewResults=[],i.getAccountType().then(function(){var a={Parameters:[{ParameterName:"AccountType",ParameterValue:i.accountType}]};k.getBalanceOverviewData(a).then(function(a){if(!a.success)return g.logError("Unable to get Balance Overview: "+a.error,a.userMsg),void b.resolve();var c=[],d=[];i.agentType!=i.agentTypes.cashier?(c=$.grep(a.data.Data,function(a){return"TOT"!=a.RowId}),d=$.grep(a.data.Data,function(a){return"TOT"==a.RowId})):c=$.grep(a.data.Data,function(a){return"ACC"==a.RowId});for(var e=0;e<c.length;e++){var f=c[e];i.overviewResults.push(i.parseOverviewRecord(f))}$.fn.dataTable.isDataTable("#overviewResults")?$("#overviewResults").dataTable():$("#overviewResults").dataTable({dom:'rt<"bottom"><"clear">',oLanguage:{sLengthMenu:"Rows per page _MENU_"},paging:!1,ordering:!1,searching:!1,columns:i.overviewColumns,data:i.overviewResults,bSort:!1,bInfo:!1,autoWidth:!1,footerCallback:function(a,b,c,e,f){if(d.length>0){var g=this.api(),i=d[0];$(g.column(0).footer()).html('<span class="total">'+locale.common.total+"</span>"),$(g.column(1).footer()).html("<span>"+h("currencyFormat")(i.Availability,2)+"</span>"),$(g.column(2).footer()).html("<span>"+h("currencyFormat")(i.Credit,2)+"</span>"),$(g.column(3).footer()).html('<span class="balance">'+h("currencyFormat")(i.Balance,2)+"</span>")}else $("#overviewResults").find("tfoot").remove()}}),b.resolve()})}),b.promise},this.getPlaySource=function(){var b=a.defer();return i.balances=[],i.totalBalance=0,i.totalCredit=0,j.getPlaySource(i.apiParam).then(function(a){if(!a.success)return g.logError("Unable to get user balances: "+a.error,a.userMsg),void b.resolve();var c=a.data;angular.forEach(c,function(a){null!=a.Credit&&$.isNumeric(a.Credit)&&(i.totalCredit+=parseFloat(a.Credit)),a.IsMain===!0&&(i.MainWalletId=a.Id,i.MainWalletName=a.Name),i.totalBalance+=a.Balance,a.Name=a.Name.replace(" Account","");for(var b in locale.account.cashier.accounts){var c=a.Name[0].toLowerCase()+a.Name.slice(1);b===c&&(a.Name=locale.account.cashier.accounts[b])}}),i.balances=c,b.resolve()}),b.promise},this.maxMessages=5,this.numberOfMessages=0,this.getAllMessages=function(){var b=a.defer();return l.getAllMessages().then(function(a){if(!a.success)return void g.logError("Unable to get messages: "+a.error,a.userMsg);var c=a.data;c.sort(function(a,b){return moment(b.SentOnDate)-moment(a.SentOnDate)}),i.allMessages=c.slice(0,i.maxMessages),i.numberOfMessages=i.allMessages.length,b.resolve()}),b.promise},this.redirectTo=function(a,b){switch(a){case"messages":c.go("shopMessageDetails",{messageId:b,ret:"overview"});break;default:c.go("shopStatementSearch",{})}},this.lastTransColumns=[{title:locale.account.shopWebsite.accountStatement.overview.transID,class:"left"},{title:locale.account.shopWebsite.accountStatement.lastTransactions.transDate,class:"left"},{title:locale.account.shopWebsite.accountStatement.lastTransactions.type,class:"left"},{title:locale.account.balance.credit,class:"right"},{title:locale.account.statementSearch.resultColumns.status,class:"resStatus center"},{title:locale.account.statementSearch.resultColumns.balance,class:"right"}],this.lastTransResults=[],this.transactionTypes=[],this.parseLastTransRecord=function(a){var b=a.Id,c=h("dateSuffix")(a.TransactionDate)+" "+h("date")(a.TransactionDate,"HH:mm"),d=a.Description,e=h("currencyFormat")(a.Amount,2),f=h("currencyFormat")(a.RollingBalance,2),g="",i="<i class='fa fa-circle'></i>",j="<i class='fa fa-times'></i>",k="<i class='fa fa-clock-o'></i>",l="<i class='fa fa-check'></i>";switch(a.TransactionStatusCode){case"QUEUED":case"MANUAL_PROCESSING":case"AWAITING_INFO":case"PENDING":case"VALIDATED":case"APPROVED":case"PROCESSING":case"ONHOLD":g=k;break;case"FAILED":case"REJECTED":case"VOID":case"CANCELLED":g=j;break;case"VIRTUAL":case"COMPLETE":g=l;break;default:g=i}return[b,c,d,e,g,f]},this.maxTransactions=10,this.numOfTransactions=0,this.getTransactionTypes=function(){var b=a.defer();return j.getTransactionTypes().then(function(a){return a.success?(a.data.sort(function(a,b){var c=a.Description.toUpperCase(),d=b.Description.toUpperCase();return c<d?-1:c>d?1:0}),i.transactionTypes=a.data,void b.resolve()):(g.logError("Unable to get Transaction Types: "+a.error,a.userMsg),void b.resolve())}),b.promise},this.getLastTransactions=function(){var b=a.defer();return i.lastTransResults=[],i.getTransactionTypes().then(function(){for(var a=[],c=0;c<i.transactionTypes.length;c++){var d=i.transactionTypes[c];a.push(d.Id)}var e={MainTxTypesIdentifiers:a,PageNumber:1,PageSize:i.maxTransactions,DateFrom:moment().startOf("day").subtract(2,"month").add(1,"day").format(),DateTo:moment().endOf("day").format()};j.getUserTransactions(e).then(function(a){if(!a.success)return g.logError("Unable to get user transactions: "+a.error,a.userMsg),void b.resolve();for(var c=a.data,d=0,e=0,f=0;f<c.length;f++){var h=c[f],j=c[f].TransactionStatusCode;"VIRTUAL"!==j&&"REAL"!==j&&"COMPLETE"!==j&&"PENDING"!==j||(c[f].Amount>0?d+=c[f].Amount:e+=c[f].Amount),i.lastTransResults.push(i.parseLastTransRecord(h))}i.numOfTransactions=i.lastTransResults.length,$.fn.dataTable.isDataTable("#lastTransResults")?$("#lastTransResults").dataTable():$("#lastTransResults").dataTable({dom:'rt<"clear">',oLanguage:{sLengthMenu:"Rows per page _MENU_"},paging:!1,ordering:!1,searching:!1,columns:i.lastTransColumns,data:i.lastTransResults,bSort:!1,bInfo:!1,autoWidth:!1,drawCallback:function(a){$("#lastTransResults tbody tr td").off("click"),$("#lastTransResults tbody tr td").on("click",i.redirectTo)}}),b.resolve()})}),b.promise},this.getDownloadLinks=function(){var b=a.defer();return e.desktop.getShopDownloadLinks(globalSettings.CurrentLanguage).then(function(a){return a.success?(i.downloadLinks=a.data,void b.resolve()):(g.logError("Unable to get download links: "+a.error),void b.resolve())}),b.promise},f.hasValidLogin()&&f.isAgent()&&void 0!=f.getUserData()){this.isLoggedIn=!0,this.agentType=f.getAgentType(f.getUserData().userType),this.currencySymbol=f.getUserData().currency.CurrencySymbol,$.fn.dataTable.moment("DD/MM/YYYY, HH:mm:ss"),b.showLoader(),this.getPlaySourceCode();var m=this.overviewStatements(),n=this.getPlaySource(),o=this.getAllMessages(),p=this.getLastTransactions(),q=this.getDownloadLinks();a.all([m,n,o,p,q]).then(function(){b.hideLoader()})}}])}(),function(){angular.module("shopAgentContent",[]).controller("ShopAgentContentController",["$state","$sce","authService","loggingService","pageData",function(a,b,c,d,e){if(!e)return a.go("shop");var f=[];return e.allowedAgentTypes&&e.allowedAgentTypes.forEach(function(a){switch(a.toLowerCase()){case"agent":f.push(c.agentTypes.agent);break;case"superagent":f.push(c.agentTypes.superAgent);break;case"masteragent":f.push(c.agentTypes.masterAgent)}}),!c.hasValidLogin()||!c.isAgent()||f.indexOf(c.getAgentType(c.getUserData().userType))<0?(d.logError("Access blocked to agent content page with ID: "+e.pageId),a.go("shop")):(this.pageTitle=e.pageTitle,void(this.content=b.trustAsHtml(e.content)))}])}(),function(){angular.module("shopAgentRegistration",[]).controller("AgentRegisterController",["$scope","$rootScope","$state","$window","$cookies","$http","authService","platformApiService","helperService","thirdPartyApiService","ngDialog","loggingService",function(a,b,c,d,e,f,g,h,i,j,k,l){var m=this,n=h.location,o=h.security,p=h.settings,q=j.ipify,r=h.clientSpecific;if(a.forms={},this.hasActivationProcess=!0,this.registrationCountries=[],this.countries=[],this.cities=[],this.states=[],this.currencies=[],this.inputValueLimits={Email:{Max:50,Min:5,Pattern:"^(?=.*?[@]).{5,}$"}},this.showCitiesNotification=!1,this.firstName="",this.lastName="",this.gender="M",this.country=null,this.state=null,this.province=null,this.city="",this.showCitizenship=!1,this.citizenship=null,this.address="",this.dateOfBirth=null,this.SelectedYear=null,this.SelectedMonth=null,this.SelectedDay=null,this.email="",this.confirmEmail="",this.mobileExtension="+"+globalSettings.Account_LoginPrefix,this.mobile=null,this.currency=null,this.promoCode="",this.siteDiscoveryMethod=null,this.contractSigned=!1,this.receiveEmails=!0,this.extraRegDict={},this.resendLink="",this.userID="",this.locationDescription="",this.moreInfo="",this.submitInProgress=!1,this.isAgentRegistration=!1,this.agentId,this.onCountryChanged=function(){m.citizenship=m.country,m.onCitizenshipChanged(!0),m.cities=[],m.states=[],m.state=null,m.province=null,m.city="",m.getCitiesForCountryAndState(m.country,m.state),m.getStatesForCountry(m.country)},this.onStateChanged=function(){m.cities=[],m.city="",m.getCitiesForCountryAndState(m.country,m.state)},this.validationErrorCity=null,this.onCityChanged=function(){globalSettings.Registration_StateRegionVisible||n.getCountryCityValidation(m.country,m.city).then(function(b){return b.success?(m.validationErrorCity=null,a.forms.frmAgentRegisterUser.ddlCity.$setValidity("invalidCityServer",!0),void n.getCityState(m.country,m.city).then(function(a){return a.success?(m.state=a.data.Name,void m.getProvince()):void l.logError(a.error)})):(l.logError(b.error),m.validationErrorCity=null!=b.Result&&b.Result.length>0?b.Result[0]:b.userMsg,a.forms.frmAgentRegisterUser.ddlCity.$setValidity("invalidCityServer",!1),m.state=null,void(m.province=null))}),globalSettings.Registration_StateRegionVisible&&m.getProvince()},this.getProvince=function(){n.getCityProvince(m.country,m.city).then(function(a){return a.success?void(m.province=a.data.Name):void l.logError(a.error)})},this.citySearchQuery=null,this.citySearch=function(a){if(!globalSettings.Registration_StateRegionVisible&&(m.cities=[],m.citySearchQuery!=a&&0!=a.length)){m.citySearchQuery=a;var b={CountryCode:m.country,CityName:m.citySearchQuery,MaxRecords:10};n.getCountryCitySearchResult(b).then(function(a){a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),m.cities=a.data,0==m.cities.length?m.showCitiesNotification=!0:m.showCitiesNotification=!1})}},this.getCitiesForCountry=function(a){m.cities=[],m.citySearchQuery!=a&&0!=a.length&&(m.citySearchQuery=a,n.getCountryStates(m.citySearchQuery).then(function(a){a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0})}))},this.getCitiesForCountryAndState=function(a,b){m.cities=[],n.getStateCities(a,b).then(function(a){a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),m.cities=a.data})},this.getStatesForCountry=function(a){m.states=[],n.getCountryStates(a).then(function(a){a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),m.states=a.data})},this.onCitizenshipChanged=function(a){o.getCitzenshipRequiredInfo(m.citizenship).then(function(b){return b.success?void(null==b.data||b.data.length<=0?a&&(m.showCitizenship=!1):a&&(m.showCitizenship=!0)):void l.logError(b.error)})},this.onDateLoad=function(){var a=(new Date).getYear()-18,b=$.map($(Array(a+1)),function(a,b){return b+1900}),c=$.map($(Array(12)),function(a,b){return b+1}),d=$.map($(Array(31)),function(a,b){return b+1});m.Years=b,m.Days=d,m.Months=c},this.onDateChanged=function(){if(m.SelectedDay&&m.SelectedMonth&&m.SelectedYear){var b=moment().subtract(18,"years").startOf("day"),c=m.SelectedMonth.toString().length>1?m.SelectedMonth.toString():"0"+m.SelectedMonth,d=m.SelectedDay.toString().length>1?m.SelectedDay.toString():"0"+m.SelectedDay,e=moment(m.SelectedYear+c+d,"YYYYMMDD").startOf("day");e.isValid()?(a.forms.frmAgentRegisterUser.DOBregistDay.$setValidity("invalidDate",!0),e.isSameOrBefore(b)?a.forms.frmAgentRegisterUser.DOBregistDay.$setValidity("invalidAge",!0):a.forms.frmAgentRegisterUser.DOBregistDay.$setValidity("invalidAge",!1)):a.forms.frmAgentRegisterUser.DOBregistDay.$setValidity("invalidDate",!1)}},this.submitAgentForm=function(){if(!m.submitInProgress){m.submitInProgress=!0,m.dateOfBirth=m.SelectedYear+"-"+m.SelectedMonth+"-"+m.SelectedDay,m.extraRegDict.isContractSigned=m.contractSigned,m.ResidenceCity=""===m.city?"N/A":m.city;var a={Addresses:[{CountryCode:m.country,Province:""===m.province?"N/A":m.province,Region:m.state,City:m.ResidenceCity,Line1:""===m.address?"N/A":m.address,PostalCode:""===m.postalCode?"N/A":m.postalCode,AddressTypeCode:"MAIN"}],PhoneContacts:[{PhoneContactTypeCode:"MB",Prefix:m.mobileExtension,Number:i.cleanMobileNumber(m.mobile)}],ParentUserIdent:m.agentId?m.agentId:null,FirstName:m.firstName,LastName:m.lastName,GenderCode:m.gender,DateOfBirth:m.dateOfBirth,LocationDescription:m.locationDescription,MoreInfo:m.moreInfo,Email:m.email,CommunicationPrefferedLanguageISOCode:globalSettings.LanguageIsoCode,CurrencyISOCode:m.currency,ExtraRegistrationValues:m.extraRegDict};r.registerShopOwner(globalSettings.PlatformAPIClientIdentifier,a).then(function(a){if(m.submitInProgress=!1,a.success)i.showSuccessMessage(a.userMsg).done(),m.resendLink=i.getActivationLink(!0,a.data.UserId),c.go(".",null,{reload:!0});else if(null!=a.userMsg){l.logError(locale.account.register.regUnable+a.error);var b=i.handlePlatformError(a);b||i.showErrorMessage(a.userMsg).done()}else{l.logError(locale.account.register.regUnable+a.error);var b=i.handlePlatformError(a);b||i.showErrorMessage(a.userMsg).done(),a.success&&m.newfunction(a.data.userId)}})}},this.detectUserCountry=function(){q.getFormattedIp("json").then(function(a){var b=a.data.ip,c=b.split("."),d=parseInt(c[0]).toString(16)+parseInt(c[1]).toString(16)+parseInt(c[2]).toString(16)+parseInt(c[3]).toString(16),e="0x"+d;n.getCountryByipAddress(e).then(function(a){for(var b=0;b<m.registrationCountries.length;b++)if(m.registrationCountries[b].Name===a.data.Name){m.country=a.data.ThreeLetterCode,m.citizenship=a.data.ThreeLetterCode,m.onCitizenshipChanged();break}m.getCitiesForCountryAndState(m.country,m.state),m.getStatesForCountry(m.country)})})},a.openLoginDialog=function(){var a=k.open({template:"/partials/login/loginDialog.html",className:"loginForm",name:"LoginDialog",id:"LoginDialog",controller:"AuthController",controllerAs:"authCtrl"});loginDialogID=a.id},o.getRegistrationCountries().then(function(a){a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),m.registrationCountries=a.data,m.registrationCountries.length>0&&(m.country=m.registrationCountries[0].IsoCode),""!=globalSettings.Registration_DefaultCountry?(m.country=globalSettings.Registration_DefaultCountry,m.registrationCountries=m.registrationCountries.filter(function(a){return a.IsoCode==globalSettings.Registration_DefaultCountry}),m.citizenship=globalSettings.Registration_DefaultCountry,m.onCitizenshipChanged(),m.getStatesForCountry(m.country)):(m.detectUserCountry(),m.onCountryChanged())}),n.getAllCountries().then(function(a){a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),m.countries=a.data,m.countries.length>0&&(m.citizenship=m.countries[0].ThreeLetterCode)}),g.getCanRegisterSubAccountPlayers()){m.isAgentRegistration=!0;var s=g.getUserData();m.agentId=s.userID}o.getRegistrationCurrencies().then(function(a){if(a.data.sort(function(a,b){var c=a.Name.toUpperCase(),d=b.Name.toUpperCase();return c<d?-1:c>d?1:0}),m.currencies=a.data,m.currencies.length>0){m.currency=m.currencies[0].IsoCode;for(var b=m.isAgentRegistration?g.getUserData().currency.CurrencyCode:globalSettings.Registration_DefaultCurrency,c=0;c<m.currencies.length;c++)m.currencies[c].IsoCode===b&&(m.currency=m.currencies[c].IsoCode)}}),p.hasActivationProcess().then(function(a){a.success?m.hasActivationProcess=a.data:m.hasActivationProcess=!0}),m.onDateLoad()}])}(),function(){angular.module("shopCashDesk",["matchSearch.service","matchOfferings.service","shortcutsInfo.service"]).controller("CashDeskController",["$scope","$rootScope","$q","$timeout","$filter","authService","helperService","couponService","evaluationService","sportsApiService","loggingService","matchSearchService","matchOfferingsService","shortcutsInfoService","currencyService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=this;this.userLoggedIn=f.hasValidLogin(),this.smartBetCodes=[],this.couponData="",this.cashDeskEntries=[],this.defaultSelectionShortcut="1",this.newEntryOverride=null,this.setBankerOnReload=null,this.stakeGrossValue=0,this.changeStakeTimeout=null,this.stakeUpdated=!1,this.saveLastStake=!1,this.saveLastSelection=!1,this.savedStakeValue=null,this.savedSelectionValue=null,this.evaluationList=[],this.statusEnum=i.statusEnum,this.collapseRightSection=!1,this.showRightSectionOverlay=!1,this.postCouponInProgress=!1,this.bookCouponInProgress=!1,this.matchSearchValue="",this.isMatchSearchOpen=l.isPanelVisible,this.isMatchSearchInProgress=l.isSearchInProgress,this.matchSearchResults=[],this.matchSearchScrollConfig={theme:"minimal",alwaysShowScrollbar:1,advanced:{updateOnContentResize:!0},scrollInertia:0},this.matchSearchSelectedIndex=-1,this.matchOfferingsMatchData=null,this.matchOfferingsFilterValue="",this.isMatchOfferingsOpen=m.isPanelVisible,this.isMatchOfferingsLoading=m.isDataLoading,this.matchOfferingsResults=[],this.matchOfferingsScrollConfig={theme:"minimal",alwaysShowScrollbar:1,advanced:{updateOnContentResize:!0},scrollInertia:0},this.matchOfferingsMarketIndex=-1,this.matchOfferingsSelectionIndex=-1,this.shortcutsInfoSearchValue="",this.isShortcutsInfoOpen=n.isPanelVisible,this.isShortcutsInfoLoading=n.isDataLoading,this.shortcutsInfoSearchResults=[],this.shortcutsInfoScrollConfig={theme:"minimal",alwaysShowScrollbar:1,advanced:{updateOnContentResize:!0},scrollInertia:0},this.stakeSummationEnabled=!1,this.stakeSummationEntries=[],this.verifyCouponCode="",this.refreshEvaluationList=function(a){p.evaluationList=[];var b=_.filter(a,function(a){return a.status!=p.statusEnum.accepted&&a.status!=p.statusEnum.declined}),c=_.filter(a,function(a){return a.status==p.statusEnum.accepted||a.status==p.statusEnum.declined}),d=[].concat(b).concat(c);_.forEach(d,function(a){var b="";a.status==p.statusEnum.pending?b="pending":a.status==p.statusEnum.accepted?b="accepted":a.status==p.statusEnum.declined?b="declined":a.status==p.statusEnum.awaitingReply&&(b="awaiting-reply"),p.evaluationList.push({status:a.status,statusClass:b,coupon:a.coupon}),p.updateSummationStatus(a.coupon.CouponCode,a.status)})},this.syncToCoupon=function(a){if(p.couponData=_.cloneDeep(a),p.stakeGrossValue=p.couponData.StakeGrossValue,p.cashDeskEntries=[],null!=p.couponData&&null!=p.couponData.Odds&&_.forEach(p.couponData.Odds,function(a){var b=p.transformToCashDeskEntry(a);p.addEntry(b)}),p.setBankerOnReload){var b=_.find(p.cashDeskEntries,function(a){return a.selectionData.oddId==p.setBankerOnReload.selectionData.oddId});b&&p.toggleBankerValue(b),p.setBankerOnReload=null}var c=p.addEntry();null==p.newEntryOverride?p.stakeUpdated?(d(function(){angular.element("#txtStake").focus()},0),p.stakeUpdated=!1):c.smartbetInput.focus():(_.assignIn(c,p.newEntryOverride),c.smartbetInput.value=c.matchData.smartbetCode,c.selectionInput.enabled=!0,c.selectionInput.value=p.savedSelectionValue||p.defaultSelectionShortcut,c.selectionInput.focus(),c.selectionInput.select(),p.onSelectionValueChanged(c),p.newEntryOverride=null)},this.transformToCouponOdd=function(a){return{categoryId:a.matchData.categoryId,categoryName:a.matchData.categoryName,combinability:a.selectionData.gameplay,eventCategory:a.matchData.eventCategory,marketId:a.selectionData.marketId,marketName:a.selectionData.marketName,marketTypeId:a.selectionData.marketTypeId,matchDate:a.matchData.eventDate,matchId:a.matchData.eventId,matchName:a.matchData.eventName,matchProviderId:a.matchData.providerEventId,oddId:a.selectionData.matchOddsId,oddValue:a.selectionData.oddValue,selectionName:a.selectionData.selectionName,selectionShortcut:a.selectionData.shortcut,smartBetCode:a.matchData.smartbetCode,sportId:a.matchData.sportId,sportName:a.matchData.sportName,spreadValue:a.selectionData.spreadValue,tournamentId:a.matchData.tournamentId,tournamentName:a.matchData.tournamentName}},this.transformToCashDeskEntry=function(a){var b=p.createEntry();return b.matchData={smartbetCode:a.SmartCode,sportId:a.IDSport,sportName:a.SportName,categoryId:a.EventId,categoryName:a.EventName,tournamentId:a.TournamentId,tournamentName:a.TournamentName,eventId:a.MatchId,eventName:a.MatchName,providerEventId:a.ProviderEventId,eventDate:a.EventDate,eventCategory:a.EventCategory,selections:[]},b.savedMatchData=_.cloneDeep(b.matchData),b.smartbetInput.value=b.matchData.smartbetCode,b.smartbetInput.enabled=!0,b.selectionData={matchOddsId:a.SelectionId,shortcut:a.SelectionShortcut,oddId:a.SelectionId,marketId:a.MarketId,marketName:a.MarketName,marketTypeId:a.MarketTypeId,oddValue:a.OddValue,selectionName:a.SelectionName,spreadValue:null,gameplay:a.GamePlay},b.savedSelectionData=_.cloneDeep(b.selectionData),b.selectionInput.value=b.selectionData.shortcut,b.selectionInput.enabled=!0,b.isBanker="No"!=a.Banker,b.allowBanker=a.AllowFixed,b.savedToCoupon=!0,b},this.createTextInput=function(a,b){return{elementId:a,enabled:b,value:"",hasError:!1,errorMessage:"",focus:function(){d(function(){angular.element("#"+a).focus()},0)},blur:function(){d(function(){angular.element("#"+a).blur()},0)},select:function(){d(function(){angular.element("#"+a).select()},0)}}},this.createEntry=function(){var a=g.generateUniqueId(),b="txtSmartbet_"+a,c="txtSelection_"+a,d={id:a,matchData:null,savedMatchData:null,selectionData:null,savedSelectionData:null,savedToCoupon:!1,isBanker:!1,allowBanker:!1,inputForm:null,smartbetInput:p.createTextInput(b,!0),selectionInput:p.createTextInput(c,!1)};return d},this.addEntry=function(a){return null==a&&(a=p.createEntry()),p.cashDeskEntries.push(a),a},this.removeEntry=function(a){if(a.savedToCoupon)p.removeEntryFromCoupon(a);else{_.pull(p.cashDeskEntries,a);var b=p.addEntry();b.smartbetInput.focus()}},this.getSmartBetCodes=function(){var a=c.defer();return j.feed.getActiveSmartBetCodes().then(function(b){return b.success?(p.smartBetCodes=b.data,void a.resolve(!0)):(k.logError("Unable to get active smartbet codes: "+JSON.stringify(b.error)),void a.resolve(!1))}),a.promise},this.loadMatchData=function(a){j.feed.getQuickBet(a.smartbetInput.value,globalSettings.CurrentLanguage).then(function(b){return b.success?void(b.data.IDEvent!=-1?(a.matchData=p.formatMatchData(a.smartbetInput.value,b.data),a.selectionInput.enabled=!0,null!=a.selectionInput.value&&""!=a.selectionInput.value||(a.selectionInput.value=p.savedSelectionValue||p.defaultSelectionShortcut),a.selectionInput.focus(),a.selectionInput.select(),p.onSelectionValueChanged(a)):(a.smartbetInput.focus(),a.smartbetInput.select(),a.smartbetInput.hasError=!0,a.smartbetInput.errorMessage="Event ID is invalid")):(k.logError("Unable to get match details: "+JSON.stringify(b.error)),a.smartbetInput.focus(),a.smartbetInput.select(),a.smartbetInput.hasError=!0,void(a.smartbetInput.errorMessage=locale.account.shopWebsite.cashDesk.tooltipMessages.invalidEventId))})},this.formatMatchData=function(a,b){var c={smartbetCode:a,sportId:b.IDSport,sportName:b.SportName,categoryId:b.IDCategory,categoryName:b.CategoryName,tournamentId:b.IDTournament,tournamentName:b.TournamentName,eventId:b.IDEvent,eventName:b.EventName,providerEventId:b.ProviderIDEvent,eventDate:b.EventDate,eventCategory:b.EventCategory,selections:[]};return angular.forEach(b.Markets,function(a){angular.forEach(a.Markets,function(b){null!=b.Shortcut&&0!=b.Shortcut.trim().length&&c.selections.push({matchOddsId:b.MatchOddsID,shortcut:b.Shortcut,oddId:b.MatchOddsID,marketId:a.OddsID,marketName:a.OddsType.OddsTypeName,marketTypeId:a.OddsType.OddsTypeID,oddValue:b.OddOutcome,selectionName:b.OddAttribute.OddName,spreadValue:a.SpecialBetValue,gameplay:a.GamePlay})})}),c},this.saveEntryToCoupon=function(a){var b=c.defer();if(null==a.selectionData)b.resolve(!1);else{var d=p.transformToCouponOdd(a),e=!1;null!=p.couponData.Odds&&0!=p.couponData.Odds.length||(e=!0),h.updateCoupon(d,"POST",null,null,null,null,null,!1,!1).then(function(c){if(!c.success||c.serverSide)return void b.resolve(!1);var c=c.apiResponse;return c.ResponseStatus!=Sportsbook.ResponseStatus.Success?(g.showErrorMessage(locale.sports.coupon.errorOddResult[c.ResponseStatus],p.showMessage),void b.resolve(!1)):(e&&null!=p.savedStakeValue&&p.updateCoupon(null,"PUT",p.savedStakeValue),a.savedToCoupon=!0,void b.resolve(!0))})}return b.promise},this.toggleBankerValue=function(a){var b=c.defer();if(null==a.selectionData)b.resolve(!1);else if(a.allowBanker){var d={oddId:a.selectionData.oddId};h.updateCoupon(d,"PUT",null,null,null,null,!a.isBanker).then(function(c){if(!c.success||c.serverSide)return void b.resolve(!1);var c=c.apiResponse;return c.ResponseStatus!=Sportsbook.ResponseStatus.Success?(g.showErrorMessage(locale.sports.coupon.errorOddResult[c.ResponseStatus],p.showMessage),void b.resolve(!1)):(a.isBanker=!a.isBanker,void b.resolve(!0))})}else g.showErrorMessage(locale.account.shopWebsite.cashDesk.bankerNotAllowed,p.showMessage),b.resolve(!1);return b.promise},this.removeEntryFromCoupon=function(a){var b=c.defer();if(1==p.couponData.Odds.length)h.clearCoupon(),b.resolve(!0);else{var d={oddId:a.savedSelectionData.oddId};h.updateCoupon(d,"DELETE",null,null,null,null,null,!1).then(function(a){if(!a.success||a.serverSide)return void b.resolve(!1);var a=a.apiResponse;return a.ResponseStatus!=Sportsbook.ResponseStatus.Success?void b.resolve(!1):void b.resolve(!0)})}return b.promise},this.cancelBet=function(){p.cashDeskEntries=[];var a=p.addEntry();a.smartbetInput.focus(),h.clearCoupon(),h.updateSelectionIds(null),h.updateProviderEventIds(null)},this.placeBet=function(a){p.postCouponInProgress||(p.postCouponInProgress=!0,p.userLoggedIn?p.updateCoupon(null,"PUT",null,null,null,!1,null,!0,a):(p.updateCoupon(null,"PUT"),g.showErrorMessage(locale.sports.coupon.combinationSet.notLoggedIn,p.showMessage)))},this.bookCoupon=function(){p.bookCouponInProgress||(p.bookCouponInProgress=!0,h.bookCoupon().then(function(a){p.bookCouponInProgress=!1,b.$broadcast("cashDeskController:couponBooked",a)}))},this.updateCoupon=function(a,b,c,d,e,f,i,j,k){h.updateCoupon(a,b,c,d,e,f,i,j,p.isCurrentLive).then(function(a){if(p.stakeUpdated=a.stakeUpdated,!a.success)return void(p.postCouponInProgress=!1);if(a.serverSide){if(!a.apiResponse.success)return void(p.postCouponInProgress=!1);var b=a.apiResponse.data,c=b.ResponseStatus,d=!1;f||0!=c&&24!=c||(d=!0),d&&null!=p.couponData&&""!=p.couponData&&0!=p.couponData.Odds.length&&(k?p.onConfirmBetClicked():p.showCouponConfirmationDialog())}else{var a=a.apiResponse;a.ResponseStatus!=Sportsbook.ResponseStatus.Success&&g.showErrorMessage(locale.sports.coupon.errorOddResult[a.ResponseStatus],p.showMessage)}})},this.showCouponConfirmationDialog=function(){var a='<div class="couponConfirmation"><div class="contentMessage"><div class="messageContent"><i class="fa fa-info-circle"></i><span class="message text-left">'+locale.sports.coupon.couponOdds.couponConfirmationMessage+"</span></div></div></div>";g.showMessageWithHtml(a,!0,locale.common.cancel,!0,locale.common.confirm).then(p.onConfirmBetClicked,function(){p.postCouponInProgress=!1}).done()},this.onSaveLastStakeValueChanged=function(){p.saveLastStake||(p.savedStakeValue=null)},this.onSaveLastSelectionValueChanged=function(){p.saveLastSelection||(p.savedSelectionValue=null)},this.onSummateStakesValueChanged=function(){p.stakeSummationEnabled||(p.stakeSummationEntries=[])},this.onConfirmBetClicked=function(){var a=!0,b=!1,c=!1,d=h.getCouponSettings();if(null!=d){var e=d.split(",");a=e[0],b=e[1],c=e[2],inBehalfOf=e[3]}p.postCoupon(a,b,c,inBehalfOf)},this.postCoupon=function(c,e,j,k){h.postCoupon(c,e,j,k).then(function(k){if(!k.success)return void(p.postCouponInProgress=!1);if(!k.apiResponse.success)return p.postCouponInProgress=!1,g.showErrorMessage(locale.sports.coupon.verifyCoupon.errorCheckRecentCoupon),void b.$broadcast("getOpenBets");var l=k.apiResponse.data,m=l.ResponseStatus;if(1==m){globalSettings.Tracking_EnableDataLayer&&g.setValueToDataLayer("betPlaced",l.UpdatedBetCoupon.Stake),g.createDataLayerEvent({event:"user-place-bet",userId:l.UpdatedBetCoupon.UserId,couponID:l.CouponCode,totalStake:l.UpdatedBetCoupon.StakeGross});var n=null!=l.UpdatedBetCoupon&&0!=l.UpdatedBetCoupon.CurrentEvalReason;if(n){var o=l.UpdatedBetCoupon;o.CouponId=l.CouponId,o.CouponCode=l.CouponCode,i.addToEvaluation(o),i.runEvaluation()}var q=null,r=h.getCouponSettings();if(null!=r&&""!=r){var s=r.split(",");null!=s&&null!=s[3]&&0!=s[3]&&(q=s[3])}var t=p.statusEnum.pending;n?g.showInfoMessage(locale.sports.coupon.combinationSet.couponReserva,p.showMessage):(t=p.statusEnum.accepted,null!=f.getUserData()&&f.getUserData().isAgent&&h.printCoupon(l.CouponCode,l.UserId,a.isPokerShares),p.saveLastStake&&(p.savedStakeValue=p.stakeGrossValue),g.showSuccessMessage(p.getStatus(m),p.showMessage),b.$broadcast("getOpenBets")),p.stakeSummationEnabled&&p.stakeSummationEntries.push({couponCode:l.CouponCode,status:t,currencySymbol:f.getUserData().currency.CurrencySymbol,stake:l.UpdatedBetCoupon.StakeGross})}else if(3==m)g.showErrorMessage(p.getStatus(m),p.showMessage);else if(4==m)g.showErrorMessage(p.getStatus(m),p.showMessage);else if(69==m){var u=globalSettings.CouponLiveDelayDefault,v=p.couponData;null!=v&&0!=v.LiveDelay&&(u=v.LiveDelay);var r=h.getCouponSettings();if(null!=r&&""!=r){var s=r.split(",");null!=s&&null!=s[3]&&0!=s[3]&&(q=s[3])}d(function(){p.postCoupon(c,e,j,q)}.bind(this),u)}else g.showErrorMessage(p.getStatus(m),p.showMessage);p.postCouponInProgress=!1})},this.getStatus=function(a){return locale.sports.coupon.statusCode[a]||locale.sports.coupon.statusCode[0]+" ("+a+")"},this.onStakeValueChanged=function(a){var b=p.stakeGrossValue,c=(p.couponData.BetCouponGlobalVariable.MinBetStake,p.couponData.BetCouponGlobalVariable.MaxBetStake),e=/^[0-9.,]+$/;if(0==e.test(b))return void(p.stakeGrossValue=b.substring(0,b.length-1));if(!(isNaN(b)||parseFloat(b)<=0)){parseFloat(b)>parseFloat(c)&&(b=c),null!=p.changeStakeTimeout&&d.cancel(p.changeStakeTimeout);var f=400;p.changeStakeTimeout=d(function(){p.updateCoupon(null,"PUT",b)}.bind(this),f)}},this.onStakeValueKeyDown=function(a){var b=a.which||a.keyCode;if(a.shiftKey&&9==b){if(a.preventDefault(),0==p.cashDeskEntries.length)return;var c=p.cashDeskEntries.length-1,d=p.cashDeskEntries[c];d.selectionInput.enabled?(d.selectionInput.focus(),d.selectionInput.select()):(d.smartbetInput.focus(),d.smartbetInput.select())}else if(9==b){if(a.preventDefault(),0==p.cashDeskEntries.length)return;p.cashDeskEntries[0].smartbetInput.focus(),p.cashDeskEntries[0].smartbetInput.select()}else a.ctrlKey||13!=b||(a.preventDefault(),p.userLoggedIn?p.placeBet():p.bookCoupon())},this.focusRecordByIndex=function(a){if(!(null==a||isNaN(a)||a<0||a>=9||a>=p.cashDeskEntries.length)){var b=p.cashDeskEntries[a];b.selectionInput.enabled?(b.selectionInput.focus(),b.selectionInput.select()):(b.smartbetInput.focus(),
b.smartbetInput.select())}},this.toggleGrouping=function(a){if(null!=p.couponData&&null!=p.couponData.AllGroupings){var b=_.find(p.couponData.AllGroupings,function(b){return b.Grouping==a});if(null!=b){var c=b.Grouping+","+b.Combinations+","+!b.IsChecked;p.updateCoupon(null,"PUT",null,c)}}},this.toggleRightSection=function(){return window.innerWidth>1365?void(p.showRightSectionOverlay&&(p.showRightSectionOverlay=!1)):void(p.showRightSectionOverlay=!p.showRightSectionOverlay)},this.toggleMaximized=function(){window.innerWidth<1366||(p.collapseRightSection&&a.$parent.collapseLeftSection?(a.$parent.collapseLeftSection=!1,p.collapseRightSection=!1):(a.$parent.collapseLeftSection=!0,p.collapseRightSection=!0),a.$parent.toggleLeftSection(),p.toggleRightSection())},this.closeMatchSearchPanel=function(a){var b=l.closeSearchPanel(a);if(null!=b.cashDeskEntry){var c=_.find(p.cashDeskEntries,function(a){return a.id==b.cashDeskEntry.id});null!=c&&(null==b.smartbetCode||""==b.smartbetCode?c.smartbetInput.value="":c.smartbetInput.value=b.smartbetCode.toString(),p.onSmartbetValueChanged(c))}},this.onMatchSearchValueChanged=function(a){l.updateSearchResults(p.matchSearchValue)},this.onMatchSearchKeyDown=function(a){var b=a.which||a.keyCode;if(13==b){if(a.preventDefault(),p.matchSearchSelectedIndex>-1&&p.matchSearchSelectedIndex<p.matchSearchResults.length){var c=p.matchSearchResults[p.matchSearchSelectedIndex];p.closeMatchSearchPanel(c)}}else if(27==b)a.preventDefault(),p.closeMatchSearchPanel();else if(38==b&&p.matchSearchResults.length>0){if(a.preventDefault(),p.matchSearchSelectedIndex<0)p.matchSearchSelectedIndex=0;else if(p.matchSearchSelectedIndex>0){p.matchSearchSelectedIndex--;var d="matchSearchResult_"+p.matchSearchSelectedIndex;p.matchSearchScrollToRow(d)}}else if(40==b&&p.matchSearchResults.length>0){if(a.preventDefault(),p.matchSearchSelectedIndex<p.matchSearchResults.length-1){p.matchSearchSelectedIndex++;var d="matchSearchResult_"+p.matchSearchSelectedIndex;p.matchSearchScrollToRow(d)}}else 9==b&&a.preventDefault()},this.onMatchSearchBlur=function(){d(function(){angular.element(".match-search-panel .search-box").focus()},0)},this.matchSearchScrollToRow=function(a){var b=$(".match-search-panel .search-results-wrapper"),c=b.find(".mCSB_container");if(0!=c.length){var d=b.height(),e=Math.abs(c[0].offsetTop),f=e+d,g=$("#"+a),h=g.height(),i=g[0].offsetTop,j=i+h;if(i<e){var k=e-i;b.mCustomScrollbar("scrollTo",e-k)}else if(j>f){var k=j-f;b.mCustomScrollbar("scrollTo",e+k)}}},this.openMatchOfferingsPanel=function(a){a.selectionInput.enabled&&(p.matchOfferingsFilterValue="",p.matchOfferingsMatchData=a.matchData,m.openPanel(a),d(function(){angular.element(".match-offerings-panel .filter-box").focus()},0))},this.closeMatchOfferingsPanel=function(a){m.closePanel(a).then(function(a){if(p.matchOfferingsMatchData=null,null!=a&&null!=a.cashDeskEntry){var b=_.find(p.cashDeskEntries,function(b){return b.id==a.cashDeskEntry.id});null!=b&&(null==a.selectionShortcut||""==a.selectionShortcut?b.selectionInput.value="":b.selectionInput.value=a.selectionShortcut.toString(),p.onSelectionValueChanged(b),b.inputForm.txtSmartbet.$setDirty(),b.selectionInput.focus())}})},this.onMatchOfferingsFilterValueChanged=function(a){m.filterMatchOfferings(p.matchOfferingsFilterValue)},this.onMatchOfferingsKeyDown=function(a){var b=a.which||a.keyCode;if(13==b){if(a.preventDefault(),p.matchOfferingsMarketIndex>-1&&p.matchOfferingsMarketIndex<p.matchOfferingsResults.length){var c=p.matchOfferingsResults[p.matchOfferingsMarketIndex];if(p.matchOfferingsSelectionIndex>-1&&p.matchOfferingsSelectionIndex<c.MatchOdds.length){var d=c.MatchOdds[p.matchOfferingsSelectionIndex];p.closeMatchOfferingsPanel(d)}}}else if(27==b)a.preventDefault(),p.closeMatchOfferingsPanel();else if(38==b&&p.matchOfferingsResults.length>0){if(a.preventDefault(),p.matchOfferingsMarketIndex<0)p.matchOfferingsMarketIndex=0,p.matchOfferingsSelectionIndex=0;else if(p.matchOfferingsMarketIndex>=0){var c=p.matchOfferingsResults[p.matchOfferingsMarketIndex];if(c.MatchOdds.length>6){if(p.matchOfferingsSelectionIndex>=6)p.matchOfferingsSelectionIndex-=6;else if(p.matchOfferingsMarketIndex>=1){p.matchOfferingsMarketIndex--;var e=p.matchOfferingsResults[p.matchOfferingsMarketIndex];if(e.MatchOdds.length>6){var f=Math.ceil(e.MatchOdds.length/6);p.matchOfferingsSelectionIndex+=6*(f-1)}p.matchOfferingsSelectionIndex>e.MatchOdds.length-1&&(p.matchOfferingsSelectionIndex=e.MatchOdds.length-1)}}else if(p.matchOfferingsMarketIndex>=1){p.matchOfferingsMarketIndex--;var e=p.matchOfferingsResults[p.matchOfferingsMarketIndex];if(e.MatchOdds.length>6){var f=Math.ceil(e.MatchOdds.length/6);p.matchOfferingsSelectionIndex+=6*(f-1)}p.matchOfferingsSelectionIndex>e.MatchOdds.length-1&&(p.matchOfferingsSelectionIndex=e.MatchOdds.length-1)}var g="matchOffering_"+p.matchOfferingsMarketIndex+"_"+p.matchOfferingsSelectionIndex;p.matchOfferingsScrollToCell(g)}}else if(40==b&&p.matchOfferingsResults.length>0){if(a.preventDefault(),p.matchOfferingsMarketIndex<0)p.matchOfferingsMarketIndex=0,p.matchOfferingsSelectionIndex=0;else{var c=p.matchOfferingsResults[p.matchOfferingsMarketIndex];if(c.MatchOdds.length>6){var h=Math.floor((p.matchOfferingsSelectionIndex+1)/6)+1,i=Math.ceil(c.MatchOdds.length/6);if(i>h)p.matchOfferingsSelectionIndex+=6,p.matchOfferingsSelectionIndex>c.MatchOdds.length-1&&(p.matchOfferingsSelectionIndex=c.MatchOdds.length-1);else if(p.matchOfferingsMarketIndex<p.matchOfferingsResults.length-1){p.matchOfferingsMarketIndex++;var j=Math.floor(c.MatchOdds.length/6);p.matchOfferingsSelectionIndex=p.matchOfferingsSelectionIndex-6*j;var e=p.matchOfferingsResults[p.matchOfferingsMarketIndex];p.matchOfferingsSelectionIndex>e.MatchOdds.length-1&&(p.matchOfferingsSelectionIndex=e.MatchOdds.length-1)}}else if(p.matchOfferingsMarketIndex<p.matchOfferingsResults.length-1){p.matchOfferingsMarketIndex++;var e=p.matchOfferingsResults[p.matchOfferingsMarketIndex];p.matchOfferingsSelectionIndex>e.MatchOdds.length-1&&(p.matchOfferingsSelectionIndex=e.MatchOdds.length-1),p.matchOfferingsSelectionIndex>=6&&(p.matchOfferingsSelectionIndex=5)}}var g="matchOffering_"+p.matchOfferingsMarketIndex+"_"+p.matchOfferingsSelectionIndex;p.matchOfferingsScrollToCell(g)}else if(37==b&&p.matchOfferingsResults.length>0){a.preventDefault(),p.matchOfferingsMarketIndex<0&&(p.matchOfferingsMarketIndex=0,p.matchOfferingsSelectionIndex=0),p.matchOfferingsSelectionIndex>0&&p.matchOfferingsSelectionIndex--;var g="matchOffering_"+p.matchOfferingsMarketIndex+"_"+p.matchOfferingsSelectionIndex;p.matchOfferingsScrollToCell(g)}else if(39==b&&p.matchOfferingsResults.length>0){a.preventDefault(),p.matchOfferingsMarketIndex<0&&(p.matchOfferingsMarketIndex=0);var c=p.matchOfferingsResults[p.matchOfferingsMarketIndex];p.matchOfferingsSelectionIndex<c.MatchOdds.length-1&&p.matchOfferingsSelectionIndex++;var g="matchOffering_"+p.matchOfferingsMarketIndex+"_"+p.matchOfferingsSelectionIndex;p.matchOfferingsScrollToCell(g)}else 9==b&&a.preventDefault()},this.onMatchOfferingsFilterBlur=function(){d(function(){angular.element(".match-offerings-panel .filter-box").focus()},0)},this.matchOfferingsScrollToCell=function(a){var b=$(".match-offerings-panel .results-wrapper"),c=b.find(".mCSB_container");if(0!=c.length){var d=b.height(),e=Math.abs(c[0].offsetTop),f=e+d,g=$("#"+a).parent().parent(),h=g.height(),i=g[0].offsetTop,j=i+h;if(i<e){var k=e-i;b.mCustomScrollbar("scrollTo",e-k)}else if(j>f){var k=j-f;b.mCustomScrollbar("scrollTo",e+k)}}},this.openShortcutsInfoPanel=function(){p.shortcutsInfoSearchValue="",n.openPanel(),d(function(){angular.element(".shortcuts-info-panel .search-box").focus()},0)},this.closeShortcutsInfoPanel=function(){n.closePanel()},this.onShortcutsInfoSearchValueChanged=function(a){n.filterShortcutsInfo(p.shortcutsInfoSearchValue)},this.onShortcutsInfoSearchKeyDown=function(a){var b=a.which||a.keyCode;27==b&&(a.preventDefault(),p.closeShortcutsInfoPanel())},this.onShortcutsInfoSearchBlur=function(){d(function(){angular.element(".shortcuts-info-panel .search-box").focus()},0)},this.openNewCouponTabPanel=function(){window.open("/new-coupon-tab/","MsgWindow","width=1024,height=850")},this.showMessage=function(a,b,c){switch(a){case"success":color="green",icon="fa-check";break;case"error":color="red",icon="fa-exclamation-triangle";break;default:color="blue",icon="fa-exclamation-circle"}null==c&&(c=5e3),$.sticky(b,{speed:"fast",duplicates:!1,autoclose:c,color:color,messageIcon:icon,closeButtonHtml:'<span class="sticky-close" title="Close">&#215;</span>'})},this.getSummationTotal=function(){var a=0;p.stakeSummationEntries.length>0&&(a=_.sumBy(p.stakeSummationEntries,function(a){return a.status==p.statusEnum.declined?0:a.stake}));var b=f.getUserData().currency.CurrencySymbol;return b+e("number")(a,2)},this.updateSummationStatus=function(a,b){var c=_.find(p.stakeSummationEntries,function(b){return b.couponCode==a});null!=c&&(c.status=b)},this.onSmartbetValueChanged=function(a){var b=a.smartbetInput.value;if(a.matchData=null,a.selectionInput.value="",a.selectionData=null,isNaN(b)){if(b.trim().length<3)return;a.smartbetInput.blur(),l.openSearchPanel(a),p.matchSearchValue=a.smartbetInput.value,d(function(){angular.element(".match-search-panel .search-box").focus()},0)}else{var c=_.filter(p.smartBetCodes,function(a){return a.toString().startsWith(b)}),e=_.filter(p.smartBetCodes,function(a){return a.toString()==b});1==c.length&&1==e.length?(a.smartbetInput.blur(),p.loadMatchData(a)):a.smartbetInput.focus()}},this.onSmartbetKeyDown=function(a,b){b.smartbetInput.hasError=!1,b.smartbetInput.errorMessage="";var c=a.which||a.keyCode;if(a.shiftKey||9!=c)if(a.shiftKey&&9==c){a.preventDefault();var e=_.indexOf(p.cashDeskEntries,b);if(e>0){var f=_.nth(p.cashDeskEntries,e-1);f.selectionInput.enabled?(f.selectionInput.focus(),f.selectionInput.select()):(f.smartbetInput.focus(),f.smartbetInput.select())}else d(function(){angular.element("#txtStake").focus(),angular.element("#txtStake").select()},0)}else a.ctrlKey&&46==c&&(a.preventDefault(),p.removeEntry(b));else if(a.preventDefault(),b.smartbetInput.blur(),0==b.smartbetInput.value.trim().length){var e=_.indexOf(p.cashDeskEntries,b);e==p.cashDeskEntries.length-1&&d(function(){angular.element("#txtStake").focus(),angular.element("#txtStake").select()},0)}else b.inputForm.txtSmartbet.$dirty?p.loadMatchData(b):b.selectionInput.focus()},this.onSmartbetBlur=function(a,b){b.smartbetInput.hasError=!1,b.smartbetInput.errorMessage=""},this.onSelectionValueChanged=function(a){null!=a.matchData&&(a.selectionData=_.find(a.matchData.selections,function(b){return b.shortcut==a.selectionInput.value}))},this.onSelectionKeyDown=function(a,b){b.selectionInput.hasError=!1,b.selectionInput.errorMessage="";var c=a.which||a.keyCode;if(!a.shiftKey&&9==c||106==c||111==c||191==c)if(a.preventDefault(),null!=b.selectionData)if(b.savedToCoupon)if(b.inputForm.txtSmartbet.$dirty||b.inputForm.txtSelection.$dirty)p.removeEntry(b),p.saveEntryToCoupon(b).then(function(a){a?106==c?p.newEntryOverride={matchData:_.cloneDeep(b.matchData)}:111!=c&&191!=c||(p.setBankerOnReload=b):(b.selectionInput.focus(),b.selectionInput.select(),b.selectionInput.hasError=!0,b.selectionInput.errorMessage=locale.account.shopWebsite.cashDesk.tooltipMessages.invalidShortcut)});else if(106==c){var d=p.addEntry();d.matchData=_.cloneDeep(b.matchData),d.smartbetInput.value=b.smartbetInput.value,d.selectionInput.enabled=!0,d.selectionInput.value=p.savedSelectionValue||p.defaultSelectionShortcut,d.selectionInput.focus(),d.selectionInput.select()}else{111!=c&&191!=c||p.toggleBankerValue(b);var e=_.indexOf(p.cashDeskEntries,b),f=_.nth(p.cashDeskEntries,e+1);f.smartbetInput.focus(),f.smartbetInput.select()}else p.saveEntryToCoupon(b).then(function(a){a?(p.saveLastSelection&&null==p.savedSelectionValue&&(p.savedSelectionValue=b.selectionInput.value),106==c?p.newEntryOverride={matchData:_.cloneDeep(b.matchData)}:111!=c&&191!=c||(p.setBankerOnReload=b)):(b.selectionInput.focus(),b.selectionInput.select(),b.selectionInput.hasError=!0,b.selectionInput.errorMessage=locale.account.shopWebsite.cashDesk.tooltipMessages.invalidShortcut)});else b.selectionInput.focus(),b.selectionInput.select(),b.selectionInput.hasError=!0,b.selectionInput.errorMessage=locale.account.shopWebsite.cashDesk.tooltipMessages.invalidShortcut;else a.shiftKey&&9==c?(a.preventDefault(),b.smartbetInput.focus(),b.smartbetInput.select()):a.ctrlKey&&46==c?(a.preventDefault(),p.removeEntry(b)):a.ctrlKey&&79==c&&(a.preventDefault(),p.openMatchOfferingsPanel(b))},this.onSelectionBlur=function(a,b){b.selectionInput.hasError=!1,b.selectionInput.errorMessage=""},this.setupPageKeyDownHandler=function(){angular.element(document).on("keydown",function(b){a.$apply(function(){var a=b.which||b.keyCode;118==a?(b.preventDefault(),p.saveLastStake=!p.saveLastStake,p.onSaveLastStakeValueChanged()):119==a?(b.preventDefault(),p.saveLastSelection=!p.saveLastSelection,p.onSaveLastSelectionValueChanged()):120==a?(b.preventDefault(),d(function(){angular.element("#txtVerifyCoupon").focus()},0)):121==a?(b.preventDefault(),p.stakeSummationEnabled=!p.stakeSummationEnabled,p.stakeSummationEntries=[]):b.ctrlKey&&(b.shiftKey?67==a&&(b.preventDefault(),p.openNewCouponTabPanel()):b.altKey?49==a||97==a?(b.preventDefault(),p.toggleGrouping(1)):50==a||98==a?(b.preventDefault(),p.toggleGrouping(2)):51==a||99==a?(b.preventDefault(),p.toggleGrouping(3)):52==a||100==a?(b.preventDefault(),p.toggleGrouping(4)):53==a||101==a?(b.preventDefault(),p.toggleGrouping(5)):54==a||102==a?(b.preventDefault(),p.toggleGrouping(6)):55==a||103==a?(b.preventDefault(),p.toggleGrouping(7)):56==a||104==a?(b.preventDefault(),p.toggleGrouping(8)):57!=a&&105!=a||(b.preventDefault(),p.toggleGrouping(9)):13==a?(b.preventDefault(),p.userLoggedIn?p.placeBet(!0):p.bookCoupon()):49==a||97==a?(b.preventDefault(),p.focusRecordByIndex(0)):50==a||98==a?(b.preventDefault(),p.focusRecordByIndex(1)):51==a||99==a?(b.preventDefault(),p.focusRecordByIndex(2)):52==a||100==a?(b.preventDefault(),p.focusRecordByIndex(3)):53==a||101==a?(b.preventDefault(),p.focusRecordByIndex(4)):54==a||102==a?(b.preventDefault(),p.focusRecordByIndex(5)):55==a||103==a?(b.preventDefault(),p.focusRecordByIndex(6)):56==a||104==a?(b.preventDefault(),p.focusRecordByIndex(7)):57==a||105==a?(b.preventDefault(),p.focusRecordByIndex(8)):77==a?(b.preventDefault(),p.toggleMaximized()):73==a&&(b.preventDefault(),p.openShortcutsInfoPanel()))})})},this.onSelectionFocused=function(a,b){""!=b.smartbetInput.value&&null!=b.matchData&&(null!=b.matchData.selections&&b.matchData.selections.length>0||p.loadMatchData(b))},this.onVerifyCouponKeyDown=function(a){var b=a.which||a.keyCode;9!=b&&13!=b||(a.preventDefault(),p.verifyCoupon())},this.verifyCoupon=function(){var a=p.verifyCouponCode.trim();if(!(null==a||a.length<=0)){var b="/coupon-details-iframe/?couponCode="+a;j.coupon.getCouponByCodeNoCheck(a,globalSettings.CurrentLanguage).then(function(a){function c(){var a='<div class="fancybox-custom-content panel panel-custom no-brand-footer"> <div class="panel-heading w-icon"> <h3 class="panel-title"> <i class="fa fa-list fa-fw"></i> <span>'+locale.account.betSearch.couponDetailsGeneric.toUpperCase()+"</span> </h3> </div></div>";$(".fancybox-inner").prepend(a)}return a.success&&null!=a.data&&0!=a.data.CouponId?$.fancybox({modal:!1,showCloseButton:!0,hideOnContentClick:!1,hideOnOverlayClick:!0,width:925,height:533,type:"iframe",padding:0,margin:0,fitToView:!1,autoSize:!1,href:b,afterShow:c}):g.showErrorMessage(locale.sports.coupon.verifyCoupon.invalidCouponCode).done()})}},a.$on("couponService:couponDataChanged",function(a,b){p.syncToCoupon(b)}),a.$on("evaluationService:dataRefreshed",function(a,b){p.refreshEvaluationList(b)}),a.$on("evaluationService:couponAccepted",function(a,c){b.$broadcast("getOpenBets")}),a.$watch(function(){return f.hasValidLogin()},function(a,b){p.userLoggedIn=a}),a.$watch(function(){return l.getSearchResults()},function(a,b){null==a&&(a=[]),p.matchSearchResults=a,p.matchSearchSelectedIndex=-1},!0),a.$watch(function(){return m.getMatchOfferings()},function(a,b){null==a&&(a=[]),p.matchOfferingsResults=a,p.matchOfferingsMarketIndex=-1,p.matchOfferingsSelectionIndex=-1},!0),a.$watch(function(){return n.getShortcutsInfo()},function(a,b){null==a&&(a=[]),p.shortcutsInfoSearchResults=a},!0);(function(){b.showLoader(),p.getSmartBetCodes().then(function(){p.setupPageKeyDownHandler(),p.syncToCoupon(h.getCouponData()),b.hideLoader()})})()}])}(),function(){angular.module("matchOfferings.service",[]).factory("matchOfferingsService",["$rootScope","$q","sportsApiService","loggingService",function(a,b,c,d){var e=!1,f=null,g=!1,h=b.defer(),i=[],j="",k=[],l=function(a){h.resolve(),h=b.defer(),i=[],k=[],g=!0,c.feed.getEventOddFeedUngroupedLite(globalSettings.CurrentLanguage,4,a).then(function(a){return a.success?(i=n(a.data),k=i,void(g=!1)):void d.logError("Unable to get match offerings: "+JSON.stringify(a.error))})},m=function(a){return _.filter(i,function(b){if(null==b.MatchOdds||b.MatchOdds.length<=0)return!1;var c=b.MatchOdds[0].marketName.trim().toLowerCase();return _.includes(c,a)})},n=function(a){var b=[];return angular.forEach(a.AM,function(a){var c=a.IT[0];angular.forEach(a.IT[0].OC,function(d){var e=d.CB,f=locale.sports.events.eventOdds.combinabilityName[e],g="25%",h="97%";2==d.MO.length?(g="50%",h="98.5%"):3==d.MO.length&&(g="33.3%",h="98%");var i={MarketId:d.OI,OddsTypeName:d.OT.ON,OddsTypeID:d.OT.OI,CombinabilityName:f,CombinabilityID:e,SetWidth:g,SetInnerWidth:h,MatchOdds:[],hasSlider:/:/.test(d.MO[0].OA.ON)};angular.forEach(d.MO,function(b){var e=[];e={OddName:b.OA.ON,SpecialValue:b.OA.SV,MatchOddsID:b.OI,OddOutcome:b.OT.OO,oddId:b.OI,marketId:i.MarketId,marketName:i.OddsTypeName,marketTypeId:i.OddsTypeID,selectionName:b.OA.ON,isOddValue:!0,smartBetCode:c.SB,spreadValue:d.SB,oddValue:b.OT.OO,combinability:i.CombinabilityID,sportId:a.SI,sportName:a.SN,matchId:c.II,matchName:c.IN,matchDate:c.ID,tournamentId:c.TI,tournamentName:c.TN,categoryId:c.CI,categoryName:c.CN,eventCategory:c.EC,groupNo:d.GR,incompatibleEvents:c.IE,compatibleMarkets:d.CM},i.MatchOdds.push(e)}),b.push(i)})}),b};return{isPanelVisible:function(){return e},isDataLoading:function(){return g},openPanel:function(a){if(null==a.matchData||null==a.matchData.eventId)return void console.log("Error opening match odds: EventId is undefined");e=!0,f=a,j="",i=[],k=[];var b=a.matchData.eventId;l(b)},closePanel:function(a){var h=b.defer(),l=null,m=_.cloneDeep(f);if(a&&(l=a.shortcut),e=!1,g=!1,f=null,j="",i=[],k=[],null==a)return h.resolve({cashDeskEntry:m,selectionShortcut:null}),h.promise;var n=[{IsLive:"L"==a.eventCategory,MatchId:a.matchId,MarketId:a.marketId,SelectionId:a.oddId}];return c.feed.getOddsChanged(globalSettings.CurrentLanguage,n).then(function(a){return!a.success||a.data.length<=0?(d.logError("Unable to get shortcut from selectionId: "+JSON.stringify(a.error)),void h.resolve({cashDeskEntry:m,selectionShortcut:null})):void h.resolve({cashDeskEntry:m,selectionShortcut:a.data[0].SelectionShortCut})}),h.promise},getMatchOfferings:function(){return k},filterMatchOfferings:function(a){j=a.trim().toLowerCase(),k=m(j)}}}])}(),function(){angular.module("matchSearch.service",[]).factory("matchSearchService",["$rootScope","$q","authService","sportsApiService","loggingService",function(a,b,c,d,e){var f=!1,g=null,h="",i="",j=!1,k=b.defer(),l=[],m=[],n=function(a){k.resolve(),k=b.defer(),l=[],m=[],j=!0,d.feed.shopSearchEvents(globalSettings.CurrentLanguage,a,null,k.promise).then(function(a){a.success&&(_.forEach(a.data,function(a){l.push(p(a))}),m=o(i),j=!1)})},o=function(a){return _.filter(l,function(b){var c=b.categoryName.trim().toLowerCase(),d=b.tournamentName.trim().toLowerCase(),e=b.eventName.trim().toLowerCase();return _.includes(c,a)||_.includes(d,a)||_.includes(e,a)})},p=function(a){return{matchId:a.IDEvent,smartbetCode:a.SmartbetCode,matchDate:a.EventDate,eventName:a.EventName,sportId:a.IDSport,sportName:a.SportName,categoryId:a.IDCategory,categoryName:a.CategoryName,tournamentId:a.IDTournament,tournamentName:a.TournamentName}};return{isPanelVisible:function(){return f},isSearchInProgress:function(){return j},openSearchPanel:function(a){var b=a.smartbetInput.value.trim().toLowerCase();f=!0,g=a,h=b,i=b,l=[],m=[],n(h)},closeSearchPanel:function(a){var b=null,c=_.cloneDeep(g);return a&&(b=a.smartbetCode),f=!1,j=!1,g=null,h="",i="",l=[],m=[],{cashDeskEntry:c,smartbetCode:b}},getSearchResults:function(){return m},updateSearchResults:function(a){return a=a.trim().toLowerCase(),a.length<3?(h="",i="",l=[],void(m=[])):void(0!=h.length&&_.startsWith(a,h)?(i=a,m=o(i)):(h=a.substring(0,3),i=a.substring(0,3),n(h)))}}}])}(),function(){angular.module("shortcutsInfo.service",[]).factory("shortcutsInfoService",["$q","umbracoApiService","loggingService",function(a,b,c){var d=!1,e=!1,f=a.defer(),g=[],h="",i=[],j=function(){f.resolve(),f=a.defer(),g=[],i=[],e=!0,b.desktop.getCashDeskShortcutsInfo(globalSettings.CurrentLanguage).then(function(a){return a.success?(g=a.data,i=g,void(e=!1)):void c.logError("Unable to get shortcuts info: "+JSON.stringify(a.error))})},k=function(a){return _.filter(g,function(b){var c=b.function.trim().toLowerCase(),d=b.shortcut.trim().toLowerCase();return _.includes(c,a)||_.includes(d,a)})};return{isPanelVisible:function(){return d},isDataLoading:function(){return e},openPanel:function(){d=!0,h="",g=[],i=[],j()},closePanel:function(){d=!1,e=!1,h="",g=[],i=[]},getShortcutsInfo:function(){return i},filterShortcutsInfo:function(a){h=a.trim().toLowerCase(),i=k(h)}}}])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){var a=0,b=[];return _.forEach(A.cashiers,function(a){b.push(a)}),a=_.maxBy(b,function(a){return a.Balance}).Balance}function o(a){var b={UserId:A.cashierID,Amount:"All"===A.popupBalance?n():A.popupBalance,CapToBalance:"All"===A.popupBalance},c=JSON.parse(JSON.stringify(b).replace(/UserId/,"UserIds"));return c.UserIds=[],a||(_.forEach(A.idList,function(a){c.UserIds.push(a)}),angular.copy(c,b)),b}function p(a){var b={UserId:a,NewPassword:A.password};c.changePassword(b).then(function(a){if(!a.success){var b=k.handlePlatformError(a);return b||k.showErrorMessage(a.userMsg).done(),void d.logError("Unable to change password:"+JSON.stringify(a.error))}k.showSuccessMessage(a.userMsg).done()}).catch(function(a){d.logError("Unable to change password: "+JSON.stringify(a)),w()})}function q(a){c.loadBalance(a,o(a)).then(function(a){if(!a.success){var b=k.handlePlatformError(a);return b||k.showErrorMessage(a.userMsg).done(),void d.logError("Unable to load balance: "+JSON.stringify(a.error))}k.showSuccessMessage(a.userMsg).done(),A.init()}).catch(function(a){d.logError("Unable to load balance: "+JSON.stringify(a)),w()})}function r(a){c.unloadBalance(a,o(a)).then(function(a){if(!a.success){var b=k.handlePlatformError(a);return b||k.showErrorMessage(a.userMsg).done(),void d.logError("Unable to unload balance:"+JSON.stringify(a.error))}k.showSuccessMessage(a.userMsg).done(),A.init()}).catch(function(a){d.logError("Unable to unload balance: "+JSON.stringify(a)),w()})}function s(a,c){_.forEach(A.searchResults,function(b){if(b[1]===a)return void(A.currentBalance=b[2])});var d=j.generateSwalMarkup(a,c,D,A.currentBalance),e=h(d)(b);k.showMessageWithHtml(e,!0,locale.common.cancel,!0,locale.common.proceed,null,"cashier-sweet-alert").then(function(){C?q(a):r(a)}).catch(function(a){}).done()}function t(a){return A.cashiers[a]&&A.cashiers[a].UserBalance<1e4?parseInt(A.cashiers[a].UserBalance):1e4}function u(){return"string"==typeof A.loggedInUserBalance?isNaN(A.loggedInUserBalance.replace(/,/g,""))?0:parseFloat(A.loggedInUserBalance.replace(/,/g,"")):A.loggedInUserBalance}function v(a){var b="";return _.forEach(A.searchResults,function(c){a===c[0]&&(b=c[1])}),b}function w(){A.loading=!1,a.hideLoader()}function x(a){for(var b={data:angular.copy(a,[]),searchColumns:angular.copy(A.searchColumns,[])},c=0;c<b.data.length;c++)A.isCashier&&(b.data[c][2]=A.loggedInUserBalance),b.data[c]=A.filterColumns(b.data[c]);return b}function y(a,c){e(function(){A.isTableInitialized()&&$("#searchResults").dataTable().api().destroy();var d=x(a);$("#searchResults").dataTable({dom:'<"top"if>rt<"bottom"pl><"clear">',oLanguage:{sLengthMenu:"Rows per page _MENU_"},data:d.data,pageLength:10,order:[[2,"desc"]],bSort:!1,stateSave:!0,language:{url:A.getDTLocaleUrl()},headerCallback:function(a,b,d,e,f){var g=this.api();A.searchColumns.forEach(function(a,b){$(g.column(b).header()).html('<span style="font-weight:bold;">'+c[b]+"</span>")})},rowCallback:function(a,b){a.childNodes.forEach(function(a,b){$(a).addClass(A.searchColumns[b].class)})},footerCallback:function(a,b,c,e,f){$("#searchResults tfoot tr td").attr("colspan",d.data[0].length),$(".dataTables_length select").wrap("<span class='cashier-select-wrapper'></span>")},createdRow:function(a,c,d){h(angular.element(a).contents())(b)}}),$('input[aria-controls="searchResults"]').attr("autocomplete","none")})}function z(){c.getUserList(B.UserStatusesFilterBy,B.DirectDescendantsOnly,B.Recursive,B.AgentsOnly,B.NonAgentsOnly).then(function(a){return a.success?a.data:(A.internalServerError=!0,void d.logError("Unable to get user candidates list: "+JSON.stringify(a.error)))}).then(function(a){A.cashiers={},angular.copy(_.keyBy(a,"UserId"),A.cashiers),A.initializeSearch()}).catch(function(a){d.logError("Unable to get cashier list: "+JSON.stringify(a)),w()})}var A=this,B={DirectDescendantsOnly:"",Recursive:"",AgentsOnly:"",UserStatusesFilterBy:"",NonAgentsOnly:""},C=!1;this.internalServerError=!1,this.loggedInUserBalance=0;var D=g.getUserData().currency.CurrencySymbol,E="cashierSummary";this.isCashier=g.getAgentType(g.getUserData().userType)===g.agentTypes.cashier,this.loading=!1,this.dateSettings={fromDate:c.fromDate||moment().format("DD/MM/YYYY"),toDate:c.toDate||moment().format("DD/MM/YYYY"),minDate:moment().subtract(3,"months").toDate(),maxDate:moment().toDate()},this.period=c.period||1,this.searchResults=[],this.cashiers={},this.filterColumns=function(a){return this.isCashier&&a.splice(17),globalSettings.Cashier_ShowTax||a.splice(15,2),globalSettings.Reports_EnableLottery||a.splice(11,3),globalSettings.Shop_BtgVirtual||a.splice(7,2),globalSettings.Shop_GBVirtual||a.splice(5,2),a},this.filterTopColumns=function(a){return this.isCashier&&a.splice(13),globalSettings.Cashier_ShowTax||a.splice(11,2),globalSettings.Reports_EnableLottery||a.splice(7,3),globalSettings.Shop_BtgVirtual||a.splice(5,1),globalSettings.Shop_GBVirtual||a.splice(4,1),a},this.searchColumnsTop=this.filterTopColumns([{title:""},{title:""},{title:""},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalSports,class:"center",colspan:"2"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalVirtual,class:"center",colspan:"2"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalBV,class:"center",colspan:"2"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalGR,class:"center",colspan:"2"},{title:""},{title:""},{title:""},{title:""},{title:""},{title:""},{title:""},{title:""},{title:""}]),this.searchColumns=this.filterColumns([{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.id,class:"center"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.username,class:"username"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.currentBalance+" <span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalSportsWagers+" <span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalBetsPaidOut+" <span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalVirtualWagers+" <span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalVirtualPaidOut+" <span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalBVWagers+" <span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalBVPaidOut+" <span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalGRWagers+" <span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalGRPaidOut+" <span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalLotBets+"<span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalLotWin+"<span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.totalLotExtWin+"<span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.toCollect+" <span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.turnoverTax+" <span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.withholdingTax+" <span>("+D+")</span>",class:"right"},{title:locale.account.shopWebsite.cashiers.reports.totalSummaryReport.searchColumns.loadUnloadBalances,class:"center load-unload"},{title:'<i class="fa fa-check" aria-hidden="true"></i>',class:"center"},{title:'<i class="fa fa-key" aria-hidden="true"></i>',class:"center"}]),this.checkboxes=[],this.identifier=E,this.idList=[],this.buttonsDisabled=null,this.popupBalance=1e4,this.currentBalance=0,this.cashierID=null,this.inputType="password",this.password="",$.fn.dataTable.moment("DD/MM/YYYY, HH:mm:ss"),this.onDateChange=function(){A.period=3},this.onPeriodChanged=function(){switch(A.period){case"1":A.dateSettings.fromDate=moment().format("DD/MM/YYYY"),A.dateSettings.toDate=moment().format("DD/MM/YYYY");break;case"2":A.dateSettings.fromDate=moment().subtract(1,"day").format("DD/MM/YYYY"),A.dateSettings.toDate=moment().subtract(1,"day").format("DD/MM/YYYY");break;default:return}},this.isTableInitialized=function(){return $.fn.DataTable.isDataTable($("#searchResults"))},this.getDTLocaleUrl=function(){var a="//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/";switch(globalSettings.CurrentLanguage){case"es":return a+"Spanish.json";case"it":return a+"Italian.json";case"pt":return a+"Portuguese-Brasil.json";case"ro":return a+"Romanian.json";default:return a+"English.json"}},this.resetForm=function(){A.period=1,A.dateSettings.fromDate=moment().format("DD/MM/YYYY"),A.dateSettings.toDate=moment().format("DD/MM/YYYY"),A.copyDatesToService()},this.resetPassword=function(a){A.password="";var c=A.searchResults.find(function(b){return b[0]===a})[1],d=j.generateSwalResetPassword(c),e=h(d)(b);k.showMessageWithHtml(e,!0,locale.common.cancel,!0,locale.common.proceed,null,"cashier-sweet-alert").then(function(){p(a)}).catch(function(a){}).done()},this.updateBalance=function(a){return i("currencyFormat")(isNaN(A.currentBalance.replace(/,/g,""))?0:parseFloat(A.currentBalance.replace(/,/g,""))+a,2)},this.quickFillBalance=function(a){A.popupBalance=a},this.toggleInputType=function(){return"password"===A.inputType?A.inputType="text":A.inputType="password"},this.copyDatesToService=function(){c.fromDate=A.dateSettings.fromDate,c.toDate=A.dateSettings.toDate},this.loadBalance=function(a){A.popupBalance=u();var b=j.checkPrimitiveType(a),c="";switch(A.cashierID=a,C=!0,b){case"number":c=v(a),s(c,!0);break;case"undefined":s(c,!0);break;default:return}},this.unloadBalance=function(a){A.popupBalance=t(a);
var b=j.checkPrimitiveType(a),c="";switch(A.cashierID=a,C=!1,b){case"number":c=v(a),s(c,!1);break;case"undefined":s(c,!1);break;default:return}},this.toggleCheckboxes=function(){var a=A.checkboxes.filter(function(a){return a.checked}),b=[];_.forEach(a,function(a){b.push(a.id)}),angular.copy(b,A.idList)},this.toggleAllCheckboxes=function(){_.forEach(A.searchResults,function(a,b){_.forEach(a,function(c){_.forEach(A.cashiers,function(c){if(+c.UserId===a[0])return A.checkboxes[b].checked=!0,!1})})}),A.toggleCheckboxes()},this.unselectAllCheckboxes=function(){_.forEach(A.searchResults,function(a,b){_.forEach(a,function(c){_.forEach(A.cashiers,function(c){if(+c.UserId===a[0])return A.checkboxes[b].checked=!1,!1})})}),A.toggleCheckboxes()},this.disableSelectAll=function(){var a=A.checkboxes.filter(function(a){return a.checked});return!!_.isEmpty(A.cashiers)||a.length===A.checkboxes.length},this.disableUnselectAll=function(){var a=A.checkboxes.filter(function(a){return a.checked});return!!_.isEmpty(A.cashiers)||a.length<1},this.clearDataTableCache=function(a){l.dataTableCache[a]&&(l.dataTableCache[a].success=!1,l.dataTableCache[a].data.Data.length=0)},this.copyPeriodToService=function(){c.period=A.period},this.initializeSearch=function(){a.showLoader(),A.loading=!0;var b={Parameters:[{ParameterName:"DateFrom",ParameterValue:moment(A.dateSettings.fromDate,"DD/MM/YYYY").format("YYYY-MM-DD")+"T00:00:00"+moment.tz(moment.tz.guess()).format("Z")},{ParameterName:"DateTo",ParameterValue:moment(A.dateSettings.toDate,"DD/MM/YYYY").hours(23).minutes(59).seconds(59).milliseconds(999).format("YYYY-MM-DD")+"T23:59:59"+moment.tz(moment.tz.guess()).format("Z")}]};m.finance.getPlaySource("web").then(function(a){A.loggedInUserBalance=i("numberTruncate")(parseFloat(+a.data[0].Balance).toFixed(2)),l.getReportData(E,b).then(function(a){return a.success?a.data:void d.logError("Unable to get cashier summary: "+JSON.stringify(a.error))}).then(function(a){A.checkboxes.length=0,l.saveDataTableCache(E,angular.copy(a.Data,[])),angular.copy(j.generateCheckboxes(a.Data),A.checkboxes);var b=j.transformResponseForDataTable(a.Data,A.cashiers),c=j.calculateGrandTotals(a.Data),d=A.filterColumns(c);A.searchResults.length=0,angular.copy(b,A.searchResults),y(A.searchResults,d),w()}).catch(function(a){d.logError("Unable to get cashier summary: "+JSON.stringify(a)),w()})}).catch(function(a){console.error("Unable to get user balance: "+a)})},this.init=function(){z()},this.init()}angular.module("shopCashier",[]).controller("CashierController",a),a.$inject=["$rootScope","$scope","CashierService","loggingService","$timeout","$sessionStorage","authService","$compile","$filter","CashierHelperFunctions","helperService","ReportsService","platformApiService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(){n.loading=!1,a.hideLoader()}function l(a,b){j(function(){n.isTableInitialized()&&$("#searchResults").dataTable().api().destroy(),$("#searchResults").dataTable({dom:'<"top"if>rt<"bottom"pl><"clear">',data:a,columns:b,pageLength:10,order:[[2,"desc"]],bSort:!1,stateSave:!0,language:{url:n.getDTLocaleUrl()},footerCallback:function(a,b,c,d,e){$("#searchResults tfoot tr td").attr("colspan",12),$(".dataTables_length select").wrap("<span class='cashier-select-wrapper'></span>")}})})}var m=e.getUserData().currency.CurrencySymbol,n=this;h.fromDate=h.fromDate||moment().format("DD/MM/YYYY"),h.toDate=h.toDate||moment().format("DD/MM/YYYY");var o={Parameters:[{ParameterName:"UserID",ParameterValue:b.params.userId},{ParameterName:"DateFrom",ParameterValue:moment(h.fromDate,"DD/MM/YYYY").format("YYYY-MM-DD")+"T00:00:00"+moment.tz(moment.tz.guess()).format("Z")||moment().format("YYYY-MM-DD")+"T00:00:00"+moment.tz(moment.tz.guess()).format("Z")},{ParameterName:"DateTo",ParameterValue:moment(h.toDate,"DD/MM/YYYY").hours(23).minutes(59).seconds(59).milliseconds(999).format("YYYY-MM-DD")+"T23:59:59"+moment.tz(moment.tz.guess()).format("Z")||moment().hours(23).minutes(59).seconds(59).milliseconds(999).format("YYYY-MM-DD")+"T23:59:59"+moment.tz(moment.tz.guess()).format("Z")}]},p=b.params.reportIdentifier;this.loading=!1,this.searchResults=[],$.fn.dataTable.moment("DD/MM/YYYY, HH:mm:ss"),this.isTableInitialized=function(){return $.fn.DataTable.isDataTable($("#searchResults"))},this.getDTLocaleUrl=function(){var a="//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/";switch(globalSettings.CurrentLanguage){case"es":return a+"Spanish.json";case"it":return a+"Italian.json";case"pt":return a+"Portuguese-Brasil.json";case"ro":return a+"Romanian.json";default:return a+"English.json"}},this.init=function(){a.showLoader(),n.loading=!0,g.getReportData(p,o).then(function(a){return a.success?a.data:void i.logError("Unable to get report data for "+p+": "+JSON.stringify(a.error))}).then(function(a){var b=g.transformResponseForDataTable(a.Data,p);n.searchResults.length=0,angular.copy(b,n.searchResults),l(n.searchResults,g.generateColumns(p,m)),k()}).catch(function(a){i.logError("Unable to get report data for "+p+": "+JSON.stringify(response.error)),k()})},this.init()}angular.module("shopCashier").controller("CashierReportController",a),a.$inject=["$rootScope","$state","$filter","$scope","authService","$compile","ReportsService","CashierService","loggingService","$timeout"]}(),function(){"use strict";function a(a,b,c,d,e,f){function g(a){for(var b=[],c=0;c<a;)c++,b.push(c);return b}function h(){c.getUserList(j,k,l,m).then(function(a){return a.success?a.data:void d.logError("Unable to get users list: "+JSON.stringify(a.error))}).then(function(a){angular.copy(a,i.agents),i.agent=i.agents.length?i.agents[0].UserId:""}).catch(function(a){d.logError("Unable to get users list: "+JSON.stringify(a))})}var i=this,j="",k=!0,l=!1,m=!0;this.agents=[],this.agent="",this.numberOfCashiersToAdd=1,this.cashiersToAdd=g(20),this.resetForm=function(){i.numberOfCashiersToAdd=1,i.agent=""},this.addCashiers=function(){var a={NumberOfCashiers:i.numberOfCashiersToAdd,TpsUserIdShopOwner:i.agent};c.addCashiers(globalSettings.PlatformAPIClientIdentifier,a).then(function(a){if(!a.success){var b=e.handlePlatformError(a);return b||e.showErrorMessage(a.userMsg).done(),void d.logError("Unable to add cashiers: "+JSON.stringify(a.error))}e.showSuccessMessage(a.userMsg).done(),i.resetForm()}).catch(function(a){d.logError("Unable to add cashiers: "+JSON.stringify(error))})},this.init=function(){h()},this.init()}angular.module("shopCashierRegistration",[]).controller("CashierRegistrationController",a),a.$inject=["$rootScope","$scope","CashierService","loggingService","helperService","authService"]}(),function(){angular.module("shopDigitalAcceptance",["digitalAcceptance.service"]).controller("DigitalAcceptanceController",["$scope","$q","authService","digitalAcceptanceService","acceptedAgreements",function(a,b,c,d,e){var f=this;this.agreementTypes=d.agreementTypes,this.acceptedAgreements=e,this.selectedAgreementType=-1,this.selectedAgreement=null,this.onTabClicked=function(a){if(f.selectedAgreementType=a,f.selectedAgreement=_.find(f.acceptedAgreements,{agreementType:a}),void 0!=f.selectedAgreement){var b=c.getUserData(),d=f.selectedAgreement.content;if(1==f.selectedAgreement.agreementType){var e=f.selectedAgreement.agreementMessage,g=new RegExp(e,"g"),h=f.selectedAgreement.acceptedAgreementText+" "+b.firstName+" "+b.lastName+" "+locale.common.on+" "+f.selectedAgreement.acceptanceDate;d=d.replace(g,h)}else if(2==f.selectedAgreement.agreementType){var e=f.selectedAgreement.tandcMessage,g=new RegExp(e,"g"),h=f.selectedAgreement.acceptedTandCMessage+" "+b.firstName+" "+b.lastName+" "+locale.common.on+" "+f.selectedAgreement.acceptanceDate;d=d.replace(g,h)}f.selectedAgreement.content=d}},this.onPrintButtonClicked=function(){d.printDocument($(".accepted-digital-agreement").html())},this.onTabClicked(Object.values(d.agreementTypes)[0])}]).controller("DigitalAcceptanceModalController",["$rootScope","$scope","$q","authService","digitalAcceptanceService",function(a,b,c,d,e){var f=this;this.agreementTypes=e.agreementTypes,this.unacceptedAgreements=[],this.isModalVisible=!1,this.isMainPanelVisible=!0,this.isAcceptedPopupVisible=!1,this.isCancelPopupVisible=!1,this.selectedIndex=0,this.proceedButtonEnabled=!1,this.dataUpdated=!1,this.resetModalStatus=function(){f.isModalVisible=!1,f.isMainPanelVisible=!0,f.isAcceptedPopupVisible=!1,f.isCancelPopupVisible=!1,f.selectedIndex=0,f.proceedButtonEnabled=!1,f.dataUpdated=!1},this.showModal=function(){f.resetModalStatus(),e.getLatestAgreements().then(function(a){if(a&&a.agreements.length&&(f.unacceptedAgreements=_.filter(a.agreements,{isAccepted:!1}),f.unacceptedAgreements.length)){var b=[];f.unacceptedAgreements.forEach(function(a){b.push(f.getAgreementContent(a))}),c.all(b).then(function(a){f.isModalVisible=!0,f.unacceptedAgreements.forEach(function(a){a.version==a.savedDetails.displayVersion.value&&a.savedDetails.displayDate.value||e.markAsDisplayed(a).then(function(){f.dataUpdated=!0})})})}})},this.closeModal=function(){f.dataUpdated&&e.getLatestAgreements(!0),f.isModalVisible=!1},this.showProceedPopup=function(){f.isMainPanelVisible=!1,f.isAcceptedPopupVisible=!0,f.isCancelPopupVisible=!1},this.showCancelPopup=function(){f.isMainPanelVisible=!1,f.isAcceptedPopupVisible=!1,f.isCancelPopupVisible=!0},this.closePopups=function(){f.isMainPanelVisible=!0,f.isAcceptedPopupVisible=!1,f.isCancelPopupVisible=!1},this.getAgreementContent=function(a){var b=c.defer();return a.content?b.resolve():e.getAgreementDetails(a.agreementType,a.version).then(function(c){a.content=c?c.content:"",b.resolve()}),b.promise},this.onAgreementTabClicked=function(a){f.selectedIndex=a},this.onAgreementCheckboxClicked=function(){f.proceedButtonEnabled=_.every(f.unacceptedAgreements,["userConfirmedCheckbox",!0])},this.onPrintButtonClicked=function(){e.printDocument($(".selected-agreement").html())},this.onCancelButtonClicked=function(){f.showCancelPopup()},this.onProceedButtonClicked=function(){var b=[];f.unacceptedAgreements.forEach(function(a){a.userConfirmedCheckbox&&b.push(e.markAsAccepted(a))}),a.showLoader(".digital-acceptance-panel",null),c.all(b).then(function(b){a.hideLoader(".digital-acceptance-panel"),f.dataUpdated=!0,f.showProceedPopup()})},b.$on("digitalAcceptanceService:triggerModal",function(a){f.showModal()})}])}(),function(){angular.module("digitalAcceptance.service",[]).service("digitalAcceptanceService",["$rootScope","$q","$localStorage","authService","umbracoApiService","platformApiService","loggingService",function(a,b,c,d,e,f,g){var h=null,i=function(a){h=a},j=function(){h={displayModal:!1,agreements:[]}},k=function(){return c.daModalLog||{}},l=function(a){var b=k(),c=b[a];return c?moment(c).startOf("day"):null},m=function(a){var b=k();b[a]=moment().valueOf(),c.daModalLog=b},n={agreementTypes:{agentAgreement:1,agentTerms:2,websiteTerms:3},agentTypes:{masterAgent:1,superAgent:2,agent:3},getLatestAgreements:function(c,k){var l=b.defer();if(c=null!=c&&c,k=null!=k&&k,d.isAgent()&&d.getAgentType(d.getUserData().userType)!==d.agentTypes.cashier)if(h&&!c)l.resolve(h);else{j();var n=d.getUserData(),p=d.getAgentType(n.userType),q=e.desktop.getLatestDigitalAcceptanceByAgent(n.userID,p),r=f.user.getUserExtraDetails();b.all([q,r]).then(function(b){var c=b?b[0]:null,d=b?b[1]:null;if(c&&c.success&&c.data)if(d&&d.success&&d.data){var e=o(c.data,d.data,n.userID);i(e),a.$broadcast("digitalAcceptanceService:statusUpdated",e),e.displayModal&&k&&(a.$broadcast("digitalAcceptanceService:triggerModal"),m(n.userID)),l.resolve(e)}else g.logError("Unable to get user extra details: "+d.error,d.userMsg),l.reject();else g.logError("Unable to get latest digital acceptance"),l.reject()})}else j(),l.resolve(h);return l.promise},getAcceptedAgreements:function(){var a=b.defer();return d.isAgent()&&d.getAgentType(d.getUserData().userType)!==d.agentTypes.cashier?f.user.getUserExtraDetails().then(function(c){if(c&&c.success&&c.data){var d={};c.data.forEach(function(a){d[a.PropertyName]=a.PropertyValue});var e=[];Object.values(n.agreementTypes).forEach(function(a){var b,c;switch(a){case n.agreementTypes.agentAgreement:b="AgentAgreement.AcceptanceVersion",c="AgentAgreement.AcceptanceDate";break;case n.agreementTypes.agentTerms:b="AgentTerms.AcceptanceVersion",c="AgentTerms.AcceptanceDate";break;case n.agreementTypes.websiteTerms:b="WebsiteTerms.AcceptanceVersion",c="WebsiteTerms.AcceptanceDate";break;default:return void g.logError("Unknown digital acceptance agreement type: "+a)}e.push(p(a,d[b],d[c]))}),b.all(e).then(function(b){a.resolve(b)})}else g.logError("Unable to get user extra details: "+c.error,c.userMsg),a.reject()}):a.resolve([]),a.promise},getAgreementDetails:function(a,c){var f=b.defer(),h=d.getUserData(),i=d.getAgentType(h.userType),j=n.agentTypes[i];return e.desktop.getDigitalAcceptanceAgreement(h.userID,j,a,c).then(function(a){if(a&&a.success&&a.data){var b=a.data.content;b=b.replace(/@shopAgentFirstname|@shopSuperAgentFirstname/gi,h.firstName),b=b.replace(/@shopAgentLastname|@shopSuperAgentLastname/gi,h.lastName);var c="<img src="+a.data.signature+' width="10%" />';b=b.replace(/@signatureCEO/gi,c),a.data.content=b,f.resolve(a.data)}else g.logError("Unable to get digital acceptance agreement details"),f.resolve()}),f.promise},markAsDisplayed:function(a){var c=b.defer(),d={ExtraDetails:[{PropertyName:a.savedDetails.displayVersion.key,PropertyValue:a.version},{PropertyName:a.savedDetails.displayDate.key,PropertyValue:moment().format()}]};return f.user.setUserExtraDetails(d).then(function(a){a&&a.success?c.resolve():(g.logError("Unable to mark agreement as displayed"),c.reject())}),c.promise},markAsAccepted:function(a){var c=b.defer(),d={ExtraDetails:[{PropertyName:a.savedDetails.acceptanceVersion.key,PropertyValue:a.version},{PropertyName:a.savedDetails.acceptanceDate.key,PropertyValue:moment().format()}]};return f.user.setUserExtraDetails(d).then(function(a){a&&a.success?c.resolve():(g.logError("Unable to mark agreement as accepted"),c.reject())}),c.promise},showModal:function(){d.isAgent()&&d.getAgentType(d.getUserData().userType)!==d.agentTypes.cashier&&a.$broadcast("digitalAcceptanceService:triggerModal")},printDocument:function(a){var b=document.createElement("iframe");b.style.visibility="hidden",b.style.position="absolute",document.body.appendChild(b),b.contentWindow.document.write(a),b.contentWindow.document.close(),b.contentWindow.print(),document.body.removeChild(b)}},o=function(a,b,c){var d={displayModal:!1,agreements:[]},e=l(c),f=moment().startOf("day"),h={};return b.forEach(function(a){h[a.PropertyName]=a.PropertyValue}),a.forEach(function(a){var b,c,i,j;switch(a.agreementType){case n.agreementTypes.agentAgreement:b="AgentAgreement.DisplayVersion",c="AgentAgreement.DisplayDate",i="AgentAgreement.AcceptanceVersion",j="AgentAgreement.AcceptanceDate";break;case n.agreementTypes.agentTerms:b="AgentTerms.DisplayVersion",c="AgentTerms.DisplayDate",i="AgentTerms.AcceptanceVersion",j="AgentTerms.AcceptanceDate";break;case n.agreementTypes.websiteTerms:b="WebsiteTerms.DisplayVersion",c="WebsiteTerms.DisplayDate",i="WebsiteTerms.AcceptanceVersion",j="WebsiteTerms.AcceptanceDate";break;default:return void g.logError("Unknown digital acceptance agreement type: "+a.agreementType)}var k=_.merge(a,{isAccepted:!1,remainingDays:isNaN(globalSettings.Shop_DA_DaysToAccept)?0:parseInt(globalSettings.Shop_DA_DaysToAccept),deadlineExceeded:!1,savedDetails:{displayVersion:{key:b,value:h[b]},displayDate:{key:c,value:h[c]},acceptanceVersion:{key:i,value:h[i]},acceptanceDate:{key:j,value:h[j]}}});if(h[i]==a.version)k.isAccepted=!0;else if(h[b]&&h[b]==a.version){var l=globalSettings.Shop_DA_DaysToAccept-globalSettings.Shop_DA_RemainingDaysToForceModal,m=moment(h[c]),o=moment().diff(m,"days"),p=globalSettings.Shop_DA_DaysToAccept-o;p>0?k.remainingDays=p:(k.remainingDays=0,k.deadlineExceeded=!0),(null==e||e.isBefore(f)||o>=l)&&(d.displayModal=!0)}else d.displayModal=!0;d.agreements.push(k)}),d},p=function(a,c,d){var e=b.defer();return c?n.getAgreementDetails(a,c).then(function(a){if(a){var b=_.merge(a,{acceptanceDate:d?moment(d).format("DD/MM/YYYY"):null});e.resolve(b)}else e.resolve()}):e.resolve(),e.promise};return n}])}(),function(){angular.module("shopHome",[]).controller("ShopHomeController",["$q","$rootScope","authService","sportsApiService","platformApiService","helperService","loggingService","$window","$state","$scope","$localStorage","shopPermissionsService","virtualsService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a){var b=l.statePermissions[a];return null==b||!(!c.hasValidLogin()||!c.isAgent())&&b.indexOf(c.getAgentType(c.getUserData().userType))>=0}var o=this,p=e.finance;this.isLoggedIn=!1,this.agentType="",this.agentTypes=c.agentTypes,this.currencySymbol="",this.balanceDate=new Date,this.companyOwesYou=0,this.liabilityThreshold=0,this.creditBalance=null,this.userData={},this.isVirtualsEnabled=c.isVirtualsEnabled(),this.isGoldenRaceEnabled=c.isGoldenRaceEnabled(),this.redirectPage=function(a){switch(a){case"printodds":i.go("shopStandardPrint",{});break;case"placebet":f.goToUmbracoPage("sports","sportsEventsPrematchBySport",{sport:1});break;case"goldenracecashier":m.getGoldenRaceCashierUrl().then(function(a){a&&h.open(a,"_blank")});break;case"globalbetcashier":h.open("/global-bet-cashier/","_blank");break;case"reports":var b=n("shopCommissionsReports"),c=n("shopSalesReports");i.go("shopReports",{reportType:b?1:c?2:3,reportTab:0})}},this.getLiabilityScore=function(){var c=a.defer();return b.showLoader("#balance","element-small"),p.getLiabilityScore(o.userData.UserID,moment().format("YYYY-MM-DDTHH:mm:ss")).then(function(a){return a.success?(b.hideLoader("#balance"),o.companyOwesYou=a.data,void c.resolve()):(g.logError("Unable to get Liability Score: "+a.error,a.userMsg),void b.hideLoader("#balance"))}),p.getLiabilityThreshold(o.userData.UserID).then(function(a){return a.success?(b.hideLoader("#balance"),o.liabilityThreshold=a.data,void c.resolve()):(g.logError("Unable to get Liability Threshold: "+a.error,a.userMsg),void b.hideLoader("#balance"))}),c.promise},this.getCreditBalance=function(){var c=a.defer();return b.showLoader("#balance","element-small"),p.getCreditBalance().then(function(a){return a.success?(b.hideLoader("#balance"),o.creditBalance=a.data,void c.resolve()):(g.logError("Unable to get Credit Balance: "+a.error,a.userMsg),void b.hideLoader("#balance"))}),c.promise},this.couponCheckKeyUp=function(a){var b=$(a.currentTarget),c=b.val();a.which=a.which||a.keyCode,9!=a.which&&13!=a.which||o.couponCheckClick(c)},this.couponCheckClick=function(a){var b=a||$("#txtCouponCheck").val();null==b||b.trim().length<=0||d.coupon.getCouponByCodeNoCheck(b,globalSettings.CurrentLanguage).then(function(a){if(a.success&&null!=a.data&&0!=a.data.CouponId){var c="/coupon-details-iframe/?couponCode="+b;$.fancybox({modal:!1,showCloseButton:!0,hideOnContentClick:!1,hideOnOverlayClick:!0,width:925,height:530,type:"iframe",padding:2,margin:0,fitToView:!1,autoSize:!1,href:c,afterShow:function(){var a='<div class="fancybox-custom-content panel panel-custom no-brand-footer"> <div class="panel-heading w-icon"> <h3 class="panel-title"> <i class="fa fa-list fa-fw"></i> <span>'+locale.account.betSearch.couponDetailsGeneric.toUpperCase()+"</span> </h3> </div></div>";$(".fancybox-outer").prepend(a)}})}else e.gamingVendors.sportsbook.checkCouponRefundStatus(b).then(function(a){return a.success?a.data.IsRefunded?f.showInfoMessage(locale.sports.coupon.verifyCoupon.couponRefunded).done():f.showInfoMessage(locale.sports.coupon.verifyCoupon.couponInReview).done():f.showErrorMessage(locale.sports.coupon.verifyCoupon.couponNotFound).done()})})},this.oddsSearchKeyUp=function(a){var b=$(a.currentTarget),c=b.val();a.which=a.which||a.keyCode,9!=a.which&&13!=a.which||o.oddsSearchClick(c)},this.oddsSearchClick=function(a){var b=a||$("#txtOddsSearch").val();null==b||b.trim().length<=0||f.goToUmbracoPage("sports","sportsSearch",{searchQuery:b})},c.hasValidLogin()&&c.isAgent()&&void 0!=c.getUserData()&&(this.isLoggedIn=!0,this.agentType=c.getAgentType(c.getUserData().userType),this.currencySymbol=c.getUserData().currency.CurrencySymbol,this.userData={UserID:c.getUserData().userID,parentUserID:c.getUserData().parentUserID,parentUserFirstName:c.getUserData().parentFirstName,parentUserLastName:c.getUserData().parentLastName,parentEmail:c.getUserData().parentEmail,parentMobileNumber:c.getUserData().parentMobileNumber,parentHomeNumber:c.getUserData().parentHomeNumber},this.parentAgentType=c.getAgentType(c.getUserData().parentUserType),this.agentType==o.agentTypes.agent&&(this.getLiabilityScore(),this.getCreditBalance())),this.openCashier=function(){o.popup=window.open(globalSettings.Shop_BtgVirtual,"_blank");const a=(k.userData,setInterval(function(){o.popup.postMessage(window.localStorage.getItem("userData"),globalSettings.Shop_BtgVirtual)},200)),b=function(b){"I've received the message"===b.data&&clearInterval(a)};setTimeout(function(){a&&clearInterval(a)},3e4),window.addEventListener("message",b,!1)}}])}(),function(){angular.module("shopMarketingDetails",[]).controller("ShopMarketingDetailsController",["$uiRouterGlobals","$sce","umbracoApiService",function(a,b,c){var d=this;this.pageTitle="",this.htmlContent="";var e=a.params.pageId||-1;c.desktop.getMarketingDetails(e).then(function(a){return a.success?(d.pageTitle=a.data.pageTitle,void(d.htmlContent=b.trustAsHtml(a.data.htmlContent))):void loggingService.logError("Unable to get marketing details: "+JSON.stringify(a.error))})}])}(),function(){"use strict";angular.module("shopReports",[]).controller("ReportsController",["$rootScope","$scope","$state","$uiRouterGlobals","loggingService","sportsApiService","$timeout","$sessionStorage","authService","$compile","$filter","helperService","ReportsService","$transitions","platformApiService","websiteApiService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a){var b={Parameters:[{ParameterName:"DateFrom",ParameterValue:moment(t.dateSettings.fromDate,"DD/MM/YYYY").format("YYYY-MM-DD")+"T00:00:00"+moment.tz(moment.tz.guess()).format("Z")},{ParameterName:"DateTo",ParameterValue:moment(t.dateSettings.toDate,"DD/MM/YYYY").hours(23).minutes(59).seconds(59).milliseconds(999).format("YYYY-MM-DD")+"T23:59:59"+moment.tz(moment.tz.guess()).format("Z")},{ParameterName:"IsSettled",ParameterValue:t.isSettled}]},c={Parameters:[{ParameterName:"DateFrom",ParameterValue:moment(t.dateSettings.fromDate,"DD/MM/YYYY").format("YYYY-MM-DD")+"T00:00:00"+moment.tz(moment.tz.guess()).format("Z")},{ParameterName:"DateTo",ParameterValue:moment(t.dateSettings.toDate,"DD/MM/YYYY").hours(23).minutes(59).seconds(59).milliseconds(999).format("YYYY-MM-DD")+"T23:59:59"+moment.tz(moment.tz.guess()).format("Z")},{ParameterName:"IsSettled",ParameterValue:t.isSettled}]},d=t.showAgentList||t.showShopOwnerList?c:b;switch(a){case"agentSales":case"allProductAnalysis":case"allProducts":case"globalbetProduct":case"goldenRaceProduct":case"sportsbookBetsByUser":case"sportsbookProduct":d.Parameters.push({ParameterName:"UserId",ParameterValue:t.showAgentList?t.selectedAgent:i.getUserData().userID});break;case"bKVAnalysisCommission":case"gBColorAnalysisCommission":case"gBVirtualAnalysisCommission":case"bKVMobileAnalysisCommission":case"lotSpecialFiveAnalysisCommission":case"lotDailyDrawAnalysisCommission":case"vDogRaceAnalysisCommission":case"spin2WinAnalysisCommission":case"gRLuckyBallCommissionEstimate":case"sportsAnalysisCommission":d.Parameters.push({ParameterName:"UserId",ParameterValue:t.showShopOwnerList?t.selectedShopOwner:i.getUserData().userID});break;default:d.Parameters.push({ParameterName:"UserId",ParameterValue:i.getUserData().userID})}switch(a){case"allProducts":case"sportsbookProduct":case"globalbetProduct":case"goldenRaceProduct":case"liabilityAudit":angular.copy(d.Parameters.filter(function(a){return"DateFrom"===a.ParameterName||"DateTo"===a.ParameterName||t.showAgentList&&"UserId"===a.ParameterName}),w.Parameters);break;case"creditBalance":angular.copy(d.Parameters.filter(function(a){return"DateFrom"===a.ParameterName||"DateTo"===a.ParameterName||"UserId"===a.ParameterName}),w.Parameters);break;case"liabilityOverview":var e=d.Parameters.filter(function(a){return"DateFrom"===a.ParameterName});e[0].ParameterName="Day",angular.copy(e,w.Parameters);break;case"agentCommission":angular.copy(d.Parameters.filter(function(a){return"DateFrom"===a.ParameterName||"UserId"===a.ParameterName}),w.Parameters),w.Parameters.push({ParameterName:"DateTo",ParameterValue:moment(t.dateSettings.toDate,"DD/MM/YYYY").format("YYYY-MM-DD")+"T00:00:00"+moment.tz(moment.tz.guess()).format("Z")}),w.Parameters.push({ParameterName:"Retail",ParameterValue:t.isRetail}),d.Parameters=w.Parameters;break;case"agentSales":case"agentVirtualSales":case"allProductAnalysis":case"agentLotterySales":angular.copy(d.Parameters.filter(function(a){return"DateFrom"===a.ParameterName||"UserId"===a.ParameterName||"DateTo"===a.ParameterName}),w.Parameters),w.Parameters.push({ParameterName:"Retail",ParameterValue:t.isRetail}),d.Parameters=w.Parameters;break;default:angular.copy(d,w)}}function r(){t.searchInProgress=!1,a.hideLoader(".Centralbody"),a.hideLoader("#reportsContent"),a.hideLoader()}function s(a,d,e,f,h){if(u===c.router.urlService.path()){var i,k="#searchResults";e?k+="Export":f?k="#open-bets":h&&(k="#open-bets-export"),g(function(){if(t.isTableInitialized()&&$("#searchResults").dataTable().api().destroy(),"#open-bets"===k)var e=$(k).DataTable({data:a,columns:d,paging:!1,stateSave:!0,searching:!1,ordering:!1,info:!1,language:{url:t.getDTLocaleUrl()}});else var e=$(k).DataTable({dom:'<"top"if>rt<"bottom"pBl><"clear">',oLanguage:{sLengthMenu:"Rows per page _MENU_"},data:a,paging:!0,columns:d,pageLength:10,bSort:!1,buttons:[{extend:"excel",text:'<i class="fa fa-file-text-o"></i>&emsp;Export to Excel',charset:"utf-8",bom:!0},{extend:"csv",text:'<i class="fa fa-file-text-o"></i>&emsp;Export to CSV',charset:"utf-8",bom:!0}],stateSave:!0,language:{url:t.getDTLocaleUrl()},createdRow:function(a,c,d){j(angular.element(a).contents())(b)}});$(k).on("click","td.details-control",function(){var a=$(this).closest("tr"),b=e.row(a);if("Grand Total"!==b.data().channel){if(b.child.isShown()){b.child.hide(),a.removeClass("shown");var d=a.find("i:first-child");d.hasClass("fa-caret-down")&&(d.removeClass("fa-caret-down"),d.addClass("fa-caret-right"))}else{b.child(t.format(b.data(),k)).show(),a.addClass("shown");var d=a.find("i:first-child");d.hasClass("fa-caret-right")&&(d.removeClass("fa-caret-right"),d.addClass("fa-caret-down")),("reportAgentSales"===t.reportIdentifier||"reportAgentVirtualSales"===t.reportIdentifier||"reportAgentLotterySales"===t.reportIdentifier&&"#open-bets"!==k)&&$("#inner-table").on("click","td",function(){if(i){var a=$(this).closest("tr").find("i:first-child");return a.hasClass("fa-caret-down")&&(a.removeClass("fa-caret-down"),a.addClass("fa-caret-right")),i.destroy(),i=void 0,void($("#child-table")[0].innerHTML="")}var c=$(this).closest("tr"),a=c.find("i:first-child");a.hasClass("fa-caret-right")&&(a.removeClass("fa-caret-right"),a.addClass("fa-caret-down"));var d,e=c.children()[1].innerText,f=b.data();f.data.forEach(function(a){a.userName===e&&(d=a.data)}),i=$("#child-table").DataTable({data:d,columns:m.generateColumns(t.reportName+"InnerChild",t.currencySymbol,t.isSettled),order:[[1,"asc"]],paging:!1,stateSave:!0,searching:!1,ordering:!1,info:!1,language:{url:t.getDTLocaleUrl()},fnDrawCallback:function(){$("#child-table thead").remove(),$($("#child-table tbody tr")[0]).children().each(function(a){$(this).innerWidth($($($("#searchResults thead tr")[0]).children()[a]).innerWidth())}),$($("table#open-bets tbody tr td:first-child")[0]).trigger("click")}})})}$(".innerTable").on("click","td",function(){var a=$(this).closest("tr");if("reportSportsAnalysisCommission"===t.reportIdentifier||"reportBKVAnalysisCommission"===t.reportIdentifier||"reportBKVMobileAnalysisCommission"===t.reportIdentifier||"reportGBVirtualAnalysisCommission"===t.reportIdentifier||"reportLotSpecialFiveAnalysisCommission"===t.reportIdentifier||"reportLotDailyDrawAnalysisCommission"===t.reportIdentifier||"reportVDogRaceAnalysisCommission"===t.reportIdentifier||"reportSpin2WinAnalysisCommission"===t.reportIdentifier||"reportGRLuckyBallCommissionEstimate"===t.reportIdentifier||"reportGBColorAnalysisCommission"===t.reportIdentifier){"reportBKVMobileAnalysisCommission"===t.reportIdentifier?w.Parameters.push({ParameterName:"CommissionBand",ParameterValue:a[0].children[6].innerText},{ParameterName:"SelectedDate",ParameterValue:a[0].children[2].innerText}):"reportLotSpecialFiveAnalysisCommission"===t.reportIdentifier||"reportLotDailyDrawAnalysisCommission"===t.reportIdentifier?w.Parameters.push({ParameterName:"Selection",ParameterValue:a[0].children[4].innerText},{ParameterName:"SelectedDate",ParameterValue:a[0].children[2].innerText}):"reportGRLuckyBallCommissionEstimate"===t.reportIdentifier?w.Parameters.push({ParameterName:"Selection",ParameterValue:a[0].children[6].innerText},{ParameterName:"SelectedDate",ParameterValue:a[0].children[3].innerText}):w.Parameters.push({ParameterName:"CommissionBand",ParameterValue:a[0].children[4].innerText},{ParameterName:"SelectedDate",ParameterValue:a[0].children[2].innerText});var b=0;switch(t.reportIdentifier){case"reportSportsAnalysisCommission":b=1;break;case"reportBKVAnalysisCommission":b=2;break;case"reportGBVirtualAnalysisCommission":b=3;break;case"reportGBColorAnalysisCommission":b=4;break;case"reportBKVMobileAnalysisCommission":b=5;break;case"reportLotSpecialFiveAnalysisCommission":b=6;break;case"reportLotDailyDrawAnalysisCommission":b=7;break;case"reportVDogRaceAnalysisCommission":b=8;break;case"reportSpin2WinAnalysisCommission":b=9;break;case"reportGRLuckyBallCommissionEstimate":b=10;break;default:b=0}return m.setSearchParams(w),void c.go("shopReportDetails",{reportId:t.reportIdentifier,reportTab:b})}})}})})}}var t=this;this.maxDateMobileVirtualReport=new Date("2020-04-12"),this.disclaimerLocale=locale.account.shopWebsite.reports.mobileVirtuals.disclaimer||"";var u;this.currencySymbol=i.hasValidLogin()&&i.getUserData()?i.getUserData().currency.CurrencySymbol:"";var v=i.agentTypes,w={Parameters:[]};switch(this.showBonus="",t.reportIdentifier="",this.reportType=6,this.isRetail=null,this.showMonthlyBonusCalculation=!(!i.hasValidLogin()||!i.getUserData()||i.getAgentType(i.getUserData().userType)===i.agentTypes.superAgent||i.getAgentType(i.getUserData().userType)===i.agentTypes.masterAgent),this.grandTotal={},this.summery={stake:"0",winnings:"0",grossProfit:"0",PerCentGrossProfit:"0",commission:"0",bonus:"Not Applicable"},this.assistantProgram={totalAssistanceAmount:0,totalAmountRepaid:0,totalOutstandingAmount:0,nextDueDate:"",nextDueAmount:0,dueAmountTopay:0,loanIssueDate:"",repaymentData:[]},this.onReportTypeChanged=function(){"4"===t.reportType?t.isRetail="1":"5"===t.reportType?t.isRetail="0":t.isRetail=null},this.selectedAgent="",this.selectedShopOwner="",this.directDesendentAgent=[],this.shopOwnerList=[],this.showAgentList=!(!i.hasValidLogin()||!i.getUserData()||v.masterAgent!==i.getAgentType(i.getUserData().userType)),this.showShopOwnerList=!(!i.hasValidLogin()||!i.getUserData()||v.masterAgent!==i.getAgentType(i.getUserData().userType)&&v.superAgent!==i.getAgentType(i.getUserData().userType)),this.searchInProgress=!1,this.isSettled=!1,this.showChannels={0:!0},this.userDataHider={"00":!0},this.tabMenuStructure=[],this.isCommisionReport=!1,this.fullPaymentReceived=!1,this.loanId=0,d.params.reportType){case"1":this.fullTabMenuStructure=[{sectionTitle:locale.account.shopWebsite.reports.commissionAnalysis.titles.agentCommission,sectionName:"agentCommission",access:[v.masterAgent,v.superAgent,v.agent]},{sectionTitle:locale.account.shopWebsite.reports.commissionAnalysis.titles.sportsAnalysis,sectionName:"sportsAnalysisCommission",access:[v.masterAgent,v.superAgent,v.agent]},{sectionTitle:locale.account.shopWebsite.reports.commissionAnalysis.titles.betKingVirtualAnalysis,
sectionName:"bKVAnalysisCommission",access:[v.masterAgent,v.superAgent,v.agent]},{sectionTitle:locale.account.shopWebsite.reports.commissionAnalysis.titles.globalBetVirtualAnalysis,sectionName:"gBVirtualAnalysisCommission",access:[v.masterAgent,v.superAgent,v.agent]},{sectionTitle:locale.account.shopWebsite.reports.commissionAnalysis.titles.globalBetColorColorAnalysis,sectionName:"gBColorAnalysisCommission",access:[v.masterAgent,v.superAgent,v.agent]},{sectionTitle:locale.account.shopWebsite.reports.commissionAnalysis.titles.betKingMobileVirtualAnalysis,sectionName:"bKVMobileAnalysisCommission",access:[v.masterAgent,v.superAgent,v.agent]},{sectionTitle:locale.account.shopWebsite.reports.commissionAnalysis.titles.virtualDogRaceAnalysis,sectionName:"vDogRaceAnalysisCommission",access:[v.masterAgent,v.superAgent,v.agent]},{sectionTitle:locale.account.shopWebsite.reports.commissionAnalysis.titles.virtualSpin2WinAnalysis,sectionName:"spin2WinAnalysisCommission",access:[v.masterAgent,v.superAgent,v.agent]},{sectionTitle:locale.account.shopWebsite.reports.commissionAnalysis.titles.virtualLuckyBallAnalysis,sectionName:"gRLuckyBallCommissionEstimate",access:[v.masterAgent,v.superAgent,v.agent]}],globalSettings.Reports_EnableLottery&&this.fullTabMenuStructure.push({sectionTitle:locale.account.shopWebsite.reports.commissionAnalysis.titles.lotSpecialFiveAnalysis,sectionName:"lotSpecialFiveAnalysisCommission",access:[v.masterAgent,v.superAgent,v.agent]},{sectionTitle:locale.account.shopWebsite.reports.commissionAnalysis.titles.lotDailyAnalysis,sectionName:"lotDailyDrawAnalysisCommission",access:[v.masterAgent,v.superAgent,v.agent]}),globalSettings.Shop_GBVirtual||this.fullTabMenuStructure.splice(3,2),globalSettings.Shop_BtgVirtual||this.fullTabMenuStructure.splice(2,1),t.isCommisionReport=!0;break;case"2":this.fullTabMenuStructure=[{sectionTitle:locale.account.shopWebsite.reports.allProductAnalysis.title,sectionName:"allProductAnalysis",access:[v.masterAgent,v.superAgent,v.agent]},{sectionTitle:locale.account.shopWebsite.reports.agentSales.title,sectionName:"agentSales",access:[v.masterAgent,v.superAgent,v.agent]},{sectionTitle:locale.account.shopWebsite.reports.titles.virtualsByChannel,sectionName:"agentVirtualSales",access:[v.masterAgent,v.superAgent,v.agent]}],globalSettings.Reports_EnableLottery&&this.fullTabMenuStructure.push({sectionTitle:locale.account.shopWebsite.reports.titles.lotteryByChannel,sectionName:"agentLotterySales",access:[v.masterAgent,v.superAgent,v.agent]}),globalSettings.Shop_BtgVirtual||this.fullTabMenuStructure.splice(2,1);break;case"3":this.fullTabMenuStructure=[{sectionTitle:locale.account.shopWebsite.reports.liabilityAudit.title,sectionName:"liabilityAudit",access:[v.agent]},{sectionTitle:locale.account.shopWebsite.reports.creditBalance.title,sectionName:"creditBalance",access:[v.superAgent,v.agent]},{sectionTitle:locale.account.shopWebsite.reports.liabilityOverview.title,sectionName:"liabilityOverview",access:[v.superAgent]},{sectionTitle:locale.account.shopWebsite.reports.assistanceProgram.title,sectionName:"assistantProgram",access:[v.agent]}]}this.isBetweenDates=function(a,b,c){if(moment(c,"DD/MM/YYYY").isSame(moment(a,"DD/MM/YYYY"))||moment(c,"DD/MM/YYYY").isSame(moment(b,"DD/MM/YYYY")))return!0;var d=moment(c,"DD/MM/YYYY").isBetween(moment(a,"DD/MM/YYYY"),moment(b,"DD/MM/YYYY"));return d},this.getDateArray=function(a,b){for(var c=new Array,d=new Date(a);d<=b;)c.push(moment(d.toLocaleDateString("en-US"),"MM/DD/YYYY").format("MM DD YYYY")),d.setDate(d.getDate()+1);return c},this.setLimitSearchDates=function(a){t.period=3;var b,c,d,e;return"reportAgentCommission"===t.reportIdentifier?("To"===a&&moment(t.dateSettings.toDate,"DD/MM/YYYY").isBefore(moment(t.dateSettings.fromDate,"DD/MM/YYYY"))&&(t.dateSettings.fromDate=moment(t.dateSettings.toDate,"DD/MM/YYYY").day(-6).format("DD/MM/YYYY")),void("From"===a&&moment(t.dateSettings.fromDate,"DD/MM/YYYY").isAfter(moment(t.dateSettings.toDate,"DD/MM/YYYY"))&&(t.dateSettings.toDate=moment(t.dateSettings.fromDate,"DD/MM/YYYY").day(7).format("DD/MM/YYYY")))):void(("reportSportsAnalysisCommission"!==t.reportIdentifier&&"reportBKVAnalysisCommission"!==t.reportIdentifier&&"reportBKVMobileAnalysisCommission"!==t.reportIdentifier&&"reportGBVirtualAnalysisCommission"!==t.reportIdentifier&&"reportLotSpecialFiveAnalysisCommission"!==t.reportIdentifier&&"reportLotDailyDrawAnalysisCommission"!==t.reportIdentifier&&"reportVDogRaceAnalysisCommission"!==t.reportIdentifier&&"reportSpin2WinAnalysisCommission"!==t.reportIdentifier&&"reportGRLuckyBallCommissionEstimate"!==t.reportIdentifier&&"reportGBColorAnalysisCommission"!==t.reportIdentifier||!t.setDateFiltersForCommissionReports(a))&&("From"===a?(b=t.dateSettings.fromDate,d=t.dateSettings.toDate,c=moment(t.dateSettings.fromDate,"DD/MM/YYYY").add(3,"month").format("DD/MM/YYYY"),moment(d,"DD/MM/YYYY").isBefore(moment(b,"DD/MM/YYYY"))&&(t.dateSettings.toDate=b,d=b),e=t.isBetweenDates(b,c,d),e||(t.dateSettings.toDate=c),t.dateSettings.toDate=moment(d,"DD/MM/YYYY").isAfter(moment())?moment().format("DD/MM/YYYY"):d):(c=t.dateSettings.toDate,d=t.dateSettings.fromDate,b=moment(t.dateSettings.toDate,"DD/MM/YYYY").subtract(3,"month").format("DD/MM/YYYY"),moment(d,"DD/MM/YYYY").isAfter(moment(c,"DD/MM/YYYY"))&&(t.dateSettings.fromDate=c,d=c),e=t.isBetweenDates(b,c,d),e||(t.dateSettings.fromDate=b))))},this.setDateFiltersForCommissionReports=function(a){var b,c=moment(t.dateSettings.fromDate,"DD/MM/YYYY").toDate();b=1===moment(t.dateSettings.fromDate,"DD/MM/YYYY").weekday()?moment(t.dateSettings.fromDate,"DD/MM/YYYY").add(6,"d"):moment(t.dateSettings.fromDate,"DD/MM/YYYY").add(5,"d");var d=moment().toDate();t.dateSettings.fromDate=moment(t.dateSettings.fromDate,"DD/MM/YYYY").format("DD/MM/YYYY");var e=t.isBetweenDates(moment(t.dateSettings.fromDate,"DD/MM/YYYY"),b,moment(t.dateSettings.toDate,"DD/MM/YYYY"));return!!e||(b.toDate()>d?(this.enableDays=t.getDateArray(c,d),t.dateSettings.toDate=moment().format("DD/MM/YYYY"),!0):(this.enableDays=t.getDateArray(c,b.toDate()),t.dateSettings.toDate=b.format("DD/MM/YYYY"),!0))},this.sectionName="",t.parseRecord=function(a){var b=[];return _.forEach(a,function(a){var c={id:a.TpsUserId,username:a.Username,name:a.Name,surname:a.Surname};b.push(c)}),b},this.getDirectDesendentAgent=function(){var a={DirectDescendantsOnly:!0,Recursive:!1,AgentsOnly:!0,NonAgentsOnly:!1,InitialTpsUserId:null,UserStatusesFilterBy:null};o.user.getUserList(a).then(function(a){return a.success?(t.directDesendentAgent=t.parseRecord(a.data.Children),void(t.selectedAgent||(t.selectedAgent=t.directDesendentAgent[0].id))):void console.error("Error occurred while searching for users: "+JSON.stringify(a.error))})};var x=[];t.parseRecordGetShopOwners=function(a){var b=[];return b.push(a),t.flattenArray(b),t.arrayTypeSelecter(x,"J_SHOP_OWN")},t.arrayTypeSelecter=function(a,b){for(var c=[],d=0;d<a.length;d++)a[d].UserTypeCode===b&&c.push({id:a[d].TpsUserId,username:a[d].Username,name:a[d].Name,surname:a[d].Surname});return c},t.flattenArray=function(a){for(var b=0;b<a.length;b++){var c=a[b];c.Children&&c.Children.length>0?(x.push(c),t.flattenArray(c.Children)):x.push(c)}},this.getDesendentShopOwners=function(){var a={DirectDescendantsOnly:!1,Recursive:!0,AgentsOnly:!1,NonAgentsOnly:!1,InitialTpsUserId:null,UserStatusesFilterBy:null};o.user.getUserList(a).then(function(a){return a.success?(t.shopOwnerList=t.parseRecordGetShopOwners(a.data),void(t.selectedShopOwner||(t.selectedShopOwner=t.shopOwnerList[0].id))):void console.error("Error occurred while searching for users: "+JSON.stringify(a.error))})},this.filterByPermission=function(){var a=[];_.forEach(t.fullTabMenuStructure,function(b){i.hasValidLogin()&&i.isAgent()&&b.access.includes(i.getAgentType(i.getUserData().userType))&&a.push(b)}),angular.copy(a,t.tabMenuStructure)},this.dateSettings={fromDate:moment().format("DD/MM/YYYY"),toDate:moment().format("DD/MM/YYYY"),minDate:moment().subtract(3,"months").toDate(),maxDate:moment().toDate()},this.reportName="",this.period=1,this.searchResults=null,$.fn.dataTable.moment("DD/MM/YYYY, HH:mm:ss"),this.onPeriodChanged=function(){switch(t.period){case"1":t.dateSettings.fromDate=moment().format("DD/MM/YYYY"),t.dateSettings.toDate=moment().format("DD/MM/YYYY");break;case"2":t.dateSettings.fromDate=moment().subtract(1,"day").format("DD/MM/YYYY"),t.dateSettings.toDate=moment().subtract(1,"day").format("DD/MM/YYYY");break;case"7":t.dateSettings.toDate=moment().startOf("week").format("DD/MM/YYYY"),t.dateSettings.fromDate=moment(t.dateSettings.toDate,"DD/MM/YYYY").day(-6).format("DD/MM/YYYY");break;default:return}},this.isTableInitialized=function(){return $.fn.DataTable.isDataTable($("#searchResults"))},this.getDTLocaleUrl=function(){var a="//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/";switch(globalSettings.CurrentLanguage){case"es":return a+"Spanish.json";case"it":return a+"Italian.json";case"pt":return a+"Portuguese-Brasil.json";case"ro":return a+"Romanian.json";default:return a+"English.json"}},this.resetForm=function(){t.period=1,t.dateSettings.fromDate=moment().format("DD/MM/YYYY"),t.dateSettings.toDate=moment().format("DD/MM/YYYY"),t.isSettled=!1,"reportAgentCommission"!==t.reportIdentifier&&"reportSportsAnalysisCommission"!==t.reportIdentifier&&"reportBKVAnalysisCommission"!==t.reportIdentifier&&"reportBKVMobileAnalysisCommission"!==t.reportIdentifier&&"reportGBVirtualAnalysisCommission"!==t.reportIdentifier&&"reportLotSpecialFiveAnalysisCommission"!==t.reportIdentifier&&"reportLotDailyDrawAnalysisCommission"!==t.reportIdentifier&&"reportVDogRaceAnalysisCommission"!==t.reportIdentifier&&"reportSpin2WinAnalysisCommission"!==t.reportIdentifier&&"reportGRLuckyBallCommissionEstimate"!==t.reportIdentifier&&"reportGBColorAnalysisCommission"!==t.reportIdentifier||(t.period=7,t.dateSettings.toDate=moment().startOf("week").format("DD/MM/YYYY"),t.dateSettings.fromDate=moment(t.dateSettings.toDate,"DD/MM/YYYY").day(-6).format("DD/MM/YYYY"))},this.format=function(a,b){var c=a.data,d='<table class="innerTable" cellspacing="0" cellpadding="0" border="0" id="inner-table">';if("reportAllProductAnalysis"===t.reportIdentifier){var e=[];$("table#searchResults tbody tr").children().each(function(a){e.push($(this).innerWidth())}),c.forEach(function(a,b){var c=b%2===0?"even":"odd";d=d+'<tr class="single-hierarchy '+c+'"><td class="first" style="width:'+(e[0]+2)+'px;"></td><td class="center" style="width:'+(e[1]+2)+'px;padding-left:14px;">'+a.product+'</td><td style="width:'+(e[2]+2)+'px;">'+a.numberOfBets+'</td><td style="width:'+(e[3]+2)+'px;">'+a.runningBets+'</td><td style="width:'+(e[4]+2)+'px;">'+a.settledBets+'</td><td style="width:'+(e[5]+2)+'px;">'+k("numberTruncate")(a.stake)+'</td><td style="width:'+(e[6]+2)+'px;">'+k("numberTruncate")(a.winnings)+'</td><td style="width:'+e[7]+'px;">'+k("numberTruncate")(a.jackpot)+"</td></tr>"})}else if("reportAgentSales"===t.reportIdentifier||"reportAgentVirtualSales"===t.reportIdentifier||"reportAgentLotterySales"===t.reportIdentifier){if("#open-bets"===b){var f=[];$("div#open-bets_wrapper table#open-bets thead tr").children().each(function(a){f.push($(this).innerWidth())}),c.forEach(function(a,b){var c=b%2===0?"even":"odd";d=d+'<tr class="'+c+'"><td class="first " style="width:'+(f[0]-7)+'px;padding-right:5px;"> </td><td class="left normal-text" style="width:'+(f[1]-8)+'px;padding-right:10px;">'+a.product+'</td><td style="width:'+(f[2]+2)+'px;">'+k("numberTruncate")(a.runningBets)+'</td><td style="width:'+f[3]+'px;">'+k("numberTruncate")(a.stakeRunningBets)+"</td></tr>"})}else{var e=[];$("table#searchResults tbody tr").children().each(function(a){e.push($(this).innerWidth())}),c.forEach(function(a,b){var c=b%2===0?"even":"odd";d=d+'<tr class="'+c+' parent"><td class="first parent faIcon details-control" style="width:'+(e[0]+1)+'px;padding-left:20px;"><i class="fa fa-caret-right"></i></td><td class="left parent normal-text" style="width:'+(e[1]+2)+'px;">'+a.userName+'</td><td class="parent" style="width:'+(e[2]+2)+'px;">'+a.numberOfBets+'</td><td class="parent" style="width:'+(e[3]+2)+'px;">'+a.runningBets+'</td><td class="parent" style="width:'+(e[4]+2)+'px;">'+a.settledBets+'</td><td class="parent" style="width:'+(e[5]+2)+'px;">'+k("numberTruncate")(a.stake)+'</td><td class="parent" style="width:'+e[6]+'px;">'+k("numberTruncate")(a.winnings)+'</td></tr><table id="child-table"></table>'})}d+="</table>"}else if("reportSportsAnalysisCommission"===t.reportIdentifier||"reportBKVAnalysisCommission"===t.reportIdentifier||"reportGBVirtualAnalysisCommission"===t.reportIdentifier||"reportGBColorAnalysisCommission"===t.reportIdentifier){var e=[];$("table#searchResults tbody tr").children().each(function(a){e.push($(this).outerWidth())}),c.forEach(function(a,b){var c=b%2===0?"even":"odd",f=moment(a["Settled Date"]).format("DD/MM/YYYY");d=d+'<tr class="single-hierarchy set-click '+c+'"><td class="first drill-down" style="text-align:center;width:15px;"><i class="fa fa-search"></i></td > <td class="center" style="text-align:center;width:'+(e[1]+2)+'px;padding-left:0px;">'+a.Channel+'</td><td style="text-align:center;width:'+(e[2]-8)+'px;">'+(null===f?"-":f)+'</td><td style="text-align:center;width:'+e[3]+'px;">'+(null===a["Coupon Count"]?"-":a["Coupon Count"])+'</td><td style="text-align:center;width:'+e[4]+'px;">'+(null===a["Number of Selections"]?"-":a["Number of Selections"])+'</td><td style="text-align:center;width:'+e[5]+'px;">'+(null===a.Stake?"-":k("numberTruncate")(a.Stake))+'</td><td style="text-align:center;width:'+e[6]+'px;">'+(null===a["Commission Band"]?"-":a["Commission Band"])+'</td><td style="text-align:center;width:'+e[7]+'px;">'+(null===a["Commission Estimate"]?"-":k("numberTruncate")(a["Commission Estimate"]))+"</td></tr>"})}else if("reportLotSpecialFiveAnalysisCommission"===t.reportIdentifier||"reportLotDailyDrawAnalysisCommission"===t.reportIdentifier){var e=[];$("table#searchResults tbody tr").children().each(function(a){e.push($(this).outerWidth())}),c.forEach(function(a,b){var c=b%2===0?"even":"odd",f=moment(a["Settled Date"]).format("DD/MM/YYYY");d=d+'<tr class="single-hierarchy set-click '+c+'"><td class="first drill-down" style="text-align:center;width:15px;"><i class="fa fa-search"></i></td > <td class="center" style="text-align:center;width:'+(e[1]+2)+'px;padding-left:0px;">'+a.Channel+'</td><td style="text-align:center;width:'+(e[2]-8)+'px;">'+(null===f?"-":f)+'</td><td style="text-align:center;width:'+e[3]+'px;">'+(null===a["Coupon Count"]?"-":a["Coupon Count"])+'</td><td style="text-align:center;width:'+e[4]+'px;">'+(null===a.Selection?"-":a.Selection)+'</td><td style="text-align:center;width:'+e[5]+'px;">'+(null===a.Stake?"-":k("numberTruncate")(a.Stake))+'</td><td style="text-align:center;width:'+e[6]+'px;">'+(null===a["Commission Band"]?"-":a["Commission Band"])+'</td><td style="text-align:center;width:'+e[7]+'px;">'+(null===a["Commission Estimate"]?"-":k("numberTruncate")(a["Commission Estimate"]))+"</td></tr>"})}else if("reportVDogRaceAnalysisCommission"===t.reportIdentifier||"reportGRLuckyBallCommissionEstimate"===t.reportIdentifier){var e=[];$("table#searchResults tbody tr").children().each(function(a){e.push($(this).outerWidth())}),c.forEach(function(a,b){var c=b%2===0?"even":"odd",f=moment(a["Settled Date"]).format("DD/MM/YYYY");d=d+'<tr class="single-hierarchy set-click '+c+'"><td class="first drill-down" style="text-align:center;width:15px;"><i class="fa fa-search"></i></td > <td class="center" style="text-align:center;width:'+(e[1]+2)+'px;padding-left:0px;">'+a.Channel+'</td><td style="text-align:center;width:'+(e[2]-8)+'px;">'+(null===a["Coupon Count"]?"-":a["Coupon Count"])+'</td><td style="text-align:center;width:'+e[3]+'px;">'+(null===f?"-":f)+'</td><td style="text-align:center;width:'+e[4]+'px;">'+(null===a["Selection Group"]?"-":a["Selection Group"])+'</td><td style="text-align:center;width:'+e[5]+'px;">'+(null===a.Stake?"-":k("numberTruncate")(a.Stake))+'</td><td style="text-align:center;width:'+e[6]+'px;">'+(null===a["Commission Band"]?"-":a["Commission Band"])+'</td><td style="text-align:center;width:'+e[7]+'px;">'+(null===a["Commission Estimate"]?"-":k("numberTruncate")(a["Commission Estimate"]))+"</td></tr>"})}else if("reportSpin2WinAnalysisCommission"===t.reportIdentifier){var e=[];$("table#searchResults tbody tr").children().each(function(a){e.push($(this).outerWidth())}),c.forEach(function(a,b){var c=b%2===0?"even":"odd",f=moment(a["Settled Date"]).format("DD/MM/YYYY");d=d+'<tr class="single-hierarchy set-click '+c+'"><td class="first drill-down" style="text-align:center;width:15px;"><i class="fa fa-search"></i></td > <td class="center" style="text-align:center;width:'+(e[1]+2)+'px;padding-left:0px;">'+a.Channel+'</td><td style="text-align:center;width:'+(e[2]-8)+'px;">'+(null===a["Coupon Count"]?"-":a["Coupon Count"])+'</td><td style="text-align:center;width:'+e[3]+'px;">'+(null===f?"-":f)+'</td><td style="text-align:center;width:'+e[4]+'px;">'+(null===a["Product Type"]?"-":a["Product Type"])+'</td><td style="text-align:center;width:'+e[5]+'px;">'+(null===a.Stake?"-":k("numberTruncate")(a.Stake))+'</td><td style="text-align:center;width:'+e[6]+'px;">'+(null===a["Commission Band"]?"-":a["Commission Band"])+'</td><td style="text-align:center;width:'+e[7]+'px;">'+(null===a["Commission Estimate"]?"-":k("numberTruncate")(a["Commission Estimate"]))+"</td></tr>"})}else if("reportBKVMobileAnalysisCommission"===t.reportIdentifier){var e=[];$("table#searchResults tbody tr").children().each(function(a){e.push($(this).outerWidth())}),c.forEach(function(a,b){var c=b%2===0?"even":"odd";moment(a["Settled Date"]).format("DD/MM/YYYY");d=d+'<tr class="single-hierarchy set-click '+c+'"><td class="first drill-down" style="text-align:center;width:15px;"><i class="fa fa-search"></i></td > <td class="center" style="text-align:center;width:'+(e[1]+2)+'px;padding-left:0px;">'+a.Channel+'</td><td style="text-align:center;width:'+(e[2]-8)+'px;">'+(null===a["Coupon Count"]?"-":a["Coupon Count"])+'</td><td style="text-align:center;width:'+e[3]+'px;">'+(null===a.Stake?"-":k("numberTruncate")(a.Stake))+'</td><td style="text-align:center;width:'+e[4]+'px;">'+(null===a.Win?"-":k("numberTruncate")(a.Win))+'</td><td style="text-align:center;width:'+e[5]+'px;">'+(null===a["Gross Profit"]?"-":k("numberTruncate")(a["Gross Profit"]))+'</td><td style="text-align:center;width:'+e[6]+'px;">'+(null===a["Commission Band"]?"-":a["Commission Band"])+'</td><td style="text-align:center;width:'+e[7]+'px;">'+(null===a["Commission Estimate"]?"-":k("numberTruncate")(a["Commission Estimate"]))+"</td></tr>"})}else{var e=[];$("table#searchResults tbody tr").children().each(function(a){e.push($(this).innerWidth())}),c.forEach(function(a,b){var c=b%2===0?"even":"odd";d=d+'<tr class="single-hierarchy '+c+'"><td class="first" style="width:'+(e[0]+2)+'px;"></td><td class="center" style="width:'+(e[1]+2)+'px;padding-left:20px;">'+a.product+'</td><td style="width:'+(e[2]+2)+'px;">'+(null===a.settledBets?"-":a.settledBets)+'</td><td style="width:'+(e[3]+2)+'px;">'+(null===a.stake?"-":k("numberTruncate")(a.stake))+'</td><td style="width:'+(e[4]+2)+'px;">'+(null===a.winnings?"-":k("numberTruncate")(a.winnings))+'</td><td style="width:'+(e[5]+2)+'px;">'+(null===a.grossProfit?"-":k("numberTruncate")(a.grossProfit))+'</td><td style="width:'+(e[6]+2)+'px;">'+(null===a.commission?"-":k("numberTruncate")(a.commission))+'</td><td style="width:'+(e[7]+2)+'px;">'+(null===a.bonus?"-":k("numberTruncate")(a.bonus))+'</td><td style="width:'+e[8]+'px;">'+(null===a.jackpot?"-":k("numberTruncate")(a.jackpot))+"</td></tr>"})}return d+="</table>"},this.showBonusValue=function(){var a=moment(t.dateSettings.fromDate,"DD/MM/YYYY").subtract(1,"day").format("DD/MM/YYYY"),b=moment(a,"DD/MM/YYYY").endOf("month").startOf("week").format("DD/MM/YYYY"),c=moment(t.dateSettings.toDate,"DD/MM/YYYY").endOf("month").startOf("week").format("DD/MM/YYYY");return a===b&&t.dateSettings.toDate===c&&t.summery.stake>1e5?void(t.showBonus="entitled"):void(t.showBonus="lowStake")},this.setReport=function(a,b){if(r(),"reportAllProductAnalysis"===t.reportIdentifier||"reportAgentCommission"===t.reportIdentifier||"reportAgentSales"===t.reportIdentifier||"reportAgentVirtualSales"===t.reportIdentifier||"reportAgentLotterySales"===t.reportIdentifier)if(s(t.digestResponseUniversalByChannel(a),m.generateColumns(t.reportName,t.currencySymbol,t.isSettled)),"reportAllProductAnalysis"===t.reportIdentifier)s(t.formatUniversalForExport(a),m.generateColumns("allProductAnalysisExport",t.currencySymbol,t.isSettled),!0);else if("reportAgentSales"===t.reportIdentifier||"reportAgentVirtualSales"===t.reportIdentifier||"reportAgentLotterySales"===t.reportIdentifier){var c=t.digestResponseUniversalByChannel(a),d=[];c.forEach(function(a){a.data&&a.data.forEach(function(a){d.push(a)})}),d.push(t.getGrandTotalVirtuals(c,!0)),s(t.formatUniversalForExport(d),m.generateColumns("reportAgentSalesOpenBetsExport",t.currencySymbol,t.isSettled),null,null,!0),s(d,m.generateColumns("reportAgentSalesOpenBets",t.currencySymbol,t.isSettled),null,!0),s(t.formatUniversalForExport(a),m.generateColumns("allAgentSalesExport",t.currencySymbol,t.isSettled),!0)}else s(t.formatUniversalForExport(a),m.generateColumns("agentCommissionExport",t.currencySymbol,t.isSettled),!0);else if("reportSportsAnalysisCommission"===t.reportIdentifier||"reportBKVAnalysisCommission"===t.reportIdentifier||"reportBKVMobileAnalysisCommission"===t.reportIdentifier||"reportGBVirtualAnalysisCommission"===t.reportIdentifier||"reportLotSpecialFiveAnalysisCommission"===t.reportIdentifier||"reportLotDailyDrawAnalysisCommission"===t.reportIdentifier||"reportVDogRaceAnalysisCommission"===t.reportIdentifier||"reportSpin2WinAnalysisCommission"===t.reportIdentifier||"reportGRLuckyBallCommissionEstimate"===t.reportIdentifier||"reportGBColorAnalysisCommission"===t.reportIdentifier){var e="";e="reportBKVMobileAnalysisCommission"===t.reportIdentifier?"bKVMobileAnalysisCommissionExport":"reportLotSpecialFiveAnalysisCommission"===t.reportIdentifier||"reportLotDailyDrawAnalysisCommission"===t.reportIdentifier?"lotAnalysisComissionExport":"reportVDogRaceAnalysisCommission"===t.reportIdentifier?"vDogRaceAnalysisCommissionExport":"reportSpin2WinAnalysisCommission"===t.reportIdentifier?"spin2WinAnalysisCommissionExport":"reportGRLuckyBallCommissionEstimate"===t.reportIdentifier?"gRLuckyBallCommissionEstimateExport":"analysisCommissionExport",s(t.digestResponseUniversalByDate(a,"Settled Date"),m.generateColumns(t.reportName,t.currencySymbol,t.isSettled)),s(t.formatUniversalForExport(a),m.generateColumns(e,t.currencySymbol,t.isSettled),!0)}else t.searchResults=m.transformResponseForDataTable(a.Data,t.reportName),s(t.searchResults,m.generateColumns(t.reportName,t.currencySymbol,t.isSettled));r()},this.loadReport=function(b){u=c.router.urlService.path(),a.showLoader(".Centralbody"),t.searchInProgress!==!0&&(t.searchInProgress=!0,t.searchResults=null,w.Parameters=[],b&&b.data?(t.selectedAgent=b.selectedAgent,t.selectedShopOwner=b.selectedShopOwner,t.searchResults=b.data.Data,q(t.reportName),t.setReport(b.data)):(q(t.reportName),m.getReportData(t.reportIdentifier,w).then(function(a){return a.success?a.data:(e.logError("Unable to get "+t.reportIdentifier+" summary: "+JSON.stringify(a.error)),l.showErrorMessage(a.userMsg),void r())}).then(function(a){m.setDataCache("reload",{id:t.reportIdentifier,name:t.reportName,data:a,selectedAgent:t.selectedAgent,selectedShopOwner:t.selectedShopOwner}),t.setReport(a)}).catch(function(a){e.logError("Unable to get "+t.reportIdentifier+" summary: "+JSON.stringify(a)),r()})),"reportAgentCommission"===t.reportIdentifier&&t.showBonusValue())},this.formatUniversalForExport=function(a){var b=angular.copy(a);if(b.Data)return b.Data.push(this.getGrandTotalVirtuals(b.Data)),b.Data;var c=[];return b.forEach(function(a){a.data&&a.data.forEach(function(a){c.push(a)})}),c.push(this.getGrandTotalVirtuals(b,!0)),c},this.digestResponseUniversalByChannel=function(a){var b=angular.copy(a),c=[],d=b.Data.reduce(function(a,b){return a.concat(a.find(function(a){return a.channel===b.channel})?[]:[b])},[]);d.forEach(function(a){c.push({channel:a.channel,data:[]})}),b.Data.forEach(function(a){c.forEach(function(b){a.channel===b.channel&&b.data.push(a)})});var e=angular.copy(c);e.forEach(function(a){a.data=[]});for(var f=0;f<c.length;f++)if("reportAllProductAnalysis"===t.reportIdentifier){var g={"# of Bets":0,"Running Bets":0,"Settled Bets":0,Stake:0,Winnings:0,Jackpot:0};c[f].data.forEach(function(a){g["# of Bets"]+=a.numberOfBets,g["Running Bets"]+=a.runningBets,g["Settled Bets"]+=a.settledBets,g.Stake+=a.stake,g.Winnings+=a.winnings,g.Jackpot+=a.jackpot,delete a["# of Bets"],delete a["Running Bets"],delete a["Settled Bets"],delete a.Stake,delete a.Winnings,delete a.Jackpot}),c[f].numberOfBets=g["# of Bets"],c[f].runningBets=g["Running Bets"],c[f].settledBets=g["Settled Bets"],c[f].stake=k("numberTruncate")(g.Stake),c[f].winnings=k("numberTruncate")(g.Winnings),c[f].jackpot=k("numberTruncate")(g.Jackpot)}else if("reportAgentSales"===t.reportIdentifier||"reportAgentVirtualSales"===t.reportIdentifier||"reportAgentLotterySales"===t.reportIdentifier){if(!c[f].data.length)break;var g={"# of Bets":0,"Running Bets":0,"Settled Bets":0,Stake:0,StakeRunningBets:0,Winnings:0,Jackpot:0},h=c[f].data.reduce(function(a,b){return a.concat(a.find(function(a){return a.userName===b.userName})?[]:[b])},[]),i=[];h.forEach(function(a){i.push(a.userName)});var j=[];c[f].data.forEach(function(a){g["# of Bets"]+=a.numberOfBets,g["Running Bets"]+=a.runningBets,g["Settled Bets"]+=a.settledBets,g.Stake+=a.stake,g.StakeRunningBets+=a.stakeRunningBets,g.Winnings+=a.winnings,g.Jackpot+=a.jackpot}),i.forEach(function(a){for(var b=0;b<c[f].data.length;b++)if(c[f].data[b].userName===a){j.push({userName:a,data:c[f].data.filter(function(b){return b.userName===a})});break}}),j.forEach(function(a,b){var c={numberOfBets:0,runningBets:0,settledBets:0,stake:0,stakeRunningBets:0,jackpot:0,winnings:0};a.data.forEach(function(a){c.numberOfBets+=a.numberOfBets,c.runningBets+=a.runningBets,c.settledBets+=a.settledBets,c.stake+=a.stake,c.stakeRunningBets+=a.stakeRunningBets,c.jackpot+=a.jackpot,c.winnings+=a.winnings}),c.stake=k("numberTruncate")(c.stake),c.stakeRunningBets=k("numberTruncate")(c.stakeRunningBets),c.jackpot=k("numberTruncate")(c.jackpot),c.winnings=k("numberTruncate")(c.winnings),j[b]=Object.assign({},a,c)}),j.forEach(function(a){for(var b=0;b<c.length;b++)c[b].channel===a.data[0].channel&&e[b].data.push(a)}),e[f].numberOfBets=g["# of Bets"],e[f].runningBets=g["Running Bets"],e[f].settledBets=g["Settled Bets"],e[f].stake=k("numberTruncate")(g.Stake),e[f].stakeRunningBets=k("numberTruncate")(g.StakeRunningBets),e[f].winnings=k("numberTruncate")(g.Winnings),e[f].jackpot=k("numberTruncate")(g.Jackpot)}else{var l={settledBets:0,stake:0,winnings:0,grossProfit:0,commission:0,bonus:0,jackpot:0};c[f].data.forEach(function(a){l.settledBets+=a.settledBets,l.stake+=a.stake,l.winnings+=a.winnings,l.grossProfit+=a.grossProfit,l.commission+=a.commission,l.bonus+=a.bonus,l.jackpot+=a.jackpot}),c[f].settledBets=l.settledBets,c[f].stake=k("numberTruncate")(l.stake),c[f].winnings=k("numberTruncate")(l.winnings),c[f].grossProfit=k("numberTruncate")(l.grossProfit),c[f].commission=k("numberTruncate")(l.commission),c[f].bonus=k("numberTruncate")(l.bonus),c[f].jackpot=k("numberTruncate")(l.jackpot)}return 0===e.length?t.searchResults=e:(e[0].data.length&&(c=e),t.searchResults=c),c.push(this.getGrandTotalVirtuals(c)),c.forEach(function(a){"Sportsbook"===a.channel&&(t.summery.stake=a.stake,t.summery.winnings=a.winnings,t.summery.commission=a.commission,t.summery.grossProfit=k("numberTruncate")(parseFloat(t.replaceAll(a.stake.toString(),",",""))-parseFloat(t.replaceAll(a.winnings.toString(),",",""))),t.summery.PerCentGrossProfit=k("numberTruncate")(.25*parseFloat(t.replaceAll(t.summery.grossProfit.toString(),",",""))),"entitled"===t.showBonus&&(t.summery.bonus=k("numberTruncate")(.25*(parseFloat(t.replaceAll(a.stake.toString(),",",""))-parseFloat(t.replaceAll(a.winnings.toString(),",","")))-parseFloat(t.replaceAll(a.commission.toString(),",",""))),t.summery.bonus<0&&(t.showBonus="negative")))}),c},this.showRadioBtn=function(){return!t.isCommisionReport},this.digestResponseUniversalByDate=function(a,b){var c=angular.copy(a),d=[],e=c.Data.reduce(function(a,c){return a.concat(a.find(function(a){return a[b]===c[b]})?[]:[c])},[]);e.forEach(function(a){d.push({"Settled Date":a[b],data:[]})}),c.Data.forEach(function(a){d.forEach(function(c){a[b]===c[b]&&c.data.push(a)})});var f=angular.copy(d);f.forEach(function(a){a.data=[]});for(var g=0;g<d.length;g++){var h={channel:"",commissionEstimate:0,couponCount:0,stake:0,productType:"-",win:0,grossProfit:0};d[g].data.forEach(function(a){h.channel=a.Channel?a.Channel:h.channel,h.commissionEstimate+=a["Commission Estimate"],h.couponCount+=a["Coupon Count"],h.stake+=a.Stake,h.productType=h.productType,h.win+=a.Win,h.grossProfit+=a["Gross Profit"]}),d[g].Channel=h.channel,d[g]["Settled Date"]=moment(d[g]["Settled Date"]).format("DD/MM/YYYY"),d[g]["Commission Band"]="-",d[g]["Selection Group"]="-",d[g]["Commission Estimate"]=k("numberTruncate")(h.commissionEstimate),d[g]["Coupon Count"]=h.couponCount,d[g].Stake=k("numberTruncate")(h.stake),d[g]["Number of Selections"]="-",d[g].Selection="-",d[g]["Product Type"]=h.productType,d[g].Win=k("numberTruncate")(h.win),d[g]["Gross Profit"]=k("numberTruncate")(h.grossProfit)}return 0===f.length?t.searchResults=f:(f[0].data.length&&(d=f),t.searchResults=d),d.push(this.getGrandTotalVirtuals(d)),d},this.getGrandTotalVirtuals=function(a,b){if("reportAllProductAnalysis"===t.reportIdentifier||"reportAgentSales"===t.reportIdentifier||"reportAgentVirtualSales"===t.reportIdentifier||"reportAgentLotterySales"===t.reportIdentifier){var c={channel:"Grand Total",product:"",jackpot:0,numberOfBets:0,runningBets:0,settledBets:0,stake:0,stakeRunningBets:0,winnings:0,userName:""};a.forEach(function(a){"Grand Total"!==a.channel&&(c.numberOfBets+=a.numberOfBets,c.runningBets+=a.runningBets,c.settledBets+=a.settledBets,a.stake&&(c.stake+=parseFloat(t.replaceAll(a.stake.toString(),",",""))),a.stakeRunningBets&&(c.stakeRunningBets+=parseFloat(t.replaceAll(a.stakeRunningBets.toString(),",",""))),a.winnings&&(c.winnings+=parseFloat(t.replaceAll(a.winnings.toString(),",",""))),a.jackpot&&(c.jackpot+=parseFloat(t.replaceAll(a.jackpot.toString(),",",""))))}),c.numberOfBets=c.numberOfBets,c.runningBets=c.runningBets,c.settledBets=c.settledBets,c.jackpot=k("numberTruncate")(c.jackpot),c.stake=k("numberTruncate")(c.stake),c.stakeRunningBets=k("numberTruncate")(c.stakeRunningBets),c.winnings=k("numberTruncate")(c.winnings)}else if("reportAgentCommission"===t.reportIdentifier){var c={channel:"Grand Total",product:"",settledBets:0,stake:0,winnings:0,jackpot:0,grossProfit:0,commission:0,bonus:0};a.forEach(function(a){c.settledBets+=a.settledBets,a.stake&&(c.stake+=parseFloat(t.replaceAll(a.stake.toString(),",",""))),a.winnings&&(c.winnings+=parseFloat(t.replaceAll(a.winnings.toString(),",",""))),a.jackpot&&(c.jackpot+=parseFloat(t.replaceAll(a.jackpot.toString(),",",""))),a.grossProfit&&(c.grossProfit+=parseFloat(t.replaceAll(a.grossProfit.toString(),",",""))),a.commission&&(c.commission+=parseFloat(t.replaceAll(a.commission.toString(),",",""))),a.bonus&&(c.bonus+=parseFloat(t.replaceAll(a.bonus.toString(),",","")))}),c.settledBets=c.settledBets,c.stake=k("numberTruncate")(c.stake),c.winnings=k("numberTruncate")(c.winnings),c.jackpot=k("numberTruncate")(c.jackpot),c.grossProfit=k("numberTruncate")(c.grossProfit),c.commission=k("numberTruncate")(c.commission),c.bonus=k("numberTruncate")(c.bonus)}else if("reportBKVMobileAnalysisCommission"===t.reportIdentifier){var c={Channel:"Grand Total","Settled Date":"-","Coupon Count":0,"Product type":"-",
Stake:0,Win:0,"Gross Profit":0,"Commission Band":"-","Commission Estimate":0};a.forEach(function(a){c.settledBets+=a.settledBets,a["Coupon Count"]&&(c["Coupon Count"]+=parseFloat(t.replaceAll(a["Coupon Count"].toString(),",",""))),a.Stake&&(c.Stake+=parseFloat(t.replaceAll(a.Stake.toString(),",",""))),a.Win&&(c.Win+=parseFloat(t.replaceAll(a.Win.toString(),",",""))),a["Gross Profit"]&&(c["Gross Profit"]+=parseFloat(t.replaceAll(a["Gross Profit"].toString(),",",""))),a["Commission Estimate"]&&(c["Commission Estimate"]+=parseFloat(t.replaceAll(a["Commission Estimate"].toString(),",","")))}),c["Coupon Count"]=k("numberTruncate")(c["Coupon Count"]),c.Stake=k("numberTruncate")(c.Stake),c.Win=k("numberTruncate")(c.Win),c["Gross Profit"]=k("numberTruncate")(c["Gross Profit"]),c["Commission Estimate"]=k("numberTruncate")(c["Commission Estimate"])}else if("reportLotSpecialFiveAnalysisCommission"===t.reportIdentifier||"reportLotDailyDrawAnalysisCommission"===t.reportIdentifier){var c={Channel:"Grand Total","Commission Band":"-","Commission Estimate":0,"Coupon Count":0,Selection:"-","Settled Date":"-",Stake:0};a.forEach(function(a){c.settledBets+=a.settledBets,a.Stake&&(c.Stake+=parseFloat(t.replaceAll(a.Stake.toString(),",",""))),a["Commission Estimate"]&&(c["Commission Estimate"]+=parseFloat(t.replaceAll(a["Commission Estimate"].toString(),",",""))),a["Coupon Count"]&&(c["Coupon Count"]+=parseFloat(t.replaceAll(a["Coupon Count"].toString(),",","")))}),c.Stake=k("numberTruncate")(c.Stake),c["Commission Estimate"]=k("numberTruncate")(c["Commission Estimate"]),c["Coupon Count"]=k("numberTruncate")(c["Coupon Count"])}else if("reportGRLuckyBallCommissionEstimate"===t.reportIdentifier||"reportSpin2WinAnalysisCommission"===t.reportIdentifier||"reportVDogRaceAnalysisCommission"===t.reportIdentifier){var c={Channel:"Grand Total","Settled Date":"-","Selection Group":"-","Coupon Count":0,"Product Type":"-",Stake:0,Win:0,"Gross Profit":0,"Commission Band":"-","Commission Estimate":0};a.forEach(function(a){c.settledBets+=a.settledBets,a["Coupon Count"]&&(c["Coupon Count"]+=parseFloat(t.replaceAll(a["Coupon Count"].toString(),",",""))),a.Stake&&(c.Stake+=parseFloat(t.replaceAll(a.Stake.toString(),",",""))),a.Win&&(c.Win+=parseFloat(t.replaceAll(a.Win.toString(),",",""))),a["Gross Profit"]&&(c["Gross Profit"]+=parseFloat(t.replaceAll(a["Gross Profit"].toString(),",",""))),a["Commission Estimate"]&&(c["Commission Estimate"]+=parseFloat(t.replaceAll(a["Commission Estimate"].toString(),",","")))}),c["Coupon Count"]=k("numberTruncate")(c["Coupon Count"]),c.Stake=k("numberTruncate")(c.Stake),c.Win=k("numberTruncate")(c.Win),c["Gross Profit"]=k("numberTruncate")(c["Gross Profit"]),c["Commission Estimate"]=k("numberTruncate")(c["Commission Estimate"])}else{var c={Channel:"Grand Total","Commission Band":"-","Commission Estimate":0,"Coupon Count":0,"Number of Selections":"-","Settled Date":"-",Stake:0};a.forEach(function(a){c.settledBets+=a.settledBets,a.Stake&&(c.Stake+=parseFloat(t.replaceAll(a.Stake.toString(),",",""))),a["Commission Estimate"]&&(c["Commission Estimate"]+=parseFloat(t.replaceAll(a["Commission Estimate"].toString(),",",""))),a["Coupon Count"]&&(c["Coupon Count"]+=parseFloat(t.replaceAll(a["Coupon Count"].toString(),",","")))}),c.Stake=k("numberTruncate")(c.Stake),c["Commission Estimate"]=k("numberTruncate")(c["Commission Estimate"]),c["Coupon Count"]=k("numberTruncate")(c["Coupon Count"])}return b&&(c.userName="Grand Total"),t.grandTotal=c,t.grandTotal.currencySymbol=t.currencySymbol,c},this.replaceAll=function(a,b,c){return a.replace(new RegExp(t.escapeRegExp(b),"g"),c)},this.escapeRegExp=function(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},this.checkToEnablePayBtn=function(){isNaN(t.otherPaymentAmount)||""===t.otherPaymentAmount||0==t.otherPaymentAmount?($("#assitantPrg-otherPaymentButton").addClass("disabled-btn"),$("#assitantPrg-otherPaymentButton").attr("disabled")):($("#assitantPrg-otherPaymentButton").removeClass("disabled-btn"),$("#assitantPrg-otherPaymentButton").removeAttr("disabled"))},this.showReport=function(a,b){b?(t.reportIdentifier=b.id,t.reportName=b.name):(t.reportName=a,t.reportIdentifier="report"+a.charAt(0).toUpperCase()+a.slice(1),t.resetForm()),this.period="agentCommission"===a||"bKVAnalysisCommission"===a||"sportsAnalysisCommission"===a||"gBVirtualAnalysisCommission"===a||"bKVMobileAnalysisCommission"===a||"lotSpecialFiveAnalysisCommission"===a||"lotDailyDrawAnalysisCommission"===a||"vDogRaceAnalysisCommission"===a||"spin2WinAnalysisCommission"===a||"gRLuckyBallCommissionEstimate"===a||"gBColorAnalysisCommission"===a?7:this.period,t.searchResults=null,t.searchInProgress=!1},this.getAgentAssistanceLoanAccount=function(a){var a=null;p.assistanceProgram.getLoanTypes().then(function(b){if(b.success&&0!=b.data.LoanTypes.length){a=b.data.LoanTypes[0].Code;var c={loanTypeCode:a};p.assistanceProgram.getActiveLoans(c).then(function(a){if(a.success){if(a.data){if(0==a.data.Loans.length)for(var b=0;b<t.tabMenuStructure.length;b++)if("assistantProgram"==t.tabMenuStructure[b].sectionName)return void t.tabMenuStructure.splice(b,1);var c,d;a.data.Loans.forEach(function(a){a.IsActive?c=a:d?new Date(a.CloseDateUTC).getTime()>new Date(d.CloseDateUTC).getTime()&&(d=a):d=a}),c?(t.assistantProgram.nextDueDate=moment(c.NextRepaymentDateUTC,"YYYY-MM-DD").format("DD-MM-YYYY"),t.assistantProgram.nextDueAmount=c.RepaymentAmount,t.loanId=c.Id,t.getListOfLoanRepayments(),t.assistantProgram.loanIssueDate=moment(c.StartDateUTC,"YYYY-MM-DD").format("DD-MM-YYYY"),t.assistantProgram.totalAssistanceAmount=c.LoanAmount,t.assistantProgram.totalOutstandingAmount=c.OutstandingAmount,t.assistantProgram.totalAmountRepaid=t.assistantProgram.totalAssistanceAmount-t.assistantProgram.totalOutstandingAmount,t.assistantProgram.dueAmountTopay=c.OverdueAmount):(t.fullPaymentReceived=!0,t.loanId=d.Id,t.getListOfLoanRepayments(),t.assistantProgram.loanIssueDate=moment(d.StartDateUTC,"YYYY-MM-DD").format("DD-MM-YYYY"),t.assistantProgram.totalAssistanceAmount=d.LoanAmount,t.assistantProgram.totalOutstandingAmount=d.OutstandingAmount,t.assistantProgram.totalAmountRepaid=t.assistantProgram.totalAssistanceAmount-t.assistantProgram.totalOutstandingAmount,t.assistantProgram.dueAmountTopay=d.OverdueAmount)}}else if(a.data&&a.data.ErrorCode){var e=a.data.ErrorCode;e||(e=locale.account.shopWebsite.reports.assistanceProgram.payLoanAmountGeneralErrors.INTERNAL_SERVER_ERROR),l.showMessage("error",e,"exclamation-triangle",!1,"",!1,"").done()}})}})},this.getListOfLoanRepayments=function(){var a={loanID:t.loanId};p.assistanceProgram.getloanRepayments(a).then(function(a){if(!a.success&&a.data&&a.data.ErrorCode){var b=a.data.ErrorCode;return b||(b=locale.account.shopWebsite.reports.assistanceProgram.payLoanAmountGeneralErrors.INTERNAL_SERVER_ERROR),void l.showMessage("error",b,"exclamation-triangle",!1,"",!1,"").done()}t.assistantProgram.repaymentData=a.data.Repayments})},this.payAmount=function(a){if(a>0){var b='<div class="message-box info"><div class="contentMessage"> Are you sure you want to pay the amount : <b>'+a+"<b></div></div>";l.showMessageWithHtml(b,!0,locale.common.cancel,!0,locale.common.proceed).then(function(){var b={LoanId:t.loanId,Amount:a};p.assistanceProgram.payAssistanceLoanAmount(b).then(function(a){if(t.otherPaymentAmount="",t.checkToEnablePayBtn(),a.success)l.showSuccessMessage("Your transaction completed successfully! Transaction ID : "+a.data.TransactionId).done(),t.getAgentAssistanceLoanAccount();else{if(a.data&&a.data.ErrorCode===locale.account.shopWebsite.reports.assistanceProgram.payLoanAmountGeneralErrors.Loan_Unauthorized){var b='<div class="popup-title">'+locale.account.shopWebsite.reports.assistanceProgram.payLoanAmountGeneralErrors.UnAuthorizedLoanError+" </div>",c='<div class="couponConfirmation"><div class="messageContent">'+b+"</div></div>";return void l.showMessage("error",c,"exclamation-triangle",!1,"",!1,"").done()}var d=a.data.ErrorCode;d||(d=locale.account.shopWebsite.reports.assistanceProgram.payLoanAmountGeneralErrors.INTERNAL_SERVER_ERROR),d.includes("{TransactionAmount}")&&(d=d.replace("{TransactionAmount}",a.data.ErrorDetails.TransactionAmount)),l.showMessage("error",d,"exclamation-triangle",!1,"",!1,"").done()}})}).catch(function(a){}).done()}},this.getDatefromString=function(a){return a.split("T")[0].split("-").reverse().join("-")},this.init=function(){t.filterByPermission(),t.getAgentAssistanceLoanAccount(),t.showAgentList&&t.getDirectDesendentAgent(),t.showShopOwnerList&&t.getDesendentShopOwners(),g(function(){if(t.tabMenuStructure.length){var a="";if("1"===d.params.reportType)switch(d.params.reportTab){case"1":a=t.tabMenuStructure[1].sectionName;break;case"2":a=t.tabMenuStructure[2].sectionName;break;case"3":a=t.tabMenuStructure[3].sectionName;break;case"4":a=t.tabMenuStructure[4].sectionName;break;case"5":a=t.tabMenuStructure[5].sectionName;break;case"6":a=t.tabMenuStructure[6].sectionName;break;default:a=t.tabMenuStructure[0].sectionName}else a=t.tabMenuStructure[0].sectionName;var b=m.getSearchParams();b?(t.dateSettings.fromDate=moment(b[0].ParameterValue).format("DD/MM/YYYY"),t.dateSettings.toDate=moment(b[1].ParameterValue).format("DD/MM/YYYY")):(t.dateSettings.fromDate=moment().subtract(6,"d").format("DD/MM/YYYY"),t.setLimitSearchDates("From"));var c=m.getWithCachedDataValue(),e=m.getDataCache("reload");e&&c?(m.setWithCachedDataValue(!1),t.showReport(a,e),t.loadReport(e)):t.showReport(a)}}),$(window).resize(function(){$("a.aItemReport .item").textfill({maxFontPixels:13,innerTag:"div"})})},t.init()}])}(),function(){"use strict";angular.module("shopReportDetails",[]).controller("ReportDetailsController",["$rootScope","$scope","$state","$uiRouterGlobals","loggingService","sportsApiService","$timeout","$sessionStorage","authService","$compile","$filter","helperService","ReportsService","$transitions","platformApiService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(a,c){var d="#detailsResults";q.isTableInitialized()&&$("#detailsResults").dataTable().api().destroy();$(d).DataTable({dom:'<"top"if>rt<"bottom"pBl><"clear">',oLanguage:{sLengthMenu:"Rows per page _MENU_"},data:a,paging:!0,columns:c,pageLength:10,bSort:!1,buttons:[{extend:"excel",text:'<i class="fa fa-file-text-o"></i>&emsp;Export to Excel',charset:"utf-8",bom:!0},{extend:"csv",text:'<i class="fa fa-file-text-o"></i>&emsp;Export to CSV',charset:"utf-8",bom:!0}],stateSave:!0,language:{url:q.getDTLocaleUrl()},createdRow:function(a,c,d){j(angular.element(a).contents())(b)}})}var q=this,r=(i.agentTypes,null),s=[],t=[],u=null,v="";this.selectedAgent="",this.currencySymbol=i.getUserData().currency.CurrencySymbol,this.sectionName="",this.showResult=!1,this.isSettled=!1,this.searchResults=null,this.parsParams=function(a){a={Parameters:a},angular.copy(a.Parameters.filter(function(a){return"SelectedDate"===a.ParameterName}),t),angular.copy(a.Parameters.filter(function(a){return"UserId"===a.ParameterName||"CommissionBand"===a.ParameterName||"IsSettled"===a.ParameterName}),s),s.push({ParameterName:"DateFrom",ParameterValue:moment(t[0].ParameterValue,"DD/MM/YYYY").format("YYYY-MM-DD")+"T00:00:00"+moment.tz(moment.tz.guess()).format("Z")},{ParameterName:"DateTo",ParameterValue:moment(t[0].ParameterValue,"DD/MM/YYYY").format("YYYY-MM-DD")+"T23:59:59"+moment.tz(moment.tz.guess()).format("Z")}),r="reportVDogRaceAnalysisCommission"===d.params.reportId?{Parameters:[{ParameterName:"UserId",ParameterValue:a.Parameters.filter(function(a){return"UserId"===a.ParameterName})[0].ParameterValue},{ParameterName:"CommissionBand",ParameterValue:a.Parameters.filter(function(a){return"CommissionBand"===a.ParameterName})[0].ParameterValue},{ParameterName:"DateFrom",ParameterValue:a.Parameters.filter(function(a){return"DateFrom"===a.ParameterName})[0].ParameterValue},{ParameterName:"DateTo",ParameterValue:a.Parameters.filter(function(a){return"DateTo"===a.ParameterName})[0].ParameterValue}]}:"reportGRLuckyBallCommissionEstimate"===d.params.reportId?{Parameters:[{ParameterName:"UserId",ParameterValue:a.Parameters.filter(function(a){return"UserId"===a.ParameterName})[0].ParameterValue},{ParameterName:"SelectionGroup",ParameterValue:a.Parameters.filter(function(a){return"Selection"===a.ParameterName})[0].ParameterValue},{ParameterName:"DateFrom",ParameterValue:a.Parameters.filter(function(a){return"SelectedDate"===a.ParameterName})[0].ParameterValue},{ParameterName:"DateTo",ParameterValue:a.Parameters.filter(function(a){return"SelectedDate"===a.ParameterName})[0].ParameterValue}]}:"reportSpin2WinAnalysisCommission"===d.params.reportId?{Parameters:[{ParameterName:"UserId",ParameterValue:a.Parameters.filter(function(a){return"UserId"===a.ParameterName})[0].ParameterValue},{ParameterName:"ProductType",ParameterValue:a.Parameters.filter(function(a){return"CommissionBand"===a.ParameterName})[0].ParameterValue},{ParameterName:"DateFrom",ParameterValue:a.Parameters.filter(function(a){return"DateFrom"===a.ParameterName})[0].ParameterValue},{ParameterName:"DateTo",ParameterValue:a.Parameters.filter(function(a){return"DateTo"===a.ParameterName})[0].ParameterValue}]}:"reportBKVMobileAnalysisCommission"===d.params.reportId?{Parameters:[{ParameterName:"UserId",ParameterValue:a.Parameters.filter(function(a){return"UserId"===a.ParameterName})[0].ParameterValue},{ParameterName:"CommissionBand",ParameterValue:a.Parameters.filter(function(a){return"CommissionBand"===a.ParameterName})[0].ParameterValue},{ParameterName:"DateFrom",ParameterValue:a.Parameters.filter(function(a){return"DateFrom"===a.ParameterName})[0].ParameterValue},{ParameterName:"DateTo",ParameterValue:a.Parameters.filter(function(a){return"DateTo"===a.ParameterName})[0].ParameterValue}]}:"reportLotSpecialFiveAnalysisCommission"===d.params.reportId||"reportLotDailyDrawAnalysisCommission"===d.params.reportId?{Parameters:[{ParameterName:"UserId",ParameterValue:a.Parameters.filter(function(a){return"UserId"===a.ParameterName})[0].ParameterValue},{ParameterName:"Selection",ParameterValue:a.Parameters.filter(function(a){return"Selection"===a.ParameterName})[0].ParameterValue},{ParameterName:"DateFrom",ParameterValue:a.Parameters.filter(function(a){return"DateFrom"===a.ParameterName})[0].ParameterValue},{ParameterName:"DateTo",ParameterValue:a.Parameters.filter(function(a){return"DateTo"===a.ParameterName})[0].ParameterValue}]}:{Parameters:s}},this.parsReportID=function(){switch(d.params.reportId){case"reportSportsAnalysisCommission":u="reportSportsAnalysisDetailsCommission",v="sportsAnalysisDetailsCommission",q.sectionName=locale.account.shopWebsite.reports.titles.commissions+" / "+locale.account.shopWebsite.reports.commissionAnalysis.titles.sportsAnalysis+locale.account.shopWebsite.reports.commissionAnalysis.titles.secondLevelDetails;break;case"reportBKVAnalysisCommission":u="reportBKVAnalysisDetailsCommission",v="bKVAnalysisDetailsCommission",q.sectionName=locale.account.shopWebsite.reports.titles.commissions+" / "+locale.account.shopWebsite.reports.commissionAnalysis.titles.betKingVirtualAnalysis+locale.account.shopWebsite.reports.commissionAnalysis.titles.secondLevelDetails;break;case"reportBKVMobileAnalysisCommission":u="reportBKVMobileAnalysisDetailsCommission",v="bKVMobileAnalysisDetailsCommission",q.sectionName=locale.account.shopWebsite.reports.titles.commissions+" / "+locale.account.shopWebsite.reports.commissionAnalysis.titles.betKingMobileVirtualAnalysis+locale.account.shopWebsite.reports.commissionAnalysis.titles.secondLevelDetails;break;case"reportGBVirtualAnalysisCommission":u="reportGBVirtualAnalysisDetailsCommission",v="gBVirtualAnalysisDetailsCommission",q.sectionName=locale.account.shopWebsite.reports.titles.commissions+" / "+locale.account.shopWebsite.reports.commissionAnalysis.titles.globalBetVirtualAnalysis+locale.account.shopWebsite.reports.commissionAnalysis.titles.secondLevelDetails;break;case"reportGBColorAnalysisCommission":u="reportGBColorAnalysisDetailsCommission",v="gBColorAnalysisDetailsCommission",q.sectionName=locale.account.shopWebsite.reports.titles.commissions+" / "+locale.account.shopWebsite.reports.commissionAnalysis.titles.globalBetColorColorAnalysis+locale.account.shopWebsite.reports.commissionAnalysis.titles.secondLevelDetails;break;case"reportLotSpecialFiveAnalysisCommission":u="reportLotSpecialFiveAnalysisDetailsCommission",v="lotSpecialFiveAnalysisDetailsCommission",q.sectionName=locale.account.shopWebsite.reports.titles.commissions+" / "+locale.account.shopWebsite.reports.commissionAnalysis.titles.lotSpecialFiveAnalysis+locale.account.shopWebsite.reports.commissionAnalysis.titles.secondLevelDetails;break;case"reportLotDailyDrawAnalysisCommission":u="reportLotDailyDrawAnalysisDetailsCommission",v="lotDailyDrawAnalysisDetailsCommission",q.sectionName=locale.account.shopWebsite.reports.titles.commissions+" / "+locale.account.shopWebsite.reports.commissionAnalysis.titles.lotDailyAnalysis+locale.account.shopWebsite.reports.commissionAnalysis.titles.secondLevelDetails;break;case"reportGRLuckyBallCommissionEstimate":u="reportGRLuckyBallCommissionEstimateDetails",v="gRLuckyBallCommissionEstimateDetails",q.sectionName=locale.account.shopWebsite.reports.titles.commissions+" / "+locale.account.shopWebsite.reports.commissionAnalysis.titles.virtualLuckyBallAnalysis+locale.account.shopWebsite.reports.commissionAnalysis.titles.secondLevelDetails;break;case"reportVDogRaceAnalysisCommission":u="reportVDogRaceAnalysisDetailsCommission",v="vDogRaceAnalysisDetailsCommission",q.sectionName=locale.account.shopWebsite.reports.titles.commissions+" / "+locale.account.shopWebsite.reports.commissionAnalysis.titles.virtualDogRaceAnalysis+locale.account.shopWebsite.reports.commissionAnalysis.titles.secondLevelDetails;break;case"reportSpin2WinAnalysisCommission":u="reportSpin2WinAnalysisDetailsCommission",v="spin2WinAnalysisDetailsCommission",q.sectionName=locale.account.shopWebsite.reports.titles.commissions+" / "+locale.account.shopWebsite.reports.commissionAnalysis.titles.virtualSpin2WinAnalysis+locale.account.shopWebsite.reports.commissionAnalysis.titles.secondLevelDetails}},this.hideLoader=function(){a.hideLoader("#reportDetails")},this.showResultTable=function(){q.showResult=!0},this.showLoader=function(){q.showResult=!1,a.showLoader("#reportDetails",".report-details-container",0)},this.isTableInitialized=function(){return $.fn.DataTable.isDataTable($("#detailsResults"))},this.navigateBack=function(){m.setWithCachedDataValue(!0),c.go("shopReports",{reportType:1,reportTab:d.params.reportTab})},this.getDTLocaleUrl=function(){var a="//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/";switch(globalSettings.CurrentLanguage){case"es":return a+"Spanish.json";case"it":return a+"Italian.json";case"pt":return a+"Portuguese-Brasil.json";case"ro":return a+"Romanian.json";default:return a+"English.json"}},this.init=function(){q.showLoader(),q.parsParams(m.getSearchParams()),q.parsReportID(),q.searchResults=null,m.getReportData(u,r).then(function(a){return a.success?a.data:(e.logError("Unable to get "+q.reportIdentifier+" summary: "+JSON.stringify(a.error)),l.showErrorMessage("Unable to get data"),void q.hideLoader())}).then(function(a){q.searchResults=m.transformResponseForDataTable(a.Data,v),p(q.searchResults,m.generateColumns(v,q.currencySymbol,q.isSettled)),q.hideLoader(),0!==q.searchResults.length&&q.showResultTable()}).catch(function(a){e.logError("Unable to get "+q.reportIdentifier+" summary: "+JSON.stringify(a)),q.hideLoader()})},q.init()}])}(),function(){"use strict";angular.module("agentWelcomeBonusDataParser.service",[]).factory("agentWelcomeBonusDataParserService",["$filter","$location","bonusCalculationService","modelsObjects","currencyService","authService",function(a,b,c,d,e,f){return{parseProgressAndTargets:function(b,c,d,g,h){var i="",j=0,k={byBandTargets:[{band:0,daysTradedTarget:"5",weeklyTarget:49999.99,dailyBetsTarget:[{day:"Monday",maxValue:10,minValue:0},{day:"Tuesday",maxValue:10,minValue:0},{day:"Wednesday",maxValue:10,minValue:0},{day:"Thursday",maxValue:10,minValue:0},{day:"Friday",maxValue:10,minValue:0},{day:"Saturday",maxValue:10,minValue:0},{day:"Sunday",maxValue:10,minValue:0}]},{band:1,daysTradedTarget:"6",weeklyTarget:49999.99,dailyBetsTarget:[{day:"Monday",maxValue:10,minValue:0},{day:"Tuesday",maxValue:10,minValue:0},{day:"Wednesday",maxValue:10,minValue:0},{day:"Thursday",maxValue:10,minValue:0},{day:"Friday",maxValue:10,minValue:0},{day:"Saturday",maxValue:10,minValue:0},{day:"Sunday",maxValue:10,minValue:0}]},{band:2,daysTradedTarget:"7",weeklyTarget:49999.99,dailyBetsTarget:[{day:"Monday",maxValue:10,minValue:0},{day:"Tuesday",maxValue:10,minValue:0},{day:"Wednesday",maxValue:10,minValue:0},{day:"Thursday",maxValue:10,minValue:0},{day:"Friday",maxValue:10,minValue:0},{day:"Saturday",maxValue:10,minValue:0},{day:"Sunday",maxValue:10,minValue:0}]}],byWeekDailyActivity:[{bets:0,dayTitle:"Mon"},{bets:0,dayTitle:"Tue"},{bets:0,dayTitle:"Wed"},{bets:0,dayTitle:"Thu"},{bets:0,dayTitle:"Fri"},{bets:0,dayTitle:"Sat"},{bets:0,dayTitle:"Sun"}],currentStatuses:[{currentValue:0,currentValueDisplay:"0",name:"Stake in ",targetGoal:5e4,targetValueDisplay:"50000"},{currentValue:0,currentValueDisplay:"0",name:"Daily Targets Reached",targetGoal:10,targetValueDisplay:"10"},{currentValue:0,currentValueDisplay:"0",name:"Traded Days",targetGoal:5,targetValueDisplay:"5"}],currentBandPosition:.05,progress:"expired",dailyBets:10,daysTraded:5,maxStake:5e4,bonusEarnedSoFar:"0",rewardPerDay:"0",minStake:0,band:0,sportsCurrentStatuses:!1,virtualsCurrentStatuses:!1,completed:!0};if(d&&c){d.forEach(function(a){"WeeklyStake"===a.TargetName&&(k.maxStake=a.TargetInfoList[0].Target[0].Value,k.byBandTargets[0].weeklyTarget=k.maxStake-.01,k.byBandTargets[1].weeklyTarget=k.maxStake-.01,k.byBandTargets[2].weeklyTarget=k.maxStake-.01),"DaysTraded"===a.TargetName&&(k.daysTraded=a.TargetInfoList[0].Target[0].Value,k.byBandTargets[0].daysTradedTarget=k.daysTraded,k.byBandTargets[1].daysTradedTarget=parseFloat(k.daysTraded)+1+"",k.byBandTargets[2].daysTradedTarget=parseFloat(k.daysTraded)+2+""),"DailyBets"===a.TargetName&&(k.dailyBets=a.TargetInfoList[0].Target[0].Value,k.byBandTargets.forEach(function(a){a.dailyBetsTarget.forEach(function(a){a.maxValue=Math.floor(parseFloat(k.dailyBets))})}))}),c.forEach(function(a){if("SportsTraded"===a.TypeCode&&(k.sportsCurrentStatuses="True"===a.Value),"VirtualsTraded"===a.TypeCode&&(k.virtualsCurrentStatuses="True"===a.Value),"RewardPerDay"===a.TypeCode&&(k.rewardPerDay=a.Value),"DailyBets"===a.TypeCode)switch(j+=parseFloat(a.Value),a.PeriodTypeCode){case"Sunday":var b=_.findIndex(k.byWeekDailyActivity,function(a){return"Sun"===a.dayTitle});k.byWeekDailyActivity[b].bets=Math.floor(parseFloat(a.Value));break;case"Saturday":var c=_.findIndex(k.byWeekDailyActivity,function(a){return"Sat"===a.dayTitle});k.byWeekDailyActivity[c].bets=Math.floor(parseFloat(a.Value));break;case"Friday":var d=_.findIndex(k.byWeekDailyActivity,function(a){return"Fri"===a.dayTitle});k.byWeekDailyActivity[d].bets=Math.floor(parseFloat(a.Value));break;case"Thursday":var e=_.findIndex(k.byWeekDailyActivity,function(a){return"Thu"===a.dayTitle});k.byWeekDailyActivity[e].bets=Math.floor(parseFloat(a.Value));break;case"Wednesday":var f=_.findIndex(k.byWeekDailyActivity,function(a){return"Wed"===a.dayTitle});k.byWeekDailyActivity[f].bets=Math.floor(parseFloat(a.Value));break;case"Tuesday":var g=_.findIndex(k.byWeekDailyActivity,function(a){return"Tue"===a.dayTitle});k.byWeekDailyActivity[g].bets=Math.floor(parseFloat(a.Value));break;case"Monday":var h=_.findIndex(k.byWeekDailyActivity,function(a){return"Mon"===a.dayTitle});k.byWeekDailyActivity[h].bets=Math.floor(parseFloat(a.Value))}"WeeklyStake"===a.TypeCode&&(k.currentStatuses[0].currentValue=parseFloat(a.Value),k.currentStatuses[0].currentValueDisplay=parseFloat(a.Value)+"",k.currentStatuses[0].targetGoal=k.maxStake,k.currentStatuses[0].targetValueDisplay=k.maxStake+""),"DailyBets"===a.TypeCode&&(k.currentStatuses[1].currentValue=parseFloat(a.Value),k.currentStatuses[1].currentValueDisplay=parseFloat(a.Value)+"",k.currentStatuses[1].targetGoal=k.dailyBets,k.currentStatuses[1].targetValueDisplay=k.dailyBets+""),"DaysTraded"===a.TypeCode&&(k.currentStatuses[2].currentValue=parseFloat(a.Value),k.currentStatuses[2].currentValueDisplay=parseFloat(a.Value)+"",k.currentStatuses[2].targetGoal=k.daysTraded,k.currentStatuses[2].targetValueDisplay=k.daysTraded+"",parseFloat(a.Value)<=5?(k.band=0,5===parseFloat(a.Value)&&(k.currentBandPosition=1.33),4===parseFloat(a.Value)&&(k.currentBandPosition=1.06),3===parseFloat(a.Value)&&(k.currentBandPosition=.8),2===parseFloat(a.Value)&&(k.currentBandPosition=.53),1===parseFloat(a.Value)&&(k.currentBandPosition=.27)):6===parseFloat(a.Value)?(k.band=1,k.currentBandPosition=2.66):parseFloat(a.Value)>=7&&(k.band=2,k.currentBandPosition=4))});var l=moment().startOf("isoWeek").format("DD/MM/YYYY"),m=moment().add(1,"weeks").startOf("isoWeek").format("DD/MM/YYYY");i=g!==l&&h!==m?"closed":globalSettings.Reports_AgentWelcomeBonusDashboard.Expired?"expired":"inProgress",k.bonusEarnedSoFar=e.formatNumber(f.getUserData().currency.Currency,a("removeDecimalPoints")(k.rewardPerDay),!1,!0),k.progress=i}return k}}}])}(),function(){"use strict";angular.module("blackFridayBonusDataParser.service",[]).factory("blackFridayBonusDataParserService",["$location","bonusCalculationService","modelsObjects",function(a,b,c){return{emptyModelObject:function(){return{band:0,bonusEarnedSoFar:"0",dailyBets:400,daysTraded:6,maxStake:150,minStake:0,progress:"inProgress",completed:!1,currentBandPosition:0,byBandTargets:[{band:1,weeklyTarget:149.99,daysTradedTarget:"6",dailyBetsTarget:[{day:"Week",maxValue:400,minValue:0}]},{band:2,weeklyTarget:499.99,daysTradedTarget:"6",dailyBetsTarget:[{day:"Week",maxValue:500,minValue:400}]},{band:3,weeklyTarget:999.99,daysTradedTarget:"6",dailyBetsTarget:[{day:"Week",maxValue:1e3,minValue:500}]}],currentStatuses:[{currentValue:0,currentValueDisplay:"0",name:locale.account.shopWebsite.bonusDashboard.currentStatus.stakeIn,targetGoal:150,targetValueDisplay:"150"},{currentValue:0,currentValueDisplay:"0",name:locale.account.shopWebsite.bonusDashboard.currentStatus.dailyBets,targetGoal:400,targetValueDisplay:"400"},{currentValue:0,currentValueDisplay:"0",name:locale.account.shopWebsite.bonusDashboard.currentStatus.tradedDays,targetGoal:6,targetValueDisplay:"6"}],byWeekDailyActivity:[{bets:0,dayTitle:"Week"}]}},getTargetsValues:function(a){var b={};return 0===a.band&&(b.minStake=0,b.maxStake=a.byBandTargets[0].weeklyTarget+.01,b.daysTraded=parseFloat(a.byBandTargets[0].daysTradedTarget),b.dailyBets=parseFloat(a.byBandTargets[0].dailyBetsTarget[0].maxValue)),1===a.band&&(b.minStake=a.byBandTargets[0].weeklyTarget+.01,b.maxStake=a.byBandTargets[1].weeklyTarget+.01,b.daysTraded=parseFloat(a.byBandTargets[1].daysTradedTarget),b.dailyBets=parseFloat(a.byBandTargets[1].dailyBetsTarget[0].maxValue)),2===a.band&&(b.minStake=a.byBandTargets[1].weeklyTarget+.01,b.maxStake=a.byBandTargets[2].weeklyTarget+.01,b.daysTraded=parseFloat(a.byBandTargets[2].daysTradedTarget),b.dailyBets=parseFloat(a.byBandTargets[2].dailyBetsTarget[0].maxValue)),3===a.band&&(b.minStake=a.byBandTargets[2].weeklyTarget+.01,b.maxStake=a.byBandTargets[3].weeklyTarget+.01,b.daysTraded=parseFloat(a.byBandTargets[3].daysTradedTarget),b.dailyBets=parseFloat(a.byBandTargets[3].dailyBetsTarget[0].maxValue)),b},calculatingBandNode3Level:function(a,b){var c=0,d=0;return a.currentStatuses[0].currentValue>=0&&(c=0,a.currentStatuses[0].currentValue>=a.byBandTargets[0].weeklyTarget+.01&&(c=1,a.currentStatuses[0].currentValue>=a.byBandTargets[1].weeklyTarget+.01&&(c=2,a.currentStatuses[0].currentValue>=a.byBandTargets[2].weeklyTarget+.01&&(c=3)))),a.currentStatuses[2].currentValue>=0&&(d=0,a.currentStatuses[2].currentValue>=a.byBandTargets[0].daysTradedTarget&&(d=1,a.currentStatuses[2].currentValue>=a.byBandTargets[1].daysTradedTarget&&(d=2,a.currentStatuses[2].currentValue>=a.byBandTargets[2].daysTradedTarget&&(d=3)))),Math.min.apply(Math,[c,b,d])},calculatePercentToNextBandBF:function(a,b){var c=function(){if(b.currentStatuses[0].currentValue===a.minStake)return 0;if(b.currentStatuses[0].currentValue>=a.maxStake)return.3334;var c=b.currentStatuses[0].currentValue-a.minStake,d=a.maxStake-a.minStake;return c>0?.3334*c/d:0},d=c(),e=function(){return 0===b.currentStatuses[1].currentValue?0:b.currentStatuses[1].currentValue>=a.dailyBets?.3333:.3333*b.currentStatuses[1].currentValue/a.dailyBets},f=e(),g=function(){return 0===b.currentStatuses[2].currentValue?0:b.currentStatuses[2].currentValue>=a.daysTraded?.3333:.3333*b.currentStatuses[2].currentValue/a.daysTraded},h=g();console.log("band"+b.band+"stake"+d+"days"+h+"bets"+f);var i=parseFloat((b.band+d+h+f).toFixed(4));return i},parseBlkFrdProgressAndTargets:function(a,c,d,e,f){var g={currentStatuses:[{currentValue:0,currentValueDisplay:"0",name:locale.account.shopWebsite.bonusDashboard.currentStatus.stakeIn},{currentValue:0,currentValueDisplay:"0",name:"Weekly Bets"},{currentValue:0,currentValueDisplay:"0",name:locale.account.shopWebsite.bonusDashboard.currentStatus.tradedDays}],byWeekDailyActivity:[{bets:0,dayTitle:"Week"}],band:0,bonusEarnedSoFar:"0",byBandTargets:[{band:1,dailyBetsTarget:[{}]},{band:2,dailyBetsTarget:[{}]},{band:3,dailyBetsTarget:[{}]}]},h=0,i=0,j=0,k=0;if(d&&c){c.forEach(function(a){if("WeeklyStake"===a.TypeCode&&(g.currentStatuses[0].currentValue=parseFloat(a.Value),g.currentStatuses[0].currentValueDisplay=parseFloat(a.Value)+"",h=parseFloat(a.Value)),"DaysTraded"===a.TypeCode&&(g.currentStatuses[2].currentValue=parseFloat(a.Value),g.currentStatuses[2].currentValueDisplay=parseFloat(a.Value)+"",i=parseFloat(a.Value),k=parseFloat(a.Value)),"WeeklyBets"===a.TypeCode)switch(j+=parseFloat(a.Value),a.PeriodTypeCode){case"Weekly":g.byWeekDailyActivity=[{bets:parseFloat(a.Value),dayTitle:"Week"}]}}),d.forEach(function(a){"WeeklyStake"===a.TargetName&&a.TargetInfoList[0].Target.forEach(function(a){1===a.TierLevel?g.byBandTargets.forEach(function(b){1===b.band&&(b.weeklyTarget=parseFloat(a.Value))}):2===a.TierLevel?g.byBandTargets.forEach(function(b){2===b.band&&(b.weeklyTarget=parseFloat(a.Value))}):3===a.TierLevel&&g.byBandTargets.forEach(function(b){3===b.band&&(b.weeklyTarget=parseFloat(a.Value))})}),"DaysTraded"===a.TargetName&&g.byBandTargets.forEach(function(b){b.daysTradedTarget=a.TargetInfoList[0].Target[0].Value}),"WeeklyBets"===a.TargetName&&a.TargetInfoList.forEach(function(a,b){g.byBandTargets.forEach(function(c){c.dailyBetsTarget[b]={day:a.PeriodTypeCode}}),a.Target.forEach(function(a){1===a.TierLevel?g.byBandTargets.forEach(function(c){1===c.band&&(c.dailyBetsTarget[b].maxValue=Math.floor(parseFloat(a.Value)+1))}):2===a.TierLevel?g.byBandTargets.forEach(function(c){2===c.band&&(c.dailyBetsTarget[b].maxValue=Math.floor(parseFloat(a.Value)+1))}):3===a.TierLevel&&g.byBandTargets.forEach(function(c){3===c.band&&(c.dailyBetsTarget[b].maxValue=Math.floor(parseFloat(a.Value)+1))})}),g.byBandTargets.forEach(function(a){a.dailyBetsTarget.forEach(function(b,c){1===a.band?b.minValue=0:2===a.band?b.minValue=parseFloat(g.byBandTargets[0].dailyBetsTarget[c].maxValue):3===a.band&&(b.minValue=parseFloat(g.byBandTargets[1].dailyBetsTarget[c].maxValue))})})})});var l,m=[{band:0,dailyBetsReached:0},{band:1,dailyBetsReached:0},{band:2,dailyBetsReached:0}];g.byWeekDailyActivity.forEach(function(a,b){a.bets&&a.bets>=g.byBandTargets[0].dailyBetsTarget[b].maxValue&&(m[0].dailyBetsReached=m[0].dailyBetsReached+1,a.bets>=g.byBandTargets[1].dailyBetsTarget[b].maxValue&&(m[1].dailyBetsReached=m[1].dailyBetsReached+1,a.bets>=g.byBandTargets[2].dailyBetsTarget[b].maxValue&&(m[2].dailyBetsReached=m[2].dailyBetsReached+1)))}),l=m[2].dailyBetsReached>=parseFloat(g.byBandTargets[2].daysTradedTarget)?2:m[1].dailyBetsReached>=parseFloat(g.byBandTargets[1].daysTradedTarget)?1:0,g.band=this.calculatingBandNode3Level(g,l),g.currentStatuses[1].currentValue=g.byWeekDailyActivity[0].bets,
g.currentStatuses[1].currentValueDisplay=g.currentStatuses[1].currentValue+"";var n=this.getTargetsValues(g);g.currentBandPosition=this.calculatePercentToNextBandBF(n,g);var o=Math.floor(g.currentBandPosition);if(o>g.band){g.band=o,n=this.getTargetsValues(g),g.currentBandPosition=this.calculatePercentToNextBandBF(n,g);var p=Math.floor(g.currentBandPosition);p>g.band&&(g.band=p,n=this.getTargetsValues(g),g.currentBandPosition=this.calculatePercentToNextBandBF(n,g))}g.progress=b.calculatingGeneralProgress(g.band,e,f),g.minStake=n.minStake,g.maxStake=n.maxStake,g.dailyBets=n.dailyBets,g.daysTraded=n.daysTraded,g.completed=!0,g.bonusEarnedSoFar=b.calculateBonusEarned(g.band,a,g.currentStatuses[0].currentValue),g.currentStatuses[0].targetGoal=n.maxStake,g.currentStatuses[0].targetValueDisplay=n.maxStake+"",g.currentStatuses[1].targetGoal=n.dailyBets,g.currentStatuses[1].targetValueDisplay=n.dailyBets+"",g.currentStatuses[2].targetGoal=n.daysTraded,g.currentStatuses[2].targetValueDisplay=n.daysTraded+""}else g=this.emptyModelObject();return g}}}])}(),function(){"use strict";angular.module("bonusCalculation.service",[]).factory("bonusCalculationService",["$location","$filter","$timeout","currencyService","authService",function(a,b,c,d,e){return{calculatingBandNode:function(a,b){var c=0,d=0;return a.currentStatuses[0].currentValue>=0&&(c=0,a.currentStatuses[0].currentValue>=a.byBandTargets[0].weeklyTarget+.01&&(c=1,a.currentStatuses[0].currentValue>=a.byBandTargets[1].weeklyTarget+.01&&(c=2,a.currentStatuses[0].currentValue>=a.byBandTargets[2].weeklyTarget+.01&&(c=3,a.currentStatuses[0].currentValue>=a.byBandTargets[3].weeklyTarget+.01&&(c=4))))),a.currentStatuses[2].currentValue>=0&&(d=0,a.currentStatuses[2].currentValue>=a.byBandTargets[0].daysTradedTarget&&(d=1,a.currentStatuses[2].currentValue>=a.byBandTargets[1].daysTradedTarget&&(d=2,a.currentStatuses[2].currentValue>=a.byBandTargets[2].daysTradedTarget&&(d=3,a.currentStatuses[2].currentValue>=a.byBandTargets[3].daysTradedTarget&&(d=4))))),Math.min.apply(Math,[c,b,d])},getTargetsValues:function(a){var b={};return 0===a.band&&(b.minStake=0,b.maxStake=a.byBandTargets[0].weeklyTarget+.01,b.dailyBets=parseFloat(a.byBandTargets[0].daysTradedTarget),b.daysTraded=parseFloat(a.byBandTargets[0].daysTradedTarget)),1===a.band&&(b.minStake=a.byBandTargets[0].weeklyTarget+.01,b.maxStake=a.byBandTargets[1].weeklyTarget+.01,b.dailyBets=parseFloat(a.byBandTargets[1].daysTradedTarget),b.daysTraded=parseFloat(a.byBandTargets[1].daysTradedTarget)),2===a.band&&(b.minStake=a.byBandTargets[1].weeklyTarget+.01,b.maxStake=a.byBandTargets[2].weeklyTarget+.01,b.dailyBets=parseFloat(a.byBandTargets[2].daysTradedTarget),b.daysTraded=parseFloat(a.byBandTargets[2].daysTradedTarget)),3===a.band&&(b.minStake=a.byBandTargets[2].weeklyTarget+.01,b.maxStake=a.byBandTargets[3].weeklyTarget+.01,b.dailyBets=parseFloat(a.byBandTargets[3].daysTradedTarget),b.daysTraded=parseFloat(a.byBandTargets[3].daysTradedTarget)),globalSettings.Reports_PowerDashboard.ShowTierFive?(4===a.band&&(b.minStake=a.byBandTargets[3].weeklyTarget+.01,b.maxStake=a.byBandTargets[4].weeklyTarget+.01,b.dailyBets=parseFloat(a.byBandTargets[3].daysTradedTarget),b.daysTraded=parseFloat(a.byBandTargets[3].daysTradedTarget)),5===a.band&&(b.minStake=a.byBandTargets[4].weeklyTarget+.01,b.maxStake=a.byBandTargets[4].weeklyTarget+.01,b.dailyBets=parseFloat(a.byBandTargets[3].daysTradedTarget),b.daysTraded=parseFloat(a.byBandTargets[3].daysTradedTarget))):4===a.band&&(b.minStake=a.byBandTargets[3].weeklyTarget+.01,b.maxStake=a.byBandTargets[3].weeklyTarget+.01,b.dailyBets=parseFloat(a.byBandTargets[3].daysTradedTarget),b.daysTraded=parseFloat(a.byBandTargets[3].daysTradedTarget)),b},calculateBonusEarned:function(a,c,f){var g,h=e.getUserData().currency.Currency;if(40093===c)0===a?g=d.formatNumber(h,b("removeDecimalPoints")(0),!1,!0):1===a?g=d.formatNumber(h,b("removeDecimalPoints")(1e3),!1,!0):2===a?g=d.formatNumber(h,b("removeDecimalPoints")(1e4),!1,!0):3===a?g=d.formatNumber(h,b("removeDecimalPoints")(2e4),!1,!0):4===a&&(g=d.formatNumber(h,b("removeDecimalPoints")(3e4),!1,!0));else if(40092===c)0===a?g=d.formatNumber(h,b("removeDecimalPoints")(0),!1,!0):1===a?g=d.formatNumber(h,b("removeDecimalPoints")(1e3),!1,!0):2===a?g=d.formatNumber(h,b("removeDecimalPoints")(3e3),!1,!0):3===a?g=d.formatNumber(h,b("removeDecimalPoints")(5e3),!1,!0):4===a&&(g=d.formatNumber(h,b("removeDecimalPoints")(1e4),!1,!0));else if(40094===c)0===a?g=d.formatNumber(h,b("removeDecimalPoints")(0),!1,!0):1===a?g=d.formatNumber(h,b("removeDecimalPoints")(2e3),!1,!0):2===a?g=d.formatNumber(h,b("removeDecimalPoints")(5e3),!1,!0):3===a&&(g=d.formatNumber(h,b("removeDecimalPoints")(1e4),!1,!0));else if(40095===c)if(0===a)g=d.formatNumber(h,b("removeDecimalPoints")(0),!1,!0);else if(1===a)g=d.formatNumber(h,b("removeDecimalPoints")(2e3),!1,!0);else if(2===a)g=d.formatNumber(h,b("removeDecimalPoints")(8e3),!1,!0);else if(3===a)g=d.formatNumber(h,b("removeDecimalPoints")(1e4),!1,!0);else if(4===a)g=d.formatNumber(h,b("removeDecimalPoints")(15e3),!1,!0);else if(5===a&&globalSettings.Reports_PowerDashboard.ShowTierFive){var i=f/100;g=d.formatNumber(h,b("removeDecimalPoints")(i),!1,!0)}return g},calculatingGeneralProgress:function(a,b,c){var d="";0===a?d="inProgress":1===a?d="level1Achieved":2===a?d="level2Achieved":3===a?d="level3Achieved":4===a&&(d="achieved");var e=moment().startOf("isoWeek").format("DD/MM/YYYY"),f=moment().endOf("isoWeek").format("DD/MM/YYYY");return b!==e&&c!==f&&"inProgress"===d&&(d="closed"),d},calculatePercentToNextBand:function(a,b){var c=function(){if(b.currentStatuses[0].currentValue===a.minStake)return 0;if(b.currentStatuses[0].currentValue>=a.maxStake)return.3334;var c=b.currentStatuses[0].currentValue-a.minStake,d=a.maxStake-a.minStake;return c>0?.3334*c/d:0},d=c(),e=function(){return 0===b.currentStatuses[1].currentValue?0:b.currentStatuses[1].currentValue>=a.dailyBets?.3333:.3333*b.currentStatuses[1].currentValue/a.dailyBets},f=e(),g=function(){return 0===b.currentStatuses[2].currentValue?0:b.currentStatuses[2].currentValue>=a.daysTraded?.3333:.3333*b.currentStatuses[2].currentValue/a.daysTraded},h=g(),i=parseFloat((b.band+d+h+f).toFixed(4));return i}}}])}(),function(){"use strict";angular.module("shopBonusDashboardReport",["models.objects","monthlySportModels.objects","singleBonusDataParser.service","agentWelcomeBonusDataParser.service","bonusCalculation.service","mulipleBonusesDataParsing.service","blackFridayBonusDataParser.service","monthlySportReport.service"]).controller("BonusDashboardController",["modelsObjects","monthlySportModelsObjects","platformApiService","singleBonusDataParserService","agentWelcomeBonusDataParserService","mulipleBonusesDataParsingService","blackFridayBonusDataParserService","monthlySportReportService","authService","helperService","currencyService","$scope","$filter","$templateCache","$timeout","$localStorage","$rootScope","$q","$state",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t,u=this,v=null,w=i.getUserData().currency.Currency;this.currencySymbol=i.getUserData().currency.CurrencySymbol,this.dataCommissions={},this.currData={},this.multiplePieChartData={},this.liveData={completed:!1},this.ligaData={completed:!1},this.blkFrdyData={completed:!1},this.doubleData={completed:!1},this.powerData={completed:!1},this.agentWelcomeBonusData={completed:!1},this.monthlySportData={showDetailedReport:!1,tableData:[]},this.monthlySportSelectedDateRange,this.multiplePieChartOptions=a.multiplePieChartOptionsModel(),this.dateFilter=a.dateFilterModel(),this.progressBarModel={},this.reportTabs=a.reportTabsModel(),this.overview=a.overviewModel(),this.disclaimer="",this.bandsQty,this.userSelectedBand=0,this.isInfoPopup=!1,this.dailyBetsMin=null,this.dailyBetsMax=null,this.pieMaxValueLabel=0,this.pieCurrValueLabel=0,this.bendSelected="inProgress",this.selectedTab=u.reportTabs[0].id,this.bonusDatesPeriod=u.dateFilter[u.selectedTab].fromDate+" TO "+u.dateFilter[u.selectedTab].toDate,this.bonusEarnedSoFar=0,this.levelWidth,this.hideLoader=function(){q.hideLoader(".reportsContainer")},this.showLoader=function(){u.showResult=!1,q.showLoader(".reportsContainer",".panel-body",0)},this.checkIfNewTag=function(a){return"Monthly Sport Bonus"===a||"New Agent Fuel Bonus"===a},this.checkPeriodTitle=function(a){var b="";switch(a){case 6:b=locale.account.shopWebsite.bonusDashboard.turnoverForTheMonth;break;default:b=locale.account.shopWebsite.bonusDashboard.turnoverForTheWeek}return b},this.onTabChange=function(b){if(u.selectedTab!==b){u.currData={};var c=_.findIndex(u.reportTabs,function(a){return a.id===b});if(t=u.reportTabs[c].apiId,u.selectedTab=b,t)if(40093===t)globalSettings.Reports_LiveDashboard.Visible&&(u.progressBarModel=a.progressBarModel(),u.levelWidth={width:+(100/u.progressBarModel.length)+"%"},u.currData=u.liveData,u.disclaimer=locale.account.shopWebsite.bonusDashboard.kingLiveDisclaimer,u.updateBand());else if(40092===t)globalSettings.Reports_LigaDashboard.Visible&&(u.progressBarModel=a.progressBarModel(),u.levelWidth={width:+(100/u.progressBarModel.length)+"%"},u.currData=u.ligaData,u.disclaimer=locale.account.shopWebsite.bonusDashboard.kingLigaDisclaimer,u.updateBand());else if(40091===t)globalSettings.Reports_DoubleDashboard.Visible&&(u.disclaimer=locale.account.shopWebsite.bonusDashboard.kingDoubleBonusDisclaimer);else if(globalSettings.Reports_BlackFridayDashboard.Visible)40094===t&&(u.progressBarModel=a.progressBarBlkFrdModel(),u.levelWidth={width:+(100/u.progressBarModel.length)+"%"},u.currData=u.blkFrdyData,u.disclaimer=locale.account.shopWebsite.bonusDashboard.blackFridayBonusDisclaimer,u.updateBand());else if(40095===t)globalSettings.Reports_PowerDashboard.Visible&&(u.progressBarModel=globalSettings.Reports_PowerDashboard.ShowTierFive?a.fiveTierProgressBarModel():a.progressBarModel(),u.levelWidth={width:+(100/u.progressBarModel.length)+"%"},u.currData=u.powerData,u.disclaimer=locale.account.shopWebsite.bonusDashboard.powerBonusDisclaimer,u.updateBand());else if(40096===t)globalSettings.Reports_AgentWelcomeBonusDashboard.Visible&&(u.progressBarModel=a.threeTierProgressBarModel(),u.levelWidth={width:+(100/u.progressBarModel.length)+"%"},u.currData=u.agentWelcomeBonusData,u.disclaimer=locale.account.shopWebsite.bonusDashboard.agentWelcomeBonusDisclaimer,u.updateBand());else if(40040===t){if(!globalSettings.Reports_MontlySportsDashboard.Visible)return;u.disclaimer=locale.account.shopWebsite.bonusDashboard.monthlyBonusDisclaimer}}},this.showInfoPopup=function(a,b){"Monthly Sport Bonus"===b?this.infoId=6:this.infoId=a,u.isInfoPopup=!0},this.closePopup=function(){u.isInfoPopup=!u.isInfoPopup},this.dateChange=function(a){if(u.userSelectedBand=0,"currentWeek"!==a&&"lastWeek"!==a||!u.dateFilter[u.selectedTab].currentWeekDisable&&!u.dateFilter[u.selectedTab].lastWeekDisable){var b=moment().diff(moment(u.dateFilter[u.selectedTab].fromDate,"DD/MM/YYYY"),"days");b<0&&(j.showMessage("error center-message",locale.account.shopWebsite.bonusDashboard.futureDatesError,"exclamation-triangle"),u.dateFilter[u.selectedTab].fromDate=moment().startOf("isoWeek").format("DD/MM/YYYY"),u.dateFilter[u.selectedTab].toDate=moment(u.dateFilter[u.selectedTab].fromDate,"DD/MM/YYYY").add(7,"days").format("DD/MM/YYYY"),u.dateFilter[u.selectedTab].toDateDisplay=moment(u.dateFilter[u.selectedTab].fromDate,"DD/MM/YYYY").add(6,"days").format("DD/MM/YYYY")),"currentWeek"===a&&(u.dateFilter[u.selectedTab].fromDate=moment().startOf("isoWeek").format("DD/MM/YYYY"),u.dateFilter[u.selectedTab].toDate=moment(u.dateFilter[u.selectedTab].fromDate,"DD/MM/YYYY").add(7,"days").format("DD/MM/YYYY"),u.dateFilter[u.selectedTab].toDateDisplay=moment(u.dateFilter[u.selectedTab].fromDate,"DD/MM/YYYY").add(6,"days").format("DD/MM/YYYY")),"lastWeek"===a&&(u.dateFilter[u.selectedTab].fromDate=moment().startOf("isoWeek").subtract(7,"days").format("DD/MM/YYYY"),u.dateFilter[u.selectedTab].toDate=moment(u.dateFilter[u.selectedTab].fromDate,"DD/MM/YYYY").add(7,"days").format("DD/MM/YYYY"),u.dateFilter[u.selectedTab].toDateDisplay=moment(u.dateFilter[u.selectedTab].fromDate,"DD/MM/YYYY").add(6,"days").format("DD/MM/YYYY")),"datePicker"===a&&(u.dateFilter[u.selectedTab].fromDate=moment(u.dateFilter[u.selectedTab].fromDate,"DD/MM/YYYY").startOf("isoWeek").format("DD/MM/YYYY"),u.dateFilter[u.selectedTab].toDate=moment(u.dateFilter[u.selectedTab].fromDate,"DD/MM/YYYY").add(7,"days").format("DD/MM/YYYY"),u.dateFilter[u.selectedTab].toDateDisplay=moment(u.dateFilter[u.selectedTab].fromDate,"DD/MM/YYYY").add(6,"days").format("DD/MM/YYYY")),"manual"!==a&&(u.showLoader(),u.parseDateChangeData())}},this.updateBand=function(a){if(a)switch(a){case"Level 1":case"5 Trading Days":if(0===u.userSelectedBand)return;u.userSelectedBand=0,u.updateBetRange(),u.updatePieChart();break;case"Level 2":case"6 Trading Days":if(1===u.userSelectedBand)return;u.userSelectedBand=1,u.updateBetRange(),u.updatePieChart();break;case"Level 3":case"7 Trading Days":if(2===u.userSelectedBand)return;u.userSelectedBand=2,u.updateBetRange(),u.updatePieChart();break;case"Level 4":if(3===u.userSelectedBand)return;u.userSelectedBand=3,u.updateBetRange(),u.updatePieChart();break;case"Level 5":if(4===u.userSelectedBand)return;u.userSelectedBand=4,u.updateBetRange(),u.updatePieChart()}else{var b=u.currData.band;b?b>3&&(b=globalSettings.Reports_PowerDashboard.ShowTierFive?4:3):b=0,u.userSelectedBand=b,u.updateBetRange(),u.updatePieChart()}},this.minBetRangeUpdater=function(){var a=90,b=u.currData.byBandTargets[u.userSelectedBand].dailyBetsTarget[0].minValue,c=u.dailyBetsMin||0,d=c,e=7,f=b-c;f<0&&(f=c-b),f>=150&&(e=7),f>=300&&(e=16),f>=1e3&&(e=41);var g=function(){o(function(){b>c?(d+=e,d>=b?(o.cancel(),u.dailyBetsMin=b):(u.dailyBetsMin=Math.round(d),g())):b<c&&(d-=e,d<=b?(o.cancel(),u.dailyBetsMin=b):(u.dailyBetsMin=Math.round(d),g()))},a)};g()},this.maxBetRangeUpdater=function(){var a=30,b=u.currData.byBandTargets[u.userSelectedBand].dailyBetsTarget[0].maxValue,c=u.dailyBetsMax||0,d=c,e=7,f=b-c;f<0&&(f=c-b),f>=150&&(e=7),f>=300&&(e=16),f>=1e3&&(e=41);var g=function(){o(function(){b>c?(d+=e,d>=b?(o.cancel(),u.dailyBetsMax=b):(u.dailyBetsMax=Math.round(d),g())):b<c&&(d-=e,d<=b?(o.cancel(),u.dailyBetsMax=b):(u.dailyBetsMax=Math.round(d),g()))},a)};g()},this.updateBetRange=function(){u.minBetRangeUpdater(),u.maxBetRangeUpdater()},this.stepsTitle=function(a){var b;1===u.selectedTab?b=locale.account.shopWebsite.bonusDashboard.tooltip.bonusEligiblePower[a]:2===u.selectedTab?b=locale.account.shopWebsite.bonusDashboard.tooltip.bonusEligibleLive[a]:4===u.selectedTab?b=locale.account.shopWebsite.bonusDashboard.tooltip.bonusEligibleLiga[a]:5===u.selectedTab?b=locale.account.shopWebsite.bonusDashboard.tooltip.bonusEligibleBlackFriday[a]:7===u.selectedTab&&(b=locale.account.shopWebsite.bonusDashboard.tooltip.bonusEligibleAgentWelcome[a]);var c=4===u.selectedTab?locale.account.shopWebsite.bonusDashboard.tooltip.weeklyBets:locale.account.shopWebsite.bonusDashboard.tooltip.dailyBets,d=40096===u.currData.apiId?locale.account.shopWebsite.bonusDashboard.tooltip.tradedDaysTitle[a]:locale.account.shopWebsite.bonusDashboard.tooltip.level[a];this.nodeTitle=d+locale.account.shopWebsite.bonusDashboard.tooltip.weeklyStake+k.formatNumber(w,m("removeDecimalPoints")(u.currData.byBandTargets[a].weeklyTarget+.01),!1,!0)+locale.account.shopWebsite.bonusDashboard.tooltip.htmlEnd+c+u.currData.byBandTargets[a].dailyBetsTarget[0].maxValue+locale.account.shopWebsite.bonusDashboard.tooltip.htmlEnd+locale.account.shopWebsite.bonusDashboard.tooltip.tradedDays+parseFloat(u.currData.byBandTargets[a].daysTradedTarget)+locale.account.shopWebsite.bonusDashboard.tooltip.htmlEnd+b},this.processCalculation=function(){var b=0===u.currData.currentStatuses[0].currentValue.length?0:u.currData.currentStatuses[0].currentValue;u.bonusEarnedSoFar=u.currData.bonusEarnedSoFar,u.bandsQty=globalSettings.Reports_PowerDashboard.ShowTierFive?a.fiveTierProgressBarModel().length:a.progressBarModel().length,40096===u.currData.apiId&&b>999999.99?u.pieCurrValueLabel=k.getCurrencySymbol(w)+(u.currData.currentStatuses[0].currentValue/1e6).toFixed(1)+"M":u.pieCurrValueLabel=k.formatNumber(w,m("removeDecimalPoints")(~~b),!1,!0),u.pieMaxValueLabel=k.formatNumber(w,m("removeDecimalPoints")(u.currData.byBandTargets[u.userSelectedBand].weeklyTarget+.01),!1,!0),u.userSelectedBand<u.currData.band?u.bendSelected="passed":u.userSelectedBand===u.currData.band?u.bendSelected="inProgress":u.userSelectedBand>=u.currData.band+1&&(u.bendSelected="blocked");var c=100*b/u.currData.byBandTargets[u.userSelectedBand].weeklyTarget,d=100-c;return b>=u.currData.byBandTargets[u.userSelectedBand].weeklyTarget?[{value:100,className:"passed"}]:"blocked"===u.bendSelected?(u.pieCurrValueLabel=k.formatNumber(w,m("removeDecimalPoints")(0),!1,!0),[{value:100,className:"in-progress-b"}]):[{value:c,className:"in-progress-a"},{value:d,className:"in-progress-b"}]},this.updatePieChart=function(){this.pieChartData={series:u.processCalculation()},this.pieChartOptions=a.singlePieChartOptionsModel()},this.checkBetsTargetGoal=function(a){return a>=u.currData.byBandTargets[u.userSelectedBand].dailyBetsTarget[0].maxValue},this.parseCommissionPlanData=function(a){a.forEach(function(a){40093===a.Id&&globalSettings.Reports_LiveDashboard.Visible?u.getUserProgressAndLimits(a.Id):40092===a.Id&&globalSettings.Reports_LigaDashboard.Visible?u.getUserProgressAndLimits(a.Id):40091===a.Id&&globalSettings.Reports_DoubleDashboard.Visible?u.getUserProgressAndLimits(a.Id):40094===a.Id&&globalSettings.Reports_BlackFridayDashboard.Visible?u.getUserProgressAndLimits(a.Id):40095===a.Id&&globalSettings.Reports_PowerDashboard.Visible?u.getUserProgressAndLimits(a.Id):40040===a.Id&&globalSettings.Reports_MontlySportsDashboard.Visible&&u.initializeMonthlySportBonusReport()})},this.parseDateChangeData=function(){0===u.selectedTab?(globalSettings.Reports_BlackFridayDashboard.Visible&&(u.blkFrdyData.completed=!1,u.getUserProgressAndLimits(40094)),globalSettings.Reports_DoubleDashboard.Visible&&(u.doubleData.completed=!1,u.getUserProgressAndLimits(40091)),globalSettings.Reports_LigaDashboard.Visible&&(u.ligaData.completed=!1,u.getUserProgressAndLimits(40092)),globalSettings.Reports_LiveDashboard.Visible&&(u.liveData.completed=!1,u.getUserProgressAndLimits(40093)),globalSettings.Reports_PowerDashboard.Visible&&(u.powerData.completed=!1,u.getUserProgressAndLimits(40095)),globalSettings.Reports_AgentWelcomeBonusDashboard.Visible&&(u.agentWelcomeBonusData.completed=!1,u.getUserProgressAndLimits(40096))):1===u.selectedTab?(u.powerData.completed=!1,u.getUserProgressAndLimits(40095)):2===u.selectedTab?(u.liveData.completed=!1,u.getUserProgressAndLimits(40093)):3===u.selectedTab?(u.ligaData.completed=!1,u.getUserProgressAndLimits(40092)):4===u.selectedTab?(u.doubleData.completed=!1,u.getUserProgressAndLimits(40091)):5===u.selectedTab?(u.blkFrdyData.completed=!1,u.getUserProgressAndLimits(40094)):7===u.selectedTab&&(u.agentWelcomeBonusData.completed=!1,u.getUserProgressAndLimits(40096))},this.updateAfterCalculate=function(){1===u.selectedTab?(u.currData=u.powerData,u.updateBand()):2===u.selectedTab?(u.currData=u.liveData,u.updateBand()):3===u.selectedTab?(u.currData=u.ligaData,u.updateBand()):5===u.selectedTab?(u.currData=u.blkFrdyData,u.updateBand()):7===u.selectedTab&&(u.currData=u.agentWelcomeBonusData,u.updateBand()),u.hideLoader()},this.checkIfBlocked=function(a){return"blocked"!=u.bendSelected?a:0},this.getUserProgressAndLimits=function(a){v=null;var b={datefrom:moment(u.dateFilter[u.selectedTab].fromDate,"DD/MM/YYYY").format("YYYY-MM-DD")+"T00:00:00",dateto:moment(u.dateFilter[u.selectedTab].toDate,"DD/MM/YYYY").format("YYYY-MM-DD")+"T00:00:00",commissionPlanId:a},d=c.commissions.getTargets(b),e=c.commissions.getProgress(b);r.all([d,e]).then(function(b){var c=b[0],d=b[1];if(!c.success||!d.success){var e;e=c.success?"errorMsg":"dateError",console.error("Error occurred while searching for users: "+JSON.stringify(c.error)||c.error),v||(v=""),40093===a&&globalSettings.Reports_LiveDashboard.Visible&&(globalSettings.Reports_LiveDashboard.Pause?""!==globalSettings.Reports_LiveDashboard.Message&&(v=v+globalSettings.Reports_LiveDashboard.Message+"</br>"):v=v+locale.account.shopWebsite[e]+" "+locale.account.shopWebsite.bonusDashboard.tabs.kingsLive+"</br>"),40092===a&&globalSettings.Reports_LigaDashboard.Visible&&(globalSettings.Reports_LigaDashboard.Pause?""!==globalSettings.Reports_LigaDashboard.Message&&(v=v+globalSettings.Reports_LigaDashboard.Message+"</br>"):v=v+locale.account.shopWebsite[e]+" "+locale.account.shopWebsite.bonusDashboard.tabs.kingsLiga+"</br>"),40091===a&&globalSettings.Reports_DoubleDashboard.Visible&&(globalSettings.Reports_DoubleDashboard.Pause?""!==globalSettings.Reports_DoubleDashboard.Message&&(v=v+globalSettings.Reports_DoubleDashboard.Message+"</br>"):v=v+locale.account.shopWebsite[e]+" "+locale.account.shopWebsite.bonusDashboard.tabs.doubleBonus+"</br>"),40094===a&&globalSettings.Reports_BlackFridayDashboard.Visible&&(globalSettings.Reports_BlackFridayDashboard.Pause?""!==globalSettings.Reports_BlackFridayDashboard.Message&&(v=v+globalSettings.Reports_BlackFridayDashboard.Message+"</br>"):v=v+locale.account.shopWebsite[e]+" "+locale.account.shopWebsite.bonusDashboard.tabs.blackFridayBonus+"</br>"),40095===a&&globalSettings.Reports_PowerDashboard.Visible&&(globalSettings.Reports_PowerDashboard.Pause?""!==globalSettings.Reports_PowerDashboard.Message&&(v=v+globalSettings.Reports_PowerDashboard.Message+"</br>"):v=v+locale.account.shopWebsite.generalError+"</br>"),40096===a&&globalSettings.Reports_AgentWelcomeBonusDashboard.Visible&&(globalSettings.Reports_AgentWelcomeBonusDashboard.Pause?""!==globalSettings.Reports_AgentWelcomeBonusDashboard.Message&&(v=v+globalSettings.Reports_AgentWelcomeBonusDashboard.Message+"</br>"):v=globalSettings.Reports_AgentWelcomeBonusDashboard.noDataUserMessage+"</br>")}u.parsePlan(a,d.data,c.data),globalSettings.Reports_LiveDashboard.Visible&&u.liveData.completed&&u.updateAfterCalculate(),globalSettings.Reports_LigaDashboard.Visible&&u.ligaData.completed&&u.updateAfterCalculate(),globalSettings.Reports_DoubleDashboard.Visible&&u.doubleData.completed&&u.updateAfterCalculate(),globalSettings.Reports_BlackFridayDashboard.Visible&&u.blkFrdyData.completed&&u.updateAfterCalculate(),globalSettings.Reports_PowerDashboard.Visible&&u.powerData.completed&&u.updateAfterCalculate(),globalSettings.Reports_AgentWelcomeBonusDashboard.Visible&&u.agentWelcomeBonusData.completed&&u.updateAfterCalculate()})},this.asignToTabs=function(a){var b=_.findIndex(u.reportTabs,function(b){return b.apiId===a.apiId});b===-1?u.reportTabs.push({title:a.title,id:a.id,target:a.progress,imageName:a.img,apiId:a.apiId}):(u.reportTabs[b].target=a.progress,u.selectedTab===u.reportTabs[b].id&&u.onTabChange(u.selectedTab))},this.changeOverviewValue=function(a){var b=_.findIndex(u.overview,function(b){return b.id===a.id});u.overview[b].title=a.title,u.overview[b].id=a.id,u.overview[b].imageName=a.img,u.overview[b].apiId=a.apiId,u.overview[b].target=a.progress},this.parsePlan=function(a,b,c){if(40093===a){var h=d.parseProgressAndTargets(a,b,c,u.dateFilter[u.selectedTab].fromDate,u.dateFilter[u.selectedTab].toDate);globalSettings.Reports_LiveDashboard.Pause&&(h.progress="paused"),h.completed||(h.completed=!0),h.apiId=40093,h.id=3,h.title=locale.account.shopWebsite.bonusDashboard.tabs.kingsLive,h.img="logo-live-league",0===u.selectedTab&&(u.dateFilter[h.id].fromDate=u.dateFilter[u.selectedTab].fromDate,u.dateFilter[h.id].toDate=u.dateFilter[u.selectedTab].toDate,u.dateFilter[h.id].toDateDisplay=u.dateFilter[u.selectedTab].toDateDisplay,u.dateFilter[h.id].value=u.dateFilter[u.selectedTab].value),(0===u.selectedTab&&!u.liveData.progress||0!==u.selectedTab)&&(u.asignToTabs(h),u.liveData=h),0===u.selectedTab&&(u.liveData.completed=!0,u.changeOverviewValue(h))}else if(40094===a){var i=g.parseBlkFrdProgressAndTargets(a,b,c,u.dateFilter[u.selectedTab].fromDate,u.dateFilter[u.selectedTab].toDate);globalSettings.Reports_LiveDashboard.Pause&&(h.progress="paused"),i.completed||(i.completed=!0),i.apiId=40094,i.id=6,i.title=locale.account.shopWebsite.bonusDashboard.tabs.blackFridayBonus,i.img="black-friday",0===u.selectedTab&&(u.dateFilter[i.id].fromDate=u.dateFilter[u.selectedTab].fromDate,u.dateFilter[i.id].toDate=u.dateFilter[u.selectedTab].toDate,u.dateFilter[i.id].toDateDisplay=u.dateFilter[u.selectedTab].toDateDisplay,u.dateFilter[i.id].value=u.dateFilter[u.selectedTab].value),(0===u.selectedTab&&!u.blkFrdyData.progress||0!==u.selectedTab)&&(u.asignToTabs(i),u.blkFrdyData=i),0===u.selectedTab&&(u.blkFrdyData.completed=!0,u.changeOverviewValue(i))}else if(40092===a){var k=d.parseProgressAndTargets(a,b,c,u.dateFilter[u.selectedTab].fromDate,u.dateFilter[u.selectedTab].toDate);globalSettings.Reports_LigaDashboard.Pause&&(k.progress="paused"),k.completed||(k.completed=!0),k.apiId=40092,k.id=4,k.title=locale.account.shopWebsite.bonusDashboard.tabs.kingsLiga,k.img="logo-liga",0===u.selectedTab&&(u.dateFilter[k.id].fromDate=u.dateFilter[u.selectedTab].fromDate,u.dateFilter[k.id].toDate=u.dateFilter[u.selectedTab].toDate,u.dateFilter[k.id].toDateDisplay=u.dateFilter[u.selectedTab].toDateDisplay,u.dateFilter[k.id].value=u.dateFilter[u.selectedTab].value),(0===u.selectedTab&&!u.ligaData.progress||0!==u.selectedTab)&&(u.asignToTabs(k),u.ligaData=k),0===u.selectedTab&&(u.ligaData.completed=!0,u.changeOverviewValue(k))}else if(40091===a){var l=f.parseDoubleProgressAndTargets(b,c,u.dateFilter[u.selectedTab].fromDate,u.dateFilter[u.selectedTab].toDate);globalSettings.Reports_DoubleDashboard.Pause&&(l.progress="paused"),l.completed||(l.completed=!0),l.apiId=40091,l.id=5,l.title=locale.account.shopWebsite.bonusDashboard.tabs.doubleBonus,l.img="logo-double-bonus",0===u.selectedTab&&(u.dateFilter[l.id].fromDate=u.dateFilter[u.selectedTab].fromDate,u.dateFilter[l.id].toDate=u.dateFilter[u.selectedTab].toDate,u.dateFilter[l.id].toDateDisplay=u.dateFilter[u.selectedTab].toDateDisplay,u.dateFilter[l.id].value=u.dateFilter[u.selectedTab].value),(0===u.selectedTab&&!u.doubleData.progress||0!==u.selectedTab)&&(u.asignToTabs(l),u.multiplePieChartData.one={},u.multiplePieChartData.one=l.pie.live,u.multiplePieChartData.two={},u.multiplePieChartData.two=l.pie.liga,u.multiplePieChartData.three={},u.multiplePieChartData.three=l.pie.total,u.doubleData=l),0===u.selectedTab&&(u.doubleData.completed=!0,u.changeOverviewValue(l))}else if(40095===a){var m=d.parseProgressAndTargets(a,b,c,u.dateFilter[u.selectedTab].fromDate,u.dateFilter[u.selectedTab].toDate);globalSettings.Reports_PowerDashboard.Pause&&(m.progress="paused"),m.completed||(m.completed=!0),m.apiId=40095,m.id=1,m.title=locale.account.shopWebsite.bonusDashboard.tabs.powerBonus,m.img="logo-double-bonus",0===u.selectedTab&&(u.dateFilter[m.id].fromDate=u.dateFilter[u.selectedTab].fromDate,u.dateFilter[m.id].toDate=u.dateFilter[u.selectedTab].toDate,u.dateFilter[m.id].toDateDisplay=u.dateFilter[u.selectedTab].toDateDisplay,u.dateFilter[m.id].value=u.dateFilter[u.selectedTab].value),(0===u.selectedTab&&!u.powerData.progress||0!==u.selectedTab)&&(u.asignToTabs(m),u.powerData=m),0===u.selectedTab&&(u.powerData.completed=!0,u.changeOverviewValue(m))}else if(40096===a){var n=e.parseProgressAndTargets(a,b,c,u.dateFilter[u.selectedTab].fromDate,u.dateFilter[u.selectedTab].toDate);globalSettings.Reports_AgentWelcomeBonusDashboard.Pause&&(n.progress="paused"),n.completed||(n.completed=!0),n.apiId=40096,n.id=7,n.title=locale.account.shopWebsite.bonusDashboard.tabs.agentWelcomeBonus,n.img="logo-double-bonus",0===u.selectedTab&&(u.dateFilter[n.id].fromDate=u.dateFilter[u.selectedTab].fromDate,u.dateFilter[n.id].toDate=u.dateFilter[u.selectedTab].toDate,u.dateFilter[n.id].toDateDisplay=u.dateFilter[u.selectedTab].toDateDisplay,u.dateFilter[n.id].value=u.dateFilter[u.selectedTab].value),(0===u.selectedTab&&!u.agentWelcomeBonusData.progress||0!==u.selectedTab)&&(u.asignToTabs(n),u.agentWelcomeBonusData=n),0===u.selectedTab&&(u.agentWelcomeBonusData.completed=!0,u.changeOverviewValue(n))}v&&j.showMessage("error center-message",v,"exclamation-triangle")},this.changeValueToCurrency=function(a){return a&&0!==a.length?k.formatNumber(w,m("removeDecimalPoints")(a),!1,!0):k.formatNumber(w,m("removeDecimalPoints")(0),!1,!0)},this.initializeMonthlySportBonusReport=function(){var a={id:6,title:"Monthly Sport Bonus",img:"logo-double-bonus",imageName:"logo-double-bonus",apiId:40040,progress:"inProgress",target:"inProgress"};u.reportTabs.push(a),u.changeOverviewValue(a),h.setReportData(a),h.getCommissionPeriods().then(function(a){if(a.success){u.monthlySportData.parsedPeriods=h.parseCommissionPeriods(a),u.dateFilter[6].fromDate=moment(u.monthlySportData.parsedPeriods[0].dateFrom).format("DD/MM/YYYY"),u.dateFilter[6].toDate=moment(u.monthlySportData.parsedPeriods[0].dateTo).format("DD/MM/YYYY"),u.dateFilter[6].toDateDisplay=moment(u.monthlySportData.parsedPeriods[0].dateTo).format("DD/MM/YYYY"),u.monthlySportSelectedDateRange=u.monthlySportData.parsedPeriods[0];var b=u.parseEstimatedCommValueDates(u.monthlySportSelectedDateRange);return u.requestNewReportData(u.monthlySportSelectedDateRange,b),a.data}return void j.showErrorMessage("Unable to get commission periods"+JSON.stringify(a.error)||a.userMsg)})},this.parseEstimatedCommValueDates=function(a){var b=null,c=moment().startOf("isoweek").format("YYYY-MM-DDTHH:mm:ss"),d=moment().endOf("isoweek").format("YYYY-MM-DDTHH:mm:ss");return moment(c,"YYYY-MM-DDTHH:mm:ss").isBefore(moment(a.dateFrom,"YYYY-MM-DDTHH:mm:ss"))||moment(c,"YYYY-MM-DDTHH:mm:ss").isAfter(moment(a.dateFrom,"YYYY-MM-DDTHH:mm:ss"))?b:b={CommissionDateTo:moment(d,"YYYY-MM-DDTHH:mm:ss").add(1,"days").format("YYYY-MM-DDTHH:mm:ss"),ReportDateTo:d,commissionPeriodNumber:null,dateFrom:c,dateTo:d,toDisplay:null}},this.getMonthlySportBonusReportTableData=function(a){u.requestNewReportData(a,u.parseEstimatedCommValueDates(a))},this.requestNewReportData=function(a,b){var c=h.getTableData(a),d=h.getCommissionAmountsToDeductForPeriod(a),e=h.getCommissionProgress(a),f=h.getEstimatedCommissionAmountsToDeductForPeriod(b,!1);r.all([c,d,e,f]).then(function(a){var b=a[0],c=a[1],d=a[2],e=a[3];return b.success&&c.success&&d.success&&e.success?(u.monthlySportData.tableData=[],u.monthlySportData.grandTotal={},u.monthlySportData.tableData=h.getParsedTableData(b.data.Data),u.monthlySportData.grandTotal=h.getParsedGrandTotal(u.monthlySportData.tableData),u.monthlySportData.totalCommissionAmount=h.getParsedAmountToDeduct(c.data),u.monthlySportData.totalEstimatedCommissionAmount=h.getParsedEstimatedCommissionAmountToDeduct(e.data),u.monthlySportData.bonusCalcPercent=h.getParsedProgress(d.data),u.monthlySportData.grandTotal.calcGrossProfit=h.getCalcGrossProfit(u.monthlySportData.bonusCalcPercent,u.monthlySportData.grandTotal.grossProfit),void(u.monthlySportData.grandTotal.bonusValue=u.parseBonusValue(u.monthlySportData.grandTotal.calcGrossProfit,u.monthlySportData.totalCommissionAmount,u.monthlySportData.totalEstimatedCommissionAmount,u.monthlySportData.grandTotal.stake))):void j.showErrorMessage("Unable to get DATA on selected SPORTS PERIOD ")})},this.isTableInitialized=function(){return $.fn.DataTable.isDataTable($("#monthlySportTableData"))},this.getDTLocaleUrl=function(){var a="//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/";switch(globalSettings.CurrentLanguage){case"es":return a+"Spanish.json";case"it":return a+"Italian.json";case"pt":return a+"Portuguese-Brasil.json";case"ro":return a+"Romanian.json";default:return a+"English.json"}},this.showDetailedTable=function(a,b){h.getDetailedReport(a,b).then(function(a){u.monthlySportData.showDetailedReport=!0,u.monthlySportData.getTableDetailedData=h.parseDetailedReport(a)})},this.parseBonusValue=function(a,b,c,d){var e=locale.account.shopWebsite.bonusDashboard.monthlySportBonus.noBonus,f=a-b-c;return f>0&&d>=15e4&&(e=m("numberTruncate")(f)),
e},this.getCommissionPlansForUser=function(){c.commissions.getCommissionPlansForUser().then(function(a){if(!a.success)return void j.showMessage("error center-message","Error occurred while getting commissions"+JSON.stringify(a.error)||a.error,"exclamation-triangle");if(a){var b=[];a.data.forEach(function(a){40096===a.CommissionPlanId&&globalSettings.Reports_AgentWelcomeBonusDashboard.Visible&&b.push(a)});var c=_.sortBy(b,"FromPeriod");c.forEach(function(a){if(40096===a.CommissionPlanId){if(moment(a.ToPeriod).isBefore(moment(),"isoWeed")&&(globalSettings.Reports_AgentWelcomeBonusDashboard.Expired=!0,moment().subtract(globalSettings.Reports_AgentWelcomeBonusDashboard.ShowExpiredCommPlanForXWeeks,"weeks").isSameOrAfter(moment(a.ToPeriod))&&(globalSettings.Reports_AgentWelcomeBonusDashboard.Visible=!1)),!globalSettings.Reports_AgentWelcomeBonusDashboard.Visible)return;globalSettings.Reports_AgentWelcomeBonusDashboard.Expired=!1,u.getUserProgressAndLimits(a.CommissionPlanId)}})}})},this.init=function(){u.showLoader(),c.commissions.getCommissionPlans().then(function(a){return a.success?void(a&&(u.dataCommissions=a.data,u.parseCommissionPlanData(a.data))):(j.showMessage("error center-message","Error occurred while getting commissions"+JSON.stringify(a.error)||a.error,"exclamation-triangle"),console.error("Error occurred while searching for commissions: "+JSON.stringify(a.error)||a.error),u.hideLoader(),void s.go("shop"))}),u.getCommissionPlansForUser()},u.init()}])}(),function(){"use strict";angular.module("models.objects",[]).factory("modelsObjects",["$location",function(a){return{overviewModel:function(){return[{id:1},{id:2},{id:3},{id:4},{id:5},{id:6},{id:7}]},reportTabsModel:function(){return[{title:locale.account.shopWebsite.bonusDashboard.tabs.overview,id:0}]},progressBarModel:function(){return[{bandTitle:"Level 1"},{bandTitle:"Level 2"},{bandTitle:"Level 3"},{bandTitle:"Level 4"}]},threeTierProgressBarModel:function(){return[{bandTitle:"5 Trading Days"},{bandTitle:"6 Trading Days"},{bandTitle:"7 Trading Days"}]},fiveTierProgressBarModel:function(){return[{bandTitle:"Level 1"},{bandTitle:"Level 2"},{bandTitle:"Level 3"},{bandTitle:"Level 4"},{bandTitle:"Level 5"}]},multiplePieChartOptionsModel:function(){return{donut:!0,donutWidth:25,startAngle:0,showLabel:!1}},singlePieChartOptionsModel:function(){return{donut:!0,donutWidth:35,startAngle:0,showLabel:!1}},dateFilterModel:function(){var a=moment().startOf("isoWeek").format("DD/MM/YYYY"),b=moment(a,"DD/MM/YYYY").add(7,"days").format("DD/MM/YYYY"),c=moment(a,"DD/MM/YYYY").add(6,"days").format("DD/MM/YYYY"),d=moment("20/04/2020","DD/MM/YYYY").startOf("isoWeek").format("DD/MM/YYYY"),e=moment(d,"DD/MM/YYYY").add(7,"days").format("DD/MM/YYYY"),f=moment(d,"DD/MM/YYYY").add(6,"days").format("DD/MM/YYYY"),g=moment("4/11/2019","DD/MM/YYYY").toDate(),h="Sun Apr 26 2020 00:00:00 GMT+0100(Central European Standard Time)",i=moment().toDate(),j="Sun Apr 26 2020 00:00:00 GMT+0100(Central European Standard Time)";return{0:{value:"currentWeek",fromDate:a,toDate:b,toDateDisplay:c,minDate:g.toString(),maxDate:i.toString(),currentWeekDisable:!1,lastWeekDisable:!1},1:{value:"currentWeek",fromDate:a,toDate:b,toDateDisplay:c,minDate:h.toString(),maxDate:i.toString(),currentWeekDisable:!1,lastWeekDisable:!1},2:{value:"currentWeek",fromDate:a,toDate:b,toDateDisplay:c,minDate:h.toString(),maxDate:i.toString(),currentWeekDisable:!1,lastWeekDisable:!1},3:{value:"manual",fromDate:d,toDate:e,toDateDisplay:f,minDate:g.toString(),maxDate:j.toString(),currentWeekDisable:!0,lastWeekDisable:!0},4:{value:"manual",fromDate:d,toDate:e,toDateDisplay:f,minDate:g.toString(),maxDate:j.toString(),currentWeekDisable:!0,lastWeekDisable:!0},5:{value:"manual",fromDate:d,toDate:e,toDateDisplay:f,minDate:g.toString(),maxDate:j.toString(),currentWeekDisable:!0,lastWeekDisable:!0},6:{value:"currentWeek",fromDate:a,toDate:b,toDateDisplay:c,minDate:g.toString(),maxDate:i.toString(),currentWeekDisable:!1,lastWeekDisable:!1},7:{value:"currentWeek",fromDate:a,toDate:b,toDateDisplay:c,minDate:h.toString(),maxDate:i.toString(),currentWeekDisable:!1,lastWeekDisable:!1}}},multipleEmptyModelObject:function(){return{apiId:40091,band:0,bonusEarnedSoFar:"0",completed:!1,title:locale.account.shopWebsite.bonusDashboard.tabs.doubleBonus,progress:"inProgress",byBandTargets:{ligaDaysTradedTarget:2,ligaWeeklyTarget:100,liveDaysTradedTarget:2,liveWeeklyTarget:300,totalDaysTradedTarget:2,totalWeeklyTarget:500},byWeekDailyActivity:[{dayTitle:"Mon",ligaBets:0,ligaBetsDisplay:"0",ligaTargetBets:1,liveBets:0,liveBetsDisplay:"0",liveTargetBets:2,totalBets:0,totalBetsDisplay:"0",totalTargetBets:4},{dayTitle:"Tue",ligaBets:0,ligaBetsDisplay:"0",ligaTargetBets:1,liveBets:0,liveBetsDisplay:"0",liveTargetBets:2,totalBets:0,totalBetsDisplay:"0",totalTargetBets:4},{dayTitle:"Wed",ligaBets:0,ligaBetsDisplay:"0",ligaTargetBets:1,liveBets:0,liveBetsDisplay:"0",liveTargetBets:2,totalBets:0,totalBetsDisplay:"0",totalTargetBets:4},{dayTitle:"Thu",ligaBets:0,ligaBetsDisplay:"0",ligaTargetBets:1,liveBets:0,liveBetsDisplay:"0",liveTargetBets:2,totalBets:0,totalBetsDisplay:"0",totalTargetBets:4},{dayTitle:"Fri",ligaBets:0,ligaBetsDisplay:"0",ligaTargetBets:1,liveBets:0,liveBetsDisplay:"0",liveTargetBets:2,totalBets:0,totalBetsDisplay:"0",totalTargetBets:4},{dayTitle:"Sat",ligaBets:0,ligaBetsDisplay:"0",ligaTargetBets:1,liveBets:0,liveBetsDisplay:"0",liveTargetBets:2,totalBets:0,totalBetsDisplay:"0",totalTargetBets:4},{dayTitle:"Sun",ligaBets:0,ligaBetsDisplay:"0",ligaTargetBets:1,liveBets:0,liveBetsDisplay:"0",liveTargetBets:2,totalBets:0,totalBetsDisplay:"0",totalTargetBets:4}],currentStatuses:[{ligaCurrentValue:0,liveCurrentValue:0,name:locale.account.shopWebsite.bonusDashboard.currentStatus.stakeIn,stakeStatus:"inProgress",totalCurrentValue:0},{ligaCurrentValue:0,ligaCurrentValueDisplay:"0",liveCurrentValue:0,liveCurrentValueDisplay:"0",name:locale.account.shopWebsite.bonusDashboard.currentStatus.dailyBets,totalCurrentValue:0,totalCurrentValueDisplay:"0",tradedDaysStatus:"inProgress"},{dailyTargetReachedStatus:"inProgress",ligaCurrentValue:0,liveCurrentValue:0,name:locale.account.shopWebsite.bonusDashboard.currentStatus.tradedDays,totalCurrentValue:0}],pie:{liga:{series:[{className:"in-progress-a",value:0},{value:100,className:"in-progress-b"}]},total:{series:[{className:"in-progress-a",value:0},{value:100,className:"in-progress-b"}]},live:{series:[{className:"in-progress-a",value:0},{value:100,className:"in-progress-b"}]},ligaPerCent:0,ligaRemainigPerCent:100,livePerCent:0,liveRemainigPerCent:100,totalPerCent:0,totalRemainigPerCent:100},progressBars:{ligaGoal:1,ligaPerCent:0,ligaRemainigPerCent:1,liveGoal:1,livePerCent:0,liveRemainigPerCent:1,totalGoal:1,totalPerCent:0,totalRemainigPerCent:1}}},singleEmptyModelObject:function(){return{band:0,bonusEarnedSoFar:"0",dailyBets:2,daysTraded:2,maxStake:150,minStake:0,progress:"inProgress",completed:!1,currentBandPosition:0,byBandTargets:[{band:1,weeklyTarget:149.99,daysTradedTarget:"2",dailyBetsTarget:[{day:"Monday",maxValue:1,minValue:0},{day:"Tuesday",maxValue:1,minValue:0},{day:"Wednesday",maxValue:1,minValue:0},{day:"Thursday",maxValue:1,minValue:0},{day:"Friday",maxValue:1,minValue:0},{day:"Saturday",maxValue:1,minValue:0},{day:"Sunday",maxValue:1,minValue:0}]},{band:2,weeklyTarget:299.99,daysTradedTarget:"2",dailyBetsTarget:[{day:"Monday",maxValue:2,minValue:1},{day:"Tuesday",maxValue:2,minValue:1},{day:"Wednesday",maxValue:2,minValue:1},{day:"Thursday",maxValue:2,minValue:1},{day:"Friday",maxValue:2,minValue:1},{day:"Saturday",maxValue:2,minValue:1},{day:"Sunday",maxValue:2,minValue:1}]},{band:3,weeklyTarget:499.99,daysTradedTarget:"2",dailyBetsTarget:[{day:"Monday",maxValue:4,minValue:2},{day:"Tuesday",maxValue:4,minValue:2},{day:"Wednesday",maxValue:4,minValue:2},{day:"Thursday",maxValue:4,minValue:2},{day:"Friday",maxValue:4,minValue:2},{day:"Saturday",maxValue:4,minValue:2},{day:"Sunday",maxValue:4,minValue:2}]},{band:4,weeklyTarget:999.99,daysTradedTarget:"2",dailyBetsTarget:[{day:"Monday",maxValue:8,minValue:4},{day:"Tuesday",maxValue:8,minValue:4},{day:"Wednesday",maxValue:8,minValue:4},{day:"Thursday",maxValue:8,minValue:4},{day:"Friday",maxValue:8,minValue:4},{day:"Saturday",maxValue:8,minValue:4},{day:"Sunday",maxValue:8,minValue:4}]}],currentStatuses:[{currentValue:0,currentValueDisplay:"0",name:locale.account.shopWebsite.bonusDashboard.currentStatus.stakeIn,targetGoal:150,targetValueDisplay:"150"},{currentValue:0,currentValueDisplay:"0",name:locale.account.shopWebsite.bonusDashboard.currentStatus.dailyBets,targetGoal:2,targetValueDisplay:"2"},{currentValue:0,currentValueDisplay:"0",name:locale.account.shopWebsite.bonusDashboard.currentStatus.tradedDays,targetGoal:2,targetValueDisplay:"2"}],byWeekDailyActivity:[{bets:0,dayTitle:"Mon"},{dayTitle:"Tue",bets:0},{dayTitle:"Wed",bets:0},{dayTitle:"Thu",bets:0},{dayTitle:"Fri",bets:0},{dayTitle:"Sat",bets:0},{dayTitle:"Sun",bets:0}]}},progressBarBlkFrdModel:function(){return[{bandTitle:"Level 1"},{bandTitle:"Level 2"},{bandTitle:"Level 3"}]},blackFridayTargetsObject:function(){return{Result:[{TargetName:"WeeklyStake",TargetDisplayName:"",TargetInfoList:[{PeriodTypeCode:"Weekly",Target:[{Value:"149999.99000",TierLevel:1},{Value:"499999.99000",TierLevel:2},{Value:"999999.99000",TierLevel:3}]}]},{TargetName:"WeeklyBets",TargetDisplayName:"",TargetInfoList:[{PeriodTypeCode:"Weekly",Target:[{Value:"399.99000",TierLevel:1},{Value:"499.99000",TierLevel:2},{Value:"999.99000",TierLevel:3}]}]},{TargetName:"DaysTraded",TargetDisplayName:"DaysTraded",TargetInfoList:[{PeriodTypeCode:"Weekly",Target:[{Value:"6",TierLevel:1}]}]}]}},blackFridayProcessObject:function(){return{Result:[{Id:1305,TypeCode:"WeeklyBets",ProcessedCommissionRealId:"52bb9679-1383-40a8-8809-5f6f250617b5",Value:"612",PeriodTypeCode:"Weekly",PeriodFrom:"2019-06-10T00:00:00",PeriodTo:"2019-06-17T00:00:00"},{Id:1306,TypeCode:"DaysTraded",ProcessedCommissionRealId:"52bb9679-1383-40a8-8809-5f6f250617b5",Value:"7",PeriodTypeCode:"Weekly",PeriodFrom:"2019-06-10T00:00:00",PeriodTo:"2019-06-17T00:00:00"},{Id:1307,TypeCode:"WeeklyStake",ProcessedCommissionRealId:"52bb9679-1383-40a8-8809-5f6f250617b5",Value:"720000.00000",PeriodTypeCode:"Weekly",PeriodFrom:"2019-06-10T00:00:00",PeriodTo:"2019-06-17T00:00:00"}]}},tierFiveTargetWeeklyStake:function(){return{Value:"1999999.99000",TierLevel:5}},tierFiveTargetWeeklyBets:function(){return{Value:"49.90000",TierLevel:5}}}}])}(),function(){"use strict";angular.module("monthlySportModels.objects",[]).factory("monthlySportModelsObjects",["$location",function(a){return{GetProgressObject:function(){return{data:[{Id:0,TypeCode:"BonusPercentageOnAvgSelections",ProcessedCommissionRealId:"00000000-0000-0000-0000-000000000000",Value:"0",PeriodTypeCode:"Monthly",PeriodFrom:"2020-02-24T00:00:00",PeriodTo:"2020-03-30T00:00:00"}],SystemMessage:"Success",success:!0,ResponseMessage:"Success"}}}}])}(),function(){"use strict";angular.module("monthlySportReport.service",[]).factory("monthlySportReportService",["helperService","authService","monthlySportModelsObjects","$q","$sessionStorage","platformApiService","$filter",function(a,b,c,d,e,f,g){return this.monthlySportData={},{parseCommissionPeriods:function(a){this.monthlySportData.parsedPeriods=a;var b=[],c=globalSettings.Reports_MontlySportsDashboard.minDateSportsPeriods,d=moment(c).isValid();return _.forEach(a.data,function(a){var e=a.DateFrom||a.dateFrom,f=a.DateTo||a.dateTo;d&&e<c||moment(moment(e).format("YYYY-MM-DD")).isBefore("2021-08-30")||(a.CommissionDateTo=moment(f).add(1,"days").format("YYYY-MM-DDTHH:mm:ss"),a.ReportDateTo=moment(f).format("YYYY-MM-DDTHH:mm:ss"),a.toDisplay=moment(e).format("DD MMM YYYY")+" To "+moment(f).format("DD MMM YYYY"),b.push(a))}),_.sortBy(b,["DateFrom","DateTo"])},getCommissionPeriods:function(){var a=this,b=d.defer();return a.monthlySportData.parsedPeriods?b.resolve(a.monthlySportData.parsedPeriods):f.report.getCommissionPeriods(40040,globalSettings.Reports_MontlySportsDashboard.PeriodFilterDropdownSize-1).then(function(a){b.resolve(a)}).catch(function(a){b.reject(a)}),b.promise},getCurrency:function(){return this.monthlySportData.currency=b.getUserData().currency.Currency,this.monthlySportData.currency},getUserId:function(){return this.monthlySportData.userId=b.getUserData().userID,this.monthlySportData.userId},setReportData:function(a){this.monthlySportData=a},getReportData:function(a){return this.monthlySportData},getAPIParams:function(a){return{Parameters:[{ParameterName:"DateFrom",ParameterValue:a.DateFrom||a.dateFrom},{ParameterName:"UserId",ParameterValue:this.getUserId()},{ParameterName:"DateTo",ParameterValue:a.ReportDateTo}]}},getDetailsAPIParams:function(a,b){return{Parameters:[{ParameterName:"DateFrom",ParameterValue:b},{ParameterName:"UserId",ParameterValue:this.getUserId()},{ParameterName:"DateTo",ParameterValue:b},{ParameterName:"CommissionBand",ParameterValue:a}]}},getCommissionAPIParams:function(a){return{DateFrom:a.DateFrom||a.dateFrom,CommissionPlanId:40040,DateTo:a.CommissionDateTo}},getEstimatedCommissionAPIParams:function(a,b){return{Parameters:[{ParameterName:"DateFrom",ParameterValue:a.DateFrom||a.dateFrom},{ParameterName:"DateTo",ParameterValue:a.ReportDateTo},{ParameterName:"IsSettled",ParameterValue:b},{ParameterName:"UserId",ParameterValue:this.getUserId()}]}},getTableData:function(a){var b=d.defer();return f.report.getMonthlySportBonusData(this.getAPIParams(a)).then(function(a){b.resolve(a)}).catch(function(a){b.reject(a)}),b.promise},getParsedTableData:function(a){var b=[];return _.forEach(a,function(a){var c=[a.ChannelName||"-",a.SettledDate||"-",a.SettledBets||"-",a.NoOfSelections||"-",a.Stake||0,a.Winnings||0,a.WeightedStake||0];b.push(c)}),b},getCommissionAmountsToDeductForPeriod:function(a){var b=d.defer();return f.report.getCommissionAmountsToDeductForPeriod(this.getCommissionAPIParams(a)).then(function(a){b.resolve(a)}).catch(function(a){b.reject(a)}),b.promise},getEstimatedCommissionAmountsToDeductForPeriod:function(a,b){var c=d.defer();return a?f.report.getSportsAnalysisData(this.getEstimatedCommissionAPIParams(a,b)).then(function(a){c.resolve(a)}).catch(function(a){c.reject(a)}):c.resolve({success:!0,data:0}),c.promise},getParsedAmountToDeduct:function(a){var b=0;return _.forEach(a,function(a){b+=a.CommissionAmount}),b},getParsedEstimatedCommissionAmountToDeduct:function(a){var b=0;return _.forEach(a.Data,function(a){b+=a["Commission Estimate"]}),b},getCommissionProgress:function(a){var b=d.defer();return f.commissions.getProgress(this.getCommissionAPIParams(a)).then(function(a){a.data||(a=c.GetProgressObject()),b.resolve(a)}).catch(function(a){b.reject(a)}),b.promise},getParsedProgress:function(a){return a[0].Value},getCalcGrossProfit:function(a,b){return a*b/100},getDetailedReport:function(a,b){var c=d.defer();return f.report.getMonthlySportBonusDetailsData(this.getDetailsAPIParams(a,b)).then(function(a){c.resolve(a)}).catch(function(a){c.reject(a)}),c.promise},parseDetailedReport:function(a){var b=[];return _.forEach(a.data.Data,function(a){var c=[a.ChannelName||"-",a.SettledDate||"-",a.TicketId||"-",a.NoOfSelections||"-",a.Stake||0,a.Winnings||0,a.WeightedStake||0];b.push(c)}),b},getParsedGrandTotal:function(a){var b=0,c=0,d=0,e=0,f=0;return _.forEach(a,function(a){b+=a[2],c+=a[4],d+=a[5],e+=a[6]}),f=c-d,{settledBets:b,stake:c,weightedStake:e,winnings:d,grossProfit:f}}}}])}(),function(){"use strict";angular.module("mulipleBonusesDataParsing.service",[]).factory("mulipleBonusesDataParsingService",["$location","modelsObjects",function(a,b){return{checkGlobalProgress:function(a,b,c){var d="inProgress";a.currentStatuses[0].ligaCurrentValue>=a.byBandTargets.ligaWeeklyTarget&&a.currentStatuses[0].liveCurrentValue>=a.byBandTargets.liveWeeklyTarget&&a.currentStatuses[0].totalCurrentValue>=a.byBandTargets.totalWeeklyTarget?a.currentStatuses[0].stakeStatus="achieved":a.currentStatuses[0].stakeStatus=d;var e="inProgress";a.currentStatuses[1].ligaCurrentValue>=a.byBandTargets.ligaDaysTradedTarget&&a.currentStatuses[1].liveCurrentValue>=a.byBandTargets.liveDaysTradedTarget&&a.currentStatuses[1].totalCurrentValue>=a.byBandTargets.totalDaysTradedTarget?a.currentStatuses[1].tradedDaysStatus="achieved":a.currentStatuses[1].tradedDaysStatus=e;var f="inProgress",g=0,h=0,i=0;a.byWeekDailyActivity.forEach(function(a){a.liveBets>=a.liveTargetBets&&(g+=1),a.ligaBets>=a.ligaTargetBets&&(h+=1),a.totalBets>=a.totalTargetBets&&(i+=1)}),a.currentStatuses[2].liveCurrentValue=g,a.currentStatuses[2].ligaCurrentValue=h,a.currentStatuses[2].totalCurrentValue=i,a.currentStatuses[2].liveCurrentValue>=a.byBandTargets.liveDaysTradedTarget&&a.currentStatuses[2].ligaCurrentValue>=a.byBandTargets.ligaDaysTradedTarget&&a.currentStatuses[2].totalCurrentValue>=a.byBandTargets.totalDaysTradedTarget&&(f="achieved"),a.currentStatuses[2].dailyTargetReachedStatus=f,"achieved"===a.currentStatuses[0].stakeStatus&&"achieved"===a.currentStatuses[1].tradedDaysStatus&&"achieved"===a.currentStatuses[2].dailyTargetReachedStatus?a.progress="achieved":a.progress="inProgress";var j=moment().startOf("isoWeek").format("DD/MM/YYYY"),k=moment().endOf("isoWeek").format("DD/MM/YYYY");return b!==j&&c!==k&&"inProgress"===a.progress&&(a.progress="closed"),a},collectProgressData:function(a,b){return a.forEach(function(a){if("TotalStakeWeekly"===a.TypeCode&&(b.currentStatuses[0].totalCurrentValue=parseFloat(a.Value)),"LiveStakeWeekly"===a.TypeCode&&(b.currentStatuses[0].liveCurrentValue=parseFloat(a.Value)),"LigaStakeWeekly"===a.TypeCode&&(b.currentStatuses[0].ligaCurrentValue=parseFloat(a.Value)),"TotalDaysWeeklyTraded"===a.TypeCode&&(b.currentStatuses[1].totalCurrentValue=parseFloat(a.Value),b.currentStatuses[1].totalCurrentValueDisplay=parseFloat(a.Value)+""),"LiveDaysWeeklyTraded"===a.TypeCode&&(b.currentStatuses[1].liveCurrentValue=parseFloat(a.Value),b.currentStatuses[1].liveCurrentValueDisplay=parseFloat(a.Value)+""),"LigaDaysWeeklyTraded"===a.TypeCode&&(b.currentStatuses[1].ligaCurrentValue=parseFloat(a.Value),b.currentStatuses[1].ligaCurrentValueDisplay=parseFloat(a.Value)+""),"TotalBetsDaily"===a.TypeCode||"LiveBetsDaily"===a.TypeCode||"LigaBetsDaily"===a.TypeCode){var c;switch(a.PeriodTypeCode){case"Sunday":c=_.findIndex(b.byWeekDailyActivity,function(a){return"Sun"===a.dayTitle});break;case"Saturday":c=_.findIndex(b.byWeekDailyActivity,function(a){return"Sat"===a.dayTitle});break;case"Friday":c=_.findIndex(b.byWeekDailyActivity,function(a){return"Fri"===a.dayTitle});break;case"Thursday":c=_.findIndex(b.byWeekDailyActivity,function(a){return"Thu"===a.dayTitle});break;case"Wednesday":c=_.findIndex(b.byWeekDailyActivity,function(a){return"Wed"===a.dayTitle});break;case"Tuesday":c=_.findIndex(b.byWeekDailyActivity,function(a){return"Tue"===a.dayTitle});break;case"Monday":c=_.findIndex(b.byWeekDailyActivity,function(a){return"Mon"===a.dayTitle})}"TotalBetsDaily"===a.TypeCode&&(b.byWeekDailyActivity[c].totalBets=parseFloat(a.Value),b.byWeekDailyActivity[c].totalBetsDisplay=parseFloat(a.Value)+""),"LiveBetsDaily"===a.TypeCode&&(b.byWeekDailyActivity[c].liveBets=parseFloat(a.Value),b.byWeekDailyActivity[c].liveBetsDisplay=parseFloat(a.Value)+""),"LigaBetsDaily"===a.TypeCode&&(b.byWeekDailyActivity[c].ligaBets=parseFloat(a.Value),b.byWeekDailyActivity[c].ligaBetsDisplay=parseFloat(a.Value)+"")}}),b},processTargetsData:function(a,b){return a.forEach(function(a){"TotalStakeWeekly"!==a.TargetName&&"LiveStakeWeekly"!==a.TargetName&&"LigaStakeWeekly"!==a.TargetName||("TotalStakeWeekly"===a.TargetName&&(b.byBandTargets.totalWeeklyTarget=parseFloat(a.TargetInfoList[0].Target[0].Value)),"LiveStakeWeekly"===a.TargetName&&(b.byBandTargets.liveWeeklyTarget=parseFloat(a.TargetInfoList[0].Target[0].Value)),"LigaStakeWeekly"===a.TargetName&&(b.byBandTargets.ligaWeeklyTarget=parseFloat(a.TargetInfoList[0].Target[0].Value))),"TotalDaysTraded"!==a.TargetName&&"LiveDaysTraded"!==a.TargetName&&"LigaDaysTraded"!==a.TargetName||("TotalDaysTraded"===a.TargetName&&(b.byBandTargets.totalDaysTradedTarget=parseFloat(a.TargetInfoList[0].Target[0].Value)),"LiveDaysTraded"===a.TargetName&&(b.byBandTargets.liveDaysTradedTarget=parseFloat(a.TargetInfoList[0].Target[0].Value)),"LigaDaysTraded"===a.TargetName&&(b.byBandTargets.ligaDaysTradedTarget=parseFloat(a.TargetInfoList[0].Target[0].Value))),"TotalBetsDaily"===a.TargetName&&a.TargetInfoList.forEach(function(a){var c;"Monday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Mon"===a.dayTitle}),b.byWeekDailyActivity[c].totalTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Tuesday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Tue"===a.dayTitle}),b.byWeekDailyActivity[c].totalTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Wednesday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Wed"===a.dayTitle}),b.byWeekDailyActivity[c].totalTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Thursday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Thu"===a.dayTitle}),b.byWeekDailyActivity[c].totalTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Friday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Fri"===a.dayTitle}),b.byWeekDailyActivity[c].totalTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Saturday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Sat"===a.dayTitle}),b.byWeekDailyActivity[c].totalTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Sunday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Sun"===a.dayTitle}),b.byWeekDailyActivity[c].totalTargetBets=Math.floor(parseFloat(a.Target[0].Value)))}),"LiveBetsDaily"===a.TargetName&&a.TargetInfoList.forEach(function(a){var c;"Monday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Mon"===a.dayTitle}),b.byWeekDailyActivity[c].liveTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Tuesday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Tue"===a.dayTitle}),b.byWeekDailyActivity[c].liveTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Wednesday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Wed"===a.dayTitle}),b.byWeekDailyActivity[c].liveTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Thursday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Thu"===a.dayTitle}),b.byWeekDailyActivity[c].liveTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Friday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Fri"===a.dayTitle}),b.byWeekDailyActivity[c].liveTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Saturday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Sat"===a.dayTitle}),b.byWeekDailyActivity[c].liveTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Sunday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Sun"===a.dayTitle}),b.byWeekDailyActivity[c].liveTargetBets=Math.floor(parseFloat(a.Target[0].Value)))}),"LigaBetsDaily"===a.TargetName&&a.TargetInfoList.forEach(function(a){var c;"Monday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Mon"===a.dayTitle}),b.byWeekDailyActivity[c].ligaTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Tuesday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Tue"===a.dayTitle}),b.byWeekDailyActivity[c].ligaTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Wednesday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Wed"===a.dayTitle}),b.byWeekDailyActivity[c].ligaTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Thursday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Thu"===a.dayTitle}),b.byWeekDailyActivity[c].ligaTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Friday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Fri"===a.dayTitle}),b.byWeekDailyActivity[c].ligaTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Saturday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Sat"===a.dayTitle}),b.byWeekDailyActivity[c].ligaTargetBets=Math.floor(parseFloat(a.Target[0].Value))),"Sunday"===a.PeriodTypeCode&&(c=_.findIndex(b.byWeekDailyActivity,function(a){return"Sun"===a.dayTitle}),b.byWeekDailyActivity[c].ligaTargetBets=Math.floor(parseFloat(a.Target[0].Value)))})}),b},processProgressBar:function(a){a.progressBars={};var b=0;a.currentStatuses[0].ligaCurrentValue<a.byBandTargets.ligaWeeklyTarget&&(b=0),b=a.currentStatuses[0].ligaCurrentValue>=a.byBandTargets.ligaWeeklyTarget?.3334:.3334*a.currentStatuses[0].ligaCurrentValue/a.byBandTargets.ligaWeeklyTarget;var c=0;a.currentStatuses[1].ligaCurrentValue<a.byBandTargets.ligaDaysTradedTarget&&(c=0),c=a.currentStatuses[1].ligaCurrentValue>=a.byBandTargets.ligaDaysTradedTarget?.3333:.3333*a.currentStatuses[1].ligaCurrentValue/a.byBandTargets.ligaDaysTradedTarget;var d=0;a.currentStatuses[2].ligaCurrentValue<a.byBandTargets.ligaDaysTradedTarget&&(d=0),d=a.currentStatuses[2].ligaCurrentValue>=a.byBandTargets.ligaDaysTradedTarget?.3333:.3333*a.currentStatuses[2].ligaCurrentValue/a.byBandTargets.ligaDaysTradedTarget;var e=0;a.currentStatuses[0].liveCurrentValue<a.byBandTargets.liveWeeklyTarget&&(e=0),e=a.currentStatuses[0].liveCurrentValue>=a.byBandTargets.liveWeeklyTarget?.3334:.3334*a.currentStatuses[0].liveCurrentValue/a.byBandTargets.liveWeeklyTarget;var f=0;a.currentStatuses[1].liveCurrentValue<a.byBandTargets.liveDaysTradedTarget&&(f=0),f=a.currentStatuses[1].liveCurrentValue>=a.byBandTargets.liveDaysTradedTarget?.3333:.3333*a.currentStatuses[1].liveCurrentValue/a.byBandTargets.liveDaysTradedTarget;var g=0;a.currentStatuses[2].liveCurrentValue<a.byBandTargets.liveDaysTradedTarget&&(g=0),g=a.currentStatuses[2].liveCurrentValue>=a.byBandTargets.liveDaysTradedTarget?.3333:.3333*a.currentStatuses[2].liveCurrentValue/a.byBandTargets.liveDaysTradedTarget;var h=0;a.currentStatuses[0].totalCurrentValue<a.byBandTargets.totalWeeklyTarget&&(h=0),h=a.currentStatuses[0].totalCurrentValue>=a.byBandTargets.totalWeeklyTarget?.3334:.3334*a.currentStatuses[0].totalCurrentValue/a.byBandTargets.totalWeeklyTarget;var i=0;a.currentStatuses[1].totalCurrentValue<a.byBandTargets.totalDaysTradedTarget&&(i=0),i=a.currentStatuses[1].totalCurrentValue>=a.byBandTargets.totalDaysTradedTarget?.3333:.3333*a.currentStatuses[1].totalCurrentValue/a.byBandTargets.totalDaysTradedTarget;var j=0;return a.currentStatuses[2].totalCurrentValue<a.byBandTargets.totalDaysTradedTarget&&(j=0),j=a.currentStatuses[2].totalCurrentValue>=a.byBandTargets.totalDaysTradedTarget?.3333:.3333*a.currentStatuses[2].totalCurrentValue/a.byBandTargets.totalDaysTradedTarget,a.progressBars.totalPerCent=h+i+j,a.progressBars.totalRemainigPerCent=1-a.progressBars.totalPerCent,a.progressBars.totalGoal=1,a.progressBars.livePerCent=e+f+g,a.progressBars.liveRemainigPerCent=1-a.progressBars.livePerCent,a.progressBars.liveGoal=1,a.progressBars.ligaPerCent=b+c+d,a.progressBars.ligaRemainigPerCent=1-a.progressBars.ligaPerCent,a.progressBars.ligaGoal=1,a},processPieValues:function(a){return a.pie={},a.progressBars.totalPerCent>=a.progressBars.totalGoal?(a.pie.totalPerCent=100,a.pie.totalRemainigPerCent=0,a.pie.total={series:[{value:a.pie.totalPerCent,className:"passed"},{value:a.pie.totalRemainigPerCent,className:"in-progress-b"}],labels:[]}):(a.pie.totalPerCent=100*a.progressBars.totalPerCent/a.progressBars.totalGoal,a.pie.totalRemainigPerCent=100-a.pie.totalPerCent,a.pie.total={series:[{value:a.pie.totalPerCent,className:"in-progress-a"},{value:a.pie.totalRemainigPerCent,className:"in-progress-b"}],labels:[]}),a.progressBars.livePerCent>=a.progressBars.liveGoal?(a.pie.livePerCent=100,a.pie.liveRemainigPerCent=0,a.pie.live={series:[{value:a.pie.livePerCent,className:"passed"},{value:a.pie.liveRemainigPerCent,className:"in-progress-b"}],labels:[]}):(a.pie.livePerCent=100*a.progressBars.livePerCent/a.progressBars.liveGoal,a.pie.liveRemainigPerCent=100-a.pie.livePerCent,a.pie.live={series:[{value:a.pie.livePerCent,className:"in-progress-a"},{value:a.pie.liveRemainigPerCent,className:"in-progress-b"}],labels:[]}),a.progressBars.ligaPerCent>=a.progressBars.ligaGoal?(a.pie.ligaPerCent=100,a.pie.ligaRemainigPerCent=0,a.pie.liga={series:[{value:a.pie.ligaPerCent,className:"passed"},{value:a.pie.ligaRemainigPerCent,className:"in-progress-b"}],labels:[]}):(a.pie.ligaPerCent=100*a.progressBars.ligaPerCent/a.progressBars.ligaGoal,a.pie.ligaRemainigPerCent=100-a.pie.ligaPerCent,a.pie.liga={series:[{value:a.pie.ligaPerCent,className:"in-progress-a"},{value:a.pie.ligaRemainigPerCent,className:"in-progress-b"}],labels:[]}),a},parseDoubleProgressAndTargets:function(a,c,d,e){var f=b.multipleEmptyModelObject();return c&&a&&(f=this.collectProgressData(a,f),f=this.processTargetsData(c,f),f=this.checkGlobalProgress(f,d,e),f=this.processProgressBar(f),f=this.processPieValues(f),f.completed=!0),f}}}])}(),function(){"use strict";angular.module("singleBonusDataParser.service",[]).factory("singleBonusDataParserService",["$location","bonusCalculationService","modelsObjects",function(a,b,c){return{parseProgressAndTargets:function(a,d,e,f,g){var h={currentStatuses:[{currentValue:0,currentValueDisplay:"0",name:locale.account.shopWebsite.bonusDashboard.currentStatus.stakeIn},{currentValue:0,currentValueDisplay:"0",name:locale.account.shopWebsite.bonusDashboard.currentStatus.dailyBets},{currentValue:0,currentValueDisplay:"0",name:locale.account.shopWebsite.bonusDashboard.currentStatus.tradedDays}],byWeekDailyActivity:[{bets:0,dayTitle:"Mon"},{dayTitle:"Tue",bets:0},{dayTitle:"Wed",bets:0},{dayTitle:"Thu",bets:0},{dayTitle:"Fri",bets:0},{dayTitle:"Sat",bets:0},{dayTitle:"Sun",bets:0}],band:0,bonusEarnedSoFar:"0",byBandTargets:[{band:1,dailyBetsTarget:[{}]},{band:2,dailyBetsTarget:[{}]},{band:3,dailyBetsTarget:[{}]},{band:4,dailyBetsTarget:[{}]}]},i=0,j=0,k=0,l=0,m=0,n=0;if(e&&d){d.forEach(function(a){if("WeeklyStake"===a.TypeCode&&(h.currentStatuses[0].currentValue=parseFloat(a.Value),h.currentStatuses[0].currentValueDisplay=parseFloat(a.Value)+"",i=parseFloat(a.Value)),"DaysTraded"===a.TypeCode&&(h.currentStatuses[2].currentValue=parseFloat(a.Value),h.currentStatuses[2].currentValueDisplay=parseFloat(a.Value)+"",j=parseFloat(a.Value),n=parseFloat(a.Value)),"DailyBets"===a.TypeCode)switch(m+=parseFloat(a.Value),a.PeriodTypeCode){case"Sunday":var b=_.findIndex(h.byWeekDailyActivity,function(a){return"Sun"===a.dayTitle});h.byWeekDailyActivity[b].bets=parseFloat(a.Value);break;case"Saturday":var c=_.findIndex(h.byWeekDailyActivity,function(a){return"Sat"===a.dayTitle});h.byWeekDailyActivity[c].bets=parseFloat(a.Value);break;case"Friday":var d=_.findIndex(h.byWeekDailyActivity,function(a){return"Fri"===a.dayTitle});h.byWeekDailyActivity[d].bets=parseFloat(a.Value);break;case"Thursday":var e=_.findIndex(h.byWeekDailyActivity,function(a){return"Thu"===a.dayTitle});h.byWeekDailyActivity[e].bets=parseFloat(a.Value);break;case"Wednesday":var f=_.findIndex(h.byWeekDailyActivity,function(a){return"Wed"===a.dayTitle});h.byWeekDailyActivity[f].bets=parseFloat(a.Value);break;case"Tuesday":var g=_.findIndex(h.byWeekDailyActivity,function(a){return"Tue"===a.dayTitle});h.byWeekDailyActivity[g].bets=parseFloat(a.Value);break;case"Monday":var k=_.findIndex(h.byWeekDailyActivity,function(a){return"Mon"===a.dayTitle});h.byWeekDailyActivity[k].bets=parseFloat(a.Value)}}),40095===a&&globalSettings.Reports_PowerDashboard.ShowTierFive&&(h.byBandTargets.push({band:5,dailyBetsTarget:[{}]}),e.forEach(function(a){"WeeklyStake"===a.TargetName&&a.TargetInfoList[0].Target.push({Value:"1999999.99000",TierLevel:5}),"DailyBets"===a.TargetName&&a.TargetInfoList.forEach(function(a){a.Target.push({Value:"49.90000",TierLevel:5})})})),e.forEach(function(b){
"WeeklyStake"===b.TargetName&&b.TargetInfoList[0].Target.forEach(function(b){1===b.TierLevel?h.byBandTargets.forEach(function(a){1===a.band&&(a.weeklyTarget=parseFloat(b.Value))}):2===b.TierLevel?h.byBandTargets.forEach(function(a){2===a.band&&(a.weeklyTarget=parseFloat(b.Value))}):3===b.TierLevel?h.byBandTargets.forEach(function(a){3===a.band&&(a.weeklyTarget=parseFloat(b.Value))}):4===b.TierLevel?h.byBandTargets.forEach(function(a){4===a.band&&(a.weeklyTarget=parseFloat(b.Value),k=parseFloat(b.Value))}):5===b.TierLevel&&40095===a&&globalSettings.Reports_PowerDashboard.ShowTierFive&&h.byBandTargets.forEach(function(a){5===a.band&&(a.weeklyTarget=parseFloat(b.Value),k=parseFloat(b.Value))})}),"DaysTraded"===b.TargetName&&h.byBandTargets.forEach(function(a){a.daysTradedTarget=b.TargetInfoList[0].Target[0].Value}),"DailyBets"===b.TargetName&&b.TargetInfoList.forEach(function(b,c){h.byBandTargets.forEach(function(a){a.dailyBetsTarget[c]={day:b.PeriodTypeCode}}),b.Target.forEach(function(b){1===b.TierLevel?h.byBandTargets.forEach(function(a){1===a.band&&(a.dailyBetsTarget[c].maxValue=Math.floor(parseFloat(b.Value)+1))}):2===b.TierLevel?h.byBandTargets.forEach(function(a){2===a.band&&(a.dailyBetsTarget[c].maxValue=Math.floor(parseFloat(b.Value)+1))}):3===b.TierLevel?h.byBandTargets.forEach(function(a){3===a.band&&(a.dailyBetsTarget[c].maxValue=Math.floor(parseFloat(b.Value)+1))}):4===b.TierLevel?h.byBandTargets.forEach(function(a){4===a.band&&(a.dailyBetsTarget[c].maxValue=Math.floor(parseFloat(b.Value)+1),l=Math.floor(parseFloat(b.Value)))}):5===b.TierLevel&&40095===a&&globalSettings.Reports_PowerDashboard.ShowTierFive&&h.byBandTargets.forEach(function(a){5===a.band&&(a.dailyBetsTarget[c].maxValue=Math.floor(parseFloat(b.Value)+1),l=Math.floor(parseFloat(b.Value)))})}),h.byBandTargets.forEach(function(a){a.dailyBetsTarget.forEach(function(b,c){1===a.band?b.minValue=0:2===a.band?b.minValue=parseFloat(h.byBandTargets[0].dailyBetsTarget[c].maxValue):3===a.band?b.minValue=parseFloat(h.byBandTargets[1].dailyBetsTarget[c].maxValue):4===a.band?b.minValue=parseFloat(h.byBandTargets[2].dailyBetsTarget[c].maxValue):5===a.band&&(b.minValue=parseFloat(h.byBandTargets[3].dailyBetsTarget[c].maxValue))})})})});var o,p=[{band:0,dailyBetsReached:0},{band:1,dailyBetsReached:0},{band:2,dailyBetsReached:0},{band:3,dailyBetsReached:0}];40095===a&&globalSettings.Reports_PowerDashboard.ShowTierFive&&p.push({band:4,dailyBetsReached:0}),h.byWeekDailyActivity.forEach(function(b,c){b.bets&&b.bets>=h.byBandTargets[0].dailyBetsTarget[c].maxValue&&(p[0].dailyBetsReached=p[0].dailyBetsReached+1,b.bets>=h.byBandTargets[1].dailyBetsTarget[c].maxValue&&(p[1].dailyBetsReached=p[1].dailyBetsReached+1,b.bets>=h.byBandTargets[2].dailyBetsTarget[c].maxValue&&(p[2].dailyBetsReached=p[2].dailyBetsReached+1,b.bets>=h.byBandTargets[3].dailyBetsTarget[c].maxValue&&(p[3].dailyBetsReached=p[3].dailyBetsReached+1,40095===a&&globalSettings.Reports_PowerDashboard.ShowTierFive&&b.bets>=h.byBandTargets[4].dailyBetsTarget[c].maxValue&&(p[4].dailyBetsReached=p[4].dailyBetsReached+1)))))}),o=40095===a&&globalSettings.Reports_PowerDashboard.ShowTierFive?p[4].dailyBetsReached>=parseFloat(h.byBandTargets[4].daysTradedTarget)?4:0:p[3].dailyBetsReached>=parseFloat(h.byBandTargets[3].daysTradedTarget)?3:p[2].dailyBetsReached>=parseFloat(h.byBandTargets[2].daysTradedTarget)?2:p[1].dailyBetsReached>=parseFloat(h.byBandTargets[1].daysTradedTarget)?1:0,h.band=b.calculatingBandNode(h,o),h.currentStatuses[1].currentValue=p[h.band].dailyBetsReached,h.currentStatuses[1].currentValueDisplay=h.currentStatuses[1].currentValue+"";var q=b.getTargetsValues(h);h.currentBandPosition=b.calculatePercentToNextBand(q,h);var r=Math.floor(h.currentBandPosition);r>h.band&&(h.band=r,q=b.getTargetsValues(h),40095===a&&globalSettings.Reports_PowerDashboard.ShowTierFive?h.currentStatuses[1].currentValue=p[h.band>4?4:h.band].dailyBetsReached:h.currentStatuses[1].currentValue=p[h.band>3?3:h.band].dailyBetsReached,h.currentStatuses[1].currentValueDisplay=h.currentStatuses[1].currentValue+"",h.currentBandPosition=b.calculatePercentToNextBand(q,h)),h.progress=b.calculatingGeneralProgress(h.band,f,g),h.minStake=q.minStake,h.maxStake=q.maxStake,h.dailyBets=q.dailyBets,h.daysTraded=q.daysTraded,h.completed=!0,h.bonusEarnedSoFar=b.calculateBonusEarned(h.band,a,h.currentStatuses[0].currentValue),h.currentStatuses[0].targetGoal=q.maxStake,h.currentStatuses[0].targetValueDisplay=q.maxStake+"",h.currentStatuses[1].targetGoal=q.dailyBets,h.currentStatuses[1].targetValueDisplay=q.dailyBets+"",h.currentStatuses[2].targetGoal=q.daysTraded,h.currentStatuses[2].targetValueDisplay=q.daysTraded+""}else h=c.singleEmptyModelObject();return h}}}])}(),function(){angular.module("shop",["authenticatedBetSearch","authenticatedBetSearchVirtuals","authenticatedBetSearchLottery","authenticatedCouponDetails","authenticatedCouponDetailsVirtuals","authenticatedCouponDetailsLottery","authenticatedMoneyTransfer","authenticatedUserJourneyMoneyTransfer","authenticatedEditProfile","authenticatedProfileManagment","authenticatedChangePassword","authenticatedChangePhoneNumber","authenticatedResetPassword","authenticatedStatementSearch","authenticatedRegister","authenticatedSplitRegistration","authenticatedUpsellRegister","shopAgentRegistration","authenticatedPrintOdds","authenticatedMessageCentre","authenticatedMessageOverview","authenticatedSendNewMessage","authenticatedMessageDetails","accountBetRequest",,"accountPaymentAutoWithdrawal","accountPaymentWithdrawalDailyAttempts","authenticatedQuickCashier","authenticatedManageUsers","authenticatedActivate","authenticatedFundTransfer","authenticatedInterAccount","authenticatedInterAccountNew","authenticatedOTP","vendorImages.service","shopPermissions.service","shopHome","shopAccountStatement","shopCashierRegistration","shopUserManagement","shopUserDetails","shopBonusDashboardReport","shopViewSession","shopCashier","shopReports","shopReportDetails","shopCashDesk","shopMarketingDetails","shopAgentContent","shopDigitalAcceptance","ngScrollbars","angular-highlight-text"]).controller("ShopController",["$rootScope","$scope","$location","$window","$transitions","$q","authService","$state","umbracoApiService","loggingService","helperService","shopPermissionsService","digitalAcceptanceService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){if(!globalSettings.ShopEnabled)return void(g.hasValidLogin()?k.goToUmbracoPage("account"):window.location.href="/");var n=this;b.collapseLeftSection=!1,e.onStart({},function(a){return n.hasAccessToState(a.to().name)?void a.promise.finally(function(){n.updateMenuSelection()}):h.target("shop",{},{reload:!0})}),this.requiredLanguage="en-GB"==globalSettings.CurrentLocale?"en-US":globalSettings.CurrentLocale,this.digitalAcceptanceWarningMessage=null,this.menuStructure=[],this.overlayShown=!1,this.fullMenuStructure=[{sectionTitle:locale.shop.title,sectionTitleFaIconClass:"fa-home",sectionItems:[{itemTitle:locale.shop.home,itemFaIconClass:"fa-home",navSettings:{type:"state",target:"shopHome",params:{}},hideWhenLoggedIn:!0,isLocked:g.isAccountMenuLocked("shopHome")},{itemTitle:locale.account.userAreaMenu.newCoupon,itemFaIconClass:"fa-building-o",navSettings:{type:"state",target:"shopCashDesk",params:{}},hideWhenLoggedIn:!0,isLocked:g.isAccountMenuLocked("shopCashDesk")}]},{sectionTitle:locale.account.myAccount,sectionTitleFaIconClass:"fa-briefcase",sectionItems:[{itemTitle:locale.account.userAreaMenu.accountStatement.title,itemFaIconClass:"fa-list-alt",navSettings:{type:"state",target:"shopAccountStatement",params:{}},isLocked:g.isAccountMenuLocked("shopAccountStatement")},{itemTitle:locale.account.userAreaMenu.newCoupon,itemFaIconClass:"fa-building-o",navSettings:{type:"state",target:"shopCashDesk",params:{}},hideWhenLoggedOut:!0,isLocked:g.isAccountMenuLocked("shopCashDesk")},{itemTitle:locale.account.userAreaMenu.betList,itemFaIconClass:"fa-list",navSettings:{type:"state",target:"shopBetSearch",params:{}},isLocked:g.isAccountMenuLocked("shopBetSearch")},{itemTitle:locale.account.userAreaMenu.betListVirtuals,itemFaIconClass:"fa-vimeo",navSettings:{type:"state",target:"shopBetSearchVirtuals",params:{}},isLocked:g.isAccountMenuLocked("shopBetSearchVirtuals")},{itemTitle:locale.account.userAreaMenu.betListLottery,itemFaIconClass:"fa-list",navSettings:{type:"state",target:"shopBetSearchLottery",params:{}},isLocked:g.isAccountMenuLocked("shopBetSearchLottery")},{itemTitle:locale.account.userAreaMenu.transactionsList.title,itemFaIconClass:"fa-book",navSettings:{type:"state",target:"shopStatementSearch",params:{}},isLocked:g.isAccountMenuLocked("shopStatementSearch")},{itemTitle:locale.account.paymentMethods.deposit.menuTitle,itemFaIconClass:"fa-plus-circle",navSettings:{type:"state",target:"shopDeposit",params:{}},isLocked:g.isAccountMenuLocked("shopDeposit")},{itemTitle:locale.account.paymentMethods.withdrawal.title,itemFaIconClass:"fa-minus-circle",navSettings:{type:"state",target:"shopWithdraw",params:{}},isLocked:g.isAccountMenuLocked("shopWithdraw")},{itemTitle:locale.account.userAreaMenu.interaccount,itemFaIconClass:"fa-exchange",navSettings:{type:"state",target:"shopTransfer",params:{}},isLocked:g.isAccountMenuLocked("shopTransfer")},{itemTitle:locale.account.userAreaMenu.messages,itemFaIconClass:"fa-envelope",navSettings:{type:"state",target:"shopMessagesOverview",params:{}},isLocked:g.isAccountMenuLocked("shopMessagesOverview")},{itemTitle:locale.account.userAreaMenu.newUser,itemFaIconClass:"fa-user-plus",navSettings:{type:"state",target:"shopNewUser",params:{}},isLocked:g.isAccountMenuLocked("shopNewUser")}]},{sectionTitle:locale.account.printOdds.printOdds,sectionTitleFaIconClass:"fa-print",sectionItems:[{itemTitle:locale.account.printOdds.standardPrintOdds,itemFaIconClass:"fa-print",navSettings:{type:"state",target:"shopStandardPrint",params:{}},isLocked:g.isAccountMenuLocked("shopStandardPrint")},{itemTitle:locale.account.printOdds.fastPrintOdds,itemFaIconClass:"fa-barcode",navSettings:{type:"state",target:"shopFastPrint",params:{}},isLocked:g.isAccountMenuLocked("shopFastPrint")}]},{sectionTitle:locale.account.userAreaMenu.accountDetail,sectionTitleFaIconClass:"fa-binoculars",sectionItems:[{itemTitle:locale.account.userAreaMenu.changePersonalData,itemFaIconClass:"fa-drivers-license-o",navSettings:{type:"state",target:"shopEditProfile",params:{}},isLocked:g.isAccountMenuLocked("shopEditProfile")},{itemTitle:locale.account.password.changePassword,itemFaIconClass:"fa-key",navSettings:{type:"state",target:"shopChangePassword",params:{}},isLocked:g.isAccountMenuLocked("shopChangePassword")},{itemTitle:locale.account.phoneVerification.popup.changePhoneNumber,itemFaIconClass:"fa-mobile",navSettings:{type:"state",target:"shopChangePhoneNumber",params:{}},isLocked:g.isAccountMenuLocked("shopChangePhoneNumber")},{itemTitle:locale.account.userAreaMenu.viewSession,itemFaIconClass:"fa-clock-o",navSettings:{type:"state",target:"shopViewSession",params:{}},isLocked:g.isAccountMenuLocked("shopViewSession")}]},{sectionTitle:locale.account.userAreaMenu.myNetwork,sectionTitleFaIconClass:"fa-laptop",sectionItems:[{itemTitle:locale.account.userAreaMenu.cashiers,itemFaIconClass:"fa-money",navSettings:{type:"state",target:"shopCashiers",params:{}},isLocked:g.isAccountMenuLocked("shopCashiers")},{itemTitle:locale.account.userAreaMenu.listUsers,itemFaIconClass:"fa-users",navSettings:{type:"state",target:"shopUserManagement",params:{}},isLocked:g.isAccountMenuLocked("shopUserManagement")},{itemTitle:locale.account.userAreaMenu.userDetails,itemFaIconClass:"fa-address-book",navSettings:{type:"state",target:"shopUserDetails",params:{}},isLocked:g.isAccountMenuLocked("shopUserDetails")}]},{sectionTitle:locale.account.shopWebsite.accountStatement.reports,sectionTitleFaIconClass:"fa-black-tie",sectionItems:[{itemTitle:locale.account.shopWebsite.reports.titles.commissions,itemFaIconClass:"fa-pie-chart",navSettings:{type:"state",target:"shopCommissionsReports"},isLocked:g.isAccountMenuLocked("shopCommissionsReports")},{itemTitle:locale.account.shopWebsite.reports.titles.sales,itemFaIconClass:"fa-pie-chart",navSettings:{type:"state",target:"shopSalesReports"},isLocked:g.isAccountMenuLocked("shopSalesReports")},{itemTitle:locale.account.shopWebsite.bonusDashboard.bonus,itemFaIconClass:"fa-pie-chart",navSettings:{type:"state",target:"shopBonusDashboardReport",params:{}},isLocked:g.isAccountMenuLocked("shopBonusDashboardReport")},{itemTitle:locale.account.shopWebsite.reports.titles.creditLiability,itemFaIconClass:"fa-pie-chart",navSettings:{type:"state",target:"shopCreditReports"},isLocked:g.isAccountMenuLocked("shopCreditReports")}]},{sectionTitle:locale.account.userAreaMenu.agentRequests,sectionTitleFaIconClass:"fa-commenting-o",sectionItems:[{itemTitle:locale.account.userAreaMenu.newAgentRegistration,itemFaIconClass:"fa-user-secret",navSettings:{type:"state",target:"shopNewAgentRegistration",params:{}},isLocked:g.isAccountMenuLocked("shopNewAgentRegistration")},{itemTitle:locale.account.userAreaMenu.newCashierRegistration,itemFaIconClass:"fa-money",navSettings:{type:"state",target:"shopNewCashierRegistration",params:{}},isLocked:g.isAccountMenuLocked("shopNewCashierRegistration")}]}],this.hasAccessToState=function(a){var b=l.statePermissions[a];return null==b||!(!g.hasValidLogin()||!g.isAgent())&&b.indexOf(g.getAgentType(g.getUserData().userType))>=0},this.filterByPermission=function(){var a=[];_.forEach(n.fullMenuStructure,function(b,c){var d={sectionTitle:b.sectionTitle,sectionTitleFaIconClass:b.sectionTitleFaIconClass,sectionItems:[]};_.forEach(b.sectionItems,function(a,b){var c=!1,e=a.navSettings.target;if("state"==a.navSettings.type){var f=l.statePermissions[e];"shopAgentContentPage"===a.navSettings.target||"shopAgentDigitalAcceptance"===a.navSettings.target?g.hasValidLogin()&&g.isAgent()&&a.access.indexOf(g.getAgentType(g.getUserData().userType))>=0&&(c=!0):null==f?c=!0:g.hasValidLogin()&&g.isAgent()&&f.indexOf(g.getAgentType(g.getUserData().userType))>=0&&(c=!0)}else c=!0;if(!(!c||g.hasValidLogin()&&a.hideWhenLoggedIn||!g.hasValidLogin()&&a.hideWhenLoggedOut)){const h=d.sectionItems.filter(function(b){if(b.itemTitle===a.itemTitle)return!0});h.length||d.sectionItems.push({itemTitle:a.itemTitle,itemFaIconClass:a.itemFaIconClass,navSettings:a.navSettings,isLocked:a.isLocked})}}),d.sectionItems.length>0&&a.push(d)}),n.menuStructure=a},this.navigate=function(a,b,c){c||("popup"==a.type?d.open(a.target):b?a.target.startsWith("agent")?k.goToUmbracoPage("agents",a.target):a.target.startsWith("account")&&k.goToUmbracoPage("account",a.target):h.go(a.target,a.params||{}))},this.updateMenuSelection=function(){if(null!=n.menuStructure)for(var a=0;a<n.menuStructure.length;a++)for(var b=0;b<n.menuStructure[a].sectionItems.length;b++){var d=n.menuStructure[a].sectionItems[b],e=h.href(d.navSettings.target,d.navSettings.params||{}),f=/^\/sh\/reports\/(\d)\/(\d)$/g,g=f.exec(c.url());if(g)switch(g[1]){case"1":d.selected="shopCommissionsReports"==d.navSettings.target;break;case"2":d.selected="shopSalesReports"==d.navSettings.target;break;case"3":d.selected="shopCreditReports"==d.navSettings.target}else d.selected=c.absUrl().indexOf(e)>-1}},b.toggleLeftSection=function(){return window.innerWidth>1365?void(n.overlayShown&&(n.overlayShown=!1)):void(n.overlayShown=!n.overlayShown)},this.showCollapsedNavbar=function(){n.overlayShown=!1},this.getMarketingMaterial=function(){var a=f.defer();return i.desktop.getMarketingList(globalSettings.CurrentLanguage).then(function(b){var c=[];if(b.success){if(null!=b.data&&b.data.length>0)for(var d=0;d<b.data.length;d++){var e=b.data[d];c.push({itemTitle:e.pageTitle,itemFaIconClass:"fa-file-o",navSettings:{type:"state",target:"shopMarketingPage",params:{pageId:e.pageId}},access:["masterAgent","superAgent","agent"],isLocked:g.isAccountMenuLocked("shopMarketingPage")})}}else j.logError("Unable to get marketing material: "+JSON.stringify(b.error));return globalSettings.EnabledAgentSystem&&c.push({itemTitle:"Agent System",itemFaIconClass:"fa-cube",navSettings:{type:"popup",target:globalSettings.AgentSystemUrl,params:{}},access:["masterAgent","superAgent","agent"],isLocked:g.isAccountMenuLocked(globalSettings.AgentSystemUrl)}),c.length>0?void a.resolve({sectionTitle:locale.account.userAreaMenu.marketingMaterial,sectionTitleFaIconClass:"fa-pencil",sectionItems:c}):void a.resolve()}),a.promise},this.getAgentContentList=function(){var a=f.defer();return i.desktop.getAgentContentList(globalSettings.CurrentLanguage).then(function(b){var c=[];if(c.push({itemTitle:locale.account.shopWebsite.digitalAcceptance.pageTitle,itemFaIconClass:"fa-file-o",navSettings:{type:"state",target:"shopAgentDigitalAcceptance"},access:[g.agentTypes.masterAgent,g.agentTypes.superAgent,g.agentTypes.agent],isLocked:g.isAccountMenuLocked("shopAgentDigitalAcceptance")}),b.success){if(null!=b.data&&b.data.length>0)for(var d=0;d<b.data.length;d++){var e=b.data[d],f=[];e.allowedAgentTypes&&e.allowedAgentTypes.forEach(function(a){switch(a.toLowerCase()){case"agent":f.push(g.agentTypes.agent);break;case"superagent":f.push(g.agentTypes.superAgent);break;case"masteragent":f.push(g.agentTypes.masterAgent)}}),c.push({itemTitle:e.pageTitle,itemFaIconClass:"fa-file-o",navSettings:{type:"state",target:"shopAgentContentPage",params:{pageId:e.pageId}},access:f,isLocked:g.isAccountMenuLocked("shopAgentContentPage")})}}else j.logError("Unable to get agent content list: "+JSON.stringify(b.error));return c.length>0?void a.resolve({sectionTitle:locale.account.userAreaMenu.agentContent,sectionTitleFaIconClass:"fa-book",sectionItems:c}):void a.resolve()}),a.promise},this.showDigitalAcceptanceModal=function(){m.showModal()},this.init=function(){var a=n.getMarketingMaterial(),b=n.getAgentContentList();f.all([a,b]).then(function(a){var b=a?a[0]:null,c=a?a[1]:null;c&&n.fullMenuStructure.push(c),b&&n.fullMenuStructure.push(b),n.filterByPermission(),n.updateMenuSelection(),m.getLatestAgreements(!1,!0)})}(),b.$watch(function(){return g.hasValidLogin()},function(a,b){b!=a&&(n.filterByPermission(),n.updateMenuSelection(),m.getLatestAgreements(!0,!0),n.hasAccessToState(h.current.name)?h.reload():h.go("shop"))}),b.$on("digitalAcceptanceService:statusUpdated",function(a,b){if(!b||!b.agreements||!b.agreements.length)return void(n.digitalAcceptanceWarningMessage=null);var c=_.filter(b.agreements,{isAccepted:!1});if(c.length){var d=null!=_.find(c,["deadlineExceeded",!0]);if(1==d)n.digitalAcceptanceWarningMessage=locale.account.shopWebsite.digitalAcceptance.warningMessageLimitExceeded;else{var e=_.minBy(c,"remainingDays").remainingDays,f=locale.account.shopWebsite.digitalAcceptance.warningMessageRemainingDays;f=f.replace("{remainingDays}",e),n.digitalAcceptanceWarningMessage=f}}else n.digitalAcceptanceWarningMessage=null})}])}(),function(){angular.module("shopPermissions.service",[]).service("shopPermissionsService",["authService",function(a){var b=a.agentTypes,c=globalSettings.Shop_BtgVirtual,d=globalSettings.Reports_EnableLottery,e=globalSettings.Account_MobileEditability&&a.getVerifyAccountData()&&"Verified"!=a.getVerifyAccountData().type;return{statePermissions:{shopAccountStatement:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopBetSearch:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopBetSearchCouponDetails:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopBetSearchVirtuals:c?[b.masterAgent,b.superAgent,b.agent,b.cashier]:[],shopBetSearchLottery:d?[b.masterAgent,b.superAgent,b.agent,b.cashier]:[],shopBetSearchVirtualsCouponDetails:c?[b.masterAgent,b.superAgent,b.agent,b.cashier]:[],shopStatementSearch:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopStatementSearchCouponDetails:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopDeposit:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopDepositPaymentMethod:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopDepositAccepted:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopWithdrawCanceled:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopWithdraw:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopWithdrawPaymentMethod:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopTransfer:[b.masterAgent,b.superAgent,b.agent],shopMessages:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopMessageDetails:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopMessagesOverview:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopNewMessage:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopNewUser:[b.agent],shopEditProfile:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopChangePassword:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopChangePhoneNumber:e?[b.masterAgent,b.superAgent,b.agent,b.cashier]:[],shopPhoneVerification:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopViewSession:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopCashiers:[b.agent,b.cashier],shopCashiersReports:[b.agent,b.cashier],shopUserManagement:[b.masterAgent,b.superAgent,b.agent],shopUserDetails:[b.superAgent],shopCommissionsReports:[b.masterAgent,b.superAgent,b.agent],shopSalesReports:[b.masterAgent,b.superAgent,b.agent],shopBonusDashboardReport:c?[b.agent]:[],shopCreditReports:[b.superAgent,b.agent],shopReportDetails:[b.masterAgent,b.superAgent,b.agent],shopNewAgentRegistration:[b.masterAgent,b.superAgent],shopNewCashierRegistration:[b.superAgent],shopMarketingPage:[b.masterAgent,b.superAgent,b.agent,b.cashier],shopAgentContentPage:[b.masterAgent,b.superAgent,b.agent],shopAgentDigitalAcceptance:[b.masterAgent,b.superAgent,b.agent]}}}])}(),function(){angular.module("shopUserDetails",[]).controller("UserDetailsController",["authService","loggingService","$rootScope","$scope","helperService","ReportsService","$compile",function(a,b,c,d,e,f,g){function h(a,b){var c="#userDetailsReport";i.isTableInitialized()&&$("#userDetailsReport").dataTable().api().destroy();var e=$(c).DataTable({dom:'<"top"if>rt<"bottom"pB><"tfoot"><"clear">',oLanguage:{sLengthMenu:"Rows per page _MENU_"},data:a,paging:!0,columns:b,pageLength:10,bSort:!1,stateSave:!0,language:{url:i.getDTLocaleUrl()},createdRow:function(a,b,c){g(angular.element(a).contents())(d)},initComplete:function(){this.api().columns().every(function(){var a=this,b=$('<hr class="vertical-header-seperator"/>');b.appendTo($(a.header()))}),this.api().columns([6,7,8]).every(function(){var a=this,b=$('<div class="search-dropdown-wrapper"></div>'),c=$('<select class="search-dropdown"><option value="">All</option></select>').on("change",function(){var b=$.fn.dataTable.util.escapeRegex($(this).val());a.search(b?"^"+b+"$":"",!0,!1).draw()});a.cells("",a[0]).render("display").sort().unique().each(function(b,d){var e=$.fn.dataTable.util.escapeRegex(b);a.search()==="^"+e+"$"?c.append('<option value="'+b+'" selected="selected">'+b.substr(0,20)+"</option>"):c.append('<option value="'+b+'">'+b.substr(0,20)+"</option>")}),b.append(c).appendTo($(a.header()))})}});e.on("order.dt search.dt",function(){e.column(0,{search:"applied",order:"applied"}).nodes().each(function(a,b){a.innerHTML=b+1})}).draw();var f=null,h="";e.on("click","td i",function(a){a.stopImmediatePropagation();var b=$(this).parent();return"fa fa-eye"===b.context.className?(f.context.className="fa fa-eye-slash",void(f[0].children[1].innerText=h)):(f&&(f.context.className="fa fa-eye-slash",f[0].children[1].innerText=h),b.context.className="fa fa-eye",h=b[0].children[1].innerText,b[0].children[1].innerText=b[0].childNodes[0].value,void(f=$(this).parent()))})}var i=this,j=null,k="reportSuperAgentUserDetails",l="superAgentUserDetails";this.enableBtn=!0,this.showLoader=!1,this.resultArea=!1,this.showResult=!1,this.city=null,this.state=null,this.statues=[{id:"all",title:locale.common.statuses.all},{id:"CLSD",title:locale.common.statuses.closed},{id:"ACT",title:locale.common.statuses.active},{id:"INACT",title:locale.common.statuses.inactive},{id:"UNCONF",title:locale.common.statuses.unconfirmed},{id:"SUSP",title:locale.common.statuses.suspended},{id:"CONF",title:locale.common.statuses.confirmed},{id:"PCHANG",title:locale.common.statuses.passwordChanged},{id:"BLOCK",title:locale.common.statuses.blocked},{id:"AWAITDEP",title:locale.common.statuses.awaitingDeposit}],this.status=i.statues[0],this.getparams=function(){var b={Parameters:[{ParameterName:"UserId",ParameterValue:i.showAgentList?i.selectedAgent:a.getUserData().userID},{ParameterName:"BrandId",ParameterValue:globalSettings.BrandID},{ParameterName:"UserStatusCode",ParameterValue:"all"===i.status.id?null:i.status.id}]};return(i.city||i.state)&&(i.city&&i.state?b.Parameters.push({ParameterName:"LGA",ParameterValue:i.city},{ParameterName:"State",ParameterValue:i.state}):(b=null,e.showErrorMessage("Both LGA and State should be filled for filtering"))),b},this.hideLoader=function(){c.hideLoader("#user-details-report")},this.showLoader=function(){i.showResult=!1,c.showLoader("#user-details-report",".user-details-container",0)},this.showResultTable=function(){i.showResult=!0},this.getUserDetails=function(){return i.resultArea=!1,i.showLoader(),i.enableBtn=!1,i.status.id?(j=i.getparams(),j&&(i.searchResults=null,f.getReportData(k,j).then(function(a){return a.success?a.data:(b.logError("Unable to get "+i.reportIdentifier+" summary: "+JSON.stringify(a.error)),e.showErrorMessage("Unable to get data"),void i.hideLoader())}).then(function(a){i.resultArea=!0,i.searchResults=f.transformResponseForDataTable(a.Data,l),h(i.searchResults,f.generateColumns(l,i.currencySymbol,i.isSettled)),i.hideLoader(),0!==i.searchResults.length&&i.showResultTable()}).catch(function(a){e.showErrorMessage("Unable to get data",a),i.hideLoader()})),i.hideLoader(),void(i.enableBtn=!0)):(e.showErrorMessage("Please select a Status"),void(i.enableBtn=!0))},this.resetForm=function(){i.status={selected:null},i.state=null,i.city=null},this.isTableInitialized=function(){return $.fn.DataTable.isDataTable($("#userDetailsReport"))},this.getDTLocaleUrl=function(){var a="//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/";switch(globalSettings.CurrentLanguage){case"es":return a+"Spanish.json";case"it":return a+"Italian.json";case"pt":return a+"Portuguese-Brasil.json";case"ro":return a+"Romanian.json";default:return a+"English.json"}}}])}(),function(){angular.module("shopUserManagement",[]).controller("UserManagementController",["$q","$rootScope","$scope","platformApiService","authService","sportsApiService","helperService","loggingService","$timeout","$window","$location","$filter","$ocLazyLoad","$state",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=this;o.currencySymbol=e.getUserData().currency.CurrencySymbol,o.userTypes=[],e.getAgentType(e.getUserData().userType)!=e.agentTypes.masterAgent&&e.getAgentType(e.getUserData().userType)!=e.agentTypes.superAgent||o.userTypes.push({id:0,directDescendants:!1,recursive:!0,agentsOnly:!1,nonAgentsOnly:!1,title:locale.common.all}),e.getAgentType(e.getUserData().userType)==e.agentTypes.masterAgent&&o.userTypes.push({id:1,directDescendants:!0,recursive:!1,agentsOnly:!0,nonAgentsOnly:!1,title:locale.common.superAgents}),e.getAgentType(e.getUserData().userType)!=e.agentTypes.masterAgent&&e.getAgentType(e.getUserData().userType)!=e.agentTypes.superAgent||o.userTypes.push({id:2,directDescendants:!1,recursive:!0,agentsOnly:!0,nonAgentsOnly:!1,title:locale.common.agents}),e.getAgentType(e.getUserData().userType)!=e.agentTypes.masterAgent&&e.getAgentType(e.getUserData().userType)!=e.agentTypes.superAgent&&o.userTypes.push({id:3,directDescendants:!1,recursive:!0,agentsOnly:!1,nonAgentsOnly:!0,title:locale.common.users}),o.userType=o.userTypes[0].id,o.onUserTypeChanged=function(){},this.gridExpandFormatter=function(a,b,c,d,e){c=c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");var f="<div style='left:"+15*e.indent+"px'>",g=o.gridDataView.getIdxById(e.id);return f+=o.searchResults[g+1]&&o.searchResults[g+1].indent>o.searchResults[g].indent?e.collapsed?"<i class='fa fa-caret-right toggle' aria-hidden='true'></i>&nbsp;"+c:"<i class='fa fa-caret-down toggle' aria-hidden='true'></i>&nbsp;"+c:"<span class='toggle'></span>&nbsp;"+c,f+="</div>"},this.gridExpandFilter=function(a){if(null!=a.parent)for(var b=a.parent;b;){if(b.collapsed)return!1;b=b.parent}return!0},this.buttonFormatter=function(a,b,c,d,e){var f="<button type='button' class='transferButton' data-userid='"+e.id+"'>"+locale.account.manageUsers.transfer+"</button>";return f},this.grid=null,this.gridDataView=null,this.gridOptions={editable:!1,forceFitColumns:!0,multiSelect:!1,showHeaderRow:!0,syncColumnCellResize:!0,autoHeight:!0},this.gridColumns=[{id:"userId",field:"userId",name:locale.account.manageUsers.id,formatter:o.gridExpandFormatter},{id:"username",field:"username",name:locale.account.manageUsers.username},{id:"name",field:"name",name:locale.account.manageUsers.name},{id:"surname",field:"surname",name:locale.account.manageUsers.surname},{id:"status",field:"status",name:locale.account.manageUsers.status},{id:"networkCredit",field:"networkCredit",name:locale.account.manageUsers.networkCredit+" <span>("+o.currencySymbol+")</span>"},{id:"availability",field:"availability",name:locale.account.manageUsers.availability+" <span>("+o.currencySymbol+")</span>"},{id:"balance",field:"balance",name:locale.account.manageUsers.balance+" <span>("+o.currencySymbol+")</span>"}],o.isTableInitialized=function(){return $.fn.DataTable.isDataTable($("#searchResults"))},o.getDTLocaleUrl=function(){var a="//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/";switch(globalSettings.CurrentLanguage){case"es":return a+"Spanish.json";case"it":return a+"Italian.json";case"pt":return a+"Portuguese-Brasil.json";case"ro":return a+"Romanian.json";default:return a+"English.json"}},o.parseRecord=function(a,b,c){null==b&&(c=0);var d=[],e=null,f=null;switch(a.UserStatus){case"DEL":f="Deleted";break;case"CLSD":f="Closed";break;case"REG":f="Registered";break;case"ACT":f="Active";break;case"INACT":f="Inactive";break;case"UNCONF":f="Unconfirmed";break;case"SUSP":f="Suspended";break;case"CONF":f="Confirmed";break;case"PCHANG":f="PasswordChanged";break;case"RTERMS":f="RefusedTerms";break;case"BLOCK":f="Blocked"}var g={userId:a.TpsUserId,username:a.Username,name:a.Name,surname:a.Surname,status:f,networkCredit:l("number")(a.UserCredit,0),availability:l("number")(a.AvailableBalance,0),balance:l("number")(a.UserBalance,0),parent:b,indent:c,collapsed:!0,id:a.TpsUserId};if(d.push(g),a.HasChildren)for(var h=0;h<a.Children.length;h++)$.merge(d,o.parseRecord(a.Children[h],g,c+1));for(var h=0;h<=d.length-1;h++)0==d[h].indent?e+=1:e;return e>0?d[0].collapsed=!1:d[0].collapsed=!0,d},o.onFormSubmit=function(){if(null===o.userType)return!1;var a=_.find(o.userTypes,["id",o.userType]),b={DirectDescendantsOnly:a.directDescendants,Recursive:a.recursive,AgentsOnly:a.agentsOnly,NonAgentsOnly:a.nonAgentsOnly,UserStatusesFilterBy:null};d.user.getUserList(b).then(function(a){return a.success?(o.searchResults=o.parseRecord(a.data),$(".manageUsersTable").width($(".manageUsersContainer").width()),o.gridDataView=new Slick.Data.DataView,o.gridDataView.beginUpdate(),o.gridDataView.setItems(o.searchResults),o.gridDataView.setFilter(o.gridExpandFilter),o.gridDataView.endUpdate(),o.grid=new Slick.Grid("#searchResults",o.gridDataView,o.gridColumns,o.gridOptions),o.grid.autosizeColumns(),o.grid.onClick.subscribe(function(a,b){if($(a.target).hasClass("toggle")){var c=o.gridDataView.getItem(b.row);c&&(c.collapsed?c.collapsed=!1:c.collapsed=!0,o.gridDataView.updateItem(c.id,c)),a.stopImmediatePropagation()}}),o.gridDataView.onRowCountChanged.subscribe(function(a,b){o.grid.updateRowCount(),o.grid.render()}),o.gridDataView.onRowsChanged.subscribe(function(a,b){o.grid.invalidateRows(b.rows),o.grid.render()}),void $(window).resize(function(){$(".manageUsersTable").width($(".manageUsersContainer").width()),o.grid.resizeCanvas()})):void console.error("Error occurred while searching for users: "+JSON.stringify(a.error))})},o.onFormReset=function(){o.userType=null}}])}(),function(){angular.module("shopViewSession",[]).factory("viewSessionSearchService",["$q","$sessionStorage","platformApiService","$filter","authService",function(a,b,c,d,e){
return{getSearchParams:function(){return b.viewSessionParams?b.viewSessionParams:{}},setSearchParams:function(a){b.viewSessionParams=a},searchSessions:function(){var d=a.defer();b.viewSessionParams||d.reject("No search parameters found");var f=e.getUserData(),g=b.viewSessionParams,h=moment(g.fromDate,"DD/MM/YYYY").format("YYYY-MM-DD")+"T00:00:00"+moment.tz(moment.tz.guess()).format("Z"),i=moment(g.toDate,"DD/MM/YYYY").hours(23).minutes(59).seconds(59).milliseconds(999).format("YYYY-MM-DD")+"T23:59:59"+moment.tz(moment.tz.guess()).format("Z");return c.user.getLoginSessions(f.userID,encodeURIComponent(h),encodeURIComponent(i)).then(function(a){d.resolve(a)}),d.promise}}}]).controller("ViewSessionController",["$scope","$rootScope","$sessionStorage","$location","$filter","viewSessionSearchService","authService","platformApiService","loggingService",function(a,b,c,d,e,f,g,h,i){var j=this;$.fn.dataTable.moment("DD/MM/YYYY, HH:mm:ss");var k=f.getSearchParams();this.fromDate=moment().subtract(7,"day").format("DD/MM/YYYY"),this.toDate=moment().format("DD/MM/YYYY"),this.minDate=moment().startOf("year").year(2005).toDate(),this.maxDate=moment().toDate(),this.period=k.period||1,this.searchColumns=[{title:locale.common.sessionStart,class:"center"},{title:locale.common.sessionEnd,class:"center"},{title:locale.common.duration,class:"center"}],this.searchResults=[],this.loading=!1,this.onPeriodChanged=function(){switch(j.period){case"2":j.fromDate=moment().format("DD/MM/YYYY"),j.toDate=moment().format("DD/MM/YYYY");break;case"3":j.fromDate=moment().startOf("isoWeek").format("DD/MM/YYYY"),j.toDate=moment().endOf("isoWeek").format("DD/MM/YYYY");break;case"4":j.fromDate=moment().startOf("month").format("DD/MM/YYYY"),j.toDate=moment().endOf("month").format("DD/MM/YYYY");break;case"5":j.fromDate=moment().subtract(1,"day").format("DD/MM/YYYY"),j.toDate=moment().subtract(1,"day").format("DD/MM/YYYY");break;case"6":j.fromDate=moment().subtract(1,"week").startOf("isoWeek").format("DD/MM/YYYY"),j.toDate=moment().subtract(1,"week").endOf("isoWeek").format("DD/MM/YYYY");break;case"7":j.fromDate=moment().subtract(1,"month").startOf("month").format("DD/MM/YYYY"),j.toDate=moment().subtract(1,"month").endOf("month").format("DD/MM/YYYY")}},this.stringSort=function(a,b){return a.trim()<b.trim()?-1:a.trim()>b.trim()?1:0},this.isAgentsPage=function(){return d.absUrl().indexOf(globalSettings.CurrentLanguage+"/agents")>-1},this.resetForm=function(){j.fromDate=moment().subtract(7,"day").format("DD/MM/YYYY"),j.toDate=moment().format("DD/MM/YYYY")},this.isTableInitialized=function(){return $.fn.DataTable.isDataTable($("#searchResults"))},this.getDTLocaleUrl=function(){var a="//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/";switch(globalSettings.CurrentLanguage){case"es":return a+"Spanish.json";case"it":return a+"Italian.json";case"pt":return a+"Portuguese-Brasil.json";case"ro":return a+"Romanian.json";default:return a+"English.json"}},this.searchSessions=function(){f.setSearchParams({fromDate:j.fromDate,toDate:j.toDate}),j.searchResults=[],b.showLoader(),j.loading=!0,f.searchSessions().then(function(a){if(a.success){var c=a.data;f.getSearchParams();_.forEach(c.UserSessions,function(a,b){var c=[],d=moment.tz(moment(a.LoginDate).format(),moment.tz.guess()).format("MM/DD/YYYY, HH:mm")||"-",e=moment.tz(moment(a.LogOffDate).format(),moment.tz.guess()).format("MM/DD/YYYY, HH:mm")||"-",f=moment(e).diff(d)||moment.duration(a.SessionDuration),g=moment.duration(f),h=g.format("d:hh:mm");c.push(d,e,h+"m"),j.searchResults.push(c)}),j.isTableInitialized()&&$("#searchResults").dataTable().api().destroy(),$("#searchResults").dataTable({dom:'<"top"if>rt<"bottom"pl><"clear">',oLanguage:{sLengthMenu:"Rows per page _MENU_"},data:j.searchResults,columns:j.searchColumns,pageLength:10,order:[[2,"desc"]],bSort:!1,stateSave:!0,language:{url:j.getDTLocaleUrl()}})}else console.error("Error occurred while searching for bets: "+JSON.stringify(a.error));j.loading=!1,b.hideLoader()})},this.searchSessions()}])}(),function(){"use strict";angular.module("bankProfile.service",[]).factory("bankProfileService",["$rootScope","platformApiService","helperService","$q","authService",function(a,b,c,d,e){var f={};return f.saveBankAccStatus=!1,f.isAllowedBankAccInfo=!1,f.profiles=null,f.enabledProfiles=0,f.bankLists=null,f.getSaveBankAccStatus=function(){return!!f.saveBankAccStatus&&f.saveBankAccStatus},f.setSaveBankAccStatus=function(a){f.saveBankAccStatus=a},f.getSaveBankAccountDetails=function(){var a=d.defer();if(f.profiles=null,f.bankLists=null,e.hasValidLogin()){var g=b.paymentVendors.bankTransfer.getBankTransferDetails(),h=b.paymentVendors.bankInformation.getBankList();d.all([g,h]).then(function(b){var d=b[0]||null,e=b[1];!e.success&&e.error||!d&&d.error?(c.showErrorMessage(e.error||d.error).done(),a.resolve(!1)):(f.bankLists=e.data,d.data&&d.data.length>0?f.profiles=f.parseProfiles(d.data):f.setSaveBankAccStatus(!1),a.resolve(!0))})}else a.resolve(!1);return a.promise},f.swapBankProfile=function(a){var e=d.defer(),g={BankTransferDetailsId:a.Id};return b.paymentVendors.bankTransfer.updateDefaultBankTransferDetails(g).then(function(a){a.success?(c.showSuccessMessage(locale.account.editProfile.saveWithdrawalBankProfile.defaultProfileChanged).done(),f.getSaveBankAccountDetails().then(function(){e.resolve(!0)})):(a.error&&c.showErrorMessage(a.error).done(),e.resolve(!1))}),e.promise},f.validateNewProfile=function(a,b){var d=!0;return f.profiles&&f.profiles.forEach(function(e){e.AccountNumber===a.AccountNumber&&e.BankCode===a.BankCode&&(3===e.Verification.VerificationStatusID?c.showErrorMessage(locale.account.editProfile.saveWithdrawalBankProfile.errorOnNewAndRejected).done():b?c.showWarningMessage(locale.account.editProfile.saveWithdrawalBankProfile.errorSameAccWithdrawals):c.showWarningMessage(locale.account.editProfile.saveWithdrawalBankProfile.errorSameAccProfileManag),d=!1)}),d},f.saveNewBankProfile=function(a,e,g){var h=d.defer();return f.validateNewProfile(a,e)?b.paymentVendors.bankTransfer.postBankTransferDetails(a).then(function(a){!a.success||a.error?("This bank account is already saved"===a.error?c.showErrorMessage(locale.account.editProfile.saveWithdrawalBankProfile.errorOnAlreadyDisabled).done():c.showErrorMessage(a.error).done(),h.resolve()):(g||c.showSuccessMessage(locale.account.editProfile.saveWithdrawalBankProfile.profileSuccessfullySaved).done(),f.getSaveBankAccountDetails().then(function(){h.resolve(a.data.Id)}))}):h.resolve(!1),h.promise},f.parseBankCode=function(a){var b="";return f.bankLists?f.bankLists.forEach(function(c){c.BankCode===a&&(b=c.BankName)}):b=null,b},f.parseProfiles=function(a){return f.setSaveBankAccStatus(!1),f.enabledProfiles=0,a.forEach(function(a){if(a.BankName=f.parseBankCode(a.BankCode),3===a.Verification.VerificationStatusID)a.class="fa fa-exclamation-triangle icon yellow",a.state=0,f.profiles?f.profiles.push(a):f.profiles=[a];else{if(!a.Enabled)return;2===a.Verification.VerificationStatusID||4===a.Verification.VerificationStatusID?(f.enabledProfiles++,a.class="fa fa-check-circle icon green",a.state=1,f.profiles?f.profiles.push(a):f.profiles=[a],f.setSaveBankAccStatus(!0)):1===a.Verification.VerificationStatusID&&(f.enabledProfiles++,a.class="fa fa-clock-o icon red",a.state=-1,f.profiles?f.profiles.push(a):f.profiles=[a],f.setSaveBankAccStatus(!0))}}),f.profiles},f.checkEnableWithdrawalBankProfile=function(){if(e.hasValidLogin()){if(globalSettings.Account_EnableWithdrawalBankProfile)if(""===globalSettings.Account_BankProfileBlackList)f.isAllowedBankAccInfo=!0;else{var a=globalSettings.Account_BankProfileBlackList.split(","),b=$.grep(a,function(a){var b=e.getUserData().userType;return a==b});f.isAllowedBankAccInfo=!(b.length>0)}else f.isAllowedBankAccInfo=!1;f.isAllowedBankAccInfo?f.getSaveBankAccountDetails():f.saveBankAccStatus=!0}},a.$watch(function(){return e.hasValidLogin()},function(a,b){a!==b&&(a?f.checkEnableWithdrawalBankProfile():(f.profiles=null,f.bankLists=null))}),f.checkEnableWithdrawalBankProfile(),f}])}(),function(){"use strict";function a(a,b,c){var d={fromDate:"",toDate:"",period:null};return d.getUserList=function(b,d,e,f,g){var h=a.defer();return c.finance.getTransferCandidates(b,d,e,f,g).then(function(a){h.resolve(a)}).catch(function(a){h.reject(a)}),h.promise},d.getCashiersSummaryData=function(b){var d=a.defer();return b||d.reject("No configuration object specified!"),c.report.getCashiersSummaryData(b).then(function(a){d.resolve(a)}).catch(function(a){d.reject(a)}),d.promise},d.loadBalance=function(b,d){var e=a.defer(),f=b?"transferTo":"transferToMany";return d||e.reject("No configuration object specified!"),c.finance[f](d).then(function(a){e.resolve(a)}).catch(function(a){e.reject(a)}),e.promise},d.unloadBalance=function(b,d){var e=a.defer(),f=b?"transferFrom":"transferFromMany";return d||e.reject("No configuration object specified!"),c.finance[f](d).then(function(a){e.resolve(a)}).catch(function(a){e.reject(a)}),e.promise},d.changePassword=function(b){var d=a.defer();return b||d.reject("No configuration object specified!"),c.user.changePassword(b).then(function(a){d.resolve(a)}).catch(function(a){d.reject(a)}),d.promise},d.addCashiers=function(b,d){var e=a.defer();return d||e.reject("No configuration object specified!"),c.clientSpecific.addCashiers(b,d).then(function(a){e.resolve(a)}).catch(function(a){e.reject(a)}),e.promise},d}function b(a){var b={};return b.quickFills=[1e4,2e4,3e4,4e4,"All"],b.checkPrimitiveType=function(a){return Object.prototype.toString.call(a).substring(8).split("").slice(0,-1).join("").toLowerCase()},b.calculateGrandTotals=function(b){var c=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0;b.forEach(function(a){c=parseFloat((c+a.BVPaidOut).toFixed(2)),d=parseFloat((d+a.BVWager).toFixed(2)),e=parseFloat((e+a.Balance).toFixed(2)),f=parseFloat((f+a.BetsPaidOut).toFixed(2)),g=parseFloat((g+a.SportsWager).toFixed(2)),h=parseFloat((h+a.ToCollect).toFixed(2)),m=parseFloat((m+(a.TurnoverTax?a.TurnoverTax:0)).toFixed(2)),n=parseFloat((n+(a.WithholdingTax?a.WithholdingTax:0)).toFixed(2)),i=parseFloat((i+a.VirtualPaidOut).toFixed(2)),o=parseFloat((o+a.VirtualWager).toFixed(2)),p=parseFloat((p+a.GRPaidOut).toFixed(2)),q=parseFloat((q+a.GRWager).toFixed(2)),globalSettings.Reports_EnableLottery&&(j=parseFloat((j+a.LotWager).toFixed(2)),k=parseFloat((k+a.LotPaidOut).toFixed(2)),l=parseFloat((l+a.LotExtPaidOut).toFixed(2)))});var r=["",locale.account.shopWebsite.cashiers.reports.totalSummaryReport.total,a("numberTruncate")(parseFloat(e).toFixed(2)),a("numberTruncate")(parseFloat(g).toFixed(2)),a("numberTruncate")(parseFloat(f).toFixed(2)),a("numberTruncate")(parseFloat(o).toFixed(2)),a("numberTruncate")(parseFloat(i).toFixed(2)),a("numberTruncate")(parseFloat(d).toFixed(2)),a("numberTruncate")(parseFloat(c).toFixed(2)),a("numberTruncate")(parseFloat(q).toFixed(2)),a("numberTruncate")(parseFloat(p).toFixed(2)),a("numberTruncate")(parseFloat(j).toFixed(2)),a("numberTruncate")(parseFloat(k).toFixed(2)),a("numberTruncate")(parseFloat(l).toFixed(2)),a("numberTruncate")(parseFloat(h).toFixed(2)),a("numberTruncate")(parseFloat(m).toFixed(2)),a("numberTruncate")(parseFloat(n).toFixed(2)),"","",""];return r},b.transformResponseForDataTable=function(b,c){var d=[];return _.forEach(b,function(b,e){var f=[];f.push(b.UserId,b.Username,c[b.UserId]?a("numberTruncate")(parseFloat(c[b.UserId].Balance).toFixed(2)):"-",a("numberTruncate")(parseFloat(b.SportsWager).toFixed(2))+' <i ng-click="cashierCtrl.copyPeriodToService(); cashierCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierSportsBets\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.BetsPaidOut).toFixed(2))+' <i ng-click="cashierCtrl.copyPeriodToService(); cashierCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierPayouts\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.VirtualWager).toFixed(2))+' <i ng-click="cashierCtrl.copyPeriodToService(); cashierCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierVirtualBets\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.VirtualPaidOut).toFixed(2))+' <i ng-click="cashierCtrl.copyPeriodToService(); cashierCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierVirtualWins\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.BVWager).toFixed(2))+' <i ng-click="cashierCtrl.copyPeriodToService(); cashierCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierBVBets\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.BVPaidOut).toFixed(2))+' <i ng-click="cashierCtrl.copyPeriodToService(); cashierCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierBVWins\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.GRWager).toFixed(2))+' <i ng-click="cashierCtrl.copyPeriodToService(); cashierCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierGRBets\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.GRPaidOut).toFixed(2))+' <i ng-click="cashierCtrl.copyPeriodToService(); cashierCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierGRWins\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',(globalSettings.Reports_EnableLottery?a("numberTruncate")(parseFloat(b.LotWager).toFixed(2)):0)+' <i ng-click="cashierCtrl.copyPeriodToService(); cashierCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierLotBets\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',(globalSettings.Reports_EnableLottery?a("numberTruncate")(parseFloat(b.LotPaidOut).toFixed(2)):0)+' <i ng-click="cashierCtrl.copyPeriodToService(); cashierCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierLotWin\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',(globalSettings.Reports_EnableLottery?a("numberTruncate")(parseFloat(b.LotExtPaidOut).toFixed(2)):0)+' <i ng-click="cashierCtrl.copyPeriodToService(); cashierCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierLotExtWin\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.ToCollect).toFixed(2)),a("numberTruncate")(parseFloat(b.TurnoverTax?b.TurnoverTax:0).toFixed(2)),a("numberTruncate")(parseFloat(b.WithholdingTax?b.WithholdingTax:0).toFixed(2)),'<button ng-disabled="cashierCtrl.cashiers['+b.UserId+'] === undefined" class="paddedButton load" ng-click="cashierCtrl.loadBalance('+b.UserId+')"><i class="fa fa-plus" aria-hidden="true"></i>'+locale.account.shopWebsite.cashiers.reports.totalSummaryReport.dataTableButtons.load+'</button><button ng-disabled="cashierCtrl.cashiers['+b.UserId+'] === undefined" class="paddedButton unload" ng-click="cashierCtrl.unloadBalance('+b.UserId+')"><i class="fa fa-minus" aria-hidden="true"></i>'+locale.account.shopWebsite.cashiers.reports.totalSummaryReport.dataTableButtons.unload+"</button>",'<label for="checkbox'+e+'" class="model-checkboxes-label"><i class="fa fa-square-o" ng-class="{selected: cashierCtrl.checkboxes['+e+'].checked}"></i><input id="checkbox'+e+'" ng-disabled="cashierCtrl.cashiers['+b.UserId+'] === undefined" type="checkbox" value="'+b.UserId+'" ng-model="cashierCtrl.checkboxes['+e+'].checked" ng-change="cashierCtrl.toggleCheckboxes()" class="model-checkboxes" /></label>','<button class="paddedButton reset-password" ng-click="cashierCtrl.resetPassword('+b.UserId+')">'+locale.account.shopWebsite.cashiers.reports.totalSummaryReport.dataTableButtons.resetPassword+"</button>"),d.push(f)}),d},b.transformResponseForDataTableIntAcc=function(b,c){var d=[];return _.forEach(b,function(b,e){var f=[];f.push(b.UserId,b.Username,c[b.UserId]?a("numberTruncate")(parseFloat(c[b.UserId].Balance).toFixed(2)):"-",a("numberTruncate")(parseFloat(b.SportsWager).toFixed(2))+' <i ng-click="interAccNewCtrl.copyPeriodToService(); interAccNewCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierSportsBets\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.BetsPaidOut).toFixed(2))+' <i ng-click="interAccNewCtrl.copyPeriodToService(); interAccNewCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierPayouts\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.VirtualWager).toFixed(2))+' <i ng-click="interAccNewCtrl.copyPeriodToService(); interAccNewCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierVirtualBets\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.VirtualPaidOut).toFixed(2))+' <i ng-click="interAccNewCtrl.copyPeriodToService(); interAccNewCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierVirtualWins\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.BVWager).toFixed(2))+' <i ng-click="interAccNewCtrl.copyPeriodToService(); interAccNewCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierBVBets\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.BVPaidOut).toFixed(2))+' <i ng-click="interAccNewCtrl.copyPeriodToService(); interAccNewCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierBVWins\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.GRWager).toFixed(2))+' <i ng-click="cashierCtrl.copyPeriodToService(); cashierCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierBVBets\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.GRPaidOut).toFixed(2))+' <i ng-click="cashierCtrl.copyPeriodToService(); cashierCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierBVWins\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',(globalSettings.Reports_EnableLottery?a("numberTruncate")(parseFloat(b.LotWager).toFixed(2)):0)+' <i ng-click="interAccNewCtrl.copyPeriodToService(); interAccNewCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierLotBets\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',(globalSettings.Reports_EnableLottery?a("numberTruncate")(parseFloat(b.LotPaidOut).toFixed(2)):0)+' <i ng-click="interAccNewCtrl.copyPeriodToService(); interAccNewCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierLotWin\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',(globalSettings.Reports_EnableLottery?a("numberTruncate")(parseFloat(b.LotExtPaidOut).toFixed(2)):0)+' <i ng-click="interAccNewCtrl.copyPeriodToService(); interAccNewCtrl.copyDatesToService();"  ui-sref="shopCashiersReports({ reportIdentifier: \'cashierLotExtWin\', userId: '+b.UserId+' })" class="fa fa-search-plus" aria-hidden="true"></i>',a("numberTruncate")(parseFloat(b.ToCollect).toFixed(2)),a("numberTruncate")(parseFloat(b.TurnoverTax?b.TurnoverTax:0).toFixed(2)),a("numberTruncate")(parseFloat(b.WithholdingTax?b.WithholdingTax:0).toFixed(2)),'<button ng-disabled="interAccNewCtrl.cashiers['+b.UserId+'] === undefined" class="paddedButton load" ng-click="interAccNewCtrl.loadBalance('+b.UserId+')"><i class="fa fa-plus" aria-hidden="true"></i>'+locale.account.shopWebsite.cashiers.reports.totalSummaryReport.dataTableButtons.load+'</button><button ng-disabled="interAccNewCtrl.cashiers['+b.UserId+'] === undefined" class="paddedButton unload" ng-click="interAccNewCtrl.unloadBalance('+b.UserId+')"><i class="fa fa-minus" aria-hidden="true"></i>'+locale.account.shopWebsite.cashiers.reports.totalSummaryReport.dataTableButtons.unload+"</button>",'<label for="checkbox'+e+'" class="model-checkboxes-label"><i class="fa fa-square-o" ng-class="{selected: interAccNewCtrl.checkboxes['+e+'].checked}"></i><input id="checkbox'+e+'" ng-disabled="interAccNewCtrl.cashiers['+b.UserId+'] === undefined" type="checkbox" value="'+b.UserId+'" ng-model="interAccNewCtrl.checkboxes['+e+'].checked" ng-change="interAccNewCtrl.toggleCheckboxes()" class="model-checkboxes" /></label>','<button class="paddedButton reset-password" ng-click="interAccNewCtrl.resetPassword('+b.UserId+')">'+locale.account.shopWebsite.cashiers.reports.totalSummaryReport.dataTableButtons.resetPassword+"</button>"),d.push(f)}),d},b.generateCheckboxes=function(a){var b=[];return _.forEach(a,function(a,c){var d={id:a.UserId,checked:!1};b.push(d)}),b},b.generateQuickFillButtons=function(c,d){var e="",f=angular.copy(d,[]);return f[4]=c?5e4:"All",_.forEach(f,function(c){var d="number"===b.checkPrimitiveType(c),f=d?a("currencyFormat")(c):c,g=d?c:"'All'";e+='<button class="paddedButton" ng-click="cashierCtrl.quickFillBalance('+g+')">'+f+"</button>"}),e},b.generateQuickFillButtonsIntAcc=function(c,d){var e="",f=angular.copy(d,[]);return f[4]=c?5e4:"All",_.forEach(f,function(c){var d="number"===b.checkPrimitiveType(c),f=d?a("currencyFormat")(c):c,g=d?c:"'All'";e+='<button class="paddedButton" ng-click="interAccNewCtrl.quickFillBalance('+g+')">'+f+"</button>"}),e},b.generateSwalMarkup=function(c,d,e,f,g){g=g?g:"";var h="string"===this.checkPrimitiveType(f);f=h&&f.indexOf("-")>-1?"0":f;var i="",j=c&&d?"Load balance for single user":c&&!d?"Unload balance for single user":!c&&d?"Load balances for "+g+" selected users":"Unload balances for "+g+" selected users",k=c&&d?"Enter the amount you wish to add to <span>"+c+"'s</span> Balance":c&&!d?"Enter the amount you wish to remove from <span>"+c+"'s</span> Balance":!c&&d?"Enter the amount you wish to add to selected users' Balances":"Enter the amount you wish to remove from selected users' Balances",l=c?"<p class='current-balance'>"+c+"'s current Balance: <span class='balance'>"+a("currencyFormat")(isNaN(f.replace(/,/g,""))?0:parseFloat(f.replace(/,/g,"")))+"</span> </p>":"",m="";return c&&(m="<p class='updated-balance'>"+c+"'s updated balance will be: <span class='balance'>",m+=d?"{{ cashierCtrl.updateBalance(cashierCtrl.popupBalance) }}":"{{ cashierCtrl.updateBalance(cashierCtrl.popupBalance*-1) }}",m+="</span > </p >"),i+='<div class="cashier-popup"><div class="cashier-popup__header"><p class="title">'+j+"</p>"+l+'</div><div class="cashier-popup__content"><p class="amount-to-add">'+k+'</p><div class="cashier-popup__input-container"><span>'+e+'</span> <input ng-if="cashierCtrl.popupBalance !== \'All\'" type="number" ng-model="cashierCtrl.popupBalance" /> <input ng-if="cashierCtrl.popupBalance === \'All\'" type="text" readonly ng-model="cashierCtrl.popupBalance"></div><p>Quick Fill</p><div class="cashier-popup__quick-fill">'+b.generateQuickFillButtons(d,b.quickFills)+"</div></div>"+m+"</div>"},b.generateSwalMarkupIntAcc=function(c,d,e,f,g,h){h=h?h:"";var i="string"===this.checkPrimitiveType(f);f=i&&f.indexOf("-")>-1?"0":f;var j="",k=c&&d?"Load balance for single user":c&&!d?"Unload balance for single user":!c&&d?"Load balances for "+h+" selected users":"Unload balances for "+h+" selected users",l=c&&d?"Enter the amount you wish to add to <span>"+c+"'s</span> Balance":c&&!d?"Enter the amount you wish to remove from <span>"+c+"'s</span> Balance":!c&&d?"Enter the amount you wish to add to selected users' Balances":"Enter the amount you wish to remove from selected users' Balances",m=c?"<p class='current-balance'>"+c+"'s current Balance: <span class='balance'>"+a("currencyFormat")(isNaN(f.replace(/,/g,""))?0:parseFloat(f.replace(/,/g,"")))+"</span> </p>":"",n=null!=g?"<p class='current-balance'>"+c+"'s credit Balance: <span class='balance'>"+a("currencyFormat")(isNaN(g.replace(/,/g,""))?0:parseFloat(g.replace(/,/g,"")))+"</span> </p>":"",o="";if(c){o="<p class='updated-balance'>"+c+"'s updated balance will be: <span class='balance'>";var p=isNaN(f.replace(/,/g,""))?0:parseFloat(f.replace(/,/g,""));o+=d?"{{ interAccNewCtrl.updateBalance("+p+", interAccNewCtrl.popupBalance) }}":"{{ interAccNewCtrl.updateBalance("+p+", interAccNewCtrl.popupBalance*-1) }}",o+="</span > </p >"}return j+='<div class="cashier-popup"><div class="cashier-popup__header"><p class="title">'+k+"</p>"+n+m+'</div><div class="cashier-popup__content"><p class="amount-to-add">'+l+'</p><div class="cashier-popup__input-container"><span>'+e+'</span> <input ng-if="interAccNewCtrl.popupBalance !== \'All\'" type="number" ng-model="interAccNewCtrl.popupBalance" /> <input ng-if="interAccNewCtrl.popupBalance === \'All\'" type="text" readonly ng-model="interAccNewCtrl.popupBalance"></div><p>Quick Fill</p><div class="cashier-popup__quick-fill">'+b.generateQuickFillButtonsIntAcc(d,b.quickFills)+"</div></div>"+o+"</div>"},b.generateSwalResetPassword=function(a){var b="";return b+='<div class="cashier-popup"><div class="cashier-popup__header"><p class="title">Reset Password</p></div><div class="cashier-popup__content"><p class="amount-to-add">Reset password for user: '+a+'</p><div class="cashier-popup__input-container"><span style="cursor: pointer" ng-click="cashierCtrl.toggleInputType()"><i class="fa fa-{{ cashierCtrl.inputType === \'password\' ? \'eye\' : \'eye-slash\' }}"></i></span> <input autocomplete="none" type="{{cashierCtrl.inputType}}" ng-model="cashierCtrl.password" /></div></div></div>'},b.generateSwalResetPasswordIntAcc=function(a){var b="";return b+='<div class="cashier-popup"><div class="cashier-popup__header"><p class="title">Reset Password</p></div><div class="cashier-popup__content"><p class="amount-to-add">Reset password for user: '+a+'</p><div class="cashier-popup__input-container"><span style="cursor: pointer" ng-click="interAccNewCtrl.toggleInputType()"><i class="fa fa-{{ interAccNewCtrl.inputType === \'password\' ? \'eye\' : \'eye-slash\' }}"></i></span> <input type="{{interAccNewCtrl.inputType}}" ng-model="interAccNewCtrl.password" /></div></div></div>'},b}angular.module("shopCashier").factory("CashierService",a).factory("CashierHelperFunctions",b),a.$inject=["$q","authService","platformApiService"],b.$inject=["$filter"]}(),function(){angular.module("cashout.service",[]).factory("cashoutService",["$rootScope","$q","$localStorage","$filter","authService","sportsApiService","loggingService","helperService","evaluationSignalrService",function(a,b,c,d,e,f,g,h,i){var j,k=Object.freeze({pending:1,approved:2,rejected:3}),l=function(){return null==c.evaluationList&&(c.evaluationList=[]),c.evaluationList},m=function(){return null==c.pendingCashoutList&&(c.pendingCashoutList=[]),c.pendingCashoutList},n=function(a,b){if(!p(a)){var c=m();c.push({cashoutId:a,couponCode:b})}},o=function(a){var b=l(),c=m();_.remove(c,function(b){return b.cashoutId==a}),0===c.length&&0===b.length&&i.stopConnection()},p=function(a,b){return null!=_.find(m(),function(c){return null!=a&&c.cashoutId==a||null!=b&&c.couponCode==b})},q=function(a){var c=b.defer();return f.coupon.getCashoutValue(a).then(function(a){return a.success?void c.resolve(s(a.data)):(g.logError("Unable to get cashout value: "+JSON.stringify(a.error)),void c.resolve(s()))}),c.promise},r=function(a){var c=b.defer();return f.coupon.cashoutValuesBulk(a).then(function(a){return a.success?void c.resolve(s(a.data,!0)):(g.logError("Unable to get cashout value: "+JSON.stringify(a.error)),void c.resolve(s()))}),c.promise},s=function(a,b){var c=[105],e=[];if(globalSettings.Sports_CashOutUnavailableCodes.trim().length>0&&(e=_.map(globalSettings.Sports_CashOutUnavailableCodes.split(","),Number)),result=[],a&&a.length>0)return _.forEach(a,function(a){var b={cashoutAvailable:!1,responseCode:2,currency:{id:-1,code:"",symbol:""},value:-1,netValue:-1,tax:-1,displayValue:"",displayNetValue:"",displayMessage:"",displayTax:"",serverData:null};b.serverData=a,b.cashoutAvailable=a.CashoutAvailability,b.responseCode=a.CashoutResult,b.cashoutAvailable?(b.value=a.CashoutValue,b.netValue=a.NetOfferedValue,b.tax=a.WithholdingTax,b.displayValue=d("currencyFormat")(b.value,2),b.displayNetValue=d("currencyFormat")(b.netValue,2),b.displayTax=d("currencyFormat")(b.tax,2)):_.indexOf(e,b.responseCode)>-1?b.displayMessage=locale.common.cashout.cashoutUnavailable:_.indexOf(c,b.responseCode)>-1&&(b.displayMessage=locale.common.cashout.errors[b.responseCode]||""),result.push(b)}),b?result:result[0]},t=function(c,d){var e=b.defer();return f.coupon.cashout(c,d).then(function(b){if(!b.success)return g.logError("Unable to cashout: "+JSON.stringify(b.error)),void e.resolve(u());var c=u(b.data);c.success&&c.cashoutId>=0&&(c.cashoutAccepted?(z(c),a.$broadcast("cashoutService:cashoutApproved")):(n(c.cashoutId,c.couponCode),w())),e.resolve(c)}),e.promise},u=function(a){var b={success:!1,cashoutAccepted:!1,userMessage:"",responseCode:300,cashoutId:-1,couponCode:"",currency:{id:-1,code:"",symbol:""},value:-1,displayValue:""};return null==a||a.length<=0?b:(b.success=a[0].CashoutRequested,b.cashoutAccepted=a[0].CashoutAccepted,b.responseCode=a[0].CashoutResult,b.cashoutId=a[0].CashoutId,b.couponCode=a[0].CouponCode,b.value=a[0].CashoutValue,b.displayValue=d("currencyFormat")(b.value,2),b.userMessage=locale.common.cashout.success,b.success||(b.userMessage=locale.common.cashout.errors.generic+" ("+b.responseCode+")"),b.responseCode>=300&&b.responseCode<400&&(b.userMessage=locale.common.cashout.errors[b.responseCode]),b)},v=function(){var a=b.defer();return pendingCashoutList=[],f.coupon.getPendingCashouts().then(function(b){return b.success?(_.forEach(b.data,function(a){n(a.CashoutID,a.CouponCode)}),void a.resolve()):(g.logError("Unable to get pending cashouts: "+JSON.stringify(b.error)),void a.resolve())}),a.promise},w=function(){var b=m();b&&b.length>0&&(i.startConnection(),j||(a.$on("cashoutEvaluationComplete",function(a,b){b&&x(b)}),j=!0))},x=function(b){if(b){var c=y(b);o(c.cashoutId),c.status==k.approved?(z(c),a.$broadcast("cashoutService:cashoutApproved")):c.status==k.rejected&&(A(c),a.$broadcast("cashoutService:cashoutRejected:"+c.couponCode,c))}},y=function(a){var b={status:k.pending,cashoutId:-1,couponCode:"",value:-1,displayValue:""};return null==a?b:(b.cashoutId=a.cashoutId,b.couponCode=a.couponCode,2==a.cashoutStatus?(b.status=k.approved,b.value=a.netOfferedValue,b.displayValue=d("currencyFormat")(b.value,2)):3==a.cashoutStatus&&(b.status=k.rejected),b)},z=function(a){var b=locale.common.cashout.approved;b=b.replace("{couponCode}",a.couponCode),b=b.replace("{cashoutValue}",a.displayValue),h.showSuccessMessage(b).done()},A=function(a){var b=locale.common.cashout.rejected;b=b.replace("{couponCode}",a.couponCode),h.showErrorMessage(b).done()},B=function(){a.$watch(function(){return e.hasValidLogin()},function(a,b){a?v().then(function(){w()}):i.stopConnection()}),a.$watch(function(){return localStorage.getItem("pendingCashoutList")},function(a,b){a!==b&&c.$sync()},!0),a.$watch(function(){return m()},function(b,c){b!==c&&a.$broadcast("cashoutService:pendingListUpdated",b)},!0)};return{init:B,getCashoutValue:q,cashoutValuesBulk:r,cashout:t,isInPendingList:p}}])}(),function(){angular.module("coupon",["coupon.service","evaluation.service","evaluationSignalr.service","cashout.service","couponPrint","expandCoupon","couponDetailsIFrame","openBets"]).controller("CouponController",["$rootScope","$scope","$q","$location","$sessionStorage","$localStorage","$timeout","$filter","$state","authService","currencyService","sportsApiService","platformApiService","helperService","loggingService","couponService","evaluationService","stateService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){
function s(a){w.quickBetData=a,$("span#quickBetEventName").text(a?a.EventName:""),a?($("div#quickBetContent").show(),$("div#quickBetEmpty").hide()):($("div#quickBetContent").hide(),$("div#quickBetEmpty").show())}function t(a){w.smartBetData=a,$("span#smartCodeEventName").text(a?a.EventName:""),$("input#txtSmartCode").prop("disabled",!a)}function u(a){$(a).addClass("selected")}function v(a){$(a).removeClass("selected")}var w=this;this.smartBetCode="",this.quickBetCode="",this.couponCodeCheck="",this.isCurrentLive=!1,this.savedCouponStorage="savedBetCoupon",this.couponData=_.cloneDeep(p.getCouponData()),this.oddChanges=_.cloneDeep(p.getOddChanges()),this.expiredEvents=_.cloneDeep(p.getExpiredEvents()),this.selectionIds=null,this.couponEmpty=!1,this.couponWaiting=!1,this.confirmedCoupon=!1,this.couponSuccess=!1,this.couponBookedSuccess=!1,this.bookingCodeSection=!0,this.bookConfirmSection=!1,this.bookConfirmData=[],this.couponSavedData=p.getSavedCoupons(),this.isClickEnabled=!0,this.bookedCouponCode="",this.agentUserId=0,this.lastCouponCode=null,this.lastUserId=null,this.lastCouponInRiserva=!1,this.showButtons=!0,this.evaluationPopupCodes=[],this.groupingsTabSelected=null,this.showPrintBtn=!1,this.showCouponLoader=!1,this.setAmountFirstTime=!0,this.isPrinted=!1,this.showBookCoupon=w.couponData&&1!=w.couponData.IsLoggedIn&&1!=w.couponData.HasLive||j.getVerifyAccountData()&&"Locked"==j.getVerifyAccountData().type,this.showPlaceBet=!(j.getVerifyAccountData()&&"Locked"==j.getVerifyAccountData().type),this.switchStatus="currentBetSlip",this.numOfValidGroupings=function(){return _.filter(w.couponData.AllGroupings,function(a){return 0!==a.Combinations}).length},this.clearExpiredEvents=function(){p.clearExpiredEvents(),w.expiredEvents=_.cloneDeep(p.getExpiredEvents())},this.toggleCouponOpenBets=function(a){var b=$(a.currentTarget),c=b.attr("id");b.hasClass("disabled")||(b.parent().find(".tab").removeClass("selected"),b.addClass("selected"),b.parent().next().find(".content").css("display","none"),b.parent().next().find("#"+c+"Content").css("display","block"),"openBets"==c?b.parent().find(".tab .totalOdds").css("display","none"):b.parent().find(".tab .totalOdds").css("display","flex"))},this.toggleSwitchCouponOpenBets=function(a){var b=$(a.currentTarget);b.parent().find(".switch-wrapper").hasClass("disabled")||("openBets"==w.switchStatus?w.switchStatus="currentBetSlip":w.switchStatus="openBets")},b.$on("setSwitchStatus",function(a,b){w.switchStatus=b}),this.delimiters=globalSettings.CouponDelimiters.split(",").map(function(a){return parseFloat(a,10)}),this.delimiters=_.uniq(_.remove(this.delimiters,function(a){return!isNaN(a)})),this.generateAmount=function(a){var b=j.hasValidLogin()?j.getUserData().currency.Currency:e.SportsbookGlobalVariable.CurrencyId;return globalSettings.Sports_RemoveTrailingZeros?k.formatNumber(b,h("removeDecimalPoints")(a),k.isInverseCurrency(b)):h("currencyFormat")(a)},this.getCurrency=function(){return j.hasValidLogin()?j.getUserData().currency.Currency:k.getCurrencyCode(e.SportsbookGlobalVariable.CurrencyId)},this.setAmount=function(a){void 0===a?(w.setAmountFirstTime=!0,w.couponData.StakeGrossValue=this.delimiters[0]):w.setAmountFirstTime?(w.setAmountFirstTime=!1,w.couponData.StakeGrossValue=a):("number"!=typeof w.couponData.StakeGrossValue&&(w.couponData.StakeGrossValue=0),w.couponData.StakeGrossValue+=a),w.updateStakeValue()},this.showCouponConfirmationDialog=function(){n.showInfoMessage(locale.sports.coupon.couponOdds.couponConfirmationMessage,null,!0,locale.common.cancel,!0,locale.common.confirm).then(w.confirmBet_Clicked,w.backBet_Clicked)},this.getUsersForAgent=function(a){if(null==j.getUserData()||!j.getUserData().isAgent)return w.users=[],void(w.agentUserId=0);if(null==e.agentUserJSON)m.user.isSportsbookEnabled().then(function(a){return a&&a.data?void m.gamingVendors.sportsbook.getDelegatedBetUserList().then(function(a){return a.success?(w.users=a.data.DelegatedBetUsers,void(e.agentUserJSON=a.data.DelegatedBetUsers)):void o.logError("Unable to get user agents: "+JSON.stringify(a.error))}):void(e.agentUserJSON=[])});else{var b=e.agentUserJSON;w.users=b}w.agentUserId=j.getUserData().userID},this.bookCoupon=function(){p.bookCoupon().then(function(a){w.handleBookCouponResponse(a)})},this.handleBookCouponResponse=function(b){if(w.bookedCouponCode="",null==b||!b.success)return void n.showErrorMessage(locale.sports.coupon.combinationSet.bookedCouponError,w.showCouponMessage);if(document.getElementById("couponContent").style.display="block",w.couponWaiting=!1,w.couponSuccess=!1,w.couponBookedSuccess=!1,w.bookingCodeSection=!0,w.bookConfirmSection=!1,w.bookConfirmData=[],w.confirmedCoupon=!1,!b.apiResponse.success)return void n.showErrorMessage(locale.sports.coupon.combinationSet.bookedCouponError,w.showCouponMessage);var c=b.apiResponse.data,d=c.ResponseStatus;1==d?(w.couponBookedSuccess=!0,w.couponSavedData=p.getSavedCoupons(),a.bookedCouponDialog=ngDialog.open({template:"/partials/coupon/bookedCoupon.html",className:"ngdialog-custom",name:"bookedCouponDialog",id:"BookedCouponDialog",data:{couponCode:c.BookedCouponCode,couponData:w.parseCouponBookedData(w.couponData)},showClose:!0,closeByDocument:!1,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1})):n.showErrorMessage(locale.sports.coupon.combinationSet.bookedCouponError,w.showCouponMessage)},this.parseCouponBookedData=function(a){var b={couponDate:moment().format("D MMM YYYY HH:mm"),couponTypeId:a.CouponTypeId,couponType:a.CouponType,couponMinWin:w.generateAmount(a.MinWin,!1,2),couponNetStakeMinWin:w.generateAmount(a.NetStakeMinWin,!1,2),couponMaxWin:w.generateAmount(a.MaxWin,!1,2),couponNetStakeMaxWin:w.generateAmount(a.NetStakeMaxWin,!1,2),couponMinOdd:h("number")(a.MinOdd,2),couponMaxOdd:h("number")(a.MaxOdd,2),couponOdds:[]};return angular.forEach(a.Odds,function(a){var c={smartCode:a.SmartCode,matchName:a.MatchName,matchDate:moment(a.EventDate).format("DD/MM/YYYY | HH:mm"),livePrematch:"L"==a.eventCategory?locale.sports.coupon.combinationSet.couponBookedLive:locale.sports.coupon.combinationSet.couponBookedPrematch,marketName:a.MarketName,selectionName:a.SelectionName};b.couponOdds.push(c)}),b},a.openLoginDialog=function(){b.bookedCouponDialog.close(),ngDialog.open({template:"/partials/login/loginDialog.html",className:"loginForm",name:"LoginDialog",id:"LoginDialog",controller:"AuthController",controllerAs:"authCtrl"})},a.goToRegister=function(){globalSettings.Header_EnableRegisterButton&&n.goToUmbracoPage("register")},a.copyToClipboard=function(a){var b=$(a.currentTarget),c=$("<input>");$("body").append(c),c.val(b.text().trim()).select(),document.execCommand("copy"),c.remove()},this.loadBookedCouponWithKeyboard=function(a){a.which=a.which||a.keyCode,13==a.which&&w.loadBookedCoupon()},this.loadBookedCoupon=function(b){b&&(w.bookedCouponCode=b),w.bookedCouponCode.length&&(w.bookedCouponCode.length>6&&!w.bookedCouponCode.match(/[PP-]{3}/)||(w.bookingCodeSection=!0,w.bookConfirmSection=!1,w.bookConfirmData=[],a.showLoader(),p.randomizeCouponLocalId(),w.bookedCouponCode.match(/[PP-]{3}/)&&l.coupon.getPokerpoolBookedCoupon(w.bookedCouponCode,globalSettings.CurrentLanguage).then(function(b){return a.hideLoader(),b.success&&null!=b.data.BookedCoupon?void w.loadSavedCoupon(b.data.BookedCoupon):void o.logError("Unable to load booked coupon: "+JSON.stringify(b.error))}),w.bookedCouponCode.length<=6&&l.coupon.getBookedCoupon(w.bookedCouponCode,globalSettings.CurrentLanguage).then(function(b){a.hideLoader();var c=!1;return b.success?(1==b.data.ResponseStatus&&null!=b.data.BookedCoupon?(w.loadSavedCoupon(b.data.BookedCoupon),c=!0):404==b.data.ResponseStatus?null!=b.data.BookedCoupon&&(w.bookingCodeSection=!1,w.bookConfirmSection=!0,w.bookConfirmData=b.data,c=!0):405==b.data.ResponseStatus?(n.showErrorMessage(locale.sports.coupon.errorOddResult[b.data.ResponseStatus],w.showCouponMessage),w.bookedCouponCode=""):b.BookedCoupon||(n.showErrorMessage(locale.sports.coupon.invalidBookingCode,w.showCouponMessage),w.bookedCouponCode=""),void(c&&B(w.bookedCouponCode))):void o.logError("Unable to load booked coupon: "+JSON.stringify(b.error))})))},this.loadBestSellerCoupon=function(b){null!=b&&(a.showLoader(),p.randomizeCouponLocalId(),l.coupon.getBestSellerById(b).then(function(b){return a.hideLoader(),b.success&&null!=b.data.BestSellerCoupon?void w.loadSavedCoupon(b.data.BestSellerCoupon):void o.logError("Unable to load best seller by id: "+JSON.stringify(b.error))}))},this.loadSavedCoupon=function(a){w.couponSuccess=!1,w.couponBookedSuccess=!1,w.bookingCodeSection=!0,w.bookConfirmSection=!1,w.bookConfirmData=[],0!=a.Odds.length&&(w.confirmedCoupon=!1),p.loadSavedCoupon(a)},this.addRemoveToCoupon=function(a,b,c){a.stopPropagation(),null==c&&(c=!1);var e=$(a.currentTarget),f=e.attr("id").replace("menu_","").replace("favMenu_","").replace("lastMinMenu_","").replace("matchDayMenu_","").replace("upcomingMenu_","").replace("close_",""),g=e.attr("data-isLive"),h=g||null===b||void 0===b?e.attr("data-matchid"):void 0;w.isCurrentLive=!1,null!=g&&"true"==g&&(w.isCurrentLive=!0);var i="POST",j=w.selectionIds;if(null!=j){var k=j.split(",").filter(function(a){return a==f})[0];if(void 0!=k){if(1===j.split(",").length)return void w.clearBet_Clicked();i="DELETE"}}if("POST"==i&&null!=b){var l=[];if(null!=p.providerEventIds)switch(b.eventCategory){case"F":l=p.providerEventIds.live;break;case"L":l=p.providerEventIds.prematch}if(_.find(l,function(a){return a==b.matchProviderId}))return void n.showErrorMessage(locale.sports.coupon.errorOddResult[11],w.showCouponMessage)}void 0==b&&(b={oddId:f,matchId:h}),w.updateCoupon(b,i,null,null,null,null,null,c),d.absUrl().indexOf("/knockout-stage")!=-1&&(window.location.href="/sports/s/knockout-stage")},this.updateCoupon=function(b,d,e,f,h,i,j,k,l){var m=c.defer();void 0==l&&(l=w.isCurrentLive);var o=null==w.couponData||w.couponData=={}||""==w.couponData;return p.updateCoupon(b,d,e,f,h,i,j,k,l).then(function(b){if(w.showCouponLoader=!1,!b.success)return void m.resolve();if(b.serverSide){if(!b.apiResponse.success)return void m.resolve();w.couponSuccess=!1,w.couponBookedSuccess=!1,w.bookingCodeSection=!0,w.bookConfirmSection=!1,w.bookConfirmData=[];var c=b.apiResponse.data,d=c.ResponseStatus;switch(d){case 0:case 24:null==i?w.confirmedCoupon=!1:i||(w.confirmedCoupon=!0);break;case 18:if(c.ExpiredEvents&&c.ExpiredEvents.length>0){var e={availableEventCount:c.AvailableEventCount,originalEventCount:c.OriginalEventCount,expiredEvents:[]};c.ExpiredEvents.forEach(function(a){var b={eventId:a.IDEvent,smartBetCode:a.SmartCode,eventName:a.EventName,eventDate:a.EventDate,eventCategory:a.EventCategory,marketName:a.MarketName,selectionName:a.SelectionName,oddValue:a.OddValue,unboostedOddValue:a.UnboostedOddValue};e.expiredEvents.push(b)}),p.updateExpiredEvents(e);var f,h=e.originalEventCount-e.availableEventCount;1===h?f=locale.sports.coupon.couponOdds.oneExpiredMessage:h>1&&(f=locale.sports.coupon.couponOdds.numOfExpiredMessage.replace("{0}",h)),n.showErrorMessage(f,w.showCouponMessage)}w.confirmedCoupon=!1;break;default:w.confirmedCoupon=!1,n.showErrorMessage(locale.sports.coupon.errorOddResult[d],w.showCouponMessage)}w.confirmedCoupon&&null!=w.couponData&&""!=w.couponData&&0!=w.couponData.Odds.length&&w.showCouponConfirmationDialog()}else{var b=b.apiResponse;b.ResponseStatus!=Sportsbook.ResponseStatus.Success&&n.showErrorMessage(locale.sports.coupon.errorOddResult[b.ResponseStatus],w.showCouponMessage),w.couponSuccess=!1,w.couponBookedSuccess=!1,0!=b.BetCoupon.Odds.length&&(null==i?w.confirmedCoupon=!1:i||(w.confirmedCoupon=!0)),w.confirmedCoupon&&null!=w.couponData&&""!=w.couponData&&0!=w.couponData.Odds.length&&w.showCouponConfirmationDialog()}g(function(){$(".scrollCouponContent").mCustomScrollbar("scrollTo","100%"),o&&a.$broadcast("stickyCouponOnFirstBetPlaced")}),m.resolve()}),m.promise},this.bankerClicked=function(a){var b=a.DataBanker,a={oddId:a.SelectionId},c=!1;"S"==b&&(c=!0),w.updateCoupon(a,"PUT",null,null,null,null,c)};var x,y;this.updateStakeValue=function(a){if(a){var b=$(a.currentTarget).val();if(b==w.couponData.StakeGrossValue)return}g.cancel(x);var c=(w.couponData.BetCouponGlobalVariable.MinBetStake,w.couponData.BetCouponGlobalVariable.MaxBetStake),d=w.couponData.StakeGrossValue.toString(),e=/^[0-9.,]+$/;if(0==e.test(d))return void(w.couponData.StakeGrossValue=d.substring(0,d.length-1));var f=!1;d.indexOf(".")==-1?"0"!=d&&(f=!0):f=!0,f&&(parseFloat(d)>parseFloat(c)&&(d=c),""!=d&&w.updateCoupon(null,"PUT",d))},this.stakeValueKeyUp=function(a){var b=0;return z=null,a.which=a.which||a.keyCode,13==a.which?(a.currentTarget.blur(),void w.placeBet_Clicked()):(globalSettings.UseServerSideCoupon&&(b=1e3),g.cancel(x),void(x=g(function(){w.updateStakeValue()}.bind(this),b)))},this.groupingCheckboxClicked=function(a){var b=_.find(w.couponData.AllGroupings,function(a){return a.IsChecked});if(null==b)return void(a.IsChecked=!0);var c=a.Grouping+","+a.Combinations+","+a.IsChecked;w.updateCoupon(null,"PUT",null,c)};var z=null;this.groupingStakeKeyUp=function(a){g.cancel(y),y=g(function(){var b=(w.couponData.BetCouponGlobalVariable.MinGroupingsBetStake,w.couponData.BetCouponGlobalVariable.MaxGroupingsBetStake),c=a.Grouping,d=a.Combinations,e=c+","+d;z=c;var f=a.ShowStake,g=(f.substring(f.length-1,f.length),/^[0-9.,]+$/);if(0==g.test(f))return void(a.ShowStake=f.substring(0,f.length-1));var h=!1;f.indexOf(".")==-1?"0"!=f&&(h=!0):h=!0,h&&(parseFloat(f)>parseFloat(b)&&(f=b),""!=f&&w.updateCoupon(null,"PUT",null,e,f))}.bind(this),1e3)},this.updateCouponSettings_Clicked=function(a){D(a)},this.getSavedCoupon_Clicked=function(a){var b=$(a.currentTarget),c=b.attr("data-id"),d=p.getSavedCouponByIndex(c.toString());w.couponSuccess=!1,w.couponBookedSuccess=!1,w.bookingCodeSection=!0,w.bookConfirmSection=!1,w.bookConfirmData=[],p.loadSavedCoupon(d),p.randomizeCouponLocalId()},this.clearBet_Clicked=function(){w.couponSuccess=!1,w.couponBookedSuccess=!1,w.bookingCodeSection=!0,w.bookConfirmSection=!1,w.bookConfirmData=[],w.confirmedCoupon=!1,B(null),p.clearCoupon(),p.updateSelectionIds(null),p.updateProviderEventIds(null),d.absUrl().indexOf("/knockout-stage")!=-1&&(window.location.href="/sports/s/knockout-stage")},this.backBet_Clicked=function(){w.confirmedCoupon=!1,w.updateCoupon(null,"PUT")},this.placeBet_Clicked=function(){j.hasValidLogin()?(w.showCouponLoader=!0,w.updateCoupon(null,"PUT",null,null,null,!1,null,!0)):(w.updateCoupon(null,"PUT"),n.showErrorMessage(locale.sports.coupon.combinationSet.notLoggedIn,w.showCouponMessage))},a.printBookedBet_Clicked=function(a,b){return window.open("/coupon-booked-print?couponCode="+a+"&couponDate="+b,"_blank","height=350,width=260,scrollbars=yes,status=no,toolbar=no,menubar=no,location=no"),!1};void 0!=document.getElementsByTagName("body")[0].innerText;this.confirmBet_Clicked=function(){var a=!0,b=!1,c=!1,d=p.getCouponSettings();if(null!=d){var e=d.split(",");a=e[0],b=e[1],c=e[2],inBehalfOf=e[3],bookedCouponCode=e.length>4?e[4]:void 0}document.getElementById("couponContent").style.display="none",w.couponWaiting=!0,w.postCoupon(a,b,c,inBehalfOf,bookedCouponCode)},this.postCoupon=function(b,c,e,f,h){w.lastCouponCode=null,w.lastUserId=null,w.lastCouponInRiserva=!1,this.showPrintBtn=null!=j.getUserData()&&j.getUserData().isAgent,p.postCoupon(b,c,e,f,h).then(function(f){if(f.success){if(document.getElementById("couponContent").style.display="block",w.couponSuccess=!1,w.couponBookedSuccess=!1,w.bookingCodeSection=!0,w.bookConfirmSection=!1,w.bookConfirmData=[],w.confirmedCoupon=!1,w.couponWaiting=!1,w.IsPokerPool=w.couponData.IsPokerPool,!f.apiResponse.success)return n.showErrorMessage(locale.sports.coupon.verifyCoupon.errorCheckRecentCoupon),void a.$broadcast("getOpenBets");var h=f.apiResponse.data,i=h.ResponseStatus;if(1==i){globalSettings.Tracking_EnableDataLayer&&n.setValueToDataLayer("betPlaced",h.UpdatedBetCoupon.Stake),n.createDataLayerEvent({event:"user-place-bet",userId:h.UpdatedBetCoupon.UserId,couponID:h.CouponCode,totalStake:h.UpdatedBetCoupon.StakeGross});var j=null!=h.UpdatedBetCoupon&&0!=h.UpdatedBetCoupon.CurrentEvalReason;if(j){var k=h.UpdatedBetCoupon;k.CouponId=h.CouponId,k.CouponCode=h.CouponCode,q.addToEvaluation(k),q.runEvaluation()}if(w.couponSuccess=!0,w.couponSavedData=p.getSavedCoupons(j),w.lastCouponCode=h.CouponCode,w.lastUserId=h.UserId,j)w.lastCouponInRiserva=!0,n.showInfoMessage(locale.sports.coupon.combinationSet.couponReserva,w.showCouponMessage);else{var l=h.CouponCode;null!=r&&(l=l+","+r),w.isClickEnabled=!0,n.showSuccessMessage(w.getStatus(i),w.showCouponMessage),a.$broadcast("getOpenBets"),g(function(){d.absUrl().indexOf("/knockout-stage")!=-1&&(window.location.href="/sports/s/knockout-stage")},2e3)}B(null)}else if(3==i)n.showErrorMessage(w.getStatus(i),w.showCouponMessage);else if(4==i)n.showErrorMessage(w.getStatus(i),w.showCouponMessage);else if(69==i){var m=globalSettings.CouponLiveDelayDefault,o=w.couponData;null!=o&&0!=o.LiveDelay&&(m=o.LiveDelay),document.getElementById("couponContent").style.display="none",w.couponWaiting=!0;var r=null,s=p.getCouponSettings();if(null!=s&&""!=s){var t=s.split(",");null!=t&&null!=t[3]&&0!=t[3]&&(r=t[3])}g(function(){w.postCoupon(b,c,e,r)}.bind(this),m)}else n.showErrorMessage(w.getStatus(i),w.showCouponMessage)}})},this.handlePrintClick=function(){null==w.lastCouponCode||w.isPrinted||(w.isPrinted=!0,g(function(){w.isPrinted=!1}.bind(this),4e3),p.printCoupon(w.lastCouponCode,w.lastUserId,b.isPokerShares))},this.bookBet_Clicked=function(){w.bookCoupon()},this.getStatus=function(a){return locale.sports.coupon.statusCode[a]||locale.sports.coupon.statusCode[0]+" ("+a+")"};var A=null;this.quickbetInit=function(){s(void 0)},this.onQuickBetCodeKeyUp=function(a){if(0!=w.quickBetCode.trim().length){isNaN(w.quickBetCode)&&(w.quickBetCode=w.quickBetCode.slice(0,-1));var b=_.filter(w.activeSmartBetCodes,function(a){return _.startsWith(a,w.quickBetCode)}),c=!1;null!=b&&1==b.length&&(c=!0);var d=a.which||a.keyCode;a.shiftKey&&9==d||16==d||8==d||(c||9==d||13==d||109==d||189==d)&&w.showMatchOdds(w.quickBetCode)}},this.quickBetAddItem=function(a){var b=$(a.currentTarget),c=b.val();if(a.which=a.which||a.keyCode,9==a.which||13==a.which){var d="L"==w.quickBetData.EventCategory;if(w.quickBetData.SelectedMarkets=[],angular.forEach(w.quickBetData.FormatMarkets,function(a){if(a.MatchOddsID==parseInt(c,10))return void w.quickBetData.SelectedMarkets.push(a)}),w.quickBetData.SelectedMarkets.length>0){var e=p.formatCSCSelection(w.quickBetData,w.quickBetData.SelectedMarkets[0]);w.updateCoupon(e,"POST",null,null,null,null,null,!1,d),$("input#txtQuickBetCode").val("").focus(),w.quickBetCode="",s(void 0)}}},this.showMatchOdds=function(a){null!=a&&""!=a?(A=setTimeout(function(){$(".quickBetContent .loadingSearch").show()},201),l.feed.getQuickBet(a,globalSettings.CurrentLanguage).then(function(a){return A&&(clearTimeout(A),A=null),$(".quickBetContent .loadingSearch").hide(),a.success?void("-"!=a.data.EventName?(s(p.formatMarkets(a.data)),$("#quickBetContent #ddlMatchOdds").focus()):s(void 0)):void o.logError("Unable to get quickbet: "+JSON.stringify(a.error))})):s(void 0)},this.activeSmartBetCodes=[],this.smartBetData=void 0,this.getSmartBetCodes=function(){l.feed.getActiveSmartBetCodes().then(function(a){return a.success?void(w.activeSmartBetCodes=a.data):void o.logError("Unable to get active smartbet codes: "+JSON.stringify(a.error))})},this.onSmartBetCodeKeyUp=function(a){if(0!=w.smartBetCode.trim().length){isNaN(w.smartBetCode)&&(w.smartBetCode=w.smartBetCode.slice(0,-1));var b=_.filter(w.activeSmartBetCodes,function(a){return _.startsWith(a,w.smartBetCode)}),c=!1;null!=b&&1==b.length&&(c=!0);var d=a.which||a.keyCode;a.shiftKey&&9==d||16==d||8==d?8==d&&t(void 0):(c||9==d||13==d||109==d||189==d)&&w.showMatchOddsSmartBet(w.smartBetCode)}},this.smartBetAddItem=function(a){var b=$(a.currentTarget),c=b.val();if(a.which=a.which||a.keyCode,""==c&&8==a.which)return void g(function(){$("input#txtSmartBetCode").focus()},10);if(""!=c&&(9==a.which||13==a.which)){var d=c.split(","),e="",f="";w.smartBetData.SelectedMarkets=[];for(var h=0;h<d.length;h+=1){var i=d[h];if(j.hasValidLogin()&&i.indexOf("-")!=-1){var k=i.split("-");shortcut=k[0].split("+")[0],e=k[1].split("+")[0]}else shortcut=i.split("-")[0];if(i.indexOf("+")!=-1){var k=i.split("+");shortcut=k[0].split("-")[0],f=k[1].split("-")[0]}angular.forEach(w.smartBetData.FormatMarkets,function(a){if(a.SmartCode.toLowerCase()==shortcut.toLowerCase())return void w.smartBetData.SelectedMarkets.push(a)})}if(w.smartBetData.SelectedMarkets.length>0){var l="L"==w.smartBetData.EventCategory,m=0;angular.forEach(w.smartBetData.SelectedMarkets,function(a){var b=p.formatCSCSelection(w.smartBetData,a);w.updateCoupon(b,"POST",null,null,null,null,null,!1,l).then(function(){g(function(){0===m&&(m++,""!=e&&angular.forEach(w.users,function(a){if(a.UserId==e)return C(e),void(w.agentUserId=e)}),""!==f&&w.setAmount(parseInt(f)))},0)})})}else $("span#smartCodeInvalid").css("display","block");w.smartBetCode="",g(function(){$("input#txtSmartBetCode").focus()},10),$("input#txtSmartBetCode").val(""),$("input#txtSmartCode").val("").prop("disabled",!0),$("span#smartCodeEventName").text("")}},this.showMatchOddsSmartBet=function(a){null!=a&&""!=a&&(A=setTimeout(function(){$(".smartBetContent .loadingSearch").show()},201),w.smartBetCode=a,l.feed.getQuickBet(a,globalSettings.CurrentLanguage).then(function(a){return A&&(clearTimeout(A),A=null),$(".smartBetContent .loadingSearch").hide(),a.success?void("-"!=a.data.EventName&&($("span#smartCodeInvalid").css("display","none"),a.data.SmartBetCode=w.smartBetCode,t(p.formatMarkets(a.data)),setTimeout(function(){$("#txtSmartCode").focus()},10))):void o.logError("Unable to get smartbet: "+JSON.stringify(a.error))}))},this.showCouponMessage=function(a,b,c){switch(a){case"success":color="green",icon="fa-check";break;case"error":color="red",icon="fa-exclamation-triangle";break;default:color="blue",icon="fa-exclamation-circle"}null==c&&(c=5e3),$.sticky(b,{speed:"fast",duplicates:!1,autoclose:c,color:color,messageIcon:icon,closeButtonHtml:'<span class="sticky-close" title="Close">&#215;</span>'})},this.showRiservaMessage=function(a,b){$.sticky(b,{speed:"fast",duplicates:!1,autoclose:!1,color:"blue",showCloseButton:!1})},this.sortCouponOdds=function(){sortCouponOdds(w.couponData)},this.oddValueChanged=function(a){var b=_.find(w.oddChanges,function(b){return b.oddId==a});return null!=b&&b.initialOddValue!=b.latestOddValue},this.couponContainsOddChanges=function(){return!_.every(w.oddChanges,function(a){return a.initialOddValue==a.latestOddValue})},this.getInitialOddValue=function(a){var b=_.find(w.oddChanges,function(b){return b.oddId==a});if(null!=b)return b.initialOddValue},this.getOddChangedClasses=function(a){var b=_.find(w.oddChanges,function(b){return b.oddId==a});return null==b||b.initialOddValue==b.latestOddValue?"":b.latestOddValue>b.initialOddValue?["valueChanged","valueIncreased","flashSuccess"]:["valueChanged","valueDecreased","flashDanger"]},this.acceptOddChanges=function(){p.acceptOddChanges()},this.allowOddChangesEnabled=function(){var a=p.getCouponSettings();if(null==a)return!1;var b=a.split(",");return!(b.length<=0)&&"true"==b[0]},this.toggleCouponTools=function(){w.showCouponTools=!w.showCouponTools},this.verifyCouponChange=function(){w.couponCodeCheck=w.couponCodeCheck.replace(/\s/g,"")},this.verifyCouponKeyUp=function(a){var b=a.which||a.keyCode;9!=b&&13!=b||w.verifyCoupon(w.couponCodeCheck)},this.verifyCoupon=function(a){var b=a||$("#txtCouponCheck").val();if(!(null==b||b.trim().length<=0)){var c="/coupon-details-iframe/?couponCode="+b;l.coupon.getCouponByCodeNoCheck(b,globalSettings.CurrentLanguage).then(function(a){return a.success&&null!=a.data&&0!=a.data.CouponId?$.fancybox({modal:!1,showCloseButton:!0,hideOnContentClick:!1,hideOnOverlayClick:!0,width:925,height:533,type:"iframe",padding:0,margin:0,fitToView:!1,autoSize:!1,href:c,afterShow:function(){var a='<div class="fancybox-custom-content panel panel-custom no-brand-footer"> <div class="panel-heading w-icon"> <h3 class="panel-title"> <i class="fa fa-list fa-fw"></i> <span>'+locale.account.betSearch.couponDetailsGeneric.toUpperCase()+"</span> </h3> </div></div>";$(".fancybox-outer").prepend(a)}}):void m.gamingVendors.sportsbook.checkCouponRefundStatus(b).then(function(a){return a.success?a.data.IsRefunded?n.showInfoMessage(locale.sports.coupon.verifyCoupon.couponRefunded).done():n.showInfoMessage(locale.sports.coupon.verifyCoupon.couponInReview).done():n.showErrorMessage(locale.sports.coupon.verifyCoupon.couponNotFound).done()})})}},b.$on("selectExistingOdds",function(a){var b=w.selectionIds,c=[];if(null!=b){c=b.split(",");for(var d=0;d<c.length;d++)document.querySelectorAll("[id='"+c[d]+"']").forEach(u),document.querySelectorAll("[id='menu_"+c[d]+"']").forEach(u),document.querySelectorAll("[id='poker_"+c[d]+"']").forEach(u),document.querySelectorAll("[id='favMenu_"+c[d]+"']").forEach(u),document.querySelectorAll("[id='lastMinMenu_"+c[d]+"']").forEach(u),document.querySelectorAll("[id='upcomingMenu_"+c[d]+"']").forEach(u),document.querySelectorAll("[id='matchDayMenu_"+c[d]+"']").forEach(u),document.querySelectorAll("[class='banMenu_"+c[d]+"']").forEach(u)}}),b.$on("addRemoveToCoupon",function(a,b,c,d){w.addRemoveToCoupon(b,c,d)}),b.$on("clearCoupon",function(){w.clearBet_Clicked()}),b.$on("onRepeatLast",function(a,b,c){if("groupingsList"==c.onLastRepeat){if(null==z)return;var d=$(".groupings-container input#txtGroupingStake_"+z);null!=d&&(d.focus(),d.length>0&&d[0].setSelectionRange(d.val().length,d.val().length))}}),b.$on("couponService:couponDataChanged",function(a,b){if(w.couponData=_.cloneDeep(b),w.expiredEvents=_.cloneDeep(p.getExpiredEvents()),null!=b&&""!=b&&b.Odds.length>0){if(w.couponEmpty=!1,w.sortCouponOdds(),1==b.CouponTypeId||null==b.AllGroupings)return;var c=b.AllGroupings[b.AllGroupings.length-1];1==b.Groupings.length&&c.IsChecked?1==c.Combinations?w.groupingsTabSelected="multiple":w.groupingsTabSelected="split":w.groupingsTabSelected="combination"}else w.setAmountFirstTime=!0,w.couponEmpty=!0,w.couponEmptyData=p.getSavedCoupons()}),b.$on("couponService:oddValuesChanged",function(a,b){w.oddChanges=_.cloneDeep(b),w.allowOddChangesEnabled()&&w.acceptOddChanges()}),b.$on("couponService:selectionIdsChanged",function(a,b){if(null!=w.selectionIds)for(var c=w.selectionIds.split(","),d=0;d<c.length;d++)document.querySelectorAll("[id='"+c[d]+"']").forEach(v),document.querySelectorAll("[id='menu_"+c[d]+"']").forEach(v),document.querySelectorAll("[id='poker_"+c[d]+"']").forEach(v),document.querySelectorAll("[id='favMenu_"+c[d]+"']").forEach(v),document.querySelectorAll("[id='lastMinMenu_"+c[d]+"']").forEach(v),document.querySelectorAll("[id='upcomingMenu_"+c[d]+"']").forEach(v),document.querySelectorAll("[id='matchDayMenu_"+c[d]+"']").forEach(v),document.querySelectorAll("[class='banMenu_"+c[d]+"']").forEach(v);if(null!=b)for(var e=b.split(","),d=0;d<e.length;d++)document.querySelectorAll("[id='"+e[d]+"']").forEach(u),document.querySelectorAll("[id='menu_"+e[d]+"']").forEach(u),document.querySelectorAll("[id='poker_"+e[d]+"']").forEach(u),document.querySelectorAll("[id='favMenu_"+e[d]+"']").forEach(u),document.querySelectorAll("[id='lastMinMenu_"+e[d]+"']").forEach(u),document.querySelectorAll("[id='upcomingMenu_"+e[d]+"']").forEach(u),document.querySelectorAll("[id='matchDayMenu_"+e[d]+"']").forEach(u),document.querySelectorAll("[class='banMenu_"+e[d]+"']").forEach(u);w.selectionIds=b}),b.$on("evaluationService:couponAccepted",function(b,c){a.$broadcast("getOpenBets")}),b.$on("cashDeskController:couponBooked",function(a,b){w.handleBookCouponResponse(b)}),null!=f.showCouponTools?this.showCouponTools=f.showCouponTools:(this.showCouponTools=globalSettings.Sports_CouponToolsExpanded,f.showCouponTools=globalSettings.Sports_CouponToolsExpanded),this.togglePanel=function(a){var b=!f[a];b?(w[a]=!0,f[a]=!0):(w[a]=!1,f[a]=!1)},b.$watch(function(){return j.hasValidLogin()},function(a,b){if(a){var c=p.getCouponSettings(),d=null;if(null!=c){var e=c.split(",");null!=e[3]&&(d=e[3])}w.updateCouponSettings_Clicked(d),w.getUsersForAgent(j.getUserData().userID)}w.updateCoupon(null,"PUT")}),b.$watch(function(){return i.current},function(a,b){var c=r.siteSections;w.showButtons=!1,null!=a&&null!=a.data&&(a.data.siteSection!=c.sports&&a.data.siteSection!=c.live&&a.data.siteSection!=c.pokershares||(w.showButtons=!0))}),b.$watch(function(){return w.allowOddChangesEnabled()},function(a,b){a&&w.acceptOddChanges()}),b.$watch(function(){return w.groupingsTabSelected},function(a,b){if(a!=b){var c=[];if(_.forEach(w.couponData.AllGroupings,function(a){a.IsChecked&&(a.IsChecked=!1,c.push(a.Grouping+","+a.Combinations+","+a.IsChecked))}),"multiple"==a||"split"==a){var d=w.couponData.AllGroupings[w.couponData.AllGroupings.length-1];d.IsChecked=!0,c.push(d.Grouping+","+d.Combinations+","+d.IsChecked)}else if("combination"==a){var e=w.couponData.AllGroupings[w.couponData.AllGroupings.length-2];e.IsChecked=!0,c.push(e.Grouping+","+e.Combinations+","+e.IsChecked)}if("combination"!==a){var g=[];_.forEach(w.couponData.Odds,function(a){a.Banker="No",a.Fixed=!1,g.push(a)}),w.couponData.Odds=g,f.couponData=w.couponData}c.length>0&&w.updateCoupon(null,"PUT",null,c)}});var B=(function(){w.sortCouponOdds(),w.couponToolsCurrentOpenTab=globalSettings.Sports_CouponToolsTabOrdering.split(",")[0].toLowerCase();var a=n.getUrlParameters(window.location.search);a["booking-code"]&&w.loadBookedCoupon(a["booking-code"])}(),function(a){var b=p.getCouponSettings();if(b){for(var c=b.split(","),d="",e=0;e<c.length;e++)d+=4===e?a?a:",":c[e]+",";p.updateCouponSettings(","===d.slice(-1)?d.substring(0,d.length-1):d)}else D(void 0,a)}),C=function(a){var b=p.getCouponSettings();if(null!=b){for(var c=b.split(","),d="",e=0;e<c.length;e++)d+=3===e?a+",":c[e]+",";p.updateCouponSettings(","===d.slice(-1)?d.substring(0,d.length-1):d)}},D=function(a,b){var c,d=null!=f.couponSettings?f.couponSettings.split(","):null;c=$("#chkModifyOdds").length>0?$("#chkModifyOdds").is(":checked"):null==d||d[0];var e;e=$("#chkStakeReduction").length>0?$("#chkStakeReduction").is(":checked"):null!=d&&d[1];var g;g=$("#chkAllowTransfer").length>0?$("#chkAllowTransfer").is(":checked"):null!=d&&d[2];var h=$("#ddlAgentUser").val();null!=h&&$.isNumeric(h)&&0!=h.toString().trim().length||(h=j.hasValidLogin()?a||j.getUserData().userID:"");var i;i=b?b:null!=d?d[4]:"",p.updateCouponSettings(c+","+e+","+g+","+h+","+i)};this.couponToolsOpenTab=function(a){w.couponToolsCurrentOpenTab=a}}])}(),function(){angular.module("coupon.service",[]).factory("couponService",["$rootScope","$q","$localStorage","authService","SportsbookCouponBuilder","sportsApiService","loggingService","helperService","$interval",function(a,b,c,d,e,f,g,h,i){function j(a,b,d,e,f,h,i,j,k){var l=null!=e,m=!1;if(null!=j&&""!=j&&0!=k.Odds.length&&(m=!0),null!=b||m)if(i)w(h,b,j,k,e,f,d).then(function(e){if(e.success)if(c.couponData=E(e.data.BetCoupon),"POST"==d){if(""!=b.oddId)for(var f=b.oddId.toString().split(","),h=0;h<f.length;h+=1){var i=f[h],j=_.find(c.couponData.Odds,function(a){return a.SelectionId==i});j&&T(i,j.OddValue)}}else"DELETE"==d&&U(b.oddId);else g.logError("Unable to update server side coupon: "+JSON.stringify(e.error));a.resolve({success:!0,serverSide:!0,apiResponse:e,stakeUpdated:l})});else{var n=x(b,j,k,e,f,d);if(n.ResponseStatus!=Sportsbook.ResponseStatus.Success)g.logError("Unable to update client side coupon: "+locale.sports.coupon.errorOddResult[n.ResponseStatus]);else if(c.couponData=E(n.BetCoupon),"POST"==d){var o=_.find(c.couponData.Odds,function(a){return a.SelectionId==b.oddId});T(b.oddId,o.OddValue)}else"DELETE"==d&&U(b.oddId);a.resolve({success:!0,serverSide:!1,apiResponse:n,stakeUpdated:l})}else D(),a.resolve({success:!1,stakeUpdated:l})}var k=this;this.oddChangesInterval;var l="savedBetCoupon",m=globalSettings.Sports_AllowMultipleOddSelectionPerMatch;
null!=c.couponData&&(c.couponData.IsClientSideCoupon=!globalSettings.UseServerSideCoupon);var n=function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))},o=function(a){c.couponSettings=a},p=function(a){c.expiredEvents=a},q=function(a){c.expiredEvents=null},r=function(a){c.selectionIds=a},s=function(a){c.providerEventIds=a},t=function(){c.couponLocalId=(new Date).getTime().toString().substring(3)+""+Math.floor(100*Math.random()+1)},u=function(a,d,e,f,g,h,i,k,l){var m=b.defer(),n=_.cloneDeep(c.couponData),o=null==n||n=={}||""==n;null==f||Array.isArray(f)||(f=[f]);var p=globalSettings.UseServerSideCoupon;if((l||1==k)&&(p=!0),o||"POST"!==d)j(m,a,d,e,f,l,p,n,v(a,e,f,g,i));else{var q=X(a.matchId);q?this.updateCoupon(p?{matchId:a.matchId,oddId:q.SelectionId}:{categoryId:q.EventId,categoryName:q.EventName,compatibleMarkets:q.CompatibleMarkets,eventCategory:q.EventCategory,groupNo:q.IDGroup,incompatibleEvents:q.IncompatibleEvents,marketId:q.MarketId,marketName:q.MarketName,marketTypeId:q.MarketTypeId,matchDate:q.EventDate,matchId:q.MatchId,matchName:q.MatchName,matchProviderId:q.ProviderEventId,oddId:q.SelectionId,oddValue:q.OddValue,selectionName:q.SelectionName,selectionTypeId:q.IDSelectionType,smartBetCode:q.SmartCode,sportId:q.IDSport,sportName:q.SportName,tournamentId:q.TournamentId,tournamentName:q.TournamentName},"DELETE",null,null,null,null,null,k,l).then(function(b){j(m,a,d,e,f,l,p,b.apiResponse.BetCoupon?b.apiResponse.BetCoupon:b.apiResponse.data.BetCoupon,v(a,e?e:n.StakeGross,f,g,i))}):j(m,a,d,e,f,l,p,n,v(a,e,f,g,i))}return m.promise},v=function(a,b,d,e,f){var g=_.cloneDeep(c.couponData);if(null!=b&&(g.UseGroupsStake=!1,g.StakeGross=J(b)),null!=d&&void 0!==d&&d.length>0)if(null==e)g.UseGroupsStake=!1,_.forEach(d,function(a){var b=a.split(","),c=b[0],d=b[1],e=b[2];if("true"==e){var f=g.AllGroupings.filter(function(a){return a.Grouping==c&&a.Combinations==d})[0];g.Groupings[g.Groupings.length]=f}else for(var h=g.Groupings.filter(function(a){return a.Grouping==c&&a.Combinations==d})[0],i=0;i<g.Groupings.length;i++)if(g.Groupings[i].Grouping==h.Grouping&&g.Groupings[i].Combinations==h.Combinations){g.Groupings.splice(i,1);break}});else{g.UseGroupsStake=!0;var h=d[0].split(","),i=h[0],j=h[1],k=g.Groupings.filter(function(a){return a.Grouping==i&&a.Combinations==j})[0];if(void 0==k){var l=g.PossibleMissingGroupings.filter(function(a){return a.Grouping==i&&a.Combinations==j})[0];l.Stake=parseFloat(J(e)),g.Groupings[g.Groupings.length]=l}else for(var m=0;m<g.Groupings.length;m++)if(g.Groupings[m].Grouping==k.Grouping&&g.Groupings[m].Combinations==k.Combinations){g.Groupings[m].Stake=parseFloat(J(e));break}}if(null!=f){var n=g.Odds.filter(function(b){return b.SelectionId==a.oddId})[0];n.Fixed=f}return g},w=function(a,b,c,d,e,g,h){var i="BetCoupons";if(a&&(i="LiveCoupons"),null==b&&null!=d&&d.IsPokerPool&&(i="pokerCoupons"),null!=e||null!=g)return f.coupon.updateCoupon(i,d,I());var j=null!=b?b.oddId:null;null==j&&null!=c&&""!=c&&0!=d.Odds.length&&(j=d.Odds[0].SelectionId),j=j.toString().replace("favMenu_",""),j=j.toString().replace("menu_",""),j=j.toString().replace("lastMinMenu_",""),j=j.toString().replace("upcomingMenu_",""),j=j.toString().replace("matchDayMenu_","");for(var k="",l=j.split(","),m=0;m<l.length;m+=1){var n=l[m],o="selectionIds["+m+"]="+n;k=""==k?"?"+o:k+"&"+o}return j.indexOf("poker_")!=-1&&(j=j.toString().replace("poker_",""),i="pokerCoupons"),null==c||""==c?(t(),f.coupon.addSelection(i,globalSettings.CurrentLanguage,k,I())):"put"==h.toLowerCase()?f.coupon.updateCoupon(i,d,I()):"delete"==h.toLowerCase()?f.coupon.removeSelectionFromCoupon(i,globalSettings.CurrentLanguage,j,d,I()):f.coupon.addSelectionToCoupon(i,globalSettings.CurrentLanguage,k,d,I())},x=function(a,b,c,d,f,g){var h=angular.copy(c);return null!=d||null!=f?e.updateCoupon(h):null==b||""==b?(t(),e.addSelection(a,globalSettings.CurrentLanguage)):"put"==g.toLowerCase()?e.updateCoupon(h):"delete"==g.toLowerCase()?e.removeSelection(a,h):e.addSelectionToCoupon(a,h)},y=function(a,b){var c={};return c.categoryId=a.IDCategory,c.categoryName=a.CategoryName,c.eventCategory=a.EventCategory,c.combinability=b.Gameplay,c.marketId=b.MarketID,c.marketTypeId=b.MarketTypeID,c.marketName=b.MarketName,c.matchDate=a.EventDate,c.matchId=a.IDEvent,c.matchName=a.EventName,c.matchProviderId=a.ProviderIDEvent,c.smartBetCode=a.SmartBetCode,c.oddId=b.MatchOddsID,c.oddValue=b.OddValue,c.unboostedOddValue=b.UnboostedOddValue,c.selectionTypeId=b.SelectionId,c.selectionName=b.SelectionName,c.sportId=a.IDSport,c.sportName=a.SportName,c.spreadValue=b.SpreadValue,c.specialValue=b.SpreadValue,c.tournamentId=a.IDTournament,c.tournamentName=a.TournamentName,c.incompatibleEvents=a.IncompatibleEvents,c},z=function(a){return a.FormatMarkets=[],angular.forEach(a.Markets,function(b){angular.forEach(b.Markets,function(c){var d=[];d.MatchOddsID=c.MatchOddsID,d.SmartCode=c.Shortcut,d.MarketID=b.OddsID,d.MarketName=b.OddsType.OddsTypeName,d.MarketTypeID=b.OddsType.OddsTypeID,d.OddValue=c.OddOutcome,d.UnboostedOddValue=c.UnboostedOddValue,d.SelectionId=c.OddAttribute.OddTypeID,d.SelectionName=c.OddAttribute.OddName,d.SpreadValue=b.SpecialBetValue,d.Gameplay=b.GamePlay,d.SmartBetCode=a.SmartBetCode,a.FormatMarkets.push(d)})}),a},A=function(e,h,i,j,k){var m=b.defer(),n=_.cloneDeep(c.couponData);if(null!=n&&""!=n&&0!=n.Odds.length){null==e&&(e=!1),null==h&&(h=!1),null==i&&(i=!1),null!=j&&0!=j.toString().trim().length||(j=d.getUserData().userID);var o=c.couponLocalId+d.getUserData().userID;o.length>20&&(o=o.substring(0,20));var p=null;p="P"===n.Odds[0].EventCategory?null!=n&&n.IsPokerPool?f.coupon.postCouponPokerPool(o,n):f.coupon.postCouponPokerShares(e,h,i,j,o,n):f.coupon.postCoupon(e,h,i,j,o,n,k),p.then(function(b){if(b.success){var d=b.data,e=d.ResponseStatus;if(1==e){a.$broadcast("couponService:couponPosted"),D(),r(null),c.providerEventIds=null;for(var f=!1,h=1;h<=5;h++){var i=c[l+h.toString()];if(null==i){c[l+h.toString()]=n,f=!0;break}}0==f&&(c[l+"1"]=c[l+"2"],c[l+"2"]=c[l+"3"],c[l+"3"]=c[l+"4"],c[l+"4"]=c[l+"5"],c[l+"5"]=n)}else 3!=e&&4!=e&&69!=e||(d.UpdatedBetCoupon.Odds.length>0?c.couponData=E(d.UpdatedBetCoupon):D())}else g.logError("Unable to save coupon: "+JSON.stringify(b.error));m.resolve({success:!0,apiResponse:b})})}else D(),m.resolve({success:!1});return m.promise},B=function(a,d,e){var h=b.defer();return f.coupon.createCoupon(globalSettings.CurrentLanguage,a,d,e).then(function(a){return a.success&&null!=a.data.BetCoupon?(D(),c.couponData=E(a.data.BetCoupon),void h.resolve({success:!0})):(g.logError("Unable to create coupon: "+JSON.stringify(a.error)),void h.resolve({success:!1}))}),h.promise},C=function(){var a=b.defer(),d=_.cloneDeep(c.couponData);if(null!=d&&""!=d&&0!=d.Odds.length){var e=c.couponLocalId;e.length>20&&(e=e.substring(0,20)),f.coupon.bookCoupon(e,d).then(function(b){if(b.success){var d=b.data,e=d.ResponseStatus;if(1==e){r(null),c.providerEventIds=null;for(var f=!1,h=1;h<=5;h++){var i=c[l+h.toString()];if(null==i){c[l+h.toString()]=d.UpdatedBetCoupon,f=!0;break}}0==f&&(c[l+"1"]=c[l+"2"],c[l+"2"]=c[l+"3"],c[l+"3"]=c[l+"4"],c[l+"4"]=c[l+"5"],c[l+"5"]=d.UpdatedBetCoupon),D()}a.resolve({success:!0,apiResponse:b})}else g.logError("Unable to book coupon: "+JSON.stringify(b.error)),a.resolve({success:!1,apiResponse:b})})}else D(),a.resolve({success:!1});return a.promise},D=function(){c.couponData="",q(),V(),r(null)},E=function(a){if(a){var b=new Array,e={prematch:new Array,live:new Array};a.HasLive=!1,a.IsLive=!1;var f=0;angular.forEach(a.Odds,function(c){b[f]=c.SelectionId,f+=1;var d=c.ProviderEventId;"F"==c.EventCategory&&e.prematch.indexOf(d)===-1?e.prematch.push(d):"L"==c.EventCategory&&e.live.indexOf(d)===-1&&e.live.push(d),c.Banker="No",c.DataBanker="S",1==c.Fixed&&(c.Banker="S",c.DataBanker="No"),"L"==c.EventCategory&&(a.HasLive=!0,a.IsLive=!0)}),r(b.toString()),c.providerEventIds=e;var g=a.CouponTypeId;a.CouponType="Unknown",1==g?a.CouponType=locale.sports.coupon.printCoupon.couponTypes.single:2==g?a.CouponType=locale.sports.coupon.printCoupon.couponTypes.multiple:3==g&&(a.CouponType=locale.sports.coupon.printCoupon.couponTypes.system);var h=new Array,i=new Array;angular.forEach(a.PossibleMissingGroupings,function(a){h.push({MinWin:0,MinWinNet:0,NetStakeMinWin:0,MaxWin:0,MaxWinNet:0,NetStakeMaxWin:0,Grouping:a.Grouping,Combinations:a.Combinations,Stake:-1,NetStake:0,IsChecked:!1,ShowStake:""})}),angular.forEach(a.Groupings,function(a){var b={MinWin:a.MinWin,MinWinNet:a.MinWinNet,NetStakeMinWin:a.NetStakeMinWin,MaxWin:a.MaxWin,MaxWinNet:a.MaxWinNet,NetStakeMaxWin:a.NetStakeMaxWin,MinBonus:a.MinBonus,MaxBonus:a.MaxBonus,Grouping:a.Grouping,Combinations:a.Combinations},c=a.Stake.toString().indexOf(".");c>=0?(b.Stake=parseFloat(a.Stake.toString().substring(0,c+3)),b.NetStake=a.NetStake?K(parseFloat(a.NetStake.toString().substring(0,c+3))):void 0):(b.Stake=a.Stake,b.NetStake=a.NetStake?K(a.NetStake):void 0),b.IsChecked=!1,b.ShowStake="",b.Stake!=-1&&(b.IsChecked=!0,b.ShowStake=K(b.Stake)),h.push(b),i.push(b)}),h=_.filter(h,function(a){return a.Combinations!=-1}),h.sort(L("Grouping")),a.AllGroupings=h,i.sort(L("Grouping")),a.ConfirmedGroupings=i,3==g&&0!=a.Groupings.length?a.GroupingsStatus="block":a.GroupingsStatus="none",a.StakeGrossValue=a.StakeGross;var j=a.StakeGrossValue.toString().indexOf(".");if(j>=0&&(a.StakeGrossValue=parseFloat(a.StakeGrossValue.toString().substring(0,j+3))),a.StakeGrossValue=K(a.StakeGrossValue),a.IsModifyOdds=!0,a.IsStakeReduction=!1,a.IsAllowTransfer=!1,a.AgentUser=a.UserId,null!=c.couponSettings){var k=c.couponSettings.split(",");null!=k[0]&&"true"==k[0]?a.IsModifyOdds=!0:a.IsModifyOdds=!1,null!=k[1]&&"true"==k[1]&&(a.IsStakeReduction=!0),null!=k[2]&&"true"==k[2]&&(a.IsAllowTransfer=!0),null!=k[3]&&(a.AgentUser=k[3])}return a.IsLoggedIn=d.hasValidLogin(),a}},F=function(a){var b={};null!=a&&(b.IsInRiserva=a);for(var d=[],e=1;e<=5;e++){var f=c[l+e.toString()];null!=f&&(d[e-1]=e)}return b.SavedCoupons=d,b},G=function(a){return c[l+a]},H=function(a){null!=a&&(c.couponData=E(a))},I=function(){if(null!=c.couponSettings){var a=c.couponSettings.split(",");if(null!=a[3])return null!=a[3]&&a[3].trim().length>0?a[3]:null}return null},J=function(a){return"es"!=globalSettings.CurrentLanguage&&"it"!=globalSettings.CurrentLanguage||(a=a.toString().replace(",",".")),a},K=function(a){return"es"!=globalSettings.CurrentLanguage&&"it"!=globalSettings.CurrentLanguage||(a=a.toString().replace(".",",")),a},L=function(a){var b=1;return"-"===a[0]&&(b=-1,a=a.substr(1)),function(c,d){var e=c[a]<d[a]?-1:c[a]>d[a]?1:0;return e*b}},M=function(a,b,d){if(null!=a&&0!=a.trim().length){if(null==b){var e=c.couponSettings;if(null!=e&&""!=e){var f=e.split(",");null!=f&&null!=f[3]&&0!=f[3]&&(a+=","+f[3])}}else a+=","+b;var g="/coupon-print?couponCode="+a;d&&(g+="&pokerpool="+k.IsPokerPool),globalSettings.Sports_PrintCouponCopy?null==localStorage.couponCopy?k.showCopyConfirmationDialog(g):O(g,localStorage.couponCopy,!1):O(g,!1,!1)}},N=void 0,O=function(a,b,c){c&&localStorage.setItem("couponCopy",b),a+="&hasCopy="+b,globalSettings.Sports_PrintInSameTab?(N&&document.querySelector("body").removeChild(N),N=document.createElement("iframe"),N.setAttribute("src",a),N.style.width="275px",N.style.height="830px",N.style.visibility="hidden",N.style.position="absolute",N.style.top="0px",document.body.appendChild(N)):window.open(a,"_blank","height=830,width=275,scrollbars=yes,status=no,toolbar=no,menubar=no,location=no")},P=function(){if(null==c.couponData||null==c.couponData.Odds)return[];var a=[];return angular.forEach(c.couponData.Odds,function(b){a.push({IsLive:"l"==b.EventCategory.toLowerCase(),MatchId:b.MatchId,MarketId:b.MarketId,SelectionID:b.SelectionId,SelectionValue:b.OddValue})}),a};this.runCouponOddChanges=function(){Q();var b=globalSettings.Sports_OddChangesTimer,d=P();if(null!=d&&d.length>0){var e=_.some(d,function(a){return 1==a.IsLive});b=e?globalSettings.Sports_LiveOddChangesTimer:globalSettings.Sports_OddChangesTimer,f.feed.getOddsChanged(globalSettings.CurrentLanguage,d).then(function(b){return b.success?void(null!=b.data&&0!=b.data.length&&(angular.forEach(b.data,function(a){var b=_.find(c.couponData.Odds,function(b){return b.SelectionId==a.SelectionID});b&&(b.OddValue=a.SelectionValue,b.ConfirmedOddValue=a.SelectionValue),W(a.SelectionID,a.SelectionValue)}),u(null,"PUT",c.couponData.StakeGrossValue).then(function(){a.$broadcast("couponService:oddsChanged",b.data)}))):void g.logError("Unable to get coupon odds changes: "+JSON.stringify(b.error))})}b&&(k.oddChangesInterval=i(k.runCouponOddChanges,b))};var Q=function(){null!=k.oddChangesInterval&&i.cancel(k.oddChangesInterval)};this.runCouponOddChanges();var R=function(){return c.oddChanges||(c.oddChanges=[]),c.oddChanges},S=function(){var a=R();_.forEach(a,function(a){a.initialOddValue=a.latestOddValue,a.valueChanged=!1})},T=function(a,b){var c=R(),d=_.find(c,function(b){return b.oddId==a});d||c.push({oddId:a,initialOddValue:b,latestOddValue:b,valueChanged:!1})},U=function(a){var b=R();_.remove(b,function(b){return b.oddId==a})},V=function(){c.oddChanges=[]},W=function(a,b){var c=R(),d=_.find(c,function(b){return b.oddId==a});null!=d&&(d.latestOddValue=b,d.valueChanged=!0)},X=function(a){if(!m)return"string"==typeof a&&(a=parseInt(a)),c.couponData.Odds.find(function(b){return b.MatchId===a})};return a.$watch(function(){return c.couponData},function(){a.$broadcast("couponService:couponDataChanged",c.couponData)},!0),a.$watch(function(){return c.selectionIds},function(){a.$broadcast("couponService:selectionIdsChanged",c.selectionIds)},!0),a.$watch(function(){return c.oddChanges},function(){a.$broadcast("couponService:oddValuesChanged",c.oddChanges)},!0),a.$watch(function(a){return d.hasValidLogin()},function(a){c.couponData&&(c.couponData.IsLoggedIn=a)}),{getCouponData:function(){return c.couponData},getCouponSettings:function(){return c.couponSettings},getExpiredEvents:function(){return c.expiredEvents},getCouponLocalId:function(){return c.couponLocalId},getSelectionIds:function(){return c.selectionIds},getProviderEventIds:function(){return c.providerEventIds},getOddChanges:R,acceptOddChanges:S,updateCouponSettings:o,updateExpiredEvents:p,clearExpiredEvents:q,updateSelectionIds:r,updateProviderEventIds:s,randomizeCouponLocalId:t,updateCoupon:u,postCoupon:A,createCoupon:B,clearCoupon:D,formatCoupon:E,bookCoupon:C,printCoupon:M,getSavedCoupons:F,getSavedCouponByIndex:G,loadSavedCoupon:H,getParameterByName:n,formatCSCSelection:y,formatMarkets:z}}])}(),function(){angular.module("couponDetailsIFrame",[]).controller("CouponDetailsIFrameController",["$scope","$rootScope","$q","couponService","cashoutService","$localStorage","sportsApiService","platformApiService","authService","loggingService","helperService","$uiRouterGlobals","$filter",function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=this,o=d.getParameterByName("couponCode");if(this.userData=i.getUserData(),this.userLoggedIn=i.hasValidLogin(),this.cashoutRequested=e.isInPendingList(null,o),this.cashoutData=null,this.cashoutInProgress=!1,this.cashoutRefreshInProgress=!1,this.allowCashout=!0,this.allowStyledCashout=!1,null!=globalSettings.Sports_CashOutBlackList&&i.isAgent()){var p=_.map(globalSettings.Sports_CashOutBlackList.split(","),$.trim);_.includes(p,i.getUserData().userType)&&(n.allowCashout=!1,n.allowStyledCashout=!0)}this.dataLoading=!1,this.couponDetails=null,this.eventListData=[],this.parseCouponDetails=function(a){return a.HasMaxWithholdingTax=a.MaxWithholdingTax>0,a.HasMinWithholdingTax=a.MinWithholdingTax>0,a.HasBonus=a.MaxBonus>0,a.HasTurnoverTax=a.TurnoverTax>0,a.StakeTxt=m("number")(a.StakeGross,2),a.StakeNetTxt=m("number")(a.Stake,2),a.TurnoverTaxTxt=m("number")(a.TurnoverTax,2),a.MaxWinGrossTxt=m("number")(a.MaxWin,2),a.NetStakeMaxWinGrossTxt=m("number")(a.NetStakeMaxWin,2),a.MaxPotWinGrossTxt=m("number")(a.NetStakeMaxWin+a.MaxBonus,2),a.MaxBonusTxt=m("number")(a.MaxBonus,2),a.MaxWithholdingTaxTxt=m("number")(a.MaxWithholdingTax,2),a.MaxPotentialNetWinTxt=m("number")(a.MaxWinNet,2),a.TotalOddsTxt=m("number")(a.TotalOdds,2),a.MinWinGrossTxt=m("number")(a.MinWin,2),a.NetStakeMinWinGrossTxt=m("number")(a.NetStakeMinWin,2),a.MinBonusTxt=m("number")(a.MinBonus,2),a.MinWithholdingTaxTxt=m("number")(a.MinWithholdingTax,2),a.MinPotentialWinNetTxt=m("number")(a.MinWinNet,2),a.AllCombinationsTxt=0,a.TotalTaxedTxt=m("number")(a.TotalTaxed,2),a.CombinationGroups=$(a.Groupings).each(function(b,c){c.GroupingTxt=c.Grouping.toString(),c.CombinationsTxt=c.Combinations.toString(),c.StakeTxt=c.CombinationsTxt+" X "+m("number")(c.Stake,2)+" = "+a.StakeTxt,c.MinBonusTxt=m("number")(c.MinBonus,2),c.MaxBonusTxt=m("number")(c.MaxBonus,2),c.MinWinTxt=m("number")(c.MinWin,2),c.NetStakeMinWinTxt=m("number")(c.NetStakeMinWin,2),c.NetStakeMaxWinTxt=m("number")(c.NetStakeMaxWin,2),c.MaxWinTxt=m("number")(c.MaxWin,2)}),a.AllCombinationsTxt=a.AllCombinationsTxt.toString(),a.AllStakeTxt=a.HasTurnoverTax?m("number")(a.StakeGross,2)+" - "+m("number")(a.TurnoverTax,2)+" = "+m("number")(a.Stake,2):a.StakeTxt,a.AllMinWinTxt=a.HasTurnoverTax?m("number")(a.NetStakeMinWin,2)+" - "+m("number")(a.MinWithholdingTax,2)+" = "+m("number")(a.MinWinNet,2):m("number")(a.MinWinNet,2),a.AllMaxWinTxt=a.HasTurnoverTax?m("number")(a.NetStakeMaxWin,2)+" - "+m("number")(a.MaxWithholdingTax,2)+" = "+m("number")(a.MaxWinNet,2):m("number")(a.MaxWinNet,2),null!=a.Won?(a.AllWonTxt=a.TotalTaxed>0?m("currencyFormat")(a.Won,2)+"(Tax: "+a.TotalTaxedTxt+")":m("currencyFormat")(a.Won,2),a.WonTxt=m("number")(a.Won,2)):a.WonTxt=m("number")("0.00",2),null!=a.BetFinalState?a.BetFinalState==-1?a.StatusTxt=locale.account.betSearch.running:0==a.BetFinalState?a.StatusTxt=locale.account.betSearch.systemEvaluation:1==a.BetFinalState?a.StatusTxt=locale.account.betSearch.positive:2==a.BetFinalState?a.StatusTxt=locale.account.betSearch.couponStatus.partialWon:3==a.BetFinalState?a.StatusTxt=locale.account.betSearch.negative:4==a.BetFinalState?a.Won?a.StatusTxt=locale.account.betSearch.couponStatus.voided:a.StatusTxt=locale.account.betSearch.couponStatus.cancelled:5==a.BetFinalState?a.StatusTxt=locale.account.betSearch.couponStatus.cashout:6==a.BetFinalState?a.StatusTxt=locale.account.betSearch.couponStatus.promotion:a.StatusTxt=locale.account.betSearch.unknown:1==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.running:2==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.negative:3==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.positive:4==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.cancelled:5==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.systemEvaluation:6==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.refused:7==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.userEvaluation:8==a.CouponStatusId?a.StatusTxt=locale.account.betSearch.reopened:a.StatusTxt=locale.account.betSearch.unknown,a.RebetEnabled=!1,globalSettings.Sports_EnableRebet&&$(a.Odds).each(function(b,c){if("Unset"==c.Result)return a.RebetEnabled=!0,!1}),a.showPayOrCancelButton=!0,null!=n.userData?(1!=n.agentPayCouponPermission(n.userData.userType)||null==a.Won||parseFloat(a.Won)<=0||3!=a.CouponStatusId&&4!=a.CouponStatusId&&6!=a.CouponStatusId)&&(a.showPayOrCancelButton=!1):a.showPayOrCancelButton=!1,a},this.agentPayCouponPermission=function(a){if(""==globalSettings.AgentPayCouponUserTypes)return!1;var b=globalSettings.AgentPayCouponUserTypes.split(","),c=$.grep(b,function(b){return b==a});return c.length>0},this.parseOdd=function(a){var b=""==a.OnLineCode||null==a.OnLineCode?"--":a.OnLineCode,c=a.IDEvent,d="L"===a.EventCategory?"L":"",e=a.EventDate,f=a.SportName;f+=null!=a.CategoryName?" - "+a.CategoryName:"",f+=" - "+a.Championship,f+=" - "+a.EventName;var g=a.MarketName,h=a.SelectionName;h+=1==a.OnlyRegularTime?" "+locale.sports.coupon.combinationSet.onlyRegularTimeShort:"";var i=a.OddValue?a.OddValue.toFixed(2).toString():"-",j=a.UnboostedOddValue?a.UnboostedOddValue.toFixed(2).toString():"-",k=n.parseResult(a),l=a.FixedOdd?"B":"";return{onLineCode:b,IDEvent:c,isLive:d,eventDate:e,eventName:f,marketName:g,selectionName:h,oddValue:i,unboostedOddValue:j,result:k[0],allResults:k[2],showAllResults:k[3],isBanker:l,resultLegend:k[1].length?k[1]:""}},this.parseResult=function(a){var b="",c="";a.Win==-1?(b=locale.account.betSearch.legendBlue,c="blue"):0==a.Win?(b=locale.account.betSearch.legendRed,c="red"):1==a.Win?(b=locale.account.betSearch.legendGreen,c="green"):3==a.Win?(b=locale.account.betSearch.legendBlueRed,c="blue_red"):4==a.Win?(b=locale.account.betSearch.legendBlueGreen,c="blue_green"):(b=locale.account.betSearch.legendRunning,c="running");var d="",e=!1,f="";try{if("Unset"!=a.Result){var g="";if(a.Results.length>1){g=a.Results[0].Value+" - "+a.Results[1].Value;for(var h=0,i=0;i<a.Results.length;i+=2)f+='<div class="rowContainer"><div class="divHeader">'+a.Results[i].Family+'</div><div class="divContent">'+a.Results[i].Value+"-"+a.Results[i+1].Value+"</div></div>",h++;h>2?e=!0:f="",d=2==a.IDSport||3==a.IDSport||9==a.IDSport||11==a.IDSport||13==a.IDSport||14==a.IDSport||17==a.IDSport||19==a.IDSport||20==a.IDSport||22==a.IDSport||28==a.IDSport||83==a.IDSport?g:1==a.IDSport||6==a.IDSport||12==a.IDSport||29==a.IDSport||59==a.IDSport||252==a.IDSport||253==a.IDSport||254==a.IDSport?a.Results.length>3?g+"<br>("+a.Results[2].Value+" - "+a.Results[3].Value+")":g+"<br>("+a.Results[0].Value+" - "+a.Results[1].Value+")":4==a.IDSport||16==a.IDSport||60==a.IDSport?g+"<br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+", "+a.Results[6].Value+" - "+a.Results[7].Value+")":26==a.IDSport?g+"<br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+", "+a.Results[6].Value+" - "+a.Results[7].Value+", "+a.Results[8].Value+" - "+a.Results[9].Value+")":5==a.IDSport||23==a.IDSport?a.Results.length>11?g+"<br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+", "+a.Results[6].Value+" - "+a.Results[7].Value+", "+a.Results[8].Value+" - "+a.Results[9].Value+", "+a.Results[10].Value+" - "+a.Results[11].Value+")":a.Results.length>7?g+"<br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+", "+a.Results[6].Value+" - "+a.Results[7].Value+")":g+"<br>("+a.Results[2].Value+" - "+a.Results[3].Value+", "+a.Results[4].Value+" - "+a.Results[5].Value+")":b}else d=b}}catch(a){d=b}return[d,c,f,e]},this.settleBet=function(a){b.showLoader(".sectionDetails"),h.gamingVendors.sportsbook.cashoutCoupon(a,"").then(function(a){return b.hideLoader(".sectionDetails"),a.success?(k.showSuccessMessage(a.userMsg).done(),void g.coupon.getCouponByCode(l.params.couponCode,globalSettings.CurrentLanguage).then(function(a){n.couponDetails=n.parseCouponDetails(a.data)})):void j.logError("Unable to settle bet: "+a.error,a.userMsg)})},this.copyToClipboard=function(a){var b=$(a.currentTarget),c=$("<input>");$("body").append(c),c.val(b.text().trim()).select(),document.execCommand("copy"),c.remove()},this.rebetCoupon=function(a){b.showLoader(".sectionDetails"),g.coupon.rebetCoupon(a,globalSettings.CurrentLanguage).then(function(a){b.hideLoader(".sectionDetails"),a.success&&(f.couponData=a.data.BetCoupon,f.couponLocalId=(new Date).getTime().toString().substring(3)+""+Math.floor(100*Math.random()+1),window.top.location.href.indexOf("/shop/sh/home")!=-1||window.top.location.href.indexOf("/shop/sh/accountstatement")!=-1?window.top.location.href="/sports":window.top.location.reload())})},this.parseGetCouponResponse=function(a){if(!a.success)return void j.logError("Unable to get coupon by code (no check): "+JSON.stringify(a.error));if(null!=a.data&&0!=a.data.CouponId){n.couponDetails=n.parseCouponDetails(a.data),n.eventListData=[];for(var b=0;b<a.data.Odds.length;b++)n.eventListData.push(n.parseOdd(a.data.Odds[b]))}},this.parseCashoutValueResponse=function(a){n.cashoutData=a,n.cashoutRefreshInProgress=!1,311===a.responseCode&&(n.allowCashout=!1)},this.onRefreshCashoutClicked=function(a){n.cashoutRequested=e.isInPendingList(null,a),n.cashoutRequested||n.cashoutRefreshInProgress||(n.cashoutRefreshInProgress=!0,e.getCashoutValue(a).then(function(a){n.parseCashoutValueResponse(a)}))},this.onCashoutClicked=function(a){if(n.cashoutRequested=e.isInPendingList(null,a),!n.cashoutRequested&&globalSettings.Sports_EnableCashOut&&null!=n.cashoutData&&n.cashoutData.cashoutAvailable){if(!n.userLoggedIn)return void k.showErrorMessage(locale.common.cashout.loginRequired).done();var b=n.cashoutData.tax>0?locale.common.cashout.cashoutValue+": <br>"+n.cashoutData.displayValue+" ("+locale.sports.coupon.couponOdds.tax+": "+n.cashoutData.displayTax+") = "+n.cashoutData.displayNetValue:locale.common.cashout.cashoutValue+": "+n.cashoutData.displayValue;k.showInfoMessage(b,null,!0,locale.common.cancel,!0,locale.common.proceed).then(function(){n.cashoutInProgress=!0,e.cashout([n.cashoutData.serverData],n.couponDetails.UserId).then(function(a){return n.cashoutInProgress=!1,a.success?(a.cashoutAccepted||k.showInfoMessage(a.userMessage).done(),void(n.cashoutData=null)):(304==a.responseCode&&(n.cashoutData.value=a.value,n.cashoutData.displayValue=a.displayValue,n.cashoutData.currency=a.currency),void k.showErrorMessage(a.userMessage).done())})}).done()}},n.dataLoading=!0,g.coupon.getCouponByCodeNoCheck(o,globalSettings.CurrentLanguage).then(function(a){n.parseGetCouponResponse(a),globalSettings.Sports_EnableCashOut&&!n.cashoutRequested&&a.data.BetFinalState==-1&&e.getCashoutValue(o).then(function(a){n.parseCashoutValueResponse(a)}),n.dataLoading=!1}),a.$on("onRepeatLast",function(a,b,c){"couponIframeEventList"==c.onLastRepeat&&$("#couponEvents").DataTable({ordering:!1,paging:!1,searching:!1,info:!1})}),a.$on("onRepeatLast",function(a,b,c){"couponIframeCombinationList"==c.onLastRepeat&&$("#couponCombinations").DataTable({ordering:!1,paging:!1,searching:!1,info:!1})}),a.$watch(function(){return i.hasValidLogin()},function(a,b){b&&!a&&(n.userLoggedIn=a)}),a.$on("cashoutService:cashoutRejected:"+o,function(a,b){n.cashoutRequested=!1,e.getCashoutValue(o).then(n.parseCashoutValueResponse)}),a.$on("cashoutService:pendingListUpdated",function(a){n.cashoutRequested=e.isInPendingList(null,o)})}])}(),function(){angular.module("couponPrint",[]).controller("CouponPrintController",["$scope","$timeout","authService","helperService","sportsApiService","loggingService",function(a,b,c,d,e,f){var g=this;this.loading=!0,this.currentDate=moment(),this.userLoggedIn=c.hasValidLogin(),this.hasCopy="true"==d.getQueryStringParameter("hasCopy"),this.couponData=null,this.UserName="",this.showVATNumber=!!localeSettings.vatNumber,this.showTINNumber=!!localeSettings.tinNumber;var h=0,i=a.isPokerShares&&"true"==d.getQueryStringParameter("pokerpool"),j=d.getQueryStringParameter("couponCode");if(this.formatPrintCoupon=function(a){var b="";a.Odds.sort(function(a,b){var c=new Date(a.EventDate),d=new Date(b.EventDate);return c-d}),angular.forEach(a.Odds,function(a){a.IsPreviousTournament=!1,b!=a.SportName+" - "+a.Championship&&(b=a.SportName+" - "+a.Championship,a.IsPreviousTournament=!0)});var c=new Array,d=0;return angular.forEach(a.Groupings,function(a){var b=new Array;b.Grouping=a.Grouping,b.Combinations=a.Combinations,b.Stake=a.Stake,1==a.Grouping?b.GroupingName=locale.sports.coupon.printCoupon.singole:2==a.Grouping?b.GroupingName=locale.sports.coupon.printCoupon.doppie:3==a.Grouping?b.GroupingName=locale.sports.coupon.printCoupon.triple:4==a.Grouping?b.GroupingName=locale.sports.coupon.printCoupon.quadruple:5==a.Grouping?b.GroupingName=locale.sports.coupon.printCoupon.cinquine:6==a.Grouping?b.GroupingName=locale.sports.coupon.printCoupon.sestine:7==a.Grouping?b.GroupingName=locale.sports.coupon.printCoupon.settine:b.GroupingName=locale.sports.coupon.printCoupon.uple,c[d]=b,d+=1}),c.sort(g.dynamicSort("Grouping")),a.AllGroupings=c,globalSettings.Sports_EnableWatermarkOnCoupon&&(a.IsPrinted||e.coupon.setCouponPrintedByCode(a.CouponCode).then(function(a){if(!a.success)return void f.logError("Unable to set coupon as printed: "+JSON.stringify(a.error))})),a},this.dynamicSort=function(a){var b=1;return"-"===a[0]&&(b=-1,a=a.substr(1)),function(c,d){var e=c[a]<d[a]?-1:c[a]>d[a]?1:0;return e*b}},this.getCouponData=function(){if(i)var a=e.coupon.getPokerCouponByCode(j,globalSettings.CurrentLanguage);else var a=e.coupon.getCouponByCode(j,globalSettings.CurrentLanguage);a.then(function(a){if(!a.success||null==a.data||null==a.data.CouponCode)return h++,h>=10?(g.loading=!1,void f.logError("Unable to get coupon by code: "+JSON.stringify(a.error))):void b(g.getCouponData,1e3);var c=a.data;if(null==c.CouponCode||1!=c.CouponStatusId)return void(g.loading=!1);1==c.CouponTypeId?c.CouponType=locale.sports.coupon.printCoupon.couponTypes.single:2==c.CouponTypeId?c.CouponType=locale.sports.coupon.printCoupon.couponTypes.multiple:3==c.CouponTypeId&&(c.CouponType=locale.sports.coupon.printCoupon.couponTypes.system),g.couponData=g.formatPrintCoupon(c),g.UserName=a.data.UserName;try{switch(globalSettings.Sports_PrintedCouponSize){case"normal":$("#barcode").JsBarcode(c.CouponCode,{width:1.2,displayValue:!0});break;case"small":$("#barcode").JsBarcode(c.CouponCode,{width:1,height:35,displayValue:!0});break;case"smallest":$("#barcode").JsBarcode(c.CouponCode,{width:1.15,height:22,displayValue:!0,textMargin:.1,fontSize:16,fontOptions:"bold",margin:2})}}catch(a){console.log(a.message)}i||b(function(){window.addEventListener("afterprint",function(a){globalSettings.DebugMode||window.close()});var a=$(".watermark");if(a){var b=$(".couponLogoAddress").innerHeight();a.innerHeight($("#divStampaRicevuta").innerHeight()-b),a.css("margin-top",b+"px"),a.css("display","flex")}window.print()}.bind(this),1e3),g.loading=!1})},!this.userLoggedIn||null==j||j.trim().length<=0)return void(this.loading=!1)}]).controller("CouponBookedPrintController",["$scope","helperService","$timeout",function(a,b,c){var d=this;this.couponCode=b.getQueryStringParameter("couponCode"),this.couponDate=b.getQueryStringParameter("couponDate");var e="normal"===globalSettings.Sports_PrintedCouponSize?{width:1,displayValue:!0}:{width:2,height:40,displayValue:!0};if(null!=this.couponCode&&this.couponCode.trim().length>0)try{c(function(){$("#barcode-print").JsBarcode(d.couponCode,e)})}catch(a){console.log(a.message)}c(function(){window.print(),globalSettings.DebugMode||window.close()}.bind(this),1e3)}])}(),function(){angular.module("evaluation.service",[]).factory("evaluationService",["$rootScope","$q","$localStorage","$timeout","$interval","$location","$compile","authService","sportsApiService","loggingService","helperService","couponService","evaluationSignalrService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.pendingEvaluationList=[],a.evaluationScrollConfig={theme:"minimal",axis:"y",advanced:{updateOnContentResize:!0},scrollInertia:500},a.isPrinted=!1,a.handleEvaluationPrintClick=function(b,c){if(null!=b&&!ctrlScope.isPrinted){var e=f.absUrl().indexOf("pokershares")>-1||window.location.href.indexOf("pokershares")>-1;a.isPrinted=!0,d(function(){a.isPrinted=!1}.bind(this),4e3),l.printCoupon(b,c,e)}};var n,o=Object.freeze({pending:1,accepted:2,declined:3,awaitingReply:4}),p=function(){return null==c.evaluationList&&(c.evaluationList=[]),c.evaluationList},q=function(){return null==c.pendingCashoutList&&(c.pendingCashoutList=[]),c.pendingCashoutList},r=function(a){if(!t(a.CouponCode)){var b=p();if(b.length>=10){var c=_.find(b,function(a){return a.status==o.accepted||a.status==o.declined});if(null==c)return void j.logError("Unable to add new items to the evaluation list - limit reached");s(c.coupon.CouponCode)}b.push({status:o.pending,coupon:a})}},s=function(a){var b=p(),c=q();_.remove(b,function(b){return b.coupon.CouponCode==a}),0===b.length&&0===c.length&&m.stopConnection()},t=function(a){var b=p(),c=_.find(b,function(b){
return b.coupon.CouponCode==a});return c},u=function(a,c){var d=b.defer();return i.coupon.getPendingCouponByCode(a,c).then(function(a){return a.success&&null!=a.data?void d.resolve(v(a.data)):(j.logError("Unable to get coupon evaluation status: "+JSON.stringify(a.error)),void d.resolve())}),d.promise},v=function(a){var b={updatedBetCoupon:{confirmedStake:a.ConfirmedStake,couponCode:a.UpdatedBetCoupon.CouponCode,evalCouponStatusId:a.UpdatedBetCoupon.EvalCouponStatusId,idOperatorReason:a.UpdatedBetCoupon.IDOperatorReason,maxWinNet:a.UpdatedBetCoupon.MaxWinNet,maxWithholdingTax:a.UpdatedBetCoupon.MaxWithholdingTax,offerResponseByUser:a.UpdatedBetCoupon.OfferResponseByUser,stake:a.UpdatedBetCoupon.Stake,stakeGross:a.UpdatedBetCoupon.StakeGross,userId:a.UpdatedBetCoupon.UserId,odds:[]}};return _.forEach(a.UpdatedBetCoupon.Odds,function(a){var c={categoryName:a.CategoryName,championship:a.Championship,confirmedOddValue:a.ConfirmedOddValue,eventCategory:a.EventCategory,eventName:a.EventName,marketName:a.MarketName,oddValue:a.OddValue,onLineCode:a.OnLineCode,selectionName:a.SelectionName};b.updatedBetCoupon.odds.push(c)}),b},w=function(c){var d=p();if(d&&d.length>0&&(m.startConnection(),n||(a.$on("betEvaluationComplete",function(a,b){b&&x(b)}),n=!0),c)){var e=[];_.forEach(d,function(a){if(a.status==o.pending||a.status==o.awaitingReply){var b=u(a.coupon.CouponCode,a.coupon.Userid);e.push(b),b.then(function(a){x(a)})}}),b.all(e).then(function(){a.$broadcast("evaluationService:dataRefreshed",p())})}},x=function(b){if(b){var c=b.updatedBetCoupon.evalCouponStatusId,d=o.pending;1==c?d=o.accepted:3==c||7==c?d=o.declined:8!=c&&9!=c&&10!=c||(d=o.awaitingReply),d==o.accepted?(B(b.updatedBetCoupon.couponCode),E(b.updatedBetCoupon,D),a.$broadcast("evaluationService:couponAccepted",b.updatedBetCoupon),s(b.updatedBetCoupon.couponCode),a.$broadcast("evaluationService:dataRefreshed",p())):d==o.declined?(B(b.updatedBetCoupon.couponCode),F(b.updatedBetCoupon,D),s(b.updatedBetCoupon.couponCode),a.$broadcast("evaluationService:dataRefreshed",p())):d==o.awaitingReply&&A(b)}},y=function(a){var d=b.defer();return c.evaluationList=[],i.coupon.getPendingCoupons().then(function(a){return a.success?(_.forEach(a.data,function(a){r(a)}),void d.resolve()):(j.logError("Unable to get pending evaluation coupons: "+JSON.stringify(a.error)),void d.resolve())}),d.promise},z=function(a){var b=_.cloneDeep(a.updatedBetCoupon);return b.tournaments=[],b.odds.forEach(function(a){var c=a.categoryName+" - "+a.championship,d=a.eventName,e=_.find(b.tournaments,function(a){return a.name==c});if(null==e){var e={name:c,matches:[]};b.tournaments.push(e)}var f=_.find(e.matches,function(a){return a.name==d});if(null==f){var f={name:d,onLineCode:a.onLineCode,isLive:"L"==a.eventCategory,odds:[]};e.matches.push(f)}var g=_.cloneDeep(a);g.oddValue=parseFloat(g.oddValue).toFixed(2),g.confirmedOddValue=parseFloat(g.confirmedOddValue).toFixed(2),f.odds.push(g)}),b},A=function(b){var c=_.find(a.pendingEvaluationList,function(a){return a.couponCode==b.updatedBetCoupon.couponCode});if(null==c){var d=z(b);a.pendingEvaluationList.push(d)}},B=function(b){_.remove(a.pendingEvaluationList,function(a){return a.couponCode==b})},C=function(a,c,d){var e=b.defer();return i.coupon.updatePendingCoupon(a,c,d).then(function(a){if(a.success){var b=1==a.data.ResponseStatus;e.resolve(b)}else j.logError("Unable to send evaluation reply: "+JSON.stringify(a.error)),e.resolve(!1)}),e.promise},D=function(a,b,c){switch(a){case"success":color="green",icon="fa-check";break;case"error":color="red",icon="fa-exclamation-triangle";break;default:color="blue",icon="fa-exclamation-circle"}null==c&&(c=5e3),$.sticky(b,{speed:"fast",duplicates:!1,autoclose:c,color:color,messageIcon:icon,closeButtonHtml:'<span class="sticky-close" title="Close">&#215;</span>'})},E=function(b){var c=locale.sports.coupon.combinationSet.couponApprovedByOperator;b.offerResponseByUser&&(c=locale.sports.coupon.combinationSet.couponApprovedByClient);var d="<div class='approved-coupon'><div class='message'>"+c+"<br/>"+b.couponCode+"</div>";h.getUserData().isAgent&&(d+="<div class='print-button'><span id='printRiservaBet_"+b.couponCode+"' class='printRiservaBet' ng-disabled='"+a.isPrinted+"' ng-click='handleEvaluationPrintClick(\""+b.couponCode+'", "'+b.userId+"\")'>"+locale.sports.coupon.combinationSet.print+"</span></div>"),d+="</div>",k.showSuccessMessage(g(d)(a),D,!1)},F=function(a){var b=locale.sports.coupon.combinationSet.couponRejectedByOperator;a.offerResponseByUser&&(b=locale.sports.coupon.combinationSet.couponRejectedByClient);var c=b+"<br/>"+a.couponCode;0!=a.idOperatorReason&&(c=c+"<br/><br/><u>Reason</u>: "+locale.sports.coupon.operatorReason[a.idOperatorReason]),k.showErrorMessage(c,D)};return a.evaluationReplyClicked=function(a,b,c){B(a),C(a,b,c).then(function(a){b&&!a&&k.showErrorMessage(locale.sports.coupon.combinationSet.couponReactionTooLate,D)})},a.$watch(function(){return h.hasValidLogin()},function(a,b){a?y().then(function(){w(!0)}):m.stopConnection()}),{statusEnum:o,getEvaluationList:p,addToEvaluation:r,runEvaluation:w}}])}(),function(){angular.module("evaluationSignalr.service",[]).factory("evaluationSignalrService",["$rootScope","authService",function(a,b){var c,d=!1,e=function(){c||(c=(new signalR.HubConnectionBuilder).withUrl(globalSettings.SportsBookWebSocketURL+"evaluationHub",{headers:{"X-TOKEN":b.getAccessToken(),"X-BRAND":globalSettings.BrandID}}).withAutomaticReconnect().build(),g()),d||(c.start(),d=!0)},f=function(){c&&d&&(c.stop(),d=!1)},g=function(){c.on("CashoutEvaluationComplete",function(b){a.$broadcast("cashoutEvaluationComplete",b)}),c.on("BetEvaluationComplete",function(b){a.$broadcast("betEvaluationComplete",b)})};return{startConnection:e,stopConnection:f}}])}(),function(){angular.module("expandCoupon",[]).controller("ExpandCouponController",["couponService","sportsApiService","loggingService",function(a,b,c){var d=this;this.loading=!0,this.parseCoupon=function(a){var b={};return $.each(a,function(a,c){var d=a;null!=locale.sports.coupon.expandCoupon.groupNames[a]&&(d=locale.sports.coupon.expandCoupon.groupNames[a]),b[d]=[],$.each(c,function(a,c){var e="N/A";null!=locale.sports.coupon.expandCoupon.statusDescriptions[c.IDCouponStatus]&&(e=locale.sports.coupon.expandCoupon.statusDescriptions[c.IDCouponStatus]);var f={index:a+1,totalOdds:c.TotalOdds,stake:c.Stake,bonus:c.MinBonus,potentialWin:c.MinWin,statusCode:c.IDCouponStatus,status:e,currencyId:c.CurrencyId,odds:[]};$.each(c.Odds,function(a,b){f.odds.push({matchName:b.MatchName,marketName:b.MarketName,selectionName:b.SelectionName,oddValue:b.OddValue})}),b[d].push(f)})}),b},b.coupon.expandCoupon(a.getParameterByName("couponCode")).then(function(a){a.success?null!=a.data&&(d.couponData=d.parseCoupon(a.data)):c.logError("Unable to expand coupon: "+JSON.stringify(a.error)),d.loading=!1})}])}(),function(){angular.module("openBets",[]).controller("OpenBetsController",["$scope","$rootScope","$q","couponService","cashoutService","sportsApiService","platformApiService","authService","loggingService","helperService","$uiRouterGlobals","$filter","$localStorage","$timeout",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=this;if(this.userData=h.getUserData(),this.userLoggedIn=h.hasValidLogin(),this.openBets=[],this.recentBets=[],this.numOfOpenedBets=globalSettings.Sports_NumberOfExpandedOpenBets,this.hasMoreBets=!1,this.showPrintBtn=!1,this.isPrinted=!1,this.allowCashout=!0,this.mybetsTabSelected="open",this.settledTabSelected="won",this.filterBets="",null!=globalSettings.Sports_CashOutBlackList&&h.isAgent()){var p=_.map(globalSettings.Sports_CashOutBlackList.split(","),$.trim);_.includes(p,h.getUserData().userType)&&(o.allowCashout=!1)}this.searchBetsClicked=function(){h.getAgentType(h.getUserData().userType)?j.goToUmbracoPage("shop","shopBetSearch"):j.goToUmbracoPage("account","accountBetSearch")},this.toggleOpenedBets=function(a,b){b.events.length<=0&&o.getCouponDetails(b);var c=$(a.currentTarget);c.parent().next().find(".toggleDetails").slideToggle(),c.parents(".betsContainer").find(".arrowIcon, .arrowIcon i").toggleClass("rotateIcon")},this.rebetCouponClick=function(a){f.coupon.rebetCoupon(a,globalSettings.CurrentLanguage).then(function(a){a.success&&(m.couponData=d.formatCoupon(a.data.BetCoupon),m.couponLocalId=(new Date).getTime().toString().substring(3)+""+Math.floor(100*Math.random()+1),$("#betTabs #currentBetSlip").addClass("selected"),$("#betTabs #openBets").removeClass("selected"),$("#openBetsContent").css("display","none"),$("#currentBetSlipContent").css("display","block"),b.$broadcast("setSwitchStatus","currentBetSlip"))})},this.couponDetailView=function(a){null==a||a.length<=0||f.coupon.getCouponByCodeNoCheck(a,globalSettings.CurrentLanguage).then(function(b){if(b.success&&null!=b.data&&0!=b.data.CouponId){var c="/coupon-details-iframe/?couponCode="+a;$.fancybox({modal:!1,showCloseButton:!0,hideOnContentClick:!1,hideOnOverlayClick:!0,width:925,height:533,type:"iframe",padding:0,margin:0,fitToView:!1,autoSize:!1,href:c,afterShow:function(){var a='<div class="fancybox-custom-content panel panel-custom no-brand-footer"> <div class="panel-heading w-icon"> <h3 class="panel-title"> <i class="fa fa-list fa-fw"></i> <span>'+locale.account.betSearch.couponDetailsGeneric.toUpperCase()+"</span> </h3> </div></div>";$(".fancybox-outer").prepend(a)}})}else j.showErrorMessage(locale.sports.coupon.verifyCoupon.invalidCouponCode).done()})},this.copyToClipboard=function(a){var b=$(a.currentTarget),c=$("<input>");$("body").append(c),c.val(b.text().trim()).select(),document.execCommand("copy"),c.remove()},this.couponPrintClick=function(a,b){o.isPrinted||(o.isPrinted=!0,n(function(){o.isPrinted=!1}.bind(this),4e3),d.printCoupon(a,b))},this.parseOpenBet=function(a){var b="-";if(null!=a.CouponDate&&""!=a.CouponDate){var c=new Date(a.CouponDate);b=moment(c).format("DD MMM YYYY HH:mm:ss")}var d=l("number")(a.TotalOdds,2),e=(h.getUserData().currency.CurrencySymbol,l("currencyFormat")(a.StakeGross,2)),f="",g="";return a.BetFinalState==-1?(f=locale.account.betSearch.running,g="running"):0==a.BetFinalState?(f=locale.account.betSearch.systemEvaluation,g="evaluation"):1==a.BetFinalState?(f=locale.account.betSearch.positive,g="won"):2==a.BetFinalState?(f=locale.account.betSearch.couponStatus.partialWon,g="partial-won"):3==a.BetFinalState?(f=locale.account.betSearch.negative,g="lost"):4==a.BetFinalState?a.Won?(f=locale.account.betSearch.couponStatus.voided,g="voided"):(f=locale.account.betSearch.couponStatus.cancelled,g="cancelled"):5==a.BetFinalState?(f=locale.account.betSearch.couponStatus.cashout,g="cashout"):6==a.BetFinalState?(f=locale.account.betSearch.couponStatus.promotion,g="promotion"):(f=locale.account.betSearch.unknown,g="unknown"),{userId:a.UserId,couponDate:b,couponId:a.CouponId,couponTypeId:a.CouponTypeId,couponCode:a.CouponCode,totalOdds:d,totalCombinations:a.TotalCombinations,totalStake:e,betStatus:f,betStatusClass:g,events:[]}},this.parseEvent=function(a){var b=a.IsLive?"L":"",c="",d="";return a.Win==-1?(c=locale.account.betSearch.legendBlue,d="void"):0==a.Win?(c=locale.account.betSearch.legendRed,d="lost"):1==a.Win?(c=locale.account.betSearch.legendGreen,d="won"):3==a.Win?(c=locale.account.betSearch.legendBlueRed,d="void_lost"):4==a.Win?(c=locale.account.betSearch.legendBlueGreen,d="void_won"):(c=locale.account.betSearch.legendRunning,d="running"),{isLive:b,sportId:a.IDSport,eventName:a.EventName,marketName:a.MarketName,selectionName:a.SelectionName,eventStatus:c,eventStatusClass:d}},this.getOpenBets=function(b){void 0==b&&(o.mybetsTabSelected="open",b=2),o.showPrintBtn=null!=h.getUserData()&&h.getUserData().isAgent,f.coupon.getCouponsListNoDate(b,parseInt(globalSettings.Sports_MyBetsCouponCount+1),!0,globalSettings.CurrentLanguage,globalSettings.BrandID).then(function(b){if(b.success){var c=b.data;if(o.openBets=[],c&&c.Coupons.length>0){$("#openBets, .betToggle .switch-wrapper").removeClass("disabled");for(var d=0;d<c.Coupons.length;d++)d<globalSettings.Sports_MyBetsCouponCount?o.openBets.push(o.parseOpenBet(c.Coupons[d])):o.hasMoreBets=!0;if(o.allowCashout){var f=_.map(o.openBets,function(a){return a.couponCode});e.cashoutValuesBulk(f).then(function(b){b&&b.length>0&&_.forEach(o.openBets,function(c){o.parseCashoutValueResponse(_.filter(b,function(a){return a.serverData.CouponCode===c.couponCode})[0],c),a.$on("cashoutService:cashoutRejected:"+c.couponCode,function(a,b){c.cashoutRequested=!1,e.getCashoutValue(c.couponCode).then(function(a){o.parseCashoutValueResponse(a,c)})}),a.$on("cashoutService:pendingListUpdated",function(a){c.cashoutRequested=e.isInPendingList(null,c.couponCode)})})})}}}else console.error("Error occurred while getting the open bets: "+JSON.stringify(b.error))})},this.getCouponDetails=function(a){b.showLoader("#eventDetails_"+a.couponId,"element-small"),f.coupon.getCouponByCode(a.couponCode+","+a.userId,globalSettings.CurrentLanguage).then(function(c){b.hideLoader("#eventDetails_"+a.couponId),o.parseGetCouponResponse(c,a)})},this.parseGetCouponResponse=function(a,b){if(!a.success)return void i.logError("Unable to get coupon by code: "+JSON.stringify(a.error));if(null!=a.data&&0!=a.data.CouponId)for(var c=a.data,d=0;d<c.Odds.length;d++)b.events.push(o.parseEvent(c.Odds[d]))},this.parseCashoutValueResponse=function(a,b){b.cashoutData=a,b.cashoutInProgress=!1,b.cashoutRefreshInProgress=!1,311===a.responseCode&&(o.allowCashout=!1)},this.onRefreshCashoutClicked=function(a){a.cashoutRequested=e.isInPendingList(null,a.couponCode),a.cashoutRequested||a.cashoutRefreshInProgress||(a.cashoutRefreshInProgress=!0,e.getCashoutValue(a.couponCode).then(function(b){o.parseCashoutValueResponse(b,a)}))},this.onCashoutClicked=function(a){if(a.cashoutRequested=e.isInPendingList(null,a.couponCode),!a.cashoutRequested&&globalSettings.Sports_EnableCashOut&&null!=a.cashoutData&&a.cashoutData.cashoutAvailable){if(!o.userLoggedIn)return void j.showErrorMessage(locale.common.cashout.loginRequired).done();var c=a.cashoutData.tax>0?locale.common.cashout.cashoutValue+": <br>"+a.cashoutData.displayValue+" ("+locale.sports.coupon.couponOdds.tax+": "+a.cashoutData.displayTax+") = "+a.cashoutData.displayNetValue:locale.common.cashout.cashoutValue+": "+a.cashoutData.displayValue;j.showInfoMessage(c,null,!0,locale.common.cancel,!0,locale.common.proceed).then(function(){a.cashoutInProgress=!0,e.cashout([a.cashoutData.serverData],a.userId).then(function(c){return a.cashoutInProgress=!1,c.success?(c.cashoutAccepted||(j.showInfoMessage(c.userMessage).done(),b.$broadcast("cashoutService:cashoutRequested")),void(a.cashoutData=null)):(304==c.responseCode&&(a.cashoutData.value=c.value,a.cashoutData.displayValue=c.displayValue,a.cashoutData.currency=c.currency),void j.showErrorMessage(c.userMessage).done())})}).done()}},h.hasValidLogin()&&o.getOpenBets(),a.$watch(function(){return h.hasValidLogin()},function(a,b){a!=b&&(o.userLoggedIn=a,h.hasValidLogin()?o.getOpenBets():($("#openBetsContent").css("display","none"),$("#currentBetSlipContent").css("display","block")))}),a.$on("getOpenBets",function(a){o.getOpenBets()})}])}(),function(){angular.module("currency.service",[]).service("currencyService",["$rootScope","$filter",function(a,b){var c={1:{id:1,code:"EUR",name:"Euro",symbol:""},2:{id:2,code:"CHF",name:"Swiss Franc",symbol:"CHF"},3:{id:3,code:"USD",name:"US Dollar",symbol:"$"},7:{id:7,code:"GBP",name:"Pound",symbol:""},10:{id:10,code:"RON",name:"Romanian Leu",symbol:"lei"},11:{id:11,code:"BRL",name:"Brazilian Real",symbol:"R$"},12:{id:12,code:"DOP",name:"Dominican Pesos",symbol:"RD$"},13:{id:13,code:"ARS",name:"Argentine Peso",symbol:"$"},14:{id:14,code:"PEN",name:"Peruvian Nuevo sol",symbol:"PEN"},15:{id:15,code:"KES",name:"Kenyan shilling",symbol:"KSh"},16:{id:16,code:"NGN",name:"Nigerian naira",symbol:""},17:{id:17,code:"SEK",name:"Swedish Krona",symbol:"kr"},18:{id:18,code:"NOK",name:"Norwegian Krone",symbol:"kr"},19:{id:19,code:"DKK",name:"Danish Kroner",symbol:"kr"},20:{id:20,code:"RUB",name:"Russian ruble",symbol:""},21:{id:21,code:"CNY",name:"Chinese Yuan",symbol:""},22:{id:22,code:"BGN",name:"Bulgarian lev",symbol:"BGN"},23:{id:23,code:"TRY",name:"Turkish lira",symbol:""},24:{id:24,code:"AUD",name:"Australian Dollar",symbol:"$"},25:{id:25,code:"GEL",name:"Georgian Lari",symbol:"GEL"},26:{id:26,code:"COP",name:"Colombian Peso",symbol:"$"},27:{id:27,code:"RSD",name:"Serbian Dinar",symbol:"RSD"},28:{id:28,code:"ETB",name:"Ethiopian Birr",symbol:""},29:{id:29,code:"GHS",name:"Ghanaian Cedi",symbol:"GH"}},d=["ETB"];this.getCurrency=function(a){return isNaN(a)?_.find(c,["code",a]):_.find(c,["id",a])},this.getCurrencyCode=function(a){return this.getCurrency(a).code},this.getCurrencyName=function(a){return this.getCurrency(a).name},this.getCurrencySymbol=function(a){return this.getCurrency(a).symbol},this.formatNumber=function(a,b,c,d){return d?d?c?b+this.getCurrency(a).symbol:this.getCurrency(a).symbol+b:void 0:c?b+" "+this.getCurrency(a).symbol:this.getCurrency(a).symbol+" "+b},this.smartFormatNumber=function(a,c,e){var f=c?c:0,g=f<0,h=b("number")(g?f*-1:f,e),i=g?"-":"";return i+=""===a?h:d.indexOf(a)>-1?h+this.getCurrency(a).symbol:this.getCurrency(a).symbol+h},this.isInverseCurrency=function(a){return"string"==typeof a?d.indexOf(a)>-1:d.indexOf(c?c[a].code:"")>-1}}])}(),function(){angular.module("dataUpdate.service",[]).service("dataUpdateService",["$rootScope","$interval","sportsApiService","loggingService","helperService",function(a,b,c,d,e){var f={sportsLiveBannerOdds:{enabled:!1,oddsData:null},liveEventViewMenu:{enabled:!1,sportId:null},liveEventViewOdds:{enabled:!1,matchId:null,areaId:null},liveDiary:{enabled:!1},liveOverview:{enabled:!1,sportId:null,areaId:null},liveMultiView:{enabled:!1}},g=function(){if(!globalSettings.Sports_PauseTimersWhenInactive||!e.pageVisibilityApi().isPageHidden){if(f.sportsLiveBannerOdds.enabled&&null!=f.sportsLiveBannerOdds.oddsData&&f.sportsLiveBannerOdds.oddsData.length>0&&c.feed.getOddsChangedLocked(globalSettings.CurrentLanguage,f.sportsLiveBannerOdds.oddsData).then(function(b){return b.success?void a.$broadcast("dataUpdateService:sportsLiveBannerOddsUpdated",b.data):void d.logError("Unable to get sports live banner odds changes: "+JSON.stringify(b.error))}),f.liveEventViewMenu.enabled){var b=f.liveEventViewMenu.sportId;"all"!=b&&"favourites"!=b||(b=0),c.liveFeed.getLiveAreaOddsByLayout(globalSettings.CurrentLanguage,b,3,0,!1,!1,!1,!1).then(function(b){return b.success?void a.$broadcast("dataUpdateService:liveEventViewMenuDataUpdated",b.data):void d.logError("Unable to get live events: "+JSON.stringify(b.error))})}if(f.liveEventViewOdds.enabled){var g=f.liveEventViewOdds.matchId,h=f.liveEventViewOdds.areaId;c.liveFeed.getLiveEventDetails(g,globalSettings.CurrentLanguage,h).then(function(b){return b.success?void a.$broadcast("dataUpdateService:liveEventViewOddsDataUpdated",b.data):void d.logError("Unable to get live event details: "+JSON.stringify(b.error))})}if(f.liveDiary.enabled&&c.liveFeed.getLiveUpcomingEvents().then(function(b){return b.success?void a.$broadcast("dataUpdateService:liveDiaryDataUpdated",b.data):void d.logError("Unable to get upcoming live events: "+JSON.stringify(b.error))}),f.liveOverview.enabled){var b=f.liveOverview.sportId,h=f.liveOverview.areaId;c.liveFeed.getLiveAreaOddsByLayout(globalSettings.CurrentLanguage,b,3,h,!1,!1,!0,!0).then(function(b){return b.success?void a.$broadcast("dataUpdateService:liveOverviewDataUpdated",b.data):void d.logError("Unable to get live overview events: "+JSON.stringify(b.error))})}f.liveMultiView.enabled&&c.liveFeed.getLiveMultiview(globalSettings.CurrentLanguage).then(function(b){return b.success?void a.$broadcast("dataUpdateService:liveMultiViewDataUpdated",b.data):void d.logError("Unable to get live multiview events: "+JSON.stringify(b.error))})}};return b(g,globalSettings.Sports_LiveUpdatePollingTimer),{enableSportsLiveBannerUpdates:function(a){f.sportsLiveBannerOdds.enabled=!0,f.sportsLiveBannerOdds.oddsData=a},disableSportsLiveBannerUpdates:function(){f.sportsLiveBannerOdds.enabled=!1,f.sportsLiveBannerOdds.oddsData=null},enableLiveEventViewMenuUpdates:function(a){f.liveEventViewMenu.enabled=!0,f.liveEventViewMenu.sportId=a},disableLiveEventViewMenuUpdates:function(){f.liveEventViewMenu.enabled=!1},enableLiveEventViewOddsUpdates:function(a,b){f.liveEventViewOdds.enabled=!0,f.liveEventViewOdds.matchId=a,f.liveEventViewOdds.areaId=b},disableLiveEventViewOddsUpdates:function(){f.liveEventViewOdds.enabled=!1,f.liveEventViewOdds.matchId=null,f.liveEventViewOdds.areaId=null},enableLiveDiaryUpdates:function(){f.liveDiary.enabled=!0},disableLiveDiaryUpdates:function(){f.liveDiary.enabled=!1},enableLiveOverviewUpdates:function(a,b){f.liveOverview.enabled=!0,f.liveOverview.sportId=a,f.liveOverview.areaId=b},disableLiveOverviewUpdates:function(){f.liveOverview.enabled=!1},enableLiveMultiViewUpdates:function(){f.liveMultiView.enabled=!0},disableLiveMultiViewUpdates:function(){f.liveMultiView.enabled=!1}}}])}(),function(){angular.module("deviceFingerprint.service",[]).service("deviceFingerprintService",[function(){var a=ClientJS?new ClientJS:null;a&&(a.getFonts=function(){return""});var b={getFingerprint:function(){return!!a&&a.getFingerprint()},getUserAgent:function(){return!!a&&a.getUserAgent()},getBrowser:function(){return!!a&&a.getBrowser()},getBrowserVersion:function(){return!!a&&a.getBrowserVersion()},getEngine:function(){return!!a&&a.getEngine()},getOS:function(){return!!a&&a.getOS()},getCurrentResolution:function(){return!!a&&a.getCurrentResolution()}};return b}])}(),function(){angular.module("geoAccessControl",[]).factory("geoAccessControlService",["$cookies","websiteApiService","umbracoApiService",function(a,b,c){function d(){var c=h("fromcs");"true"===c&&m&&a.put(n,m),(k||l)&&b.location.getBlockedActions().then(function(a){if(!a.success)return void console.error("GAC - Network Error: "+a.error);if(a.data){i=a.data.GeoAccessResultList||[];var b=a.data.CountryCode||"";return k&&!e()?void(window.location.href="/site-unavailable"):void f(b)}})}function e(){var a=i.find(function(a){return"SiteAccess"===a.ActionName});return!(a&&!a.IsAllowed)}function f(b){if(l&&m){var d=new RegExp("^/country-selection/?$");if(!(d.test(window.location.pathname)||b&&m.toUpperCase()===b.toUpperCase())){var e=a.get(n);e&&m.toUpperCase()===e.toUpperCase()||c.shared.getCountrySelectionDetails().then(function(a){if(!a.success||!a.data)return void console.error("GAC - Unable to get country selection details: "+JSON.stringify(a.error));if(e){var c=a.data.countryList.find(function(a){return a.countryCode===e});if(c&&c.siteURL)return void g(c)}var d=a.data.countryList.find(function(a){return a.countryCode===b});d&&(window.location.href="/country-selection"+window.location.search)})}}}function g(b){if(b){var c=new Date;c.setTime(c.getTime()+31536e6),a.put(n,b.countryCode,{path:"/",expires:c});var d=window.location.search;0===d.length?d="?"+o+"=true":d+="&"+o+"=true",window.location.href=b.siteURL+d}}function h(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?null:decodeURIComponent(c[1].replace(/\+/g," "))}var i=[],j=globalSettings.General_GeoAccessControl,k=!!j&&j.accessBlockingEnabled,l=!!j&&j.tldRedirectionEnabled,m=j?j.siteCountryCode:"",n="countrySelection",o="fromcs",p="cc",q="dr";return{geoAccessResultList:i,geoAccessControlConfig:j,accessBlockingEnabled:k,tldRedirectionEnabled:l,siteCountryCode:m,csCookieName:n,fromCSPageQS:o,clearCookieQS:p,disableRedirectQS:q,runChecks:d,setCookieAndRedirect:g,getUrlParameter:h}}]).controller("CountrySelectionController",["$rootScope","$q","$cookies","platformApiService","umbracoApiService","geoAccessControlService",function(a,b,c,d,e,f){function g(){if(!f.tldRedirectionEnabled||!f.siteCountryCode)return void(window.location.href="/");a.showLoader(".country-selection");var g=f.getUrlParameter(f.clearCookieQS);"true"===g&&c.remove(f.csCookieName);var i=c.get(f.csCookieName);return i&&f.siteCountryCode.toUpperCase()===i.toUpperCase()?void(window.location.href="/"):void b.all([d.location.getCountryOfUser(),e.shared.getCountrySelectionDetails()]).then(function(b){var d=b[0],e=b[1];if(!d.success||!d.data)return console.error("GAC - Unable to get user country information: "+JSON.stringify(d.error)),void a.hideLoader(".country-selection");if(!e.success||!e.data)return console.error("GAC - Unable to get country selection details: "+JSON.stringify(e.error)),void a.hideLoader(".country-selection");var g=f.getUrlParameter(f.disableRedirectQS);if(i&&"true"!==g){var j=e.data.countryList.find(function(a){return a.countryCode===i});if(j)return void h.goToSite(j);console.error('GAC - Unable to get country details for saved country code "'+i+'". Clearing the stored cookie value'),c.remove(f.csCookieName)}var k=d.data.TwoLetterCode,l=e.data.countryList.find(function(a){return a.countryCode===f.siteCountryCode}),m=e.data.countryList.find(function(a){return a.countryCode===k});return l&&m?(h.userCountry=d.data.Name,h.countryDetailsData=e.data,h.siteLocaleData=l,h.userLocaleData=m,h.dataLoaded=!0,void a.hideLoader(".country-selection")):void(window.location.href="/")})}var h=this;this.userCountry="",this.countryDetailsData={},this.siteLocaleData={},this.userLocaleData={},this.dataLoaded=!1,this.goToSite=function(a){f.setCookieAndRedirect(a)},g()}])}(),function(){angular.module("live",["liveOverview","liveEventView","liveMultiView","liveDiary"]).service("SRLiveService",["$timeout","loggingService","$localStorage",function(a,b,c){function d(a){setTimeout(function(){e(a,!0)},0)}function e(a,b){switch(SIR("removeWidget",m[a].container),a){case"match.lmtplus":$(".middle-widget").hide(),$(".divWidget").show();break;case"match.lmtplus-sidebar":$(m[a].container.replace("#",".")+" .widget-overlay").css("display","block")}k[a]=j[a],k[a].time=0,m[a].alreadyTimedOut=!b,delete j[a]}function f(){_.forEach(Object.keys(j),function(a){j[a].time=0})}function g(){setInterval(function(){c.liveMatchTrackerMode||_.forEach(Object.keys(j),function(a){j[a].time=isNaN(j[a].time)?0:j[a].time+1,m[a].activityTimeout&&j[a].time>globalSettings.Sports_WidgetTimeoutInterval&&e(a)})},6e4)}function h(){document.onmousemove=f,document.onmousedown=f,document.ontouchstart=f,document.onclick=f,document.onscroll=f,document.onkeypress=f,g()}var i=null,j={},k={},l=this,m={"match.lmtplus":{container:"#srl-lmts",adsFrequency:!1,momentum:"compact",layouts:"topdown",pitchLogo:"/images/brand-logo/brand-logo-widget.svg",goalBannerImage:"/images/brand-logo/brand-logo-widget.svg",goalBannerCustomBgColor:betRadarWidgetsOptions.colorBrandDarker,activityTimeout:!0,alreadyTimedOut:!1},"match.lmtplus-sidebar":{container:"#srl-lmts-sidebar",adsFrequency:!1,scoreboard:"compact",detailedScoreboard:"disable",momentum:"disable",layouts:"single",pitchLogo:"/images/brand-logo/brand-logo-widget.svg",goalBannerImage:"/images/brand-logo/brand-logo-widget.svg",goalBannerCustomBgColor:betRadarWidgetsOptions.colorBrandDarker,activityTimeout:!0,alreadyTimedOut:!1},"match.statistics":{container:"#srl-matchstats",disableWidgetHeader:!0,disableMatchHeader:!0},"season.outcome":{container:"#srl-standings",disableWidgetHeader:!1},"match.lineUps":{container:"#srl-matchlineups",disableWidgetHeader:!1}},n=function(a){var b=!0;return"match.lineUps"==a&&!globalSettings.TeamLineupLiveWidget||"match.statistics"==a&&!globalSettings.StatisticsLiveWidget?b=!1:"season.outcome"!=a||globalSettings.StandingsLiveWidget||(b=!1),b},o=function(c,d,e,f){if(n(c)){var g=m[c];if(g.matchId=d,g.sportId=e,j[c])try{SIR("removeWidget",g.container)}catch(a){b.logError("Exception in SIR removeWidget: "+a.message)}a(function(){SIR("addWidget",g.container,c.replace("-sidebar",""),g,function(){j[c]={matchId:d,sportId:e},!!f&&f()})},0)}};this.addWidgets=function(a,b,e){return a=parseInt(a),b=parseInt(b),l.widgetAvailability(b)?($("#eventWidgets").show(),o("match.lineUps",a,b,m["match.lineUps"].activityTimeout?function(){d("match.lineUps")}:void 0),o("season.outcome",a,b,m["season.outcome"].activityTimeout?function(){d("season.outcome")}:void 0),o("match.statistics",a,b,m["match.statistics"].activityTimeout?function(){d("match.statistics")}:void 0),o("match.lmtplus-sidebar",a,b,m["match.lmtplus-sidebar"].activityTimeout?function(){c.liveMatchTrackerMode||d("match.lmtplus-sidebar")}:void 0),e&&o("match.lmtplus",a,b,function(){d("match.lmtplus")}),void(i=a)):void $("#eventWidgets").hide()},this.widgetAvailability=function(a){var b=globalSettings.Sports_BetRadarLiveWidgetHideIds.split(",").filter(function(b){return b==a})[0];return void 0==b},this.removeWidgets=function(){$("#eventWidgets").hide();for(var a in j){try{globalSettings.BetRadarWidgetsEnabled&&SIR("removeWidget",m[a].container)}catch(a){b.logError("Exception in SRLiveService.removeWidgets: "+a.message)}delete j[a]}i=null},this.updateMultiView=function(a){function b(a){for(var b=0;b<a.length;b++)if(a[0].matchId===i)return!0;return!1}return a&&a.length?void(i?b(a)||l.addWidgets(a[0].matchId,a[0].sportId,!1):l.addWidgets(a[0].matchId,a[0].sportId,!1)):void(i&&l.removeWidgets())},this.pauseWidget=e,this.isWidgetPaused=function(a){return!!k[a]},this.hasWidgetTimedoutBefore=function(a){return m[a].alreadyTimedOut},this.resumeWidget=function(a){o(a,k[a].matchId,k[a].sportId,function(){switch(a){case"match.lmtplus":$(".middle-widget").show(),$(".divWidget").hide();break;case"match.lmtplus-sidebar":$(m[a].container.replace("#",".")+" .widget-overlay").css("display","none")}}),j[a]=k[a],delete k[a]},h()}]).service("liveService",["$sessionStorage","umbracoApiService",function(a,b){var c=void 0;return function(){c||b.desktop.getLiveMatchStatusMappings(globalSettings.CurrentLanguage).then(function(a){a.data?c=a.data:(console.log("Could not retrieve live match statuses, using defaults"),c=DEFAULT_LIVE_MATCH_STATUSES)},function(a){console.log("Could not retrieve live match statuses, using defaults"),c=DEFAULT_LIVE_MATCH_STATUSES})}(),{getLiveMenuSettings:function(){return a.liveMenuSettings||(a.liveMenuSettings={}),a.liveMenuSettings},setLiveMenuSettings:function(b,c){a.liveMenuSettings[b]=c},clearLiveMenuSettings:function(){a.liveMenuSettings={}},getCollapsedLiveMenuList:function(){return a.collapsedLiveMenuList||(a.collapsedLiveMenuList=[]),a.collapsedLiveMenuList},setCollapsedLiveMenuList:function(b){a.collapsedLiveMenuList=b},clearCollapsedLiveMenuList:function(){a.collapsedLiveMenuList=[]},getMatchStatusLabel:function(a,b){if(b.EventStatus){var d=void 0;return c&&(d=_.find(c[a],function(a){return a.StatusId===b.EventStatus.Id})),d?d.StatusLabel:b.EventStatus.Description}return locale.sports.live.matchStatus[b.MatchStatus]}}}]).controller("LiveBettingController",["$scope","$location","$rootScope","$transitions","sportsApiService","liveService","loggingService","SRLiveService","umbracoApiService",function(a,b,c,d,e,f,g,h,i){var j=this;f.clearLiveMenuSettings(),f.clearCollapsedLiveMenuList(),this.noEvents=!1,this.eventsLength="",this.sportId="",e.liveFeed.getLiveEvents().then(function(a){return a.success?(j.eventsLength=a.data.length,void(j.eventsLength>0?j.noEvents=!1:j.noEvents=!0)):(j.noEvents=!0,void g.logError("Unable to get live events: "+JSON.stringify(a.error)))}),this.resumeSidebar=function(){h.isWidgetPaused("match.lmtplus-sidebar")&&h.resumeWidget("match.lmtplus-sidebar")},this.hasWidgetTimedoutBefore=function(){return h.hasWidgetTimedoutBefore("match.lmtplus-sidebar")},this.getMatchStatusLabel=function(a,b){return f.getMatchStatusLabel(a,b)},d.onStart({},function(a){a.promise.finally(function(){j.sportId="sport_"+b.path().replace("/live/eventview/","").split("-")[0],c.$broadcast("changeScoreBg")})})}])}();var DEFAULT_LIVE_MATCH_STATUSES={1:[{statusId:6,statusLabel:"1st half"},{statusId:7,statusLabel:"2nd half"},{statusId:31,statusLabel:"Halftime"},{statusId:32,statusLabel:"Awaiting extra time"},{statusId:33,statusLabel:"Extra time halftime"
},{statusId:34,statusLabel:"Awaiting penalties"},{statusId:41,statusLabel:"1st extra"},{statusId:42,statusLabel:"2nd extra"},{statusId:50,statusLabel:"Penalties"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:100,statusLabel:"Ended"},{statusId:110,statusLabel:"AET"},{statusId:120,statusLabel:"AP"},{statusId:123,statusLabel:"Half Time"},{statusId:124,statusLabel:"1st Half"},{statusId:125,statusLabel:"2nd Half"}],2:[{statusId:1,statusLabel:"1st period"},{statusId:2,statusLabel:"2nd period"},{statusId:6,statusLabel:"1st half"},{statusId:7,statusLabel:"2nd half"},{statusId:13,statusLabel:"1st quarter"},{statusId:14,statusLabel:"2nd quarter"},{statusId:15,statusLabel:"3rd quarter"},{statusId:16,statusLabel:"4th quarter"},{statusId:31,statusLabel:"Halftime"},{statusId:32,statusLabel:"Awaiting extra time"},{statusId:40,statusLabel:"Overtime"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:100,statusLabel:"Ended"},{statusId:110,statusLabel:"AET"},{statusId:301,statusLabel:"First break"},{statusId:302,statusLabel:"Second break"},{statusId:303,statusLabel:"Third break"},{statusId:123,statusLabel:"Half Time"},{statusId:124,statusLabel:"1st Half"},{statusId:125,statusLabel:"2nd Half"}],3:[{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:100,statusLabel:"Ended"},{statusId:401,statusLabel:"1st inning top"},{statusId:402,statusLabel:"1st inning bottom"},{statusId:403,statusLabel:"2nd inning top"},{statusId:404,statusLabel:"2nd inning bottom"},{statusId:405,statusLabel:"3rd inning top"},{statusId:406,statusLabel:"3rd inning bottom"},{statusId:407,statusLabel:"4th inning top"},{statusId:408,statusLabel:"4th inning bottom"},{statusId:409,statusLabel:"5th inning top"},{statusId:410,statusLabel:"5th inning bottom"},{statusId:411,statusLabel:"6th inning top"},{statusId:412,statusLabel:"6th inning bottom"},{statusId:413,statusLabel:"7th inning top"},{statusId:414,statusLabel:"7th inning bottom"},{statusId:415,statusLabel:"8th inning top"},{statusId:416,statusLabel:"8th inning bottom"},{statusId:417,statusLabel:"9th inning top"},{statusId:418,statusLabel:"9th inning bottom"},{statusId:419,statusLabel:"Extra inning top"},{statusId:420,statusLabel:"Extra inning bottom"},{statusId:421,statusLabel:"Break top 1 bottom 1"},{statusId:422,statusLabel:"Break top 2 bottom 1"},{statusId:423,statusLabel:"Break top 2 bottom 2"},{statusId:424,statusLabel:"Break top 3 bottom 2"},{statusId:425,statusLabel:"Break top 3 bottom 3"},{statusId:426,statusLabel:"Break top 4 bottom 3"},{statusId:427,statusLabel:"Break top 4 bottom 4"},{statusId:428,statusLabel:"Break top 5 bottom 4"},{statusId:429,statusLabel:"Break top 5 bottom 5"},{statusId:430,statusLabel:"Break top 6 bottom 5"},{statusId:431,statusLabel:"Break top 6 bottom 6"},{statusId:432,statusLabel:"Break top 7 bottom 6"},{statusId:433,statusLabel:"Break top 7 bottom 7"},{statusId:434,statusLabel:"Break top 8 bottom 7"},{statusId:435,statusLabel:"Break top 8 bottom 8"},{statusId:436,statusLabel:"Break top 9 bottom 8"},{statusId:437,statusLabel:"Break top 9 bottom 9"},{statusId:438,statusLabel:"Break top EI bottom 9"},{statusId:439,statusLabel:"Break top EI bottom EI"},{statusId:548,statusLabel:"Break top EI bottom 7"}],4:[{statusId:1,statusLabel:"1st period"},{statusId:2,statusLabel:"2nd period"},{statusId:3,statusLabel:"3rd period"},{statusId:32,statusLabel:"Awaiting extra time"},{statusId:34,statusLabel:"Awaiting penalties"},{statusId:40,statusLabel:"Overtime"},{statusId:50,statusLabel:"Penalties"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:100,statusLabel:"Ended"},{statusId:110,statusLabel:"AET"},{statusId:120,statusLabel:"AP"},{statusId:301,statusLabel:"First break"},{statusId:302,statusLabel:"Second break"}],5:[{statusId:8,statusLabel:"1st set"},{statusId:9,statusLabel:"2nd set"},{statusId:10,statusLabel:"3rd set"},{statusId:11,statusLabel:"4th set"},{statusId:12,statusLabel:"5th set"},{statusId:61,statusLabel:"Start delayed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:92,statusLabel:"Retired"},{statusId:93,statusLabel:"Walkover    player 1 won"},{statusId:94,statusLabel:"Walkover    player 2 won"},{statusId:95,statusLabel:"Player 1 retired    player 2 won"},{statusId:96,statusLabel:"Player 2 retired    player 1 won"},{statusId:100,statusLabel:"Ended"}],6:[{statusId:6,statusLabel:"1st half"},{statusId:7,statusLabel:"2nd half"},{statusId:31,statusLabel:"Halftime"},{statusId:32,statusLabel:"Awaiting extra time"},{statusId:33,statusLabel:"Extra time halftime"},{statusId:34,statusLabel:"Awaiting penalties"},{statusId:41,statusLabel:"1st extra"},{statusId:42,statusLabel:"2nd extra"},{statusId:50,statusLabel:"Penalties"},{statusId:61,statusLabel:"Start delayed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:100,statusLabel:"Ended"},{statusId:110,statusLabel:"AET"},{statusId:120,statusLabel:"AP"},{statusId:123,statusLabel:"Half Time"},{statusId:124,statusLabel:"1st Half"},{statusId:125,statusLabel:"2nd Half"}],12:[{statusId:6,statusLabel:"1st half"},{statusId:7,statusLabel:"2nd half"},{statusId:31,statusLabel:"Halftime"},{statusId:32,statusLabel:"Awaiting extra time"},{statusId:33,statusLabel:"Extra time halftime"},{statusId:34,statusLabel:"Awaiting penalties"},{statusId:41,statusLabel:"1st extra"},{statusId:42,statusLabel:"2nd extra"},{statusId:50,statusLabel:"Penalties"},{statusId:60,statusLabel:"Postponed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:100,statusLabel:"Ended"},{statusId:110,statusLabel:"AET"},{statusId:120,statusLabel:"AP"},{statusId:440,statusLabel:"Sudden death"},{statusId:443,statusLabel:"Awaiting sudden death"},{statusId:444,statusLabel:"After sudden death"},{statusId:123,statusLabel:"Half Time"},{statusId:124,statusLabel:"1st Half"},{statusId:125,statusLabel:"2nd Half"}],13:[{statusId:13,statusLabel:"1st quarter"},{statusId:14,statusLabel:"2nd quarter"},{statusId:15,statusLabel:"3rd quarter"},{statusId:16,statusLabel:"4th quarter"},{statusId:32,statusLabel:"Awaiting extra time"},{statusId:33,statusLabel:"Extra time halftime"},{statusId:41,statusLabel:"1st extra"},{statusId:42,statusLabel:"2nd extra"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:100,statusLabel:"Ended"},{statusId:110,statusLabel:"AET"},{statusId:301,statusLabel:"First break"},{statusId:302,statusLabel:"Second break"},{statusId:303,statusLabel:"Third break"},{statusId:440,statusLabel:"Sudden death"},{statusId:443,statusLabel:"Awaiting sudden death"},{statusId:444,statusLabel:"After sudden death"}],16:[{statusId:13,statusLabel:"1st quarter"},{statusId:14,statusLabel:"2nd quarter"},{statusId:15,statusLabel:"3rd quarter"},{statusId:16,statusLabel:"4th quarter"},{statusId:32,statusLabel:"Awaiting extra time"},{statusId:40,statusLabel:"Overtime"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:100,statusLabel:"Ended"},{statusId:110,statusLabel:"AET"},{statusId:301,statusLabel:"First break"},{statusId:302,statusLabel:"Second break"},{statusId:303,statusLabel:"Third break"}],19:[{statusId:21,statusLabel:"In progress"},{statusId:30,statusLabel:"Break"},{statusId:61,statusLabel:"Start delayed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:93,statusLabel:"Walkover    player 1 won"},{statusId:94,statusLabel:"Walkover    player 2 won"},{statusId:95,statusLabel:"Player 1 retired    player 2 won"},{statusId:96,statusLabel:"Player 2 retired    player 1 won"},{statusId:97,statusLabel:"Player 1 defaulted    player 2 won"},{statusId:98,statusLabel:"Player 2 defaulted    player 1 won"},{statusId:100,statusLabel:"Ended"},{statusId:445,statusLabel:"Break"}],20:[{statusId:8,statusLabel:"1st set"},{statusId:9,statusLabel:"2nd set"},{statusId:10,statusLabel:"3rd set"},{statusId:11,statusLabel:"4th set"},{statusId:12,statusLabel:"5th set"},{statusId:61,statusLabel:"Start delayed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:93,statusLabel:"Walkover    player 1 won"},{statusId:94,statusLabel:"Walkover    player 2 won"},{statusId:95,statusLabel:"Player 1 retired    player 2 won"},{statusId:96,statusLabel:"Player 2 retired    player 1 won"},{statusId:97,statusLabel:"Player 1 defaulted    player 2 won"},{statusId:98,statusLabel:"Player 2 defaulted    player 1 won"},{statusId:100,statusLabel:"Ended"},{statusId:301,statusLabel:"First break"},{statusId:302,statusLabel:"Second break"},{statusId:303,statusLabel:"Third break"},{statusId:304,statusLabel:"Fourth break"},{statusId:305,statusLabel:"Fifth break"},{statusId:306,statusLabel:"Sixth break"},{statusId:441,statusLabel:"6th set"},{statusId:442,statusLabel:"7th set"}],21:[{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:100,statusLabel:"Ended"},{statusId:501,statusLabel:"First innings    home team"},{statusId:502,statusLabel:"First innings    away team"},{statusId:503,statusLabel:"Second innings    home team"},{statusId:504,statusLabel:"Second innings    away team"},{statusId:505,statusLabel:"Awaiting super over"},{statusId:506,statusLabel:"Super over    home team"},{statusId:507,statusLabel:"Super over    away team"},{statusId:508,statusLabel:"After super over"},{statusId:509,statusLabel:"Innings break"},{statusId:510,statusLabel:"Super over break"},{statusId:511,statusLabel:"Lunch break"},{statusId:512,statusLabel:"Tea break"},{statusId:513,statusLabel:"Stumps"}],22:[{statusId:21,statusLabel:"In progress"},{statusId:30,statusLabel:"Break"},{statusId:61,statusLabel:"Start delayed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:93,statusLabel:"Walkover    player 1 won"},{statusId:94,statusLabel:"Walkover    player 2 won"},{statusId:95,statusLabel:"Player 1 retired    player 2 won"},{statusId:96,statusLabel:"Player 2 retired    player 1 won"},{statusId:97,statusLabel:"Player 1 defaulted    player 2 won"},{statusId:98,statusLabel:"Player 2 defaulted    player 1 won"},{statusId:100,statusLabel:"Ended"}],23:[{statusId:8,statusLabel:"1st set"},{statusId:9,statusLabel:"2nd set"},{statusId:10,statusLabel:"3rd set"},{statusId:11,statusLabel:"4th set"},{statusId:12,statusLabel:"5th set"},{statusId:17,statusLabel:"Golden set"},{statusId:37,statusLabel:"Awaiting golden set"},{statusId:61,statusLabel:"Start delayed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:93,statusLabel:"Walkover    player 1 won"},{statusId:94,statusLabel:"Walkover    player 2 won"},{statusId:95,statusLabel:"Player 1 retired    player 2 won"},{statusId:96,statusLabel:"Player 2 retired    player 1 won"},{statusId:100,statusLabel:"Ended"},{statusId:130,statusLabel:"After golden set"},{statusId:301,statusLabel:"First break"},{statusId:302,statusLabel:"Second break"},{statusId:303,statusLabel:"Third break"},{statusId:304,statusLabel:"Fourth break"},{statusId:305,statusLabel:"Fifth break"},{statusId:306,statusLabel:"Sixth break"},{statusId:441,statusLabel:"6th set"},{statusId:442,statusLabel:"7th set"}],24:[{statusId:6,statusLabel:"1st half"},{statusId:7,statusLabel:"2nd half"},{statusId:13,statusLabel:"1st quarter"},{statusId:14,statusLabel:"2nd quarter"},{statusId:15,statusLabel:"3rd quarter"},{statusId:16,statusLabel:"4th quarter"},{statusId:31,statusLabel:"Halftime"},{statusId:34,statusLabel:"Awaiting penalties"},{statusId:50,statusLabel:"Penalties"},{statusId:60,statusLabel:"Postponed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:100,statusLabel:"Ended"},{statusId:120,statusLabel:"AP"},{statusId:301,statusLabel:"First break"},{statusId:302,statusLabel:"Second break"},{statusId:303,statusLabel:"Third break"},{statusId:440,statusLabel:"Sudden death"},{statusId:443,statusLabel:"Awaiting sudden death"},{statusId:444,statusLabel:"After sudden death"},{statusId:123,statusLabel:"Half Time"},{statusId:124,statusLabel:"1st Half"},{statusId:125,statusLabel:"2nd Half"}],29:[{statusId:6,statusLabel:"1st half"},{statusId:7,statusLabel:"2nd half"},{statusId:31,statusLabel:"Halftime"},{statusId:32,statusLabel:"Awaiting extra time"},{statusId:33,statusLabel:"Extra time halftime"},{statusId:34,statusLabel:"Awaiting penalties"},{statusId:41,statusLabel:"1st extra"},{statusId:42,statusLabel:"2nd extra"},{statusId:50,statusLabel:"Penalties"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:100,statusLabel:"Ended"},{statusId:110,statusLabel:"AET"},{statusId:120,statusLabel:"AP"},{statusId:123,statusLabel:"Half Time"},{statusId:124,statusLabel:"1st Half"},{statusId:125,statusLabel:"2nd Half"}],31:[{statusId:8,statusLabel:"1st set"},{statusId:9,statusLabel:"2nd set"},{statusId:10,statusLabel:"3rd set"},{statusId:11,statusLabel:"4th set"},{statusId:12,statusLabel:"5th set"},{statusId:61,statusLabel:"Start delayed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:93,statusLabel:"Walkover    player 1 won"},{statusId:94,statusLabel:"Walkover    player 2 won"},{statusId:95,statusLabel:"Player 1 retired    player 2 won"},{statusId:96,statusLabel:"Player 2 retired    player 1 won"},{statusId:97,statusLabel:"Player 1 defaulted    player 2 won"},{statusId:98,statusLabel:"Player 2 defaulted    player 1 won"},{statusId:100,statusLabel:"Ended"},{statusId:301,statusLabel:"First break"},{statusId:302,statusLabel:"Second break"},{statusId:303,statusLabel:"Third break"},{statusId:304,statusLabel:"Fourth break"}],32:[{statusId:8,statusLabel:"1st set"},{statusId:9,statusLabel:"2nd set"},{statusId:10,statusLabel:"3rd set"},{statusId:11,statusLabel:"4th set"},{statusId:12,statusLabel:"5th set"},{statusId:61,statusLabel:"Start delayed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:93,statusLabel:"Walkover    player 1 won"},{statusId:94,statusLabel:"Walkover    player 2 won"},{statusId:95,statusLabel:"Player 1 retired    player 2 won"},{statusId:96,statusLabel:"Player 2 retired    player 1 won"},{statusId:97,statusLabel:"Player 1 defaulted    player 2 won"},{statusId:98,statusLabel:"Player 2 defaulted    player 1 won"},{statusId:100,statusLabel:"Ended"},{statusId:301,statusLabel:"First break"},{statusId:302,statusLabel:"Second break"},{statusId:303,statusLabel:"Third break"},{statusId:304,statusLabel:"Fourth break"}],34:[{statusId:8,statusLabel:"1st set"},{statusId:9,statusLabel:"2nd set"},{statusId:10,statusLabel:"3rd set"},{statusId:11,statusLabel:"4th set"},{statusId:12,statusLabel:"5th set"},{statusId:17,statusLabel:"Golden set"},{statusId:61,statusLabel:"Start delayed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:93,statusLabel:"Walkover    player 1 won"},{statusId:94,statusLabel:"Walkover    player 2 won"},{statusId:95,statusLabel:"Player 1 retired    player 2 won"},{statusId:96,statusLabel:"Player 2 retired    player 1 won"},{statusId:100,statusLabel:"Ended"},{statusId:301,statusLabel:"First break"},{statusId:302,statusLabel:"Second break"},{statusId:303,statusLabel:"Third break"},{statusId:304,statusLabel:"Fourth break"}],37:[{statusId:61,statusLabel:"Start delayed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:93,statusLabel:"Walkover    player 1 won"},{statusId:94,statusLabel:"Walkover    player 2 won"},{statusId:95,statusLabel:"Player 1 retired    player 2 won"},{statusId:96,statusLabel:"Player 2 retired    player 1 won"},{statusId:97,statusLabel:"Player 1 defaulted    player 2 won"},{statusId:98,statusLabel:"Player 2 defaulted    player 1 won"},{statusId:100,statusLabel:"Ended"},{statusId:151,statusLabel:"1st Game"},{statusId:152,statusLabel:"2nd Game"},{statusId:153,statusLabel:"3rd Game"},{statusId:154,statusLabel:"4th Game"},{statusId:155,statusLabel:"5th Game"},{statusId:301,statusLabel:"First break"},{statusId:302,statusLabel:"Second break"},{statusId:303,statusLabel:"Third break"},{statusId:304,statusLabel:"Fourth break"}],109:[{statusId:61,statusLabel:"Start delayed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:93,statusLabel:"Walkover    player 1 won"},{statusId:94,statusLabel:"Walkover    player 2 won"},{statusId:95,statusLabel:"Player 1 retired    player 2 won"},{statusId:96,statusLabel:"Player 2 retired    player 1 won"},{statusId:100,statusLabel:"Ended"},{statusId:141,statusLabel:"1st map"},{statusId:142,statusLabel:"2nd map"},{statusId:143,statusLabel:"3rd map"},{statusId:144,statusLabel:"4th map"},{statusId:145,statusLabel:"5th map"},{statusId:146,statusLabel:"6th map"},{statusId:147,statusLabel:"7th map"},{statusId:301,statusLabel:"First break"},{statusId:302,statusLabel:"Second break"},{statusId:303,statusLabel:"Third break"},{statusId:304,statusLabel:"Fourth break"},{statusId:305,statusLabel:"Fifth break"},{statusId:306,statusLabel:"Sixth break"}],110:[{statusId:61,statusLabel:"Start delayed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:93,statusLabel:"Walkover    player 1 won"},{statusId:94,statusLabel:"Walkover    player 2 won"},{statusId:95,statusLabel:"Player 1 retired    player 2 won"},{statusId:96,statusLabel:"Player 2 retired    player 1 won"},{statusId:100,statusLabel:"Ended"},{statusId:141,statusLabel:"1st map"},{statusId:142,statusLabel:"2nd map"},{statusId:143,statusLabel:"3rd map"},{statusId:144,statusLabel:"4th map"},{statusId:145,statusLabel:"5th map"},{statusId:301,statusLabel:"First break"},{statusId:302,statusLabel:"Second break"},{statusId:303,statusLabel:"Third break"},{statusId:304,statusLabel:"Fourth break"}],111:[{statusId:61,statusLabel:"Start delayed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:93,statusLabel:"Walkover    player 1 won"},{statusId:94,statusLabel:"Walkover    player 2 won"},{statusId:95,statusLabel:"Player 1 retired    player 2 won"},{statusId:96,statusLabel:"Player 2 retired    player 1 won"},{statusId:100,statusLabel:"Ended"},{statusId:141,statusLabel:"1st map"},{statusId:142,statusLabel:"2nd map"},{statusId:143,statusLabel:"3rd map"},{statusId:144,statusLabel:"4th map"},{statusId:145,statusLabel:"5th map"},{statusId:146,statusLabel:"6th map"},{statusId:147,statusLabel:"7th map"},{statusId:301,statusLabel:"First break"},{statusId:302,statusLabel:"Second break"},{statusId:303,statusLabel:"Third break"},{statusId:304,statusLabel:"Fourth break"},{statusId:305,statusLabel:"Fifth break"},{statusId:306,statusLabel:"Sixth break"}],138:[{statusId:6,statusLabel:"1st half"},{statusId:7,statusLabel:"2nd half"},{statusId:18,statusLabel:"Golden raid"},{statusId:19,statusLabel:"Coin toss"},{statusId:31,statusLabel:"Halftime"},{statusId:32,statusLabel:"Awaiting extra time"},{statusId:33,statusLabel:"Extra time halftime"},{statusId:38,statusLabel:"Awaiting golden raid"},{statusId:41,statusLabel:"1st extra"},{statusId:42,statusLabel:"2nd extra"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:100,statusLabel:"Ended"},{statusId:110,statusLabel:"AET"},{statusId:140,statusLabel:"After golden raid"},{statusId:123,statusLabel:"Half Time"},{statusId:124,statusLabel:"1st Half"},{statusId:125,statusLabel:"2nd Half"}],155:[{statusId:21,statusLabel:"In progress"},{statusId:32,statusLabel:"Awaiting extra time"},{statusId:40,statusLabel:"Overtime"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:100,statusLabel:"Ended"},{statusId:110,statusLabel:"AET"}],157:[{statusId:1,statusLabel:"1st period"},{statusId:2,statusLabel:"2nd period"},{statusId:31,statusLabel:"Halftime"},{statusId:34,statusLabel:"Awaiting penalties"},{statusId:50,statusLabel:"Penalties"},{statusId:61,statusLabel:"Start delayed"},{statusId:80,statusLabel:"Interrupted"},{statusId:90,statusLabel:"Abandoned"},{statusId:100,statusLabel:"Ended"},{statusId:120,statusLabel:"AP"}]};!function(){angular.module("liveDiary",[]).controller("LiveBettingLiveDiaryController",["$scope","dataDiaryCall","dataUpdateService","loggingService","SRLiveService","$timeout","liveService","$localStorage",function(a,b,c,d,e,f,g,h){var i=this;this.filterQuery="",this.selectedSport="all",this.favouriteEventsList=h.liveDiaryFavouriteEventsList||[],this.selectedWidget,this.headerCollapsed=!0,this.showHeaderCollapsed=!1,this.clearFilterText=function(){i.filterQuery="",$("#txtFilterEvents").focus()},this.selectSport_click=function(a){"favourites"==a&&0==i.favouriteEventsList.length&&(a="all"),i.selectedSport=a},this.addRemoveFavouriteEvents_click=function(a,b){var c=i.favouriteEventsList.indexOf(a+"|"+b);c>-1?i.favouriteEventsList.splice(c,1):i.favouriteEventsList.push(a+"|"+b),h.liveDiaryFavouriteEventsList=i.favouriteEventsList,"favourites"==i.selectedSport&&0==i.favouriteEventsList.length&&i.selectSport_click("all")},this.isFavouriteEvent=function(a,b){return i.favouriteEventsList.indexOf(a+"|"+b)>-1},this.toggleCollapsedHeader=function(){i.headerCollapsed=!i.headerCollapsed},this.setScrollbarsFooter=function(){globalSettings.General_ContentScrollBars?($(".live #leftContainer footer.footer-container").empty().html($("#divMainContainer > div > footer.footer-container > div").clone()),$(".live #leftContainer footer.footer-container").css("display","flex")):$(".live #leftContainer footer.footer-container").css("display","none")},f(function(){i.setScrollbarsFooter()}),a.$on("dataUpdateService:liveDiaryDataUpdated",function(b,c){a.scopeDataDiary=c,i.showHeaderCollapsed=$(".sports-container").height()>38});var j=[];if(b.success){j=b.data;var k=[],l=[];angular.forEach(j,function(a){if(!a.EventCount){var b=j.filter(function(b){return b.SportId==a.SportId});a.EventCount=b.length}i.favouriteEventsList.indexOf(a.SportId+"|"+a.MatchIdMapping)!=-1&&l.push(a.SportId+"|"+a.MatchIdMapping)}),k.push.apply(k,l),i.favouriteEventsList=k,h.liveDiaryFavouriteEventsList=k,"favourites"==i.selectedSport&&(0==i.favouriteEventsList.length?i.selectSport_click("all"):i.selectSport_click("favourites"))}else d.logError("Unable to get upcoming live events: "+JSON.stringify(b.error));if(a.liveDiaryData=j,a.widgetAvailability=function(a){var b=globalSettings.Sports_BetRadarLiveWidgetHideIds.split(",").filter(function(b){return b==a})[0];return void 0==b},null!=a.liveDiaryData&&a.liveDiaryData.length>0){var m=a.liveDiaryData[0].SportId,n=a.liveDiaryData[0].MatchId,o=a.liveDiaryData[0].MatchName;this.selectedWidget=n,$(".live .widget-event-name").html(o),globalSettings.BetRadarWidgetsEnabled&&e.addWidgets(n,m,!1)}a.ViewEventTracker_Clicked=function(a,b,c){i.selectedWidget=b,$(".live .widget-event-name").html(c),globalSettings.BetRadarWidgetsEnabled&&e.addWidgets(b,a,!1)},this.copyToClipboard=function(a){var b=$("<input>");$("body").append(b),b.val(a).select(),document.execCommand("copy"),b.remove()},c.enableLiveDiaryUpdates(),a.$on("$destroy",function(){c.disableLiveDiaryUpdates()})}])}(),function(){angular.module("liveEventView",[]).controller("LiveBettingEventViewController",["$scope","$timeout","$uiRouterGlobals","$sessionStorage","$localStorage","$state","dataUpdateService","loggingService","dataMenuCall","dataOddsCall","SRLiveService","liveService","sportsApiService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(b,c,d,e){b.hasSlider=b.Selections[0].Name.indexOf(":")!=-1&&globalSettings.Sports_LiveCorrectScoreSliderEnabled;var f=[],g=[];b.hasSlider&&($("#homeSlider_"+b.Id+" .rz-tick-value.active").length>0?b.homeValue=$("#homeSlider_"+b.Id+" .rz-tick-value.active").text():b.homeValue=c.Score.split(":")[0],$("#awaySlider_"+b.Id+" .rz-tick-value.active").length>0?b.awayValue=$("#awaySlider_"+b.Id+" .rz-tick-value.active").text():b.awayValue=c.Score.split(":")[1]),angular.forEach(b.Selections,function(a){if(b.hasSlider){for(var c=!1,h=0;h<f.length;h++)if(f[h]==a.Name.split(":")[0]){c=!0;break}c||f.push(parseInt(a.Name.split(":")[0])),c=!1;for(var h=0;h<g.length;h++)if(g[h]==a.Name.split(":")[1]){c=!0;break}c||g.push(parseInt(a.Name.split(":")[1]))}if(0!=a.Odds[0].Value)if(0!=a.Odds[0].Status)if(a.CurrentStatus="oddsAvailable",null!=d&&null!=d.Tournaments&&d.Tournaments.length>0)if(e){var i=d.Tournaments[0].Events[0].Markets.filter(function(a){return a.Id==b.Id})[0];if(void 0!=i){var j=i.Selections.filter(function(b){return b.Id==a.Id})[0];void 0!=j?j.Odds[0].Value==a.Odds[0].Value?a.OddChanged="OddNotChanged":j.Odds[0].Value>a.Odds[0].Value?a.OddChanged="OddChangedDown":j.Odds[0].Value<a.Odds[0].Value&&(a.OddChanged="OddChangedUp"):a.OddChanged="OddNotChanged"}else a.OddChanged="OddNotChanged"}else a.OddChanged="OddNotChanged";else a.OddChanged="OddNotChanged";else a.CurrentStatus="oddsLocked";else a.CurrentStatus="oddsEmpty"}),b.hasSlider&&(b.marketSliders={home:{value:parseInt(b.homeValue),options:{id:"homeSlider_"+b.Id,showTicksValues:!0,floor:parseInt(c.Score.split(":")[0]),ceil:_.max(f),onChange:function(b,c){a.CheckSliderSelection(),a.SetActiveElement(b,c)}}},away:{value:parseInt(b.awayValue),options:{id:"awaySlider_"+b.Id,showTicksValues:!0,floor:parseInt(c.Score.split(":")[1]),ceil:_.max(g),onChange:function(b,c){a.CheckSliderSelection(),a.SetActiveElement(b,c)}}}})}function o(a,b,c,d){var e=new Map,f=[];return angular.forEach(a,function(a){const f=e.get(a.Specifier);n(a,b,c,d),e.set(a.Specifier,(f?f:[]).concat(a))}),e.forEach(function(a,b){const c=b.split(/~/g),d=c[0],e=c[1]+" : "+c[2];f.push({title:locale.sports.live.lightningBetsMarketPrefix+e,markets:a.map(function(a){return a.Name=a.Name.includes(" - ")?a.Name.split(" - ")[1].split(d)[0]:a.Name.split(d)[0],a.Name+=d+")",a}),SortOrder:a[0].SortOrder,GroupNo:a[0].GroupNo})}),f}var p=this;if(this.liveMenuSettings=l.getLiveMenuSettings(),this.sportEventMatchIds=c.params.sportEventMatchIds,this.sportId=null,this.matchId=null,this.areaId=null,this.providerId=null,this.widgetAvailability=!1,this.collapsedList=l.getCollapsedLiveMenuList(),this.sportIdList=[],this.headerCollapsed=!0,this.showHeaderCollapsed=!1,this.filterQuery=p.liveMenuSettings.filterQuery||"",l.setLiveMenuSettings("filterQuery",p.filterQuery),this.selectedSport=p.liveMenuSettings.selectedSport||"all",l.setLiveMenuSettings("selectedSport",p.selectedSport),this.selectedTournament=p.liveMenuSettings.selectedTournament||("favourites"==p.selectedSport?"favourites":"all"),l.setLiveMenuSettings("selectedTournament",p.selectedTournament),this.favouriteEventsList=e.liveOverviewFavouriteEventsList||[],this.liveDiaryFavouriteEventsList=e.liveDiaryFavouriteEventsList||[],this.isExpandWidget=!1,this.setScrollbarsFooter=function(){globalSettings.General_ContentScrollBars?($(".live #leftContainer .eventOdds footer.footer-container").empty().html($("#divMainContainer > div > footer.footer-container > div").clone()),$(".live #leftContainer footer.footer-container").css("display","none"),$(".live #leftContainer .eventOdds footer.footer-container").css("display","flex")):$(".live #leftContainer .eventOdds footer.footer-container").css("display","none")},this.newAreaIds=globalSettings.Sports_NewAreaIds.split(","),this.lightningBetAreaId=globalSettings.Sports_LightningBetAreaId,b(function(){p.setScrollbarsFooter()}),null!=p.sportEventMatchIds){var q=p.sportEventMatchIds.split("-");this.sportId=q[0],this.matchId=q[1],this.providerId=q[2],this.areaId=q[3]||null,this.widgetAvailability=k.widgetAvailability(q[0])}this.toggleCollapsedList=function(a){if("all"===a)p.collapsedList.length>0?p.collapsedList=[]:p.collapsedList=p.sportIdList;else if("header"===a)p.headerCollapsed=!p.headerCollapsed;else{var b=p.collapsedList.indexOf(a);b>-1?p.collapsedList.splice(b,1):p.collapsedList.push(a)}l.setCollapsedLiveMenuList(p.collapsedList)},this.isSportCollapsed=function(a){return"all"==a?p.collapsedList.length>0:p.collapsedList.indexOf(a)>-1},this.changeArea=function(a){m.liveFeed.getLiveEventDetails(p.matchId,globalSettings.CurrentLanguage,a).then(function(a){var b=d.liveBettingCurrentEventJSON,c=[];a.success?c=a.data:h.logError("Unable to get live event details: "+JSON.stringify(a.error)),p.eventOddsData=p.checkEventOdds(c,b,!0),d.liveBettingCurrentEventJSON=c}),g.disableLiveEventViewOddsUpdates(),g.enableLiveEventViewOddsUpdates(p.matchId,a)},this.clearFilterText=function(){p.filterQuery="",l.setLiveMenuSettings("filterQuery",p.filterQuery),$("#txtFilterEvents").focus()},this.updateFilterText=function(){l.setLiveMenuSettings("filterQuery",p.filterQuery)},this.selectSport_click=function(a){"favourites"==a?0==p.favouriteEventsList.length?a="all":l.setLiveMenuSettings("selectedTournament","favourites"):l.setLiveMenuSettings("selectedTournament","all"),l.setLiveMenuSettings("selectedSport",a),f.go("liveOverview")},this.selectTournament_click=function(a){p.selectedTournament=a,l.setLiveMenuSettings("selectedTournament",p.selectedTournament),f.go("liveOverview")},this.addRemoveFavouriteEvents_click=function(a,b){var c=p.favouriteEventsList.indexOf(a+"|"+b);c>-1?p.favouriteEventsList.splice(c,1):p.favouriteEventsList.push(a+"|"+b),e.liveOverviewFavouriteEventsList=p.favouriteEventsList,"favourites"==p.selectedSport&&0==p.favouriteEventsList.length&&p.selectSport_click("all")},this.isFavouriteEvent=function(a,b){return p.favouriteEventsList.indexOf(a+"|"+b)>-1},this.removeHighlight=function(a){var b=new RegExp('<span class="highlight">',"gi"),c=new RegExp("</span>","gi");return a.replace(b,"").replace(c,"")},this.setHighlight=function(a,b){if(!b)return a;b=p.escapeRegExp(b);var c=new RegExp(b,"gi"),d=new RegExp("&amp;","gi");return a.replace(d,"&").replace(c,function(a){return'<span class="highlight">'+a+"</span>"})},this.escapeRegExp=function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},this.checkLeftMenuOdds=function(a){p.sportIdList=[];var b=[],c=[];if(a&&a.Sports&&a.Sports.length>0){for(var d=0;d<a.Sports.length;d++){var f=a.Sports[d];p.sportIdList.push(f.Id),f.isCollapsed=p.isSportCollapsed(f.Id),f.IsSelected=!1,f.Id==p.sportId&&(f.IsSelected=!0);for(var g=0;g<p.TournamentEvents(f.Tournaments,f.Id).length;g++){var h=p.TournamentEvents(f.Tournaments,f.Id)[g];h.IsSelected=!1,h.Id==p.matchId&&(h.IsSelected=!0),p.favouriteEventsList.indexOf(f.Id+"|"+h.Id)==-1&&p.liveDiaryFavouriteEventsList.indexOf(f.Id+"|"+h.Id)==-1||c.push(f.Id+"|"+h.Id)}"all"!=p.selectedSport&&"favourites"!=p.selectedSport&&p.favouriteEventsList.forEach(function(a){var c=a.split("|")[0];c!=f.Id&&b.push(a)})}b.push.apply(b,c),p.favouriteEventsList=b,e.liveOverviewFavouriteEventsList=b,"favourites"==p.selectedSport&&0==p.favouriteEventsList.length&&p.selectSport_click("all")}return a},this.TournamentEvents=function(a,b){var c=[];return angular.forEach(a,function(a){angular.forEach(a.Events,function(d){d.SportId=b,d.TournamentId=a.Id,d.TournamentName=a.Name,c.push(d)})}),c};var r=[];i.success?r=i.data:h.logError("Unable to get live events: "+JSON.stringify(i.error)),this.leftMenuData=this.checkLeftMenuOdds(r),a.$on("dataUpdateService:liveEventViewMenuDataUpdated",function(a,b){p.leftMenuData=p.checkLeftMenuOdds(b),p.showHeaderCollapsed=$(".sports-container").height()>38}),this.checkEventOdds=function(b,c,d){if(null!=b.Tournaments){var e=b.Tournaments[0].Events[0].Teams,g=a.eventTeam(e,1)+" - "+a.eventTeam(e,2);$(".live .widget-event-name").html(g);var h=[];angular.forEach(b.Tournaments[0].Events[0].Markets,function(a,e){a.SortOrder=e,0===a.GroupNo&&(n(a,b.Tournaments[0].Events[0],c,d),h.push(a))}),b.Tournaments[0].Events[0].Markets=_.sortBy(_.concat(o(b.Tournaments[0].Events[0].Markets.filter(function(a){return 1===a.GroupNo}),b.Tournaments[0].Events[0],c,d),h),function(a){return a.SortOrder})}else f.go("liveEventView");return b},this.expandCollapseWidget=function(){p.isExpandWidget=k.isWidgetPaused("match.lmtplus"),p.isExpandWidget?(k.resumeWidget("match.lmtplus"),k.isWidgetPaused("match.lmtplus-sidebar")&&k.resumeWidget("match.lmtplus-sidebar")):k.pauseWidget("match.lmtplus");
},this.backToOverview=function(){f.go("liveOverview")},a.SetActiveElement=function(b,c){a.$$postDigest(function(){for(var d=$("#"+b+" .rz-tick-value"),e=0;e<d.length;e++)if(d[e].textContent==c){$("#"+b+" .rz-tick-value").removeClass("active"),$("#"+b+" .rz-tick-value:eq("+e+")").addClass("active");break}a.$broadcast("reCalcViewDimensions")})},a.hasSelection=!0,a.CheckSliderSelection=function(){0==$(".contentSlider .oddContainer").children(":visible:not(.fakeEmpty)").length?a.hasSelection=!1:a.hasSelection=!0},d.liveBettingCurrentEvent=p.matchId,a.$on("dataUpdateService:liveEventViewOddsDataUpdated",function(a,b){var c=d.liveBettingCurrentEventJSON,e=p.matchId,f=d.liveBettingCurrentEvent,g=!1;null!=f&&e==f?g=!0:d.liveBettingCurrentEvent=e,p.eventOddsData=p.checkEventOdds(b,c,g),d.liveBettingCurrentEventJSON=b}),a.eventTeam=function(a,b){var c="",d=a.filter(function(a){return a.ItemOrder==b})[0];return void 0!=d&&(c=d.Name.trim()),c},a.eventClicked=function(a){var b=$(a.currentTarget),c=b.attr("data-sportid"),d=b.attr("data-eventid"),e=b.attr("data-matchid");f.go("liveEventViewByMatchIds",{sportEventMatchIds:c+"-"+d+"-"+e})},a.AddRemoveToCoupon=function(b){a.$emit("addRemoveToCoupon",b)},a.$on("onRepeatLast",function(b,c,d){"liveMenuList"==d.onLastRepeat?a.$emit("selectExistingOdds"):"liveOddsList"==d.onLastRepeat&&(a.$emit("selectExistingOdds"),$(".flashPrice.flashUp").css({"background-position":"0px 56px"}).animate({"background-position":"0px -56px"},1e3),$(".flashPrice.flashDown").css({"background-position":"0px -56px"}).animate({"background-position":"0px 56px"},1e3))}),globalSettings.BetRadarWidgetsEnabled&&null!=p.sportEventMatchIds&&(k.removeWidgets(),k.addWidgets(p.providerId,p.sportId,!0),b(function(){$(".middle-widget").hide(),$(".divWidget").show()}));var s=d.liveBettingCurrentEventJSON,t=[];j.success?t=j.data:h.logError("Unable to get live event details: "+JSON.stringify(j.error)),this.eventOddsData=this.checkEventOdds(t,s,!1),d.liveBettingCurrentEventJSON=t,null!=p.matchId&&(g.enableLiveEventViewMenuUpdates(p.selectedSport),g.enableLiveEventViewOddsUpdates(p.matchId,p.areaId),a.$on("$destroy",function(){g.disableLiveEventViewMenuUpdates(),g.disableLiveEventViewOddsUpdates()}))}])}(),function(){angular.module("liveMultiView",[]).controller("LiveBettingMultiViewController",["$scope","$state","dataMultiViewCall","dataUpdateService","loggingService","$sessionStorage","SRLiveService","$timeout",function(a,b,c,d,e,f,g,h){globalSettings.BetRadarWidgetsEnabled&&g.removeWidgets();var i,j,k,l,m=this;this.setScrollbarsFooter=function(){globalSettings.General_ContentScrollBars?($(".live #leftContainer footer.footer-container").empty().html($("#divMainContainer > div > footer.footer-container > div").clone()),$(".live #leftContainer footer.footer-container").css("display","flex")):$(".live #leftContainer footer.footer-container").css("display","none")},h(function(){m.setScrollbarsFooter()});var n=[];c.success?n=c.data:e.logError("Unable to get multiview event data: "+JSON.stringify(c.error)),0==n.length&&b.go("liveDiary",{}),a.$on("dataUpdateService:liveMultiViewDataUpdated",function(b,c){a.multiViewData=a.formatMultiView(c),f.liveBettingCurrentMultiViewJSON=c}),a.changeSport=function(b){a.SportId=b,a.multiViewData=a.formatMultiView(f.liveBettingCurrentMultiViewJSON)},a.formatMultiView=function(b){var c=!1,d="";angular.forEach(b,function(b){d=d+b.Id+"|"+b.EventCount+",",a.SportId==b.Id&&(c=!0)}),!c&&null!=b&&b.length>0&&(a.SportId=b[0].Id),""!=d&&(d=d.substring(0,d.length-1)),a.AvailableSportIds=[{AvailableSportIds:d}];var e=f.liveBettingCurrentMultiViewJSON,h=f.liveBettingMultiViewEvents,i=[],j=[];angular.forEach(b,function(b){a.SportId==b.Id&&(a.SportName=b.Name,angular.forEach(b.Tournaments,function(a){angular.forEach(a.Events,function(c){var d=!1;if(null!=h){i=h.split(",");for(var e=b.Id+"-"+a.Id+"-"+c.Id,f=0;f<i.length;f++)if(i[f]==e){d=!0;break}}d||(c.SportId=b.Id,c.TournamentId=a.Id,j.push(c))})}))}),a.UpperMenuEvents=[{UpperMenuEvents:j}];var k=[],l=[];return null!=h&&(i=h.split(","),angular.forEach(i,function(a){var c=a.split("-")[0],d=a.split("-")[1],f=a.split("-")[2],g=b.filter(function(a){return a.Id==c})[0];if(void 0!=g){var h=g.Tournaments.filter(function(a){return a.Id==d})[0];if(void 0!=h){var i=h.Events.filter(function(a){return a.Id==f})[0];void 0!=i&&(i.SportId=g.Id,i.SportName=g.Name,i.TournamentId=h.Id,i.TournamentName=h.Name,l.push({matchId:i.ProviderId,sportId:i.SportId}),angular.forEach(i.Markets,function(a){angular.forEach(a.Selections,function(b){var g="33.3%";if(2==a.Selections.length&&(g="50%"),a.SetOddsWidth=g,0!=b.Odds[0].Value)if(0!=b.Odds[0].Status){if(b.CurrentStatus="oddsAvailable",b.OddChanged="OddNotChanged",null!=e){var h=_.find(e,function(a){return a.Id==c});if(null==h)return;var i=_.find(h.Tournaments,function(a){return a.Id==d});if(null==i)return;var j=_.find(i.Events,function(a){return a.Id==f});if(null==j)return;var k=_.find(j.Markets,function(b){return b.Id==a.Id});if(null==k)return;var l=_.find(k.Selections,function(a){return a.Id==b.Id});if(null==l)return;l.Odds[0].Value>b.Odds[0].Value?b.OddChanged="OddChangedDown":l.Odds[0].Value<b.Odds[0].Value&&(b.OddChanged="OddChangedUp")}}else b.CurrentStatus="oddsLocked";else b.CurrentStatus="oddsEmpty"})}),k.push(i))}}})),a.PairMiddleEventsSelected=o(k),g.updateMultiView(l),b};var o=function(a){for(var b=a.slice(),c=[];b.length;)c.push(b.splice(0,2));return c};a.widgetAvailability=function(a){var b=globalSettings.Sports_BetRadarLiveWidgetHideIds.split(",").filter(function(b){return b==a})[0];return void 0==b},a.eventTeam=function(a,b){var c="",d=a.filter(function(a){return a.ItemOrder==b})[0];return void 0!=d&&(c=d.Name.toLowerCase()),c},a.SportId=1,a.multiViewData=a.formatMultiView(n),a.AddRemoveToCoupon=function(b){a.$emit("addRemoveToCoupon",b)};var p=function(a,b){globalSettings.BetRadarWidgetsEnabled&&g.addWidgets(b,a,!1)};a.ViewEventTracker_Clicked=function(a){var b=$(a.currentTarget),c=b.attr("data-sportId"),d=b.attr("data-matchId");p(c,d)},a.eventClicked=function(a){var c=$(a.currentTarget),d=c.attr("data-sportid"),e=c.attr("data-eventid"),f=c.attr("data-matchid");b.go("liveEventViewByMatchIds",{sportEventMatchIds:d+"-"+e+"-"+f})},a.AddMultiViewEvent_Clicked=function(b){var c=$(b.currentTarget);$("#divEventsSelected").removeClass("over"),$("#divEventsSelected").find("#dropHereIcon").removeClass("active");var d=c.attr("data-sportId"),e=c.attr("data-tournamentId"),g=c.attr("data-eventId"),h=d+"-"+e+"-"+g,i=f.liveBettingMultiViewEvents;i=null!=i?i+","+h:h,f.liveBettingMultiViewEvents=i,a.changeSport(d)},a.RemoveMultiViewEvent_Clicked=function(b){var c=$(b.currentTarget),d=c.attr("data-sportId"),e=c.attr("data-tournamentId"),g=c.attr("data-eventId"),h=d+"-"+e+"-"+g,i=f.liveBettingMultiViewEvents,j=[];if(null!=i){j=i.split(",");var k=j.indexOf(h);k>-1&&j.splice(k,1);var l="";j.forEach(function(a){l=l+a+","}),""!=l&&(l=l.substring(0,l.length-1)),""==l?delete f.liveBettingMultiViewEvents:f.liveBettingMultiViewEvents=l,a.changeSport(d)}},a.upperMenuEventsOptions={responsive:!0,mouseDrag:!1,touchDrag:!1,dots:!1,afterAction:function(a){i=this.owl.visibleItems}},a.upperMenuHeaderOptions={responsive:!0,dots:!1},a.$on("onRepeatLast",function(b,c,e){if("upperMenuEventsList"==e.onLastRepeat){a.$emit("selectExistingOdds"),$(".flashPrice.flashUp").css({"background-position":"0px 48px"}).animate({"background-position":"0px -48px"},1e3),$(".flashPrice.flashDown").css({"background-position":"0px -48px"}).animate({"background-position":"0px 48px"},1e3);var h=$("#owl-upperMultiView");null!=j&&h.trigger("owl.jumpTo",j[0]),$("#next").click(function(){h.trigger("next.owl.carousel")}),$("#prev").click(function(){h.trigger("prev.owl.carousel",[300])});var i=!1;$(".liveBettingItem").draggable({appendTo:"#divEventsSelected",revert:"invalid",helper:"clone",start:function(a,b){d.disableLiveMultiViewUpdates(),$(b.helper).width($(this).width()),$(b.helper).css("z-index",1004),$(this).css("opacity","0.2")},stop:function(b,c){var e=$(this).attr("data-sportId"),g=$(this).attr("data-tournamentId"),h=$(this).attr("data-eventId");$(this).attr("data-matchId");if(1==i){var j=e+"-"+g+"-"+h,k=f.liveBettingMultiViewEvents;k=null!=k?k+","+j:j,f.liveBettingMultiViewEvents=k}else $("#divEventsSelected").removeClass("over").removeClass("dropHereIcon"),$("#divEventsSelected").find("#dropHereIcon").removeClass("active");a.changeSport(e),d.enableLiveMultiViewUpdates(),i=!1}}),$("#divEventsSelected").droppable({drop:function(a,b){i=!0,$(this).removeClass("over"),$(this).find("#dropHereIcon").removeClass("active")},over:function(a,b){$(a.currentTarget).hasClass("liveBettingItem")&&($(this).addClass("over").addClass("dropHereIcon"),$(this).find("#dropHereIcon").addClass("active"))},out:function(a,b){$(a.currentTarget).hasClass("liveBettingItem")&&($(this).removeClass("over").removeClass("dropHereIcon"),$(this).find("#dropHereIcon").removeClass("active"))}});var m=f.liveBettingMultiViewEvents;if(null==m||""==m)$("#divEventsSelected").find("#dropHereIcon").addClass("active"),globalSettings.BetRadarWidgetsEnabled&&g.removeWidgets();else{var n=m.split(","),o=n[0].split("-")[0],q=n[0].split("-")[1],r=n[0].split("-")[2],s=a.multiViewData.filter(function(a){return a.Id==o})[0];if(void 0!=s){var t=s.Tournaments.filter(function(a){return a.Id==q})[0];if(void 0!=t){var u=t.Events.filter(function(a){return a.Id==r})[0];void 0!=u&&(currentFirstSportId=o,currentFirstMatchId=u.ProviderId)}}currentFirstSportId+"_"+currentFirstMatchId!=k+"_"+l&&(k=currentFirstSportId,l=currentFirstMatchId,isFirst=!0),isFirst&&(p(k,l),isFirst=!1)}$(".divPairContainer").sortable({connectWith:".divPairContainer",handle:".eventHeaderItem",start:function(a,b){d.disableLiveMultiViewUpdates()},stop:function(b,c){var e="";$(".divMultiView").each(function(){e=e+$(this).attr("id")+","}),0!=e.length&&(e=e.substring(0,e.length-1)),f.liveBettingMultiViewEvents=e,a.changeSport($(".aItemSport .selected").attr("id")),d.enableLiveMultiViewUpdates()}}),$(".divMultiView").each(function(){$(this).height($(this).parent().height()-10)})}}),d.enableLiveMultiViewUpdates(),a.$on("$destroy",function(){d.disableLiveMultiViewUpdates()})}])}(),function(){angular.module("liveOverview",[]).controller("LiveBettingOverviewController",["$scope","$timeout","$state","dataOverviewCall","dataUpdateService","loggingService","SRLiveService","liveService","sportsApiService","$sessionStorage","$localStorage",function(a,b,c,d,e,f,g,h,i,j,k){var l=this;this.liveMenuSettings=h.getLiveMenuSettings(),this.filterQuery=l.liveMenuSettings.filterQuery||"",h.setLiveMenuSettings("filterQuery",l.filterQuery),this.selectedSport=l.liveMenuSettings.selectedSport||"all",h.setLiveMenuSettings("selectedSport",l.selectedSport),this.selectedTournament=l.liveMenuSettings.selectedTournament||("favourites"==l.selectedSport?"favourites":"all"),h.setLiveMenuSettings("selectedTournament",l.selectedTournament),this.favouriteEventsList=k.liveOverviewFavouriteEventsList||[],this.liveDiaryFavouriteEventsList=k.liveDiaryFavouriteEventsList||[],this.selectedWidget,this.setScrollbarsFooter=function(){globalSettings.General_ContentScrollBars?($(".live #leftContainer footer.footer-container").empty().html($("#divMainContainer > div > footer.footer-container > div").clone()),$(".live #leftContainer footer.footer-container").css("display","flex")):$(".live #leftContainer footer.footer-container").css("display","none")},b(function(){l.setScrollbarsFooter()}),this.collapsedList=h.getCollapsedLiveMenuList(),this.headerCollapsed=!0,this.showHeaderCollapsed=!1,this.selectedMarkets={},this.selectedMatchMarketGroup=[],this.clearFilterText=function(){l.filterQuery="",h.setLiveMenuSettings("filterQuery",l.filterQuery),$("#txtFilterEvents").focus()},this.updateFilterText=function(){h.setLiveMenuSettings("filterQuery",l.filterQuery)},this.selectSport_click=function(b){if(b!=l.selectedSport){var c=b;"all"!=b&&"favourites"!=b||(c=0),"favourites"==b&&0==l.favouriteEventsList.length&&(b="all"),i.liveFeed.getLiveAreaOddsByLayout(globalSettings.CurrentLanguage,c,3,0,!1,!1,!0,!0).then(function(c){var d=j.liveBettingCurrentOverviewJSON,e=[];c.success?e=c.data:f.logError("Unable to get live event details: "+JSON.stringify(c.error)),l.selectedSport=b,h.setLiveMenuSettings("selectedSport",l.selectedSport),l.selectedTournament="favourites"==b?"favourites":"all",h.setLiveMenuSettings("selectedTournament",l.selectedTournament),a.overviewData=a.formatOverview(e,d),j.liveBettingCurrentOverviewJSON=e}),e.disableLiveOverviewUpdates(),e.enableLiveOverviewUpdates(c,0)}},this.sportAreasAvailability=function(a){var b=globalSettings.Sports_LiveSportsAreasAvailability.split(",").filter(function(b){return b==a})[0];return void 0!=b},this.selectTournament_click=function(a){l.selectedTournament=a,h.setLiveMenuSettings("selectedTournament",l.selectedTournament)},this.selectArea_click=function(b){i.liveFeed.getLiveAreaOddsByLayout(globalSettings.CurrentLanguage,l.selectedSport,3,b,!1,!1,!0,!0).then(function(b){var c=j.liveBettingCurrentOverviewJSON,d=[];b.success?d=b.data:f.logError("Unable to get live event details: "+JSON.stringify(b.error)),a.overviewData=a.formatOverview(d,c),j.liveBettingCurrentOverviewJSON=d}),e.disableLiveOverviewUpdates(),e.enableLiveOverviewUpdates(l.selectedSport,b)},this.addRemoveFavouriteEvents_click=function(a,b){var c=l.favouriteEventsList.indexOf(a+"|"+b);c>-1?l.favouriteEventsList.splice(c,1):l.favouriteEventsList.push(a+"|"+b),k.liveOverviewFavouriteEventsList=l.favouriteEventsList,"favourites"==l.selectedSport&&0==l.favouriteEventsList.length&&l.selectSport_click("all")},this.isFavouriteEvent=function(a,b){return l.favouriteEventsList.indexOf(a+"|"+b)>-1},this.toggleCollapsedList=function(a){if("all"===a)l.collapsedList.length>0?l.collapsedList=[]:l.collapsedList=l.sportIdList;else if("header"===a)l.headerCollapsed=!l.headerCollapsed;else{var b=l.collapsedList.indexOf(a);b>-1?l.collapsedList.splice(b,1):l.collapsedList.push(a)}h.setCollapsedLiveMenuList(l.collapsedList)},this.isSportCollapsed=function(a){return"all"==a?l.collapsedList.length>0:l.collapsedList.indexOf(a)>-1},a.TournamentEvents=function(a,b){var c=[];return angular.forEach(a,function(a){angular.forEach(a.Events,function(d){d.SportId=b,d.TournamentId=a.Id,d.TournamentName=a.Name,c.push(d)})}),c},a.widgetAvailability=function(a){var b=globalSettings.Sports_BetRadarLiveWidgetHideIds.split(",").filter(function(b){return b==a})[0];return void 0==b},a.eventTeam=function(a,b){var c="",d=a.filter(function(a){return a.ItemOrder==b})[0];return void 0!=d&&(c=d.Name),c},a.formatOverview=function(b,c){if(b&&b.SportsMarkets&&b.SportsMarkets.length>0)for(var d=0;d<b.SportsMarkets.length;d++)b.SportsMarkets[d].Markets.length>3&&(b.SportsMarkets[d].Markets=b.SportsMarkets[d].Markets.slice(0,3));l.sportIdList=[];var e=[],f=[];if(b&&b.Sports&&b.Sports.length>0){for(var d=0;d<b.Sports.length;d++){var g=b.Sports[d];l.sportIdList.push(g.Id),g.isCollapsed=l.isSportCollapsed(g.Id),g.markets=[],g.headers=[],l.generateMarkets(b,g),l.generateHeaders(g);for(var h=0;h<a.TournamentEvents(g.Tournaments,g.Id).length;h++){var i=a.TournamentEvents(g.Tournaments,g.Id)[h];l.favouriteEventsList.indexOf(g.Id+"|"+i.Id)==-1&&l.liveDiaryFavouriteEventsList.indexOf(g.Id+"|"+i.Id)==-1||f.push(g.Id+"|"+i.Id),i.odds={},l.parseOdds(g,i);var j=0;Object.keys(i.odds).forEach(function(a){j+=i.odds[a].oddValue?i.odds[a].oddValue:0}),i.trackByKey=[i.Id,i.Score?i.Score:"",j].join("_")}"all"!=l.selectedSport&&"favourites"!=l.selectedSport&&l.favouriteEventsList.forEach(function(a){var b=a.split("|")[0];b!=g.Id&&e.push(a)})}e.push.apply(e,f),l.favouriteEventsList=e,k.liveOverviewFavouriteEventsList=e,"favourites"==l.selectedSport&&0==l.favouriteEventsList.length&&l.selectSport_click("all")}return b},this.generateMarkets=function(a,b){var c=_.find(a.SportsMarkets,function(a){return a.Id==b.Id});if(c&&c.Markets&&c.Markets.length>0){for(var d=[],e=0;e<c.Markets.length;e++){var f=c.Markets[e];f.Selections&&(f.HasSpread?f.Selections.length>2?f.columnCount=f.Selections.length:f.columnCount=f.Selections.length+1:f.columnCount=f.Selections.length,d.push(f))}b.markets=d}},this.generateHeaders=function(a){for(var b=!0,c=0;c<a.markets.length;c++){var d=!0;b=!b;var e=a.markets[c];if(e.Selections)if(e.HasSpread)for(var f=!0,g=0;g<e.Selections.length;g++){var h=e.Selections[g];h.uniqueKey=[e.TypeId,h.TypeId,h.Name].join("_"),h.isAlternate=b,h.isNewMarket=d,d=!1,f&&e.Selections.length<3?(a.headers.push(h),a.headers.push({marketId:e.TypeId,uniqueKey:[e.TypeId,h.TypeId,"spread"].join("_"),isHeaderOnly:!0,Name:locale.sports.events.eventOdds.spread,isNewMarket:d,isAlternate:b}),d=!1,f=!1):f&&1==g?(h.spreadUniqueKey=[e.TypeId,h.TypeId,"spread"].join("_"),h.columnCount=e.Selections.length,a.headers.push(h),d=!1,f=!1):a.headers.push(h)}else for(var g=0;g<e.Selections.length;g++){var h=e.Selections[g];h.uniqueKey=[e.TypeId,h.TypeId,h.Name].join("_"),h.isAlternate=b,h.isNewMarket=d,d=!1,a.headers.push(h)}}},this.parseOdds=function(a,b){if(!b.Markets)return!1;for(var c="",d=!0,e=0;e<b.Markets.length;e++){d=!d;var f=b.Markets[e],g=f.Id,h=f.TypeId,i=f.Name,k=f.Status,m=f.SpecialValue,n=m&&""!=m;if(n)for(var o=0;o<f.Selections.length;o++){var p=f.Selections[o],q=p.Id,r=p.TypeId,s=p.Name,t=[b.Id,h,m].join("_"),u=[h,r,"spread"].join("_");u=[u,m].join("|"),b.odds[u]={uniqueKey:u,matchMarketUniqueKey:t,isOddValue:!1,value:m,combinability:"spread",matchId:b.Id,marketTypeId:h,spreadValue:m};var u=[h,r,s].join("_");u=[u,m].join("|"),b.odds[u]={oddId:q,uniqueKey:u,matchMarketUniqueKey:t,marketId:g,marketName:i,marketTypeId:h,marketStatus:k,selectionId:q,selectionTypeId:r,selectionName:s,isOddValue:!0,value:p.Odds?p.Odds[0].Value.toFixed(2):null,oddValue:p.Odds?p.Odds[0].Value:null,oddStatus:p.Odds?p.Odds[0].Status:null,spreadValue:m,combinability:f.Combinability,isAlternate:d,sportId:a.Id,sportName:a.Name,matchId:b.Id,matchProviderId:b.ProviderId,matchName:b.Name,matchDate:b.Date,tournamentId:b.TournamentId,tournamentName:b.TournamentName,categoryId:b.CategoryId,categoryName:b.CategoryName}}else{for(var v=j.SportsbookMarketTypeIds?j.SportsbookMarketTypeIds.filter(function(a){return"1X2"===a.LookupCode}):[],w=j.SportsbookMarketTypeIds?j.SportsbookMarketTypeIds.filter(function(a){return"1-2"===a.LookupCode}):[],x=v.length?v[0].IDMarketType:10,y=w.length?w[0].IDMarketType:20,o=0;o<f.Selections.length;o++){var p=f.Selections[o],q=p.Id,r=p.TypeId,s=p.Name,u=[h,r,s].join("_");b.odds[u]={oddId:q,uniqueKey:u,marketId:g,marketName:i,marketTypeId:h,selectionId:q,selectionTypeId:r,selectionName:s,isOddValue:!0,value:p.Odds?p.Odds[0].Value.toFixed(2):null,oddValue:p.Odds?p.Odds[0].Value:null,oddStatus:p.Odds?p.Odds[0].Status:null,spreadValue:m,combinability:f.Combinability,isAlternate:d,sportId:a.Id,sportName:a.Name,matchId:b.Id,matchProviderId:b.ProviderId,matchName:b.Name,matchDate:b.Date,tournamentId:b.TournamentId,tournamentName:b.TournamentName,categoryId:b.CategoryId,categoryName:b.CategoryName},h!=x&&h!=y||(c+=s+"|"+p.Odds.Value+",")}b.tooltipOdds=c}}a.headers.forEach(function(a){var c=l.spreadMarketsGroups(b.odds,a.uniqueKey);if(c&&c.length>1){var d,e=[c[0].matchId,c[0].marketTypeId].join("_"),f=!1;l.selectedMatchMarketGroup.forEach(function(a){if(a&&a.toString().startsWith(e)){var b=c.filter(function(b){return b.matchMarketUniqueKey==a});return void(b&&b.length>0?f=!0:(f=!1,d=a))}}),d&&(l.selectedMatchMarketGroup=l.selectedMatchMarketGroup.filter(function(a){return a!=d})),f||l.selectedMatchMarketGroup.push([e,c[0].spreadValue].join("_"));var g=0;c.forEach(function(a){b.odds[a.uniqueKey].prevClick=g-1,b.odds[a.uniqueKey].nextClick=g+1,b.odds[a.uniqueKey].hasMarketGroup=!0,b.odds[a.uniqueKey].marketGroupCount=c.length,g++})}}),b.oddsLength=Object.keys(b.odds).length},this.findValueByPrefix=function(a,b,c){c||(c=0);var d=0;for(var e in a)if(a.hasOwnProperty(e)&&e.toString().startsWith(b)){if(d==c)return a[e];d++}},this.spreadMarketsGroups=function(a,b){var c=[];for(var d in a)a.hasOwnProperty(d)&&d.toString().startsWith(b)&&c.push(a[d]);return c},this.prevSpreadOdds_click=function(a,b,c){if(c.prevClick!=-1){var d=l.findValueByPrefix(a,b,c.prevClick);d&&(l.selectedMatchMarketGroup.push(d.matchMarketUniqueKey),l.selectedMatchMarketGroup=l.selectedMatchMarketGroup.filter(function(a){return a!=c.matchMarketUniqueKey}))}},this.nextSpreadOdds_click=function(a,b,c){if(c.nextClick!=c.marketGroupCount){var d=l.findValueByPrefix(a,b,c.nextClick);d&&(l.selectedMatchMarketGroup.push(d.matchMarketUniqueKey),l.selectedMatchMarketGroup=l.selectedMatchMarketGroup.filter(function(a){return a!=c.matchMarketUniqueKey}))}};var m=function(a){var b=$(a),c=b.children("div").eq(1);c.find("tr.event-row:eq(0)")},n=j.liveBettingCurrentOverviewJSON,o=[];d.success?o=d.data:f.logError("Unable to get multiview event data: "+JSON.stringify(d.error)),o.Sports&&0==o.Sports.length&&c.go("liveDiary",{}),a.overviewData=a.formatOverview(o,n),j.liveBettingCurrentOverviewJSON=o;var p=function(a){if(a&&a.Sports&&a.Sports.length>0)for(var b=0;b<a.Sports.length;b++)m(".tblEventOdds_live_"+a.Sports[b].Id);$(".table-cell-event .event").each(function(){if($(this).text().length>55){var a=$(this).html();$(this).attr("title",$(this).text()),a=a.substr(0,98)+"...",$(this).html(a)}})};if(b(function(){p(o)}.bind(this),10),$(window).resize(function(){for(var a=0;a<o.Sports.length;a++)m(".tblEventOdds_live_"+o.Sports[a].Id)}),a.$on("dataUpdateService:liveOverviewDataUpdated",function(c,d){var e=j.liveBettingCurrentOverviewJSON;a.overviewData=a.formatOverview(d,e),j.liveBettingCurrentOverviewJSON=d,b(function(){p(d)}.bind(this),10),l.showHeaderCollapsed=$(".sports-container").height()>38,$(window).resize(function(){if(d&&d.Sports&&d.Sports.length>0){l.showHeaderCollapsed=$(".sports-container").height()>38;for(var a=0;a<d.Sports.length;a++)m(".tblEventOdds_live_"+d.Sports[a].Id)}})}),a.AddRemoveToCoupon=function(b,c){null!=c&&0!=c.marketStatus&&0!=c.oddStatus&&c.isOddValue&&a.$emit("addRemoveToCoupon",b)},a.$on("onRepeatLast",function(b,c,d){"overviewList"==d.onLastRepeat&&a.$emit("selectExistingOdds")}),a.overviewData&&a.overviewData.Sports&&a.overviewData.Sports.length>0){var q=a.overviewData.Sports[0].Id,r=a.overviewData.Sports[0].Tournaments[0].Events[0].ProviderId,s=a.overviewData.Sports[0].Tournaments[0].Events[0].Teams,t=a.eventTeam(s,1)+" - "+a.eventTeam(s,2);this.selectedWidget=r,$(".live .widget-event-name").html(t),globalSettings.BetRadarWidgetsEnabled&&g.addWidgets(r,q,!1)}a.ViewEventTracker_Clicked=function(b,c,d){var e=a.eventTeam(d,1)+" - "+a.eventTeam(d,2);l.selectedWidget=c,$(".live .widget-event-name").html(e),globalSettings.BetRadarWidgetsEnabled&&g.addWidgets(c,b,!1)},a.changeMarket_Clicked=function(b,c){l.selectedMarkets[b]=c,a.overviewData=a.formatOverview(o,n)},"all"==l.selectedSport||"favourites"==l.selectedSport?e.enableLiveOverviewUpdates(0,0):e.enableLiveOverviewUpdates(l.selectedSport,0),a.$on("$destroy",function(){e.disableLiveOverviewUpdates()})}])}(),function(){angular.module("casinoGames",[]).controller("casinoGamesCtrl",["platformApiService","$timeout","$compile","$window","$rootScope","$scope","$sce","authService","ngDialog","helperService",function(a,b,c,d,e,f,g,h,i,j){var k=this,l=a.gamingVendors.casinoGames;this.vendors=[{name:locale.common.vendors.allProviders,vendor:"",active:!0}],this.selects=this.vendors[0],this.CasinoGames={CasinoMainMenu:[{sortId:0,target:"_blank",visible:!0,description:"CASINO SECTION",Code:"casino-new",subMenu:"CasinoSubMenu"},{sortId:1,target:"_blank",visible:!0,description:"SLOTS SECTION",Code:"slots-all",subMenu:null},{sortId:3,target:"_blank",visible:!0,description:"LIVEGAMES SKINS",Code:"livecasino-skins",subMenu:null},{sortId:4,target:"_blank",visible:!0,description:"GAMES SECTION",Code:"games-all",subMenu:"GamesSubMenu"},{sortId:5,target:"_blank",visible:!0,description:"BETFIVE5 GAMES SECTION",Code:"games-bingo-keno",subMenu:"BetFive5GamesSubMenu"},{sortId:6,target:"_blank",visible:!0,description:"SKINS CASINO SECTION",Code:"casino-slots",subMenu:"CasinoSkinsSubMenu"},{sortId:8,target:"_blank",visible:!0,description:"CASINO SECTION NEW",Code:"new-casino-new",subMenu:"NewCasinoSubMenu"}],NewCasinoSubMenu:[{sortId:1,target:"_blank",visible:!0,description:"CASINO SECTION ALL",Code:"new-casino-all"},{sortId:2,target:"_blank",visible:!0,description:"CASINO SECTION TOP",Code:"new-casino-top"},{sortId:0,target:"_blank",visible:!0,description:"CASINO SECTION NEW",Code:"new-casino-new"},{sortId:3,target:"_blank",visible:!0,description:"CASINO SECTION SLOTS",Code:"new-casino-slots"},{sortId:8,target:"_blank",visible:!0,description:"CASINO SECTION CARD",Code:"new-casino-card"},{sortId:9,target:"_blank",visible:!0,description:"CASINO SECTION ROULETTE",Code:"new-casino-roulette"},{sortId:6,target:"_blank",visible:!0,description:"CASINO SECTION VIDEO POKER",Code:"new-casino-video-poker"},{sortId:5,target:"_blank",visible:!0,description:"CASINO SECTION GAMES",Code:"new-casino-games"},{sortId:7,target:"_blank",visible:!1,description:"CASINO SECTION RACE SLOTS",Code:"new-casino-race-slots"},{sortId:4,target:"_blank",visible:!1,description:"CASINO SECTION LIVE GAMES",Code:"new-casino-live-games"},{sortId:99,target:"_blank",visible:!1,description:"TEMPORARY HTML5 SECTION",Code:"new-casino-html"}],CasinoSkinsSubMenu:[{sortId:0,target:"_blank",visible:!0,description:"CASINO SECTION ALL",Code:"casino-all"},{sortId:1,target:"_blank",visible:!0,description:"CASINO SECTION SLOTS",Code:"casino-slots"},{sortId:2,target:"_blank",visible:!0,description:"CASINO SECTION CARD",Code:"casino-card-games"},{sortId:3,target:"_blank",visible:!0,description:"CASINO SECTION ROULETTE",Code:"casino-roulette"},{sortId:4,target:"_blank",visible:!0,description:"CASINO SECTION VIDEO POKER",Code:"casino-video-poker"},{sortId:5,target:"_blank",visible:!1,description:"CASINO SECTION SPECIAL GAMES",Code:"casino-special-games"},{sortId:6,target:"_blank",visible:!1,description:"CASINO SECTION FAVOURITES",Code:"casino-favourites"},{sortId:7,target:"_blank",visible:!1,description:"CASINO SECTION MORE GAMES",Code:"casino-more-games"},{sortId:8,target:"_blank",visible:!0,description:"CASINO SECTION LIVE GAMES",Code:"casino-live-games"}]},this.ImageResourceURL=globalSettings.ImageResourceURL,this.search,this.active={},this.liveGameCategories={},this.liveGamesGames=k.liveGamesGames,this.liveGamesSelectedGame={},this.platformTypeCode="DESK",this.categoryCode="casino-top",this.thumbnailWidth=k.CasinoGames.CasinoMainMenu[2].ThumbnailSize,this.API=k.API,this.ErrorsInLiveCasinoGamesService={},this.MainMenuList=k.CasinoGames.CasinoMainMenu,this.bannerRotat=k.bannerRotat,this.userLogged=h.hasValidLogin(),this.showSubMenu=function(a){k.categoryCode=a,k.getGames(),k.active=a},this.getGames=function(){l.games(k.platformTypeCode,k.categoryCode).then(function(a){if(!a.success){var b=j.handlePlatformError(a);return void(b||j.showErrorMessage(a.userMsg).done())}k.liveGamesGames=a.data;var c=_.uniqBy(a.data,"VendorName"),d=[];_.forEach(c,function(a){_.forEach(locale.common.vendors,function(b,c){if(a.VendorName.toLowerCase()===c.toLowerCase())return d.push({name:locale.common.vendors[c],vendor:a.VendorName,active:!1}),!1})}),d.unshift({name:locale.common.vendors.allProviders,vendor:"",active:!0}),angular.copy(d,k.vendors),k.selects=k.vendors[0],0===a.data.length&&j.showErrorMessage(locale.common.gamesNotAvailable).done()})},this.urlChecker=function(a){return window.location.href.indexOf("https://")>-1&&a.indexOf("http://")&&(a=a.replace("http://","https://")),window.location.href.indexOf("http://")>-1&&a.indexOf("https://")&&(a=a.replace("https://","http://")),a},this.getGameUrl=function(a,b,c,d){return k.userLogged?void l.getGameUrl(a,k.platformTypeCode,b).then(function(a){return a.success?void k.openPopupWindow(a.data,c,d):void j.showErrorMessage(a.userMsg).done()}):void k.openLoginDialog()},this.urlThumbChecker=function(a){var b=a.substring(a.lastIndexOf("/")+1);return a=globalSettings.ImageResourceURL+"casinoGames/casinoAll/"+b},this.urlRibbonChecker=function(a){return urlRibbon=globalSettings.ImageResourceURL+"casinoGames/vendorRibbons/"+localeSettings.brandName+"_"+a+".png",urlRibbon};var m="";this.openLoginDialog=function(){var a=i.open({template:"/partials/login/loginDialog.html",className:"loginForm",name:"LoginDialog",id:"LoginDialog",controller:"AuthController",controllerAs:"authCtrl"});m=a.id},f.$watch(function(){return h.hasValidLogin()},function(a,b){a!=b&&(k.userLogged=a,k.getGames(),a&&i.isOpen(m)&&i.close(m))}),this.openPopupWindow=function(a,b,c){return $.fancybox({padding:2,transitionIn:"elastic",transitionOut:"elastic",speedIn:600,speedOut:200,overlayShow:!0,centerOnScroll:!0,titleShow:!0,autosize:!1,type:"iframe",href:a,showCloseButton:!1,width:c,height:b,title:'<div class="expand"><i class="fa fa-expand" aria-hidden="true"></i></div><div class="closeButton" ><i class="fa fa-times" aria-hidden="true"></i></div>',helpers:{overlay:{closeClick:!1}},afterShow:function(a,b){$(".expand").click(function(){$(".fancybox-wrap").toggleClass("fullFancy"),$(".expand").css({display:"none",visibility:"hidden"})}),$(".closeButton").click(function(){$.fancybox.close()})}}),!1}}])}(),function(){angular.module("liveCasinoGames",[]).controller("liveCasinoGamesCtrl",["platformApiService","$timeout","$compile","$window","$rootScope","$scope","$sce","authService","ngDialog","helperService",function(a,b,c,d,e,f,g,h,i,j){var k=this,l=a.gamingVendors.casinoGames;this.liveGamesGames=k.liveGamesGames,this.ImageResourceURL=globalSettings.ImageResourceURL,this.active={},this.liveGamesGames=k.liveGamesGames,this.liveGamesSelectedGame={},this.platformTypeCode="DESK",this.categoryCode="casino-top",this.ErrorsInLiveCasinoGamesService={},this.userLogged=h.hasValidLogin(),this.showSubMenu=function(a){k.categoryCode=a,k.getGames(),k.active=a},this.getGames=function(){l.games(k.platformTypeCode,k.categoryCode).then(function(a){if(!a.success){var b=j.handlePlatformError(a);return void(b||j.showErrorMessage(a.userMsg).done())}k.liveGamesGames=a.data,0===a.data.length&&j.showErrorMessage(locale.common.gamesNotAvailable).done()})},this.getGameUrl=function(a,b,c,d){return k.userLogged?void l.getGameUrl(a,k.platformTypeCode,b).then(function(a){if(!a.success){var b=j.handlePlatformError(a);return void(b||j.showErrorMessage(a.userMsg).done())}k.openPopupWindow(a.data,c,d)}):void k.openLoginDialog()},this.urlChecker=function(a){return window.location.href.indexOf("https://")>-1&&a.indexOf("http://")&&(a=a.replace("http://","https://")),window.location.href.indexOf("http://")>-1&&a.indexOf("https://")&&(a=a.replace("https://","http://")),a},this.urlThumbChecker=function(a){var b=a.substring(a.lastIndexOf("/")+1);return a=globalSettings.ImageResourceURL+"casinoGames/livecasino/"+b},this.urlRibbonChecker=function(a){return urlRibbon=globalSettings.ImageResourceURL+"casinoGames/vendorRibbons/"+localeSettings.brandName+"_"+a+".png",urlRibbon};var m="";this.openLoginDialog=function(){var a=i.open({template:"/partials/login/loginDialog.html",className:"loginForm",name:"LoginDialog",id:"LoginDialog",controller:"AuthController",controllerAs:"authCtrl"});m=a.id},f.$watch(function(){return h.hasValidLogin()},function(a,b){b!=a&&(k.userLogged=a,k.getGames(),a&&i.isOpen(m)&&i.close(m))}),this.openPopupWindow=function(a,b,c){return $.fancybox({padding:2,transitionIn:"elastic",transitionOut:"elastic",speedIn:600,speedOut:200,overlayShow:!0,centerOnScroll:!0,titleShow:!0,autosize:!1,type:"iframe",href:a,showCloseButton:!1,width:c,height:b,title:'<div class="expand"><i class="fa fa-expand" aria-hidden="true"></i></div><div class="closeButton" ><i class="fa fa-times" aria-hidden="true"></i></div>',helpers:{overlay:{closeClick:!1}},afterShow:function(a,b){$(".expand").click(function(){$(".fancybox-overlay").toggleClass("fullFancy"),$(".expand").css({display:"none",visibility:"hidden"})}),
$(".closeButton").click(function(){$.fancybox.close()})}}),!1}}])}(),function(){angular.module("virtualGames",[]).controller("virtualGamesCtrl",["platformApiService","$timeout","$compile","$window","$rootScope","$scope","$sce","authService","ngDialog","helperService",function(a,b,c,d,e,f,g,h,i,j){var k=this,l=a.gamingVendors.globalBet;this.ErrorsInLiveCasinoGamesService={},this.globalBetPage={},f.$watch(function(){return h.hasValidLogin()},function(a,b){k.loadGlobalBet()}),this.loadGlobalBet=function(a){l.getLogoutUrl().then(function(a){return a.success?void(0!=a.data.length&&$.ajax({url:a.data,xhrFields:{withCredentials:!0}})):void(k.ErrorsInLiveCasinoGamesService.SubmissionError=a.userMsg)}),l.getGameFrameUrl("WEB").then(function(a){if(!a.success)return k.ErrorsInLiveCasinoGamesService.SubmissionError=a.userMsg,void j.showErrorMessage(locale.common.gamesNotAvailable).done();var b=a.data;k.globalBetPage={src:g.trustAsResourceUrl(encodeURI(b))}})},this.urlChecker=function(a){return window.location.href.indexOf("https://")>-1&&a.indexOf("http://")&&(a=a.replace("http://","https://")),window.location.href.indexOf("http://")>-1&&a.indexOf("https://")&&(a=a.replace("https://","http://")),a}}]).controller("virtualLeagueTvCtrl",["$scope","$sce","authService",function(a,b,c){var d=this;this.leagueTvUrl=globalSettings.LeagueTvUrl,this.leagueTvPage={},a.$watch(function(){return c.hasValidLogin()},function(a,b){d.loadLeagueTV()}),this.loadLeagueTV=function(){d.leagueTvPage={src:b.trustAsResourceUrl(encodeURI(d.leagueTvUrl))}}}]).controller("goldenRaceCashierCtrl",["$scope","platformApiService","helperService","loggingService","$sce","authService",function(a,b,c,d,e,f){var g=this,h=b.gamingVendors.goldenRace;this.iFreamPath="",a.$watch(function(){return f.hasValidLogin()},function(a,b){g.loadGoldenRace()}),this.loadGoldenRace=function(){h.getCashierUrl().then(function(a){if(!a.success){d.logError("Unable to load Golden Race Cashier: "+a.error,a.userMsg);var b=c.handlePlatformError(a);return void(b||c.showErrorMessage(a.userMsg).done())}g.openPopupWindow(a.data)})},g.openPopupWindow=function(a){return $.fancybox({padding:"1",margin:"2",transitionIn:"elastic",transitionOut:"elastic",speedIn:600,speedOut:200,overlayShow:!0,centerOnScroll:!0,titleShow:!0,autosize:!0,type:"iframe",href:a,showCloseButton:!1,width:"100%",height:"100%",helpers:{overlay:{closeClick:!1}},afterShow:function(a,b){$(".closeButton").click(function(){$.fancybox.close()})}}),!1}}]).controller("globalBetCashierCtrl",["$scope","platformApiService","helperService","loggingService","$sce","authService",function(a,b,c,d,e,f){var g=this,h=b.gamingVendors.globalBet;this.iFreamPath={},this.loadGlobalBetCashier=function(a){h.getGameFrameUrl("SHOP").then(function(a){if(!a.success){d.logError("Unable to load Global Bet Cashier: "+a.error,a.userMsg);var b=c.handlePlatformError(a);return void(b||c.showErrorMessage(a.userMsg).done())}var f=a.data;g.iFreamPath={src:e.trustAsResourceUrl(encodeURI(f))}})},g.loadGlobalBetCashier()}]).controller("onlineVirtualBetsControler",["$scope","$location","platformApiService","helperService","loggingService","$sce","authService","$window",function(a,b,c,d,e,f,g,h){var i=this,j=c.gamingVendors.globalBet;this.iFreamPath={},a.$watch(function(){return g.hasValidLogin()},function(a,b){a!=b&&i.loadOnlineVirtual()}),this.loadOnlineVirtual=function(){$("#globalbet").empty(),j.getGameFrameUrl("WEB").then(function(a){if(!a.success){e.logError("Unable to load Online Virtual: "+a.error,a.userMsg);var b=d.handlePlatformError(a);return void(b||d.showErrorMessage(a.userMsg).done())}var c=a.data.replace("vspro.jsp","vspro-headless.jsp");$(document).ready(function(){var a=document.getElementById("globalbet");widgetAdapter.registerVirtualSports(a,encodeURI(c))},{sticky:!0})})},i.loadOnlineVirtual()}])}(),function(){angular.module("partners",[]).controller("partnersController",["$scope","$anchorScroll",function(a,b){this.scrollToElement=function(a){b(a)}}])}(),function(){angular.module("poker",[]).controller("PokerController",["$rootScope","platformApiService","authService","helperService","loggingService",function(a,b,c,d,e){var f=this,g=b.gamingVendors.poker;this.clientDonwloadLinks=[],this.userLoggedIn=c.hasValidLogin(),this.userHasPokerAccount=!1,this.isPokerVendorEnabled=!0,this.isResetMode=!1,this.userInfo={},this.nickName="",this.password="",this.passwordConfirm="",this.registerPokerAccount=function(){var a={Nickname:f.nickName,Password:f.password};g.register(a).then(function(a){return a.success?(d.showSuccessMessage("Registration successful").done(),void h()):void e.logError("Unable to register: "+a.error,a.userMsg)})},this.currentPasswordForReset="",this.newPasswordForReset="",this.passwordConfirmForReset="",this.resetPassword=function(){var a={OldPassword:f.currentPasswordForReset,NewPassword:f.newPasswordForReset};g.resetPassword(a).then(function(a){return a.success?(d.showSuccessMessage("Password successfuly changed!").done(),h(),void f.clearReset()):void e.logError("Unable to reset password: "+a.error,a.userMsg)})},this.clearReset=function(){f.currentPasswordForReset="",f.newPasswordForReset="",f.passwordConfirmForReset="",f.isResetMode=!1},this.sendPassword=function(){g.resendPassword().then(function(a){return a.success?void d.showSuccessMessage("The password was sent to your mailbox").done():void e.logError("Unable to send password: "+a.error,a.userMsg)})},g.getOSSupport().then(function(a){return a.success?void angular.forEach(a.data,function(a){g.getClient(a).then(function(b){b.success?(b.data.Title=locale.poker.downloadFor+("WIN"===a?"Windows":a),b.data.ImageUrl=globalSettings.SiteContentURL+"/images/poker/poker_sidebar_"+a+".png",f.clientDonwloadLinks.push(b.data)):e.logError("Unable to get client: "+b.error)})}):void e.logError("Unable to get OS support: "+a.error)});var h=function(){f.userLoggedIn&&(f.isResetMode=!1,g.isPokerVendorEnabled().then(function(a){return a.success?(f.isPokerVendorEnabled=a.data,void(f.isPokerVendorEnabled&&g.getUserInfo().then(function(a){return a.success?(f.userHasPokerAccount=null!=a.data&&null!=a.data.Username,void(f.userInfo=a.data)):void e.logError("Unable to get hive poker user info: "+a.error,a.userMsg)}))):void e.logError("Unable to get client: "+a.error,a.userMsg)}))};a.$watch(function(){return c.hasValidLogin()},function(a,b){b!==a&&(f.userLoggedIn=a,f.userLoggedIn&&h())}),h()}])}(),function(){"use strict";function a(a,b,c,d){var e={};return e.dataTableCache={},e.getReportData=function(b,d){var e="",f=a.defer();switch(d||f.reject("No configuration object specified!"),b){case"cashierSummary":e="getCashiersSummaryData";break;case"cashierLotBets":e="getLotteryBetsData";break;case"cashierLotWin":e="getLotteryWinsData";break;case"cashierLotExtWin":e="getLotteryExtWinsData";break;case"cashierSportsBets":e="getSportsbookBetsData";break;case"cashierSportsWins":e="getSportsbookWinsData";break;case"cashierPayouts":e="getCashPayoutsData";break;case"cashierVirtualWins":e="getVirtualWinsData";break;case"cashierVirtualBets":e="getVirtualBetsData";break;case"cashierBVWins":e="getBVWinsData";break;case"cashierBVBets":e="getBVBetsData";break;case"cashierGRWins":e="getGRWinsData";break;case"cashierGRBets":e="getGRBetsData";break;case"reportSportsbookBetsByUser":e="getSportsbookBetsByUserData";break;case"reportAllProducts":e="getAllProductsData";break;case"reportSportsbookProduct":e="getSportsbookProductData";break;case"reportAllProductAnalysis":e="getAgentProductsSalesData";break;case"reportAgentSales":e="getSportsbookSalesByChannelData";break;case"reportAgentVirtualSales":e="getAgentVirtualSalesData";break;case"reportAgentLotterySales":e="getAgentLotterySalesData";break;case"reportAgentCommission":e="getAgentCommissionData";break;case"reportGlobalbetProduct":e="getGlobalbetProductData";break;case"reportGoldenRaceProduct":e="getGoldenRaceProductData";break;case"reportLiabilityOverview":e="getLiabilityOverviewData";break;case"reportLiabilityAudit":e="getLiabilityAuditData";break;case"reportCreditBalance":e="getCreditBalanceData";break;case"reportSportsAnalysisCommission":e="getSportsAnalysisData";break;case"reportSportsAnalysisDetailsCommission":e="getSportsAnalysisDetailsData";break;case"reportBKVAnalysisCommission":e="getBKVirtualAnalysisData";break;case"reportBKVAnalysisDetailsCommission":e="getBKVirtualAnalysisDetailsData";break;case"reportBKVMobileAnalysisCommission":e="getBKVMobileAnalysisData";break;case"reportBKVMobileAnalysisDetailsCommission":e="getBKVMobileAnalysisDetailsData";break;case"reportGBVirtualAnalysisCommission":e="getGBVirtualAnalysisData";break;case"reportGBVirtualAnalysisDetailsCommission":e="getGBVirtualAnalysisDetailsData";break;case"reportGBColorAnalysisCommission":e="getGBColorAnalysisData";break;case"reportLotSpecialFiveAnalysisCommission":e="getLotSpecialFiveAnalysisData";break;case"reportLotDailyDrawAnalysisCommission":e="getLotDailyAnalysisData";break;case"reportLotSpecialFiveAnalysisDetailsCommission":e="getLotSpecialFiveAnalysisDetailsData";break;case"reportLotDailyDrawAnalysisDetailsCommission":e="getLotDailyAnalysisDetailsData";break;case"reportVDogRaceAnalysisCommission":e="getVDogRaceAnalysisData";break;case"reportVDogRaceAnalysisDetailsCommission":e="getVDogRaceAnalysisDetailsData";break;case"reportSpin2WinAnalysisCommission":e="getSpin2WinAnalysisData";break;case"reportSpin2WinAnalysisDetailsCommission":e="getSpin2WinAnalysisDetailsData";break;case"reportGRLuckyBallCommissionEstimate":e="getGRLuckyBallCommissionEstimateData";break;case"reportGRLuckyBallCommissionEstimateDetails":e="getGRLuckyBallCommissionEstimateDetailsData";break;case"reportGBColorAnalysisDetailsCommission":e="getGBColorAnalysisDetailsData";break;case"reportSuperAgentUserDetails":e="getSAUserDetailsData";break;default:e="getSportsbookBetsData"}return this.dataTableCache[b]&&this.dataTableCache[b].data.Data.length?f.resolve(this.dataTableCache[b]):c.report[e](d).then(function(a){f.resolve(a)}).catch(function(a){f.reject(a)}),f.promise},e.setDataCache=function(a,b){this.dataTableCache[a]=b},e.getDataCache=function(a){return this.dataTableCache[a]},e.saveDataTableCache=function(a,b){_.isObject(this.dataTableCache[a])||(this.dataTableCache[a]={success:!1,data:{Data:[]}}),this.dataTableCache[a].data.Data.length||(this.dataTableCache[a].success=!0,angular.copy(b||[],this.dataTableCache[a].data.Data))},e.showDetails=!1,e.setWithCachedDataValue=function(a){this.value=a},e.getWithCachedDataValue=function(){return this.value},e.getSearchParams=function(){return b.reportSearchParams?b.reportSearchParams:null},e.setSearchParams=function(a){b.reportSearchParams=a.Parameters},e.transformResponseForDataTable=function(a,b){var c=[];return _.forEach(a,function(a,e){var f=[];switch(b){case"sportsbookBetsByUser":f.push(a.UserId||"-",a.Username||"-",a.ParentId||"-",a.ParentUsername||"-",a.NumberOfBets,d("number")(a.Stake,2)),null!==a.PotentialWin?f.push(d("number")(a.PotentialWin,2)):f.push(d("number")(a.Win,2),d("number")(a.GrossProfit,2));break;case"allProducts":f.push(a.Product,a.NumberOfBets,d("number")(a.Stake,2),d("number")(a.Winnings,2),d("number")(a.GrossProfit,2),d("number")(a.Commissions,2),d("number")(a.NetProfit,2));break;case"allProductAnalysis":f.push(a.channel,a.numberOfBets,a.runningBets,a.settledBets,d("number")(a.stake,2),d("number")(a.winnings,2),d("number")(a.jackpot,2));break;case"allProductAnalysis":f.push(a.channel,a.numberOfBets,a.runningBets,a.settledBets,d("number")(a.stake,2),d("number")(a.winnings,2),d("number")(a.jackpot,2));break;case"agentVirtualSales":f.push(a.channel,a.product,a.settledBets||"-",d("number")(a.stake,2)||"-",d("number")(a.winnings,2)||"-",d("number")(a.jackpot,2)||"-",d("number")(a.grossProfit,2)||"-",d("number")(a.commission,2)||"-",d("number")(a.bonus,2)||"-");break;case"agentLotterySales":case"lotterySales":case"lotteryWinnings":case"lotteryExtWins":f.push(a.channel,a.product,a.settledBets||"-",d("number")(a.stake,2)||"-",d("number")(a.winnings,2)||"-",d("number")(a.jackpot,2)||"-",d("number")(a.grossProfit,2)||"-",d("number")(a.commission,2)||"-",d("number")(a.bonus,2)||"-");break;case"agentCommission":f.push(a.channel,a.product,a.settledBets||"-",d("number")(a.stake,2)||"-",d("number")(a.winnings,2)||"-",d("number")(a.grossProfit,2)||"-",d("number")(a.commission,2)||"-",d("number")(a.bonus,2)||"-",d("number")(a.jackpot,2)||"-");break;case"sportsAnalysisCommission":case"gBVirtualAnalysisCommission":case"gBColorAnalysisCommission":case"bKVAnalysisCommission":f.push(null,a.Channel||"-",d("date")(a["Settled Date"],"dd/MM/yyyy"),d("number")(a["Coupon Count"],0)||"-",a["Number of Selections"]||"-",d("number")(a.Stake,2)||"-",a["Commission Band"]||"-",d("number")(a["Commission Estimate"],2)||"-");break;case"lotSpecialFiveAnalysisCommission":case"lotDailyDrawAnalysisCommission":f.push(null,a.Channel||"-",d("date")(a["Settled Date"],"dd/MM/yyyy"),d("number")(a["Coupon Count"],0)||"-",a.Selection||"-",d("number")(a.Stake,2)||"-",a["Commission Band"]||"-",d("number")(a["Commission Estimate"],2)||"-");break;case"bKVMobileAnalysisDetailsCommission":f.push(a.Channel||"-",a["Product Type"]||"-",moment(a["Settled Date"],"YYYY/MM/DD").format("DD/MM/YYYY"),a["Ticket Id"]||"-",d("number")(a.Stake,2)||"-",d("number")(a.Win,2)||"-",d("number")(a["Gross Profit"],2)||"-");break;case"sportsAnalysisDetailsCommission":case"bKVAnalysisDetailsCommission":case"gBVirtualAnalysisDetailsCommission":case"gBColorAnalysisDetailsCommission":f.push(a.Channel||"-",a["Product type"]||"-",moment(a["Settled Date"],"YYYY/MM/DD").format("DD/MM/YYYY"),a["Ticket Id"]||"-",a["Number of Selections"]||"-",d("number")(a.Stake,2)||"-",a["Commission Band"]||"-",d("number")(a["Commission Estimate"],2)||"-");break;case"lotSpecialFiveAnalysisDetailsCommission":case"lotDailyDrawAnalysisDetailsCommission":f.push(a.Channel||"-",a["Product Type"]||"-",moment(a["Settled Date"],"YYYY/MM/DD").format("DD/MM/YYYY"),a["Ticket Id"]||"-",a.Selection||"-",d("number")(a.Stake,2)||"-",a["Commission Band"]||"-",d("number")(a["Commission Estimate"],2)||"-");break;case"sportsbookProduct":f.push(a.UserId||"-",a.Username||"-",a.ParentId||"-",a.ParentUsername||"-",a.NumberOfBets,d("number")(a.Stake,2),d("number")(a.WinningsPaidOut,2),d("number")(a.JackpotsWinnings,2),d("number")(a.GrossProfit,2),d("number")(a.Commissions,2),d("number")(a.NetProfit,2));break;case"globalbetProduct":f.push(a.Product,a.Username||"-",a.Id||"-",a.NumberOfBets,d("number")(a.Stake,2),d("number")(a.WinningsPaidOut,2),d("number")(a.JackpotsWinnings,2),d("number")(a.GrossProfit,2),d("number")(a.Commissions,2),d("number")(a.NetProfit,2));break;case"liabilityOverview":f.push(a.UserId||"-",a.Name||"-",a.Surname||"-",a.Status||"-",a.Username||"-",a.LiabilityClosureTime||"-",a.ParentId||"-",a.ParentUsername||"-",d("number")(a.Score,2));break;case"liabilityAudit":f.push(a.UserId||"-",a.TransactionId||"-",a.CategoryCode||"-",d("number")(a.AffectedBalanceAmount,2),d("date")(a.TransactionDate,"MM/dd/yyyy, HH:mm"),d("number")(a.LiabilityAfterTx,2));break;case"creditBalance":f.push(a.id||"-",d("date")(a.CreatedOn,"MM/dd/yyyy, HH:mm"),a.Description||"-",d("number")(a.Credit,2),d("number")(a.Debit,2),d("number")(a.Balance,2));break;case"goldenRaceProduct":f.push(a.UserId||"-",a.Username||"-",a.ParentId||"-",a.ParentUsername||"-",a.NumberOfBets,d("number")(a.Stake,2),d("number")(a.WinningsPaidOut,2),d("number")(a.JackpotsWinnings,2),d("number")(a.GrossProfit,2),d("number")(a.Commissions,2),d("number")(a.NetProfit,2));break;case"cashierSportsBets":case"cashierSportsWins":case"cashierVirtualBets":case"cashierVirtualWins":case"cashierBVBets":case"cashierBVWins":case"cashierGRBets":case"cashierGRWins":case"cashierPayouts":case"cashierLotBets":case"cashierLotWin":case"cashierLotExtWin":f.push(a.Id,a.CouponCode||"-",d("date")(a.TransactionDate,"MM/dd/yyyy, HH:mm"),d("number")(a.RollingBalance),d("number")(a.Amount),a.TransactionStatusCode,a.TransactionStatusDescription,a.Description,a.FurtherDetails||"-");break;case"superAgentUserDetails":f.push(0,a.Id.toString()||"-",a.Username||"-",a.Name||"-",a["Contact Number"]||"-",a.Address||"-",a.LGA||"-",a.State||"-",a.Status||"-");break;case"gRLuckyBallCommissionEstimateDetails":case"vDogRaceAnalysisDetailsCommission":f.push(a.Channel||"-",a["Ticket Id"]||"-",a["Commission Band"]||"-",d("number")(a["Commission Estimate"],2)||"-",a["Product Type"]||"-",a["Selection Group"]||a["Selection Grouping"]||"-",moment(a["Settled Date"],"YYYY/MM/DD").format("DD/MM/YYYY"),d("number")(a.Stake,2)||"-");break;case"spin2WinAnalysisDetailsCommission":f.push(a.Channel||"-",a["Ticket Id"]||"-",a["Commission Band"]||"-",d("number")(a["Commission Estimate"],2)||"-",a["Product Type"]||"-",moment(a["Settled Date"],"YYYY/MM/DD").format("DD/MM/YYYY"),d("number")(a.Stake,2)||"-")}c.push(f)}),c},e.generateColumns=function(a,b,c){var d=[];switch(a){case"sportsbookBetsByUser":d.push({title:locale.account.shopWebsite.reports.sportsbookBets.searchColumns.userId,class:"center"},{title:locale.account.shopWebsite.reports.sportsbookBets.searchColumns.username,class:"left-align"},{title:locale.account.shopWebsite.reports.sportsbookBets.searchColumns.parentId,class:"center"},{title:locale.account.shopWebsite.reports.sportsbookBets.searchColumns.parentUsername,class:"left-align"},{title:locale.account.shopWebsite.reports.sportsbookBets.searchColumns.numberOfBets,class:"center"},{title:locale.account.shopWebsite.reports.sportsbookBets.searchColumns.stake+" <span>("+b+")</span>",class:"right-align"}),c?d.push({title:locale.account.shopWebsite.reports.sportsbookBets.searchColumns.win+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.sportsbookBets.searchColumns.grossProfit+" <span>("+b+")</span>",class:"right-align"}):d.push({title:locale.account.shopWebsite.reports.sportsbookBets.searchColumns.potentialWin+" <span>("+b+")</span>",class:"right-align"});break;case"allProductAnalysis":d.push({className:"details-control",orderable:!1,data:null,defaultContent:'<i class="fa fa-caret-right"></i>'},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"left",data:"channel"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.numberOfBets,class:"right-align",data:"numberOfBets"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.runningBets,class:"right-align",data:"runningBets"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.settledBets,class:"right-align",data:"settledBets"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.stake+" <span>("+b+")</span>",class:"right-align",data:"stake"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.winnings+" <span>("+b+")</span>",class:"right-align",data:"winnings"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.jackpot+" <span>("+b+")</span>",class:"right-align",data:"jackpot"});break;case"agentVirtualSales":case"agentSales":case"agentLotterySales":case"lotterySales":case"lotteryWinnings":case"lotteryExtWins":d.push({className:"details-control",orderable:!1,data:null,defaultContent:'<i class="fa fa-caret-right"></i>'},{title:"",class:"left",data:"channel"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.numberOfBets,class:"right-align",data:"numberOfBets"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.runningBets,class:"right-align",data:"runningBets"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.settledBets,class:"right-align",data:"settledBets"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.stake+" <span>("+b+")</span>",class:"right-align",data:"stake"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.winnings+" <span>("+b+")</span>",class:"right-align",data:"winnings"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.jackpot+" <span>("+b+")</span>",class:"right-align",data:"jackpot"});break;case"agentVirtualSalesInnerChild":case"agentSalesInnerChild":case"agentLotterySalesInnerChild":case"lotterySalesInnerChild":case"lotteryWinningsInnerChild":case"lotteryExtWinsInnerChild":d.push({className:"details-control hidden",orderable:!1,data:null,defaultContent:'<i class="fa fa-minus-circle"></i>'},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.productName,class:"left",data:"product"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.numberOfBets,class:"right-align",data:"numberOfBets"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.runningBets,class:"right-align",data:"runningBets"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.settledBets,class:"right-align",data:"settledBets"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.stake+" <span>("+b+")</span>",class:"right-align",data:"stake"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.winnings+" <span>("+b+")</span>",class:"right-align",data:"winnings"});break;case"allProductAnalysisExport":d.push({title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"left",data:"channel"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.productName,class:"left",data:"product"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.numberOfBets,class:"right-align",data:"numberOfBets"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.runningBets,class:"right-align",data:"runningBets"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.settledBets,class:"right-align",data:"settledBets"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.stake+" <span>("+b+")</span>",class:"right-align",data:"stake"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.winnings+" <span>("+b+")</span>",class:"right-align",data:"winnings"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.jackpot+" <span>("+b+")</span>",class:"right-align",data:"jackpot"});break;case"allAgentSalesExport":d.push({title:locale.account.shopWebsite.reports.agentSales.searchColumns.channel,class:"left",data:"channel"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.productName,class:"left",data:"product"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.userName,class:"left",data:"userName"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.numberOfBets,class:"right-align",data:"numberOfBets"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.runningBets,class:"right-align",data:"runningBets"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.settledBets,class:"right-align",data:"settledBets"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.stake+" <span>("+b+")</span>",class:"right-align",data:"stake"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.winnings+" <span>("+b+")</span>",class:"right-align",data:"winnings"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.jackpot+" <span>("+b+")</span>",class:"right-align",data:"jackpot"});break;case"reportAgentSalesOpenBets":d.push({className:"details-control",orderable:!1,data:null,defaultContent:'<i class="fa fa-caret-right"></i>'},{title:"",class:"right-align",data:"userName"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.runningBets,class:"center",data:"runningBets"},{title:locale.account.shopWebsite.reports.agentCommission.searchColumns.openStakes+" <span>("+b+")</span>",class:"right-align",data:"stakeRunningBets"});break;case"reportAgentSalesOpenBetsExport":d.push({title:locale.account.shopWebsite.reports.agentSales.searchColumns.userName,class:"left",data:"userName"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.productName,class:"left",data:"product"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.runningBets,class:"center",data:"runningBets"},{title:locale.account.shopWebsite.reports.agentCommission.searchColumns.openStakes+" <span>("+b+")</span>",class:"right-align",data:"stakeRunningBets"});break;case"agentCommission":d.push({className:"details-control",orderable:!1,data:null,defaultContent:'<i class="fa fa-caret-right"></i>'},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"left",data:"channel"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.settledBets,class:"right-align",data:"settledBets"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.stake+" <span>("+b+")</span>",class:"right-align",data:"stake"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.winnings+" <span>("+b+")</span>",class:"right-align",data:"winnings"},{title:locale.account.shopWebsite.reports.allProducts.searchColumns.grossProfit+" <span>("+b+")</span>",class:"right-align",data:"grossProfit"},{title:locale.account.shopWebsite.reports.allProducts.searchColumns.commission+" <span>("+b+")</span>",class:"right-align comm",data:"commission"},{title:locale.account.shopWebsite.reports.agentCommission.searchColumns.bonus+" <span>("+b+")</span>",class:"right-align",data:"bonus"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.jackpot+" <span>("+b+")</span>",class:"right-align",data:"jackpot"});break;case"sportsAnalysisCommission":case"bKVAnalysisCommission":case"gBVirtualAnalysisCommission":case"gBColorAnalysisCommission":d.push({className:"details-control center whbg",orderable:!1,data:null,defaultContent:'<i class="fa fa-caret-right"></i>'},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center whbg",data:"Channel"},{title:locale.account.shopWebsite.reports.commissionAnalysis.settledDate,class:"center whbg",data:"Settled Date"},{title:locale.account.shopWebsite.reports.commissionAnalysis.couponCount,class:"center whbg",data:"Coupon Count"},{title:locale.account.shopWebsite.reports.commissionAnalysis.numberOfSelections,class:"center whbg",data:"Number of Selections"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.stake+" <span>("+b+")</span>",class:"center whbg",data:"Stake"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionBand,class:"center whbg",data:"Commission Band"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionEstimate+" <span>("+b+")</span>",class:"center whbg",data:"Commission Estimate"});break;case"lotSpecialFiveAnalysisCommission":case"lotDailyDrawAnalysisCommission":d.push({className:"details-control center whbg",orderable:!1,data:null,defaultContent:'<i class="fa fa-caret-right"></i>'},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center whbg",data:"Channel"},{title:locale.account.shopWebsite.reports.commissionAnalysis.settledDate,class:"center whbg",data:"Settled Date"},{title:locale.account.shopWebsite.reports.commissionAnalysis.couponCount,class:"center whbg",data:"Coupon Count"},{title:locale.account.shopWebsite.reports.commissionAnalysis.selection,class:"center whbg",data:"Selection"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.stake+" <span>("+b+")</span>",class:"center whbg",data:"Stake"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionBand,class:"center whbg",data:"Commission Band"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionEstimate+" <span>("+b+")</span>",class:"center whbg",data:"Commission Estimate"});break;case"gRLuckyBallCommissionEstimate":case"vDogRaceAnalysisCommission":d.push({className:"details-control center whbg",orderable:!1,data:null,defaultContent:'<i class="fa fa-caret-right"></i>'},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center whbg",data:"Channel"},{title:locale.account.shopWebsite.reports.commissionAnalysis.couponCount,class:"center whbg",data:"Coupon Count"},{title:locale.account.shopWebsite.reports.commissionAnalysis.settledDate,class:"center",data:"Settled Date"},{title:locale.account.shopWebsite.reports.commissionAnalysis.selectionGroup,class:"center",data:"Selection Group"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.stake+" <span>("+b+")</span>",class:"center whbg",data:"Stake"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionBand,class:"center whbg",data:"Commission Band"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionEstimate+" <span>("+b+")</span>",class:"center whbg",data:"Commission Estimate"});break;case"gRLuckyBallCommissionEstimateExport":case"vDogRaceAnalysisCommissionExport":d.push({title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center whbg",data:"Channel"},{title:locale.account.shopWebsite.reports.commissionAnalysis.couponCount,class:"center whbg",data:"Coupon Count"},{title:locale.account.shopWebsite.reports.commissionAnalysis.settledDate,class:"center",data:"Settled Date"},{title:locale.account.shopWebsite.reports.commissionAnalysis.selectionGroup,class:"center",data:"Selection Group"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.stake+" <span>("+b+")</span>",class:"center whbg",data:"Stake"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionBand,class:"center whbg",data:"Commission Band"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionEstimate+" <span>("+b+")</span>",class:"center whbg",data:"Commission Estimate"});break;case"gRLuckyBallCommissionEstimateDetails":case"vDogRaceAnalysisDetailsCommission":d.push({title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.ticketId,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionBand,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionEstimate+" <span>("+b+")</span>",class:"center whbg"},{title:locale.account.shopWebsite.reports.commissionAnalysis.productType,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.selectionGroup,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.settledDate,class:"center"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.stake+" <span>("+b+")</span>",class:"center"});break;case"spin2WinAnalysisCommission":d.push({className:"details-control center whbg",orderable:!1,data:null,defaultContent:'<i class="fa fa-caret-right"></i>'},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center whbg",data:"Channel"},{title:locale.account.shopWebsite.reports.commissionAnalysis.couponCount,class:"center whbg",data:"Coupon Count"},{title:locale.account.shopWebsite.reports.commissionAnalysis.settledDate,class:"center",data:"Settled Date"},{title:locale.account.shopWebsite.reports.commissionAnalysis.productType,class:"center",data:"Product Type"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.stake+" <span>("+b+")</span>",class:"center whbg",data:"Stake"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionBand,class:"center whbg",data:"Commission Band"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionEstimate+" <span>("+b+")</span>",class:"center whbg",data:"Commission Estimate"});break;case"spin2WinAnalysisCommissionExport":d.push({title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center whbg",data:"Channel"},{title:locale.account.shopWebsite.reports.commissionAnalysis.couponCount,class:"center whbg",data:"Coupon Count"
},{title:locale.account.shopWebsite.reports.commissionAnalysis.settledDate,class:"center",data:"Settled Date"},{title:locale.account.shopWebsite.reports.commissionAnalysis.productType,class:"center",data:"Product Type"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.stake+" <span>("+b+")</span>",class:"center whbg",data:"Stake"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionBand,class:"center whbg",data:"Commission Band"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionEstimate+" <span>("+b+")</span>",class:"center whbg",data:"Commission Estimate"});break;case"spin2WinAnalysisDetailsCommission":d.push({title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.ticketId,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionBand,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionEstimate+" <span>("+b+")</span>",class:"center whbg"},{title:locale.account.shopWebsite.reports.commissionAnalysis.productType,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.settledDate,class:"center"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.stake+" <span>("+b+")</span>",class:"center"});break;case"bKVMobileAnalysisCommission":d.push({className:"details-control center whbg",orderable:!1,data:null,defaultContent:'<i class="fa fa-caret-right"></i>'},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center whbg",data:"Channel"},{title:locale.account.shopWebsite.reports.commissionAnalysis.couponCount,class:"center whbg",data:"Coupon Count"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.stake+" <span>("+b+")</span>",class:"center whbg",data:"Stake"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.winnings+" <span>("+b+")</span>",class:"center whbg",data:"Win"},{title:locale.account.shopWebsite.reports.allProducts.searchColumns.grossProfit+" <span>("+b+")</span>",class:"center whbg",data:"Gross Profit"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionBand,class:"center whbg",data:"Commission Band"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionEstimate+" <span>("+b+")</span>",class:"center whbg",data:"Commission Estimate"});break;case"bKVMobileAnalysisCommissionExport":d.push({title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center whbg",data:"Channel"},{title:locale.account.shopWebsite.reports.commissionAnalysis.couponCount,class:"center whbg",data:"Coupon Count"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.stake+" <span>("+b+")</span>",class:"center whbg",data:"Stake"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.winnings+" <span>("+b+")</span>",class:"center whbg",data:"Win"},{title:locale.account.shopWebsite.reports.allProducts.searchColumns.grossProfit+" <span>("+b+")</span>",class:"center whbg",data:"Gross Profit"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionBand,class:"center whbg",data:"Commission Band"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionEstimate+" <span>("+b+")</span>",class:"center whbg",data:"Commission Estimate"});break;case"bKVMobileAnalysisDetailsCommission":d.push({title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.productType,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.settledDate,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.ticketId,class:"center"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.stake+" <span>("+b+")</span>",class:"center"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.winnings+" <span>("+b+")</span>",class:"center whbg"},{title:locale.account.shopWebsite.reports.allProducts.searchColumns.grossProfit+" <span>("+b+")</span>",class:"center whbg"});break;case"sportsAnalysisDetailsCommission":case"bKVAnalysisDetailsCommission":case"gBVirtualAnalysisDetailsCommission":case"gBColorAnalysisDetailsCommission":d.push({title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.productType,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.settledDate,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.ticketId,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.numberOfSelections,class:"center"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.stake+" <span>("+b+")</span>",class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionBand,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionEstimate+" <span>("+b+")</span>",class:"center"});break;case"lotSpecialFiveAnalysisDetailsCommission":case"lotDailyDrawAnalysisDetailsCommission":d.push({title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.productType,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.settledDate,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.ticketId,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.selection,class:"center"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.stake+" <span>("+b+")</span>",class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionBand,class:"center"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionEstimate+" <span>("+b+")</span>",class:"center"});break;case"agentCommissionExport":d.push({title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"left",data:"channel"},{title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.productName,class:"left",data:"product"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.settledBets,class:"right-align",data:"settledBets"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.stake+" <span>("+b+")</span>",class:"right-align",data:"stake"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.winnings+" <span>("+b+")</span>",class:"right-align",data:"winnings"},{title:locale.account.shopWebsite.reports.allProducts.searchColumns.grossProfit+" <span>("+b+")</span>",class:"right-align",data:"grossProfit"},{title:locale.account.shopWebsite.reports.allProducts.searchColumns.commission+" <span>("+b+")</span>",class:"right-align",data:"commission"},{title:locale.account.shopWebsite.reports.agentCommission.searchColumns.bonus+" <span>("+b+")</span>",class:"right-align",data:"bonus"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.jackpot+" <span>("+b+")</span>",class:"right-align",data:"jackpot"});break;case"analysisCommissionExport":d.push({title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center whbg",data:"Channel"},{title:locale.account.shopWebsite.reports.commissionAnalysis.settledDate,class:"center whbg",data:"Settled Date"},{title:locale.account.shopWebsite.reports.commissionAnalysis.couponCount,class:"center whbg",data:"Coupon Count"},{title:locale.account.shopWebsite.reports.commissionAnalysis.numberOfSelections,class:"center whbg",data:"Number of Selections"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.stake+" <span>("+b+")</span>",class:"center whbg",data:"Stake"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionBand,class:"center whbg",data:"Commission Band"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionEstimate+" <span>("+b+")</span>",class:"center whbg",data:"Commission Estimate"});break;case"lotAnalysisComissionExport":d.push({title:locale.account.shopWebsite.reports.allProductAnalysis.searchColumns.channel,class:"center whbg",data:"Channel"},{title:locale.account.shopWebsite.reports.commissionAnalysis.settledDate,class:"center whbg",data:"Settled Date"},{title:locale.account.shopWebsite.reports.commissionAnalysis.couponCount,class:"center whbg",data:"Coupon Count"},{title:locale.account.shopWebsite.reports.commissionAnalysis.selection,class:"center whbg",data:"Selection"},{title:locale.account.shopWebsite.reports.agentSales.searchColumns.stake+" <span>("+b+")</span>",class:"center whbg",data:"Stake"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionBand,class:"center whbg",data:"Commission Band"},{title:locale.account.shopWebsite.reports.commissionAnalysis.commissionEstimate+" <span>("+b+")</span>",class:"center whbg",data:"Commission Estimate"});break;case"allProducts":d.push({title:locale.account.shopWebsite.reports.allProducts.searchColumns.productName,class:"left"},{title:locale.account.shopWebsite.reports.allProducts.searchColumns.numberOfBets,class:"center"},{title:locale.account.shopWebsite.reports.allProducts.searchColumns.stake+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.allProducts.searchColumns.winnings+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.allProducts.searchColumns.grossProfit+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.allProducts.searchColumns.commission+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.allProducts.searchColumns.netProfit+" <span>("+b+")</span>",class:"right-align"});break;case"sportsbookProduct":d.push({title:locale.account.shopWebsite.reports.sportsbookProduct.searchColumns.userId,class:"center"},{title:locale.account.shopWebsite.reports.sportsbookProduct.searchColumns.username,class:"left-align"},{title:locale.account.shopWebsite.reports.sportsbookProduct.searchColumns.parentId,class:"center"},{title:locale.account.shopWebsite.reports.sportsbookProduct.searchColumns.parentUsername,class:"left-align"},{title:locale.account.shopWebsite.reports.sportsbookProduct.searchColumns.numberOfBets,class:"center"},{title:locale.account.shopWebsite.reports.sportsbookProduct.searchColumns.stake+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.sportsbookProduct.searchColumns.winningsPaidOut+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.sportsbookProduct.searchColumns.jackpotsWinnings+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.sportsbookProduct.searchColumns.grossProfit+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.sportsbookProduct.searchColumns.commission+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.sportsbookProduct.searchColumns.netProfit+" <span>("+b+")</span>",class:"right-align"});break;case"globalbetProduct":d.push({title:locale.account.shopWebsite.reports.allProducts.searchColumns.productName,class:"left"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.username,class:"left-align"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.userId,class:"center"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.numberOfBets,class:"center"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.stake+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.winningsPaidOut+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.jackpotsWinnings+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.grossProfit+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.commission+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.netProfit+" <span>("+b+")</span>",class:"right-align"});break;case"goldenRaceProduct":d.push({title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.userId,class:"center"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.username,class:"left-align"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.parentId,class:"center"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.parentUsername,class:"left-align"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.numberOfBets,class:"center"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.stake+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.winningsPaidOut+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.jackpotsWinnings+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.grossProfit+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.commission+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.goldenRaceProduct.searchColumns.netProfit+" <span>("+b+")</span>",class:"right-align"});break;case"liabilityOverview":d.push({title:locale.account.shopWebsite.reports.liabilityOverview.searchColumns.userId,class:"center"},{title:locale.account.shopWebsite.reports.liabilityOverview.searchColumns.name,class:"left-align"},{title:locale.account.shopWebsite.reports.liabilityOverview.searchColumns.surname,class:"left-align"},{title:locale.account.shopWebsite.reports.liabilityOverview.searchColumns.status,class:"center"},{title:locale.account.shopWebsite.reports.liabilityOverview.searchColumns.username,class:"left-align"},{title:locale.account.shopWebsite.reports.liabilityOverview.searchColumns.liabilityClosureTime,class:"center"},{title:locale.account.shopWebsite.reports.liabilityOverview.searchColumns.parentId,class:"center"},{title:locale.account.shopWebsite.reports.liabilityOverview.searchColumns.parentUsername,class:"left-align"},{title:locale.account.shopWebsite.reports.liabilityOverview.searchColumns.score+" <span>("+b+")</span>",class:"right-align"});break;case"liabilityAudit":d.push({title:locale.account.shopWebsite.reports.liabilityAudit.searchColumns.userId,class:"center"},{title:locale.account.shopWebsite.reports.liabilityAudit.searchColumns.transactionId,class:"center"},{title:locale.account.shopWebsite.reports.liabilityAudit.searchColumns.categoryCode,class:"left-align"},{title:locale.account.shopWebsite.reports.liabilityAudit.searchColumns.affectedBalanceAmount+" <span>("+b+")</span>",class:"left-align"},{title:locale.account.shopWebsite.reports.liabilityAudit.searchColumns.transactionDate,class:"center"},{title:locale.account.shopWebsite.reports.liabilityAudit.searchColumns.liabilityAfterTx+" <span>("+b+")</span>",class:"right-align"});break;case"creditBalance":d.push({title:locale.account.shopWebsite.reports.creditBalance.searchColumns.id,class:"center"},{title:locale.account.shopWebsite.reports.creditBalance.searchColumns.createdOn,class:"center"},{title:locale.account.shopWebsite.reports.creditBalance.searchColumns.description,class:"left-align"},{title:locale.account.shopWebsite.reports.creditBalance.searchColumns.credit+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.creditBalance.searchColumns.debit+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.reports.creditBalance.searchColumns.balance+" <span>("+b+")</span>",class:"right-align"});break;case"cashierSportsBets":case"cashierSportsWins":case"cashierVirtualBets":case"cashierVirtualWins":case"cashierBVBets":case"cashierBVWins":case"cashierGRBets":case"cashierGRWins":case"cashierPayouts":case"cashierLotBets":case"cashierLotWin":case"cashierLotExtWin":d.push({title:locale.account.shopWebsite.cashiers.reports.otherReports.searchColumns.id,class:"center"},{title:locale.account.shopWebsite.cashiers.reports.otherReports.searchColumns.couponCode,class:"center"},{title:locale.account.shopWebsite.cashiers.reports.otherReports.searchColumns.transactionDate,class:"center"},{title:locale.account.shopWebsite.cashiers.reports.otherReports.searchColumns.rollingBalance+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.cashiers.reports.otherReports.searchColumns.amount+" <span>("+b+")</span>",class:"right-align"},{title:locale.account.shopWebsite.cashiers.reports.otherReports.searchColumns.transactionStatusCode,class:"center"},{title:locale.account.shopWebsite.cashiers.reports.otherReports.searchColumns.transactionStatusDescription,class:"center"},{title:locale.account.shopWebsite.cashiers.reports.otherReports.searchColumns.description,class:"center"},{title:locale.account.shopWebsite.cashiers.reports.otherReports.searchColumns.furtherDetails,class:"center"});break;case"superAgentUserDetails":d.push({title:locale.account.shopWebsite.reports.serialNumber,class:"left-align non-vertical-align"},{title:locale.account.shopWebsite.cashiers.reports.otherReports.searchColumns.id,class:"left-align non-vertical-align"},{title:locale.account.shopWebsite.reports.liabilityOverview.searchColumns.username,class:"left-align non-vertical-align"},{title:locale.account.shopWebsite.reports.liabilityOverview.searchColumns.name,class:"left-align non-vertical-align"},{title:locale.account.editProfile.contactInformation.telephone,class:"left-align non-vertical-align",render:function(a){return e.maskData(a,"115px")}},{title:locale.account.editProfile.personalData.address,class:"left-align non-vertical-align",render:function(a){return e.maskData(a,"260px")}},{title:locale.account.shopWebsite.reports.lGA,class:"left-align filter-dropdown"},{title:locale.account.shopWebsite.reports.state,class:"left-align filter-dropdown"},{title:locale.account.shopWebsite.reports.liabilityOverview.searchColumns.status,class:"left-align filter-dropdown"})}return e.maskData=function(a,b){for(var c="",d=0;d<a.length;d++)c+="&#8727;";return'<div style="display:flex;height:35px"><input type="hidden" value="'+a+'"><span style="text-align:left;width:'+b+';line-height: 18px;overflow: hidden;overflow-wrap: break-word;word-wrap: break-word;">'+c+'</span><i style="line-height: 35px;" class="fa fa-eye-slash"/></div>'},d},e}angular.module("reports.service",[]).factory("ReportsService",a),a.$inject=["$q","$sessionStorage","platformApiService","$filter"]}(),function(){angular.module("accountBetRequest",[]).controller("betRequestCtrl",["$interval","$sce","$window","$location","$scope","platformApiService","helperService","loggingService",function(a,b,c,d,e,f,g,h){var i=this,j=f.common;this.userName="",this.contactEmail="",this.requestDesc="",this.exampleUserName="Andre Akkari",this.exampleEmail="sample@example.com",this.ErrorsInBetRequest={},this.disableBtn=!0,this.RequestBetRequestModel=new gamingAppModels.RequestBetRequestModel,this.clearBetRequest=function(){i.userNameEmail="",i.betDetails=""},this.clearReset=function(b){a(function(){i.ErrorsInBetRequest.SubmissionError="",d.path("/request-a-bet"+b)},5e3,1)},this.requestABet=function(){i.disableBtn=!1,i.RequestBetRequestModel.ContactName=i.userName,i.RequestBetRequestModel.ContactEmail=i.contactEmail,i.RequestBetRequestModel.Details=i.requestDesc,""===i.userName?(h.logError("No Username","Please insert Username"),i.clearReset(""),i.disableBtn=!0):""===i.contactEmail?(h.logError("No Email","Email is required"),i.clearReset(""),i.disableBtn=!0):""===i.requestDesc?(h.logError("No Details","Details are required"),i.clearReset(""),i.disableBtn=!0):j.requestBet(i.RequestBetRequestModel).then(function(a){(a.data=!0)&&(g.showSuccessMessage("Your Bet Request has been registered and will be processed by one of our operators shortly").done(),d.path("/")),(a.data=!1)&&(h.logError("Bet Not Placed","Your Bet Request failed please contact customer care"),i.clearReset("")),a.success||(h.logError("APi error","Your Bet Request:"+a.error),i.clearReset(""))})}}])}(),function(){angular.module("matchOdds",["matchOdds.service"]).controller("SportsMatchOddsController",["$scope","matchOddsService",function(a,b){var c=this;c.getOddsData=b.getOddsData,c.boostedOdds=b.getBoostedOdds(),c.showBoostedOddsSection=c.boostedOdds.length>1,this.updateCoupon=function(b,c){null!=c&&void 0!=c&&(globalSettings.UseServerSideCoupon?a.$emit("addRemoveToCoupon",b,null):void 0!=c&&a.$emit("addRemoveToCoupon",b,c))},this.headerClicked=function(a){var b=$(a.currentTarget),c=b.parent().data("menuid");globalSettings.Sports_EnableExpandedOdds&&("block"==$("#area_"+c).css("display")?($("#area_"+c).toggle(),b.parent().toggleClass("opened"),b.toggleClass("opened")):(b.parent().toggleClass("opened"),b.toggleClass("opened"),$("#area_"+c).toggle()))},this.toggleMarketsDescription=function(a){if(null!=a&&null!=a.currentTarget){var b=$(a.currentTarget);b.toggleClass("opened"),b.parent().parent().next().stop().toggle()}},this.closeMarketsDescription=function(a){if(null!=a&&null!=a.currentTarget){var b=$(a.currentTarget);b.parent().parent().prev().find(".infoIcon").removeClass("opened"),b.parent().parent().stop(),b.parent().parent().toggle()}}}])}(),function(){angular.module("matchOdds.service",[]).factory("matchOddsService",[function(){var a=[],b=[],c=null,d=function(d){c=d,a=d,b=f()},e=function(b){a=[],null!=c&&c.find(function(c){b.includes(c.Area.AI)&&a.push(c)})},f=function(){if(a&&a.length>0){var b=[];return _.forEach(a,function(a){var c=_.filter(a.MatchOdds,function(a){return a.unboostedOddValue>1&&a.unboostedOddValue<a.oddValue});c.length>0&&_.forEach(c,function(a){b.push(a)})}),b}};return{getOddsData:function(){return a},initialiseOddsCollection:d,setOddsFromAreas:e,getBoostedOdds:function(){return b}}}])}(),function(){angular.module("sports",["sportsSearch","sportsEvents","sportsEventOdds","sportsLessThanTwo","sportsPredictor","sportsResults","latestWinnersWidget","latestResultsWidget","marketMoversWidget","hottestMarketsWidget","mostPopularWidget","upcomingEventsWidget","bannerWidget","screensaverWidget","lastMinuteWidget","matchDayWidget","liveBettingWidget","bestSellersWidget","sportsMatch","matchOdds","matchOdds.service","ngScrollbars"]).factory("sportsService",["$localStorage","$sessionStorage","$location","$state","umbracoApiService",function(a,b,c,d,f){var g=[],h={},i={list:[globalSettings.Sports_LandingPage_DefaultMostPopularWidgetConfig,globalSettings.Sports_LandingPage_DefaultUpcomingEventsWidgetConfig,globalSettings.Sports_LandingPage_DefaultHottestOUWidgetConfig,globalSettings.Sports_LandingPage_DefaultMatchOfTheDayWidgetConfig,globalSettings.Sports_LandingPage_DefaultLiveBettingWidgetConfig,globalSettings.Sports_LandingPage_DefaultMarketMoversWidgetConfig],mostPopularLeagueCount:globalSettings.Sports_LandingPage_DefaultMostPopularWidgetLeagueCount,mostPopularAllTabText:globalSettings.Sports_LandingPage_DefaultMostPopularWidgetAllTabText,mostPopularAllTabOrder:globalSettings.Sports_LandingPage_DefaultMostPopularWidgetAllTabOrder};return{getTimeRange:function(){return null==b.timeRange&&this.setTimeRange(globalSettings.ScheduleTimeFrame),b.timeRange},setTimeRange:function(a){b.timeRange=a},isPokerPage:function(){return c.absUrl().indexOf("/pokershares")>-1},parseEventData:function(a){var b=[];if(null==a)return b;for(var c=0;c<a.length;c++){var d=this.parseEvent(a[c]);d&&b.push(d)}return b},parseRegionGroupingData:function(a){var b=[];return angular.forEach(a.RE,function(a){var c=a.RI,d=a.RN,e=a.RO,f=a.AR;b.push({regionID:c,regionName:d,regionOrder:e,regionAreas:f})}),b},parseSelectionDescription:function(a,b,c){if(b&&""!==b){var d=c?c.split(" - ")[0]:a.split(" - ")[0],e=c?c.split(" - ")[1]:a.split(" - ")[1],f="";return c&&(f=this.parseGoalscorerPlayer(a)),b=this.replaceAll(b,"{{HOME}}",d),b=this.replaceAll(b,"{{AWAY}}",e),b=this.replaceAll(b,"{{PLAYER}}",f)}},replaceAll:function(a,b,c){return a.replace(new RegExp(this.escapeRegExp(b),"g"),c)},escapeRegExp:function(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},parseGoalscorerPlayer:function(a){var b="",c=a.match(/\[(.*?)\]/);return b=c?c[1]:a},parseMoreEventData:function(a,b){if(b=b||!1,a&&Object.keys(a).length&&!a.noOddsEventId){var c=[];return c.EventId=a.AM[0].IT[0].II,c.CategoryId=a.AM[0].IT[0].CI,c.TournamentId=a.AM[0].IT[0].TI,c.SmartbetCode=a.AM[0].IT[0].SB,c.ExtProvIdItem=a.AM[0].IT[0].EI,c.SportId=a.AM[0].SI,c.MatchName=a.AM[0].IT[0].IN,c.MatchDate=a.AM[0].IT[0].ID,c.OddsCollection=[],angular.forEach(a.AM,function(a){var d=a.IT[0];angular.forEach(a.IT[0].OC,function(e){var f=e.CB,g=locale.sports.events.eventOdds.combinabilityName[f],h="25%",i="97%";2==e.MO.length?(h="50%",i="98.5%"):3==e.MO.length&&(h="33.3%",i="98%");var j=void 0;b&&(j=a.AR);var k={MarketId:e.OI,OddsTypeName:e.OT.ON,OddsDescription:e.OT.OD||"",OddsTypeID:e.OT.OI,CombinabilityName:g,CombinabilityID:f,SetWidth:h,SetInnerWidth:i,MatchOdds:[],hasSlider:/:/.test(e.MO[0].OA.ON),Area:j};angular.forEach(e.MO,function(b){var c=[],f=b.OA.SD,g=f&&""!==f?f.replace("{{HOME}}",d.IN.split(" - ")[0]).replace("{{AWAY}}",d.IN.split(" - ")[1]):"";c={OddName:b.OA.ON,SpecialValue:b.OA.VD,MatchOddsID:b.OI,OddOutcome:b.OT.OO,oddId:b.OI,marketId:k.MarketId,marketName:k.OddsTypeName,marketTypeId:k.OddsTypeID,selectionName:b.OA.ON,selectionDescription:g,isOddValue:!0,smartBetCode:d.SB,spreadValue:b.OA.VD,oddValue:b.OT.OO,unboostedOddValue:b.OT.UO,combinability:k.CombinabilityID,sportId:a.SI,sportName:a.SN,matchId:d.II,matchName:d.IN,matchDate:d.ID,tournamentId:d.TI,tournamentName:d.TN,categoryId:d.CI,categoryName:d.CN,eventCategory:d.EC,groupNo:e.GR,incompatibleEvents:d.IE,compatibleMarkets:e.CM,selectionTypeId:b.OA.OI},k.MatchOdds.push(c)}),c.OddsCollection.push(k)})}),c}},splitArray:function(a,b){for(var c=[],d=0;d<a.length;d+=b)c.push(a.slice(d,d+b));return c},parseEvent:function(b){if(!b.data.AreaMatches||b.data.AreaMatches.length<=0)return null;a.oddsFilter=a.oddsFilter||[];var d="";b.data.AreaMatches[0].Items.length>0&&(d=b.data.AreaMatches[0].Items[0].CategoryName+" "+b.data.AreaMatches[0].Items[0].TournamentName);var e=!1,f="";void 0!=b.eventId&&(f=b.eventId.split("-")[0]+"-"+b.eventId.split("-")[1]+"-"+b.eventId.split("-")[2]),a.oddsFilter.length?_.forEach(a.oddsFilter,function(a){e=globalSettings.Sports_OddsFilterExpandedByDefault?a!==b.eventId:a===b.eventId}):e=!!globalSettings.Sports_OddsFilterExpandedByDefault;var g=[],h=parseInt(globalSettings.Sports_NumberOfRegionTabs);if(null!=b.data.Regions){for(var i=0;i<b.data.Regions.length;i++)this.parseRegion(g,b.data.Areas,b.data.Regions[i]);g=this.splitArray(g,h)}var j=null;null!=b.data.AreaMatches[0].Region&&(j=b.data.AreaMatches[0].Region.RegionID);for(var k=c.search().matchId,l={eventId:b.eventId,sportId:b.data.AreaMatches[0].SportID,sportName:b.data.AreaMatches[0].SportName,expandOddFilters:e,eventName:d,regions:g,regionsTabs:h,areas:b.data.Areas,selectedRegion:j,selectedArea:b.data.AreaMatches[0].Area.AreaID,groupingType:b.data.AreaMatches[0].GroupingType,multilineType:b.data.AreaMatches[0].AreaMarkets[0]?b.data.AreaMatches[0].AreaMarkets[0].OddsType.MultilineType:null,selectedOutright:null,matchIdParameter:k,markets:[],headers:[],matches:[],matchesByDay:{}},m="",i=0;i<b.data.AreaMatches[0].AreaMarkets.length;i++){var n=b.data.AreaMatches[0].AreaMarkets[i];""!=n.OddsType.OddsDescription&&(m+="<div><span>"+n.OddsType.OddsTypeName+":</span><div>"+n.OddsType.OddsDescription+"</div></div>"),this.parseMarket(l,n)}if(l.marketsDescription=m,2==l.groupingType){for(var o=_.uniqBy(b.data.AreaMatches[0].Items,function(a){return a.ExtParentItemID}),i=0;i<o.length;i++)this.parseMatch(l,o[i],!0);for(var i=0;i<l.matches.length;i++){for(var p=l.matches[i].parentMatchId,q=_.filter(b.data.AreaMatches[0].Items,function(a){return a.ExtParentItemID==p}),r=0;r<q.length;r++)this.parseMatch(l.matches[i],q[r]);for(var s=_.uniqBy(q,function(a){return a.ExtParentTeamID}),t=0;t<s.length;t++)s[t].ExtParentTeamID&&l.matches[i].teams.push({parentTeamName:s[t].ExtParentTeamName,parentTeamOrder:s[t].ExtTeamOrder})}}else for(var i=0;i<b.data.AreaMatches[0].Items.length;i++)this.parseMatch(l,b.data.AreaMatches[0].Items[i]);this.generateHeaders(l),this.groupMatches(l),l.hasTotalOdds=!1;for(var i=0;i<l.matches.length;i++){var u=l.matches[i];if(u.totalOdds>l.headers.length){l.hasTotalOdds=!0;break}}return 0!=l.groupingType&&l.matches.length>0&&(l.selectedMatch=l.matches[0].matchId),l},parseRegion:function(a,b,c){for(var d={regionId:c.RegionID,regionName:c.RegionName,regionAreas:[]},e=0;e<c.AreaIds.length;e++)for(var f=[],g=0;g<b.length;g++)if(c.AreaIds[e]==b[g].AreaID){f={areaId:b[g].AreaID,areaName:b[g].AreaName},d.regionAreas.push(f);break}a.push(d)},parseMarket:function(a,b){for(var c={marketId:b.OddsType.OddsTypeID,name:b.OddsType.OddsTypeName,isOutright:b.OddsType.IsOutright,order:b.OddsType.OddsTypeOrder,idGroup:b.OddsType.IDGroup,idGroupMarketType:b.OddsType.IDGroupMarketType,specialBetValue:b.SpecialBetValue,specialCount:b.SpecialCount,selections:[]},d=0;d<b.Markets.length;d++)this.parseSelection(c,b.Markets[d]);a.markets.push(c)},parseSelection:function(a,b){a.selections.push({marketId:a.marketId,selectionId:b.OddAttribute.OddTypeID,specialValue:b.OddAttribute.SpecialValueDisplay,isHeaderOnly:!1,name:b.OddAttribute.OddName})},parseMatch:function(a,b,c){var d={matchId:b.ItemID,tournamentId:b.TournamentId,tournamentName:b.TournamentName,categoryId:b.CategoryId,categoryName:b.CategoryName,name:b.ItemName,date:new Date(b.ItemDate),smartBetCode:b.SmartBetCode,scheduleStatus:b.ScheduleStatus,isAntepost:b.IsAntepost,extProvStatistic:b.ExtProvStatistic,extProvIdItem:b.ExtProvIDItem,totalOdds:b.TotalOdds,eventCategory:b.EventCategory,incompatibleEvents:b.IncompatibleEvents,parentMatchId:b.ExtParentItemID,parentMatchName:b.ExtParentItemName,parentTeamName:b.ExtParentTeamName,parentTeamOrder:b.ExtTeamOrder};c?(d.teams=[],d.matches=[]):(d.odds={},this.parseOdds(a,d,b.OddsCollection)),a.matches.push(d)},parseOdds:function(a,c,d){if(!d[0])return!1;var e=this,f=d[0].OddsType.IsOutright,g="";if(f){var h=[];c.collection={},angular.forEach(d,function(b){var d=b.OddsType.OddsTypeID,f=b.MarketCurrency;angular.forEach(b.MatchOdds,function(g){var i=g,j=i.OddAttribute.OddTypeID,k=[d,j].join("_"),l=h.filter(function(a){return a.SmartBetCode==i.SmartBetCode})[0];void 0==l&&(c.collection["sb"+i.SmartBetCode]={smartBetCode:i.SmartBetCode,name:i.OddAttribute.OddName,odds:{}},h.push(i));var m=i.OddAttribute.SelectionDescription,n=e.parseSelectionDescription(i.OddAttribute.OddName,m,c.parentMatchName);c.collection["sb"+i.SmartBetCode].outcome=i.Outcome?i.Outcome:[],0!=c.collection["sb"+i.SmartBetCode].outcome.length?c.collection["sb"+i.SmartBetCode].odds[k]={oddId:i.MatchOddsID,uniqueKey:k,isOddValue:!0,value:i.Outcome?i.Outcome.OddOutcome.toFixed(2):null,oddValue:i.Outcome?i.Outcome.OddOutcome:null,unboostedOddValue:i.Outcome?i.Outcome.UnboostedOddValue:null,scheduleStatus:i.Outcome?i.Outcome.ScheduleStatus:null,combinability:b.Combinability,marketId:b.OddCollectionID,marketName:b.OddsType.OddsTypeName,marketTypeId:b.OddsType.OddsTypeID,selectionName:i.OddAttribute.OddName,selectionDescription:n,smartBetCode:i.SmartBetCode,sportId:a.sportId,sportName:a.sportName,matchId:c.matchId,matchName:c.name,matchDate:c.date,tournamentId:c.tournamentId,tournamentName:c.tournamentName,categoryId:c.categoryId,
categoryName:c.categoryName,eventCategory:c.eventCategory,groupNo:b.GroupNo,incompatibleEvents:c.incompatibleEvents,compatibleMarkets:b.CompatibleMarkets,spreadValue:0,selectionTypeId:j}:(c.collection["sb"+i.SmartBetCode].pricePerShare=i.Outcome?null:i.PricePerShare,c.collection["sb"+i.SmartBetCode].availableShares=i.Outcome?null:100*i.AvailableShares,c.collection["sb"+i.SmartBetCode].markup=i.Outcome?null:i.Markup,c.collection["sb"+i.SmartBetCode].marketCurrency=f,c.collection["sb"+i.SmartBetCode].oddId=i.MatchOddsID,c.collection["sb"+i.SmartBetCode].oddPokerShares={oddId:i.MatchOddsID,uniqueKey:k,isOddValue:!0,value:i.Outcome?i.Outcome.OddOutcome.toFixed(2):null,oddValue:i.Outcome?i.Outcome.OddOutcome:null,unboostedOddValue:i.Outcome?i.Outcome.UnboostedOddValue:null,scheduleStatus:i.Outcome?i.Outcome.ScheduleStatus:null,combinability:b.Combinability,marketId:b.OddCollectionID,marketName:b.OddsType.OddsTypeName,marketTypeId:b.OddsType.OddsTypeID,selectionName:i.OddAttribute.OddName,selectionDescription:n,smartBetCode:i.SmartBetCode,sportId:a.sportId,sportName:a.sportName,matchId:c.matchId,matchProviderId:c.extProvIdItem,matchName:c.name,matchDate:c.date,tournamentId:c.tournamentId,tournamentName:c.tournamentName,categoryId:c.categoryId,categoryName:c.categoryName,eventCategory:c.eventCategory,groupNo:b.GroupNo,incompatibleEvents:c.incompatibleEvents,compatibleMarkets:b.CompatibleMarkets,spreadValue:0,selectionTypeId:j})})})}else for(var i=!0,j=0;j<d.length;j++){i=!i;var k=d[j],l=k.OddsType.OddsTypeID,m=null!=k.OddsType.IDGroup,n=0!=k.OddsType.MultilineType;if(m)for(var o=null,p=0,q=0;q<k.MatchOdds.length;q++){var r=k.MatchOdds[q],s=r.OddAttribute.OddTypeID,t=r.OddAttribute.SpecialValueDisplay,u=r.OddAttribute.OddName;0!=r.OddAttribute.SpecialValueDisplay&&(u+=" ("+r.OddAttribute.SpecialValueDisplay+")");var l=k.OddsType.OddsTypeID,v=k.OddsType.OddsTypeName;if(o!=t&&(o=t,p++,!n)){var w=[l,"spread",p].join("_");c.odds[w]={uniqueKey:w,isOddValue:!1,value:t,combinability:"spread"}}var x=r.OddAttribute.SelectionDescription,y=e.parseSelectionDescription(c.name,x,c.parentMatchName),w=[l,s,p].join("_");c.odds[w]={oddId:r.MatchOddsID,uniqueKey:w,marketId:k.OddCollectionID,marketName:v,marketTypeId:l,selectionName:u,selectionDescription:y,isOddValue:!0,smartBetCode:r.SmartBetCode,value:r.Outcome?r.Outcome.OddOutcome.toFixed(2):null,oddValue:r.Outcome?r.Outcome.OddOutcome:null,unboostedOddValue:r.Outcome?r.Outcome.UnboostedOddValue:null,scheduleStatus:r.Outcome?r.Outcome.ScheduleStatus:null,spreadValue:k.SpecialBetValue,combinability:k.Combinability,isAlternate:i,sportId:a.sportId,sportName:a.sportName,matchId:c.matchId,matchProviderId:c.extProvIdItem,matchName:c.name,matchDate:c.date,tournamentId:c.tournamentId,tournamentName:c.tournamentName,categoryId:c.categoryId,categoryName:c.categoryName,eventCategory:c.eventCategory,groupNo:k.GroupNo,incompatibleEvents:c.incompatibleEvents,compatibleMarkets:k.CompatibleMarkets,selectionTypeId:s}}else{for(var z=b.SportsbookMarketTypeIds?b.SportsbookMarketTypeIds.filter(function(a){return"1X2"===a.LookupCode}):[],A=b.SportsbookMarketTypeIds?b.SportsbookMarketTypeIds.filter(function(a){return"1-2"===a.LookupCode}):[],B=z.length?z[0].IDMarketType:10,C=A.length?A[0].IDMarketType:20,q=0;q<k.MatchOdds.length;q++){var r=k.MatchOdds[q],s=r.OddAttribute.OddTypeID,D=r.OddAttribute.SpecialValue,E=r.OddAttribute.SpecialValueDisplay,u=r.OddAttribute.OddName;0!=E&&(u+=" ("+E+")");var v=k.OddsType.OddsTypeName,x=r.OddAttribute.SelectionDescription,y=e.parseSelectionDescription(c.name,x,c.parentMatchName),w=[l,s,D,r.OddAttribute.OddName].join("_");c.odds[w]={oddId:r.MatchOddsID,uniqueKey:w,marketId:k.OddCollectionID,marketName:v,marketTypeId:k.OddsType.OddsTypeID,selectionName:u,selectionDescription:y,isOddValue:!0,smartBetCode:r.SmartBetCode,value:r.Outcome?r.Outcome.OddOutcome.toFixed(2):null,oddValue:r.Outcome?r.Outcome.OddOutcome:null,unboostedOddValue:r.Outcome?r.Outcome.UnboostedOddValue:null,scheduleStatus:r.Outcome?r.Outcome.ScheduleStatus:null,spreadValue:E,combinability:k.Combinability,isAlternate:i,sportId:a.sportId,sportName:a.sportName,matchId:c.matchId,matchProviderId:c.extProvIdItem,matchName:c.name,matchDate:c.date,tournamentId:c.tournamentId,tournamentName:c.tournamentName,categoryId:c.categoryId,categoryName:c.categoryName,eventCategory:c.eventCategory,groupNo:k.GroupNo,incompatibleEvents:c.incompatibleEvents,compatibleMarkets:k.CompatibleMarkets,selectionTypeId:s},l!=B&&l!=C||(g+=u+"|"+r.Outcome.OddOutcome+",")}c.tooltipOdds=g}}c.oddsLength=Object.keys(c.odds).length},generateHeaders:function(a){for(var b=0;b<a.markets.length;b++){var c=!0,d=a.markets[b],e=d.marketId,f=!1,g=null!=d.idGroup,h=0!=d.templateType;if(g&&(e=d.idGroupMarketType,h&&(f=!0)),f)for(var i=d.specialCount,j=d.selections.length/i,k=1,l=1,m=!0,n=0;n<d.selections.length;n++){m&&(a.headers.push({marketId:d.marketId,uniqueKey:[d.marketId,"spread",k].join("_"),isHeaderOnly:!0,name:locale.sports.events.eventOdds.spread,isNewMarket:c}),c=!1,m=!1);var o=d.selections[n];o.uniqueKey=[d.marketId,o.selectionId,k].join("_"),o.isNewMarket=c,c=!1,a.headers.push(o),l++,l>j&&(k++,l=1,m=!0)}else if(null==a.matches[0].collection||0!=a.matches[0].collection[Object.keys(a.matches[0].collection)[0]].outcome.length)for(var n=0;n<d.selections.length;n++){var o=d.selections[n],p=o.name,q=d.specialBetValue;d.isOutright?o.uniqueKey=[e,o.selectionId].join("_"):o.uniqueKey=[e,o.selectionId,q,p].join("_"),o.outrightHeaderName=d.name,o.isNewMarket=c,c=!1,a.headers.push(o)}else a.headers.push({uniqueKey:"markup",orderByKey:"markup",sortable:!0,outrightHeaderName:locale.account.betSearch.markup}),a.headers.push({uniqueKey:"pricePerShares",orderByKey:"pricePerShare",sortable:!0,outrightHeaderName:locale.account.betSearch.pricePerShares}),a.headers.push({uniqueKey:"availableShares",orderByKey:"availableShares",sortable:!1,outrightHeaderName:locale.account.betSearch.availableShares}),a.headers.push({uniqueKey:"buy",sortable:!1,outrightHeaderName:" "})}},validateNoOfChamps:function(b){if(null!=b&&null!=b.eventMarketIds){var c=globalSettings.DefaultNumOfEventsSelected;null!=a.numOfChampionships&&(c=a.numOfChampionships);var e=b.eventMarketIds.split(",").reverse().filter(Boolean);return!(e.length>c)||(e.splice(0,e.length-c),d.go("sportsMultipleEvents",{eventMarketIds:e.reverse().join(",")+","},{reload:!0}),!1)}},groupMatches:function(a){for(var b="sportsDateEvent"==d.current.name,c=0;c<a.matches.length;c++){var e=a.matches[c];if(b){var f=e.categoryName+" - "+e.tournamentName,g=f,h=f,i=moment(e.date).format("dddd, DD MMMM");a.matchesByDay.hasOwnProperty(f)||(a.matchesByDay[f]={dateStr:g,realdate:h,currentDate:i,matches:[]}),a.matchesByDay[f].matches.push(e)}else{var j=moment(e.date).dayOfYear(),g=moment(e.date).format("dddd, DD MMMM"),h=e.date;a.matchesByDay.hasOwnProperty(j)||(a.matchesByDay[j]={dateStr:g,realdate:h,matches:[]}),a.matchesByDay[j].matches.push(e)}}b||(a.matchesByDay=this.sortBy(a.matchesByDay,"realdate"))},sortBy:function(a,b){var c=[];for(var d in a)if(a.hasOwnProperty(d)){var e={};e[d]=a[d],e.tempSortName=a[d][b],c.push(e)}c.sort(function(a,b){var c=a.tempSortName,d=b.tempSortName;return c>d?1:c<d?-1:0});for(var f=[],g=0,h=c.length;g<h;g++){var e=c[g];delete e.tempSortName;for(var d in e)if(e.hasOwnProperty(d))var i=d;var j=e[i];f.push(j)}return f},addOddsDataToCache:function(a,b){for(var c=0;c<g.length;c++)if(g[c].eventId==a)return;g.push({eventId:a,promise:b})},getOddsDataFromCache:function(a){for(var b,c=0;c<g.length;c++)if(g[c].eventId==a){b=g[c];break}return b},clearEventFromCache:function(a){for(var b=0;b<g.length;b++)if(g[b].eventId=a){g.splice(b,1);break}},clearOddsDataCache:function(){g=[]},clearOldEventData:function(a){var b=g;g=[];for(var c=0;c<b.length;c++)for(e=0;e<a.length;e++)if(a[e]==b[c].eventId){g.push(b[c]);break}},saveMetaDataCache:function(){h={metaTitle:document.title,metaDescription:$('meta[name="description"]').attr("content"),metaKeywords:$('meta[name="keywords"]').attr("content")}},getMetaDataCache:function(){return h},getWidgetConfigs:function(a){var b=_.filter(i.list,function(a){return a.enabled}),c={mostPopularLeagueCount:i.mostPopularLeagueCount,mostPopularAllTabText:i.mostPopularAllTabText,mostPopularAllTabOrder:i.mostPopularAllTabOrder};f.desktop.getWidgetsList(globalSettings.CurrentLanguage).then(function(d){d.success&&d.data.list.length>0?a(_.filter(d.data.list,function(a){return a.enabled}),{mostPopularLeagueCount:d.data.mostPopularLeagueCount,mostPopularAllTabText:d.data.mostPopularAllTabText,mostPopularAllTabOrder:d.data.mostPopularAllTabOrder}):a(b,c)},function(){a(b,c)})},getWidgetConfig:function(a,b){return _.find(a,function(a){return a.type===b})}}}]).factory("eventsCacheService",["$q","sportsApiService",function(a,b){var c=null,d=null,e=function(a){return a.trim().replace(/[^A-Z0-9]/gi," ").replace(/\s+/gi,"-").replace(/^-+/gi,"").replace(/-+$/gi,"").toLowerCase()},f=function(){c=null,d=null;var e=a.defer();return a.all([b.feed.getPrematchTournaments(globalSettings.CurrentLanguage,4),b.feed.getOutrightTournaments(globalSettings.CurrentLanguage,4)]).then(function(a){return a[0].success&&a[1].success?(c={prematch:{sports:{}},outright:{sports:{}}},d={sports:{}},g(a[0].data,!1),g(a[1].data,!0),void e.resolve(!0)):void e.resolve(!1)}),e.promise},g=function(a,b){angular.forEach(a.Sports,function(a){var f=a.MenuUniqueID||a.SportID.toString();f&&f.indexOf("_")!=-1&&(f+="_"+a.SportID);var g=e(a.SportName),h=b?"outright":"prematch";c[h].sports[g]||(c[h].sports[g]={id:f,categories:{}});var i=c[h].sports[g];d.sports[f]||(d.sports[f]={name:g,categories:{}});var j=d.sports[f];angular.forEach(a.Category,function(a){var c=a.ItemID,d=e(a.ItemName);i.categories[d]||(i.categories[d]={id:c,tournaments:{}});var f=i.categories[d];j.categories[c]||(j.categories[c]={name:d,tournaments:{}});var g=j.categories[c];angular.forEach(a.Tournaments,function(a){var c=a.ItemID,d=e(a.ItemName);f.tournaments[d]={id:c},g.tournaments[c]={name:d,isOutright:b}})})})};return{getNameCache:function(){var b=a.defer();return null==c?f().then(function(a){return a?void b.resolve(c):void b.resolve(null)}):b.resolve(c),b.promise},getIdCache:function(){var b=a.defer();return null==d?f().then(function(a){return a?void b.resolve(d):void b.resolve(null)}):b.resolve(d),b.promise},convertToIds:function(b){var c=a.defer();return this.getNameCache().then(function(a){if(!a)return void c.resolve(null);var d=b.isOutright?"outright":"prematch",e=a[d].sports[b.sport.toLowerCase()];if(!e)return void c.resolve(null);var f=e.categories[b.category.toLowerCase()];if(!f)return void c.resolve(null);var g=f.tournaments[b.tournament.toLowerCase()];return g?void c.resolve({sport:e.id,category:f.id,tournament:g.id}):void c.resolve(null)}),c.promise},convertToNames:function(b){var c=a.defer();return this.getIdCache().then(function(a){if(!a)return void c.resolve(null);var d=a.sports[b.sport];if(!d)return void c.resolve(null);var e=d.categories[b.category];if(!e)return void c.resolve(null);var f=e.tournaments[b.tournament];return f?void c.resolve({sport:d.name,category:e.name,tournament:f.name,isOutright:f.isOutright}):void c.resolve(null)}),c.promise},getSportIdFromName:function(b,c){var d=a.defer();return this.getNameCache().then(function(a){if(!a)return void d.resolve(null);var e=c?"outright":"prematch",f=a[e].sports[b.toLowerCase()];return f?void d.resolve(f.id):void d.resolve(null)}),d.promise},getSportNameFromId:function(b){var c=a.defer();return this.getIdCache().then(function(a){if(!a)return void c.resolve(null);var d=a.sports[b];return d?void c.resolve(d.name):void c.resolve(null)}),c.promise}}}]).controller("SportsController",["$rootScope","$scope","$compile","$location","$uiRouterGlobals","$q","$localStorage","$transitions","$state","authService","umbracoApiService","sportsService","sportsApiService","platformApiService","thirdPartyApiService","f2pGuardianApiService","helperService","$window","$interval","loggingService","eventsCacheService","$timeout","couponService","matchOddsService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){function y(a,b){_.forEach(a,function(c,d){var e=c===b;e&&a.splice(d,1)})}function z(a){var b=a.expandOddFilters,c=angular.copy(g.oddsFilter,[]);globalSettings.Sports_OddsFilterExpandedByDefault?b?y(c,a.eventId):c.push(a.eventId):b?c.push(a.eventId):y(c,a.eventId),angular.copy(c,g.oddsFilter)}function A(a){var c=document.querySelector(".is-sticky"),d=[],e=function(){d=d.length>0?d:$(document.querySelector(".innerAllOdds"));var a=d.height()+d.offset().top-$(document).scrollTop()-$(c).outerHeight();(globalSettings.General_ContentScrollBars?$(document).scrollTop()+$(".main-header").height():$(document).scrollTop()>d.offset().top-$(c).outerHeight())?f(c):g(c),a>0?$(c).css({top:0}):$(c).css({top:a})},f=function(a){globalSettings.General_ContentScrollBars?$(a).hasClass("stickied-table")||($(a).addClass("stickied-table"),globalSettings.General_FullWidthLayout?$(a).addClass("full-width"):$(a).addClass("fixed-width")):$(a).hasClass("stickied")||($(a).addClass("stickied"),globalSettings.General_FullWidthLayout?$(a).addClass("full-width"):$(a).addClass("fixed-width"))},g=function(a){$(a).removeClass("stickied"),$(a).removeClass("stickied-table"),$(a).removeClass("full-width"),$(a).removeClass("fixed-width")};if(c){if(globalSettings.General_ContentScrollBars){var h=new IntersectionObserver(function(a){a[0].isIntersecting?g(c):f(c)});$(".region-area-wrapper").length&&h.observe($(".region-area-wrapper")[0])}else angular.element(r).on("scroll",e);b.$on("$destroy",function(){$("#match_"+a).removeClass("is-sticky"),angular.element(r).off("scroll"),$("#match_"+a).off("scroll")})}else{var i=document.querySelector(".stickied");i&&($(i).removeClass("stickied"),$(c).removeClass("full-width"),$(c).removeClass("fixed-width")),i=document.querySelector(".stickied-table"),i&&($(i).removeClass("stickied-table"),$(c).removeClass("full-width"),$(c).removeClass("fixed-width")),angular.element(r).off("scroll")}}var B=this,C=o.statistics;this.getWidgetConfig,this.widgetConfigList,this.widgetExtraDetails,l.saveMetaDataCache(),h.onStart({},function(a){var b=[];l.isPokerPage()?b.push(B.pokersharesMenuCtrl):(b.push(B.favouritesMenuCtrl),b.push(B.prematchMenuCtrl),b.push(B.outrightsMenuCtrl)),B.setMenuSelections(b,a.targetState().name(),a.params()),a.promise.finally(function(){var a=l.getTimeRange();B.getEventsByTimerange(a)})}),h.onSuccess({},function(b){if("sportsHome"==b.targetState().name()){var c=d.$$search.createSIDs;if(null!=c){var e=[c,w.getSelectionIds()].join(","),f=e.split(",").filter(function(a){return a.trim().length>0});f=_.uniq(f);var g=[];_.forEach(f,function(a){g.push({SelectionId:a.trim()})}),g.length>0&&(w.createCoupon(isNaN(d.$$search.stake)?null:parseFloat(d.$$search.stake),null,g),delete d.$$search.stake),delete d.$$search.createSIDs}if(!j.hasValidLogin()){var h=d.$$search.f2pToken;if(h)p.auth.validateToken(h).then(function(b){if(b.success&&b.data&&b.data.isValidated){var c=ngDialog.getOpenDialogs();ngDialog.close(c[0]);var e={f2pToken:h};a.upsellLoginDialog=ngDialog.open({template:"/partials/login/loginDialog.html",className:"loginForm",name:"LoginDialog",id:"LoginDialog",controller:"AuthController",controllerAs:"authCtrl",data:e,showClose:!0,closeByDocument:!1,closeByEscape:!1,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1})}else t.logError("Unable to get API token: "+JSON.stringify(b.error),"The token is not valid!");delete d.$$search.f2pToken});else{var i=d.$$search.bkToken;i&&a.$broadcast("loginWithTokenRequest",i),delete d.$$search.bkToken}}d.$$compose()}}),this.getMainBgImage=function(){k.desktop.getMainSectionBackground().then(function(a){a.success&&$(".container .Centralbody").append("<style>.mainContent:before{background-image:url("+a.data+")}</style>")})},this.getMainBgImage(),b.events=[],this.headToHeadData=[],this.lastMatchesData=[],this.nextMatchesData=[],this.overUnderData=[],this.goalscorerData=[],this.assistsData=[],this.cardsData=[],this.leagueRankingData=[],this.hasSection=!1,this.sportsbookInfo={},this.favouritesMenu=[],this.favouritesMenuCtrl={type:"favourites"},this.prematchMenu=[],this.prematchMenuCtrl={type:"matches"},this.outrightsMenu=[],this.outrightsMenuCtrl={type:"outrights"},this.pokersharesMenu=[],this.pokersharesMenuCtrl={type:"matches"},this.numOfChampOptions=[{value:5,text:"5"},{value:10,text:"10"},{value:15,text:"15"},{value:20,text:"20"},{value:25,text:"25"},{value:30,text:"All"}];var D=globalSettings.DefaultNumOfEventsSelected;null!=g.numOfChampionships&&(D=g.numOfChampionships);for(var E=0;E<this.numOfChampOptions.length;E++){var F=this.numOfChampOptions[E];if(F.value==D){this.selectedChampOption=F;break}}this.timeRange=null,this.timeRangeSlider={value:B.timeRange,options:{floor:1,ceil:4,step:1,showTicksValues:!0,translate:function(a){return locale.sports.events.upcomingEvents[a]},onEnd:function(a,b){l.setTimeRange(b),B.timeRange!=b&&(l.clearOddsDataCache(),i.reload())}}},B.broadcast=function(){s(function(){b.$broadcast("reCalcViewDimensions")},0,1)},this.sortType="name",this.reverse=!1,B.accessFromSports=!1,B.setOrder=function(a){B.reverse=this.sortType===a&&!B.reverse,B.sortType=a},B.getEventsByTimerange=function(a){B.timeRange!=a&&(this.timeRange=this.timeRangeSlider.value=a,l.isPokerPage()?B.loadPokersharesTournaments():(m.feed.getFeedInfo().then(function(a){return a.success?void(B.sportsbookInfo=a.data):void t.logError("Unable to get feed info: "+JSON.stringify(a.error))}),B.loadSportsTournaments()),B.broadcast())},this.parseDataForMenu=function(a,c,d,e){c.splice(0);var f=0;angular.forEach(a,function(g){var h=g.MenuUniqueID||g.SportID.toString();h&&h.indexOf("_")!=-1&&(h+="_"+g.SportID),e++;var i=!1;"matches"===d&&globalSettings.Sports_MenuAutoExpandMinSportCount>=a.length&&(f++,globalSettings.Sports_MenuAutoExpandSportOpenCount>=f&&(i=!0));var j={label:g.SportName,data:{id:h,type:d,order:e},children:[],onSelect:B.sportClicked,showItemIcon:!b.isPokerShares,expanded:i};angular.forEach(g.Category,function(a){e++;var b={label:a.ItemName,data:{id:h+"-"+a.ItemID,type:d,order:e},children:[],onBoxClick:B.categoryBoxClicked};angular.forEach(a.Tournaments,function(c){e++;var f={label:c.ItemName,data:{id:h+"-"+a.ItemID+"-"+c.ItemID,type:d,order:e,areaId:c.InitAreaID,regionId:c.InitRegionID},onSelect:B.tournamentClicked,hasFavourites:!0,onFavouriteSelect:B.addRemoveFavourite};b.children.push(f)}),j.children.push(b)}),c.push(j)})},this.parseDataForFavouritesMenu=function(a,c,d){c.splice(0);var e={label:locale.common.favourites,data:{id:0,type:d,order:0},children:[],showItemIcon:!b.isPokerShares,classes:["child-active"]},f={label:locale.common.favourites,data:{id:0,type:d,order:0},children:[]};e.children.push(f);var h=[];angular.forEach([B.prematchMenu,B.outrightsMenu],function(a){angular.forEach(a,function(a){angular.forEach(a.children,function(a){angular.forEach(a.children,function(a){h.push(a.data.id)})})})}),angular.forEach(a,function(a){var b=a.linkId.replace("-"+a.areaId+"-"+a.regionId,""),c=b.split("-")[2];if(!h.includes(b))return void(g.eventsAddToFavourites=$.grep(g.eventsAddToFavourites,function(a){return a.itemId!=c}));var e={label:a.itemName,data:{id:b,type:d,order:0,areaId:a.areaId,regionId:a.regionId},onSelect:B.tournamentClicked,hasFavourites:!0,onFavouriteSelect:B.addRemoveFavourite};f.children.push(e)}),0!==f.children.length&&c.push(e)},b.loadFavouritesTournaments=function(){B.favouritesMenu=[],void 0!=g.eventsAddToFavourites&&g.eventsAddToFavourites.length>0&&B.parseDataForFavouritesMenu(g.eventsAddToFavourites,B.favouritesMenu,"favourites")};var G=0;this.loadSportsTournaments=function(){B.prematchMenu=[];var a=[m.feed.getPrematchTournaments(globalSettings.CurrentLanguage,B.timeRange).then(function(a){return a.success?void B.parseDataForMenu(a.data.Sports,B.prematchMenu,"matches",G):void t.logError("Unable to get matches: "+JSON.stringify(a.error))}),m.feed.getOutrightTournaments(globalSettings.CurrentLanguage,B.timeRange).then(function(a){return a.success?void B.parseDataForMenu(a.data.Sports,B.outrightsMenu,"outright",G):void t.logError("Unable to get outrights: "+JSON.stringify(a.error))})];f.all(a).then(function(){b.loadFavouritesTournaments()})},this.loadPokersharesTournaments=function(){m.feed.getPokerTournaments(globalSettings.CurrentLanguage,B.timeRange).then(function(a){return a.success?void B.parseDataForMenu(a.data.Sports,B.pokersharesMenu,"matches",G):void t.logError("Unable to get pokershares tournaments: "+JSON.stringify(a.error))})},this.statisticsBetradar=function(d,e){e=e||!0;var g=globalSettings.Sports_BetRadarStatisticsURL;if(0!=globalSettings.Sports_BetRadarStatisticsEnabled&&null!=g&&0!=g.trim().length){var h=$(d.currentTarget),i=h.data("eventid"),j=h.data("externalprovid");g.endsWith("/")&&(g=g.slice(0,-1)),null!=j&&"undefined"!=j&&0!=j&&(1==globalSettings.Sports_BetRadarStatisticsEnabled?B.statisticsBetradarPopup(g,j):2==globalSettings.Sports_BetRadarStatisticsEnabled&&(B.headToHeadData=[],B.lastMatchesData=[],B.nextMatchesData=[],B.overUnderData=[],B.goalscorerData=[],B.assistsData=[],B.cardsData=[],B.leagueRankingData=[],"none"==$("#divStatisticsContainer_"+i).css("display")?($(".moreOddsContainer").css("display","none"),$("#match_"+i).removeClass("is-sticky"),A(i),a.showLoader(),v(function(){C.getMatchStatistics(globalSettings.CurrentLanguage,j).then(function(d){if(d.success){var h=d.data.doc[0],k=h.data._seasonid,l=h.data.teams.home.uid,m=h.data.teams.away.uid;if(!l||!m||!k)return a.hideLoader(),$("#divStatisticsContainer_"+i).css("display","none"),void $("#divStatisticsWidget_"+i).css("display","none");C.getHeadToHeadStatistics(globalSettings.CurrentLanguage,l,m).then(function(d){if(!d.success||_.isEmpty(d.data.doc[0].data.matches))B.headToHeadData={EventId:i},v(function(){$(".divStatisticsWidget #left-tabs #headToHead").css("display","none"),$(".divStatisticsWidget #right-container #content_headToHead").css("display","none"),$(".divStatisticsWidget #right-container #content_headToHead .sectionNotFound").css("display","block"),$(".divStatisticsWidget #right-container #content_headToHead .sectionFound").css("display","none")}.bind(this),0);else{var h=d.data.doc;h.EventId=i,h.HomeTeamId=l,h.AwayTeamId=m,B.headToHeadData=B.parseHeadToHeadData(h),B.hasSection=!0,v(function(){$(".divStatisticsWidget #left-tabs #headToHead").css("display","flex"),$(".divStatisticsWidget #right-container #content_headToHead .sectionNotFound").css("display","none"),$(".divStatisticsWidget #right-container #content_headToHead .sectionFound").css("display","block")}.bind(this),0)}var n=B.getLastMatches(l,m),o=B.getNextMatches(l,m),p=B.getOverUnder(l,m,k),q=B.getGoalscorer(l,m,k),r=B.getAssists(l,m,k),s=B.getCards(l,m,k),t=B.getLeagueRanking(l,m,k);f.all([n,o,p,q,r,s,t]).then(function(){a.hideLoader(),B.hasSection?(e?$("#divStatisticsContainer_"+i).css("display","table-row"):$("#divStatisticsContainer_"+i).css("display","block"),$("#divStatisticsWidget_"+i).css("display","flex"),$(".divStatisticsWidget #left-tabs > div, .divStatisticsWidget #right-container > div").removeClass("selected"),$(".divStatisticsWidget #left-tabs > div:visible").each(function(){return $(this).addClass("selected"),$(".divStatisticsWidget #right-container #content_"+$(this).attr("id")).addClass("selected"),!1}),$(".divStatisticsWidget #left-tabs #moreStatistics").css("display","flex"),$(".divStatisticsWidget #left-tabs #moreStatistics").attr("ng-click","sportsCtrl.statisticsBetradarPopup('"+g+"', "+j+")"),c($(".divStatisticsWidget #left-tabs #moreStatistics"))(b)):($("#divStatisticsContainer_"+i).css("display","none"),$("#divStatisticsWidget_"+i).css("display","none"),B.statisticsBetradarPopup(g,j))})})}else $("#divStatisticsContainer_"+i).css("display","none"),$("#divStatisticsWidget_"+i).css("display","none")})}.bind(this),0)):($("#divStatisticsContainer_"+i).css("display","none"),$("#divStatisticsWidget_"+i).css("display","none"))))}},this.getLastMatches=function(a,b){var c=f.defer();return C.getLastMatchesStatistics(globalSettings.CurrentLanguage,a).then(function(d){if(d.success&&d.data.doc[0].data&&!_.isEmpty(d.data.doc[0].data.matches)){var e=d.data.doc;C.getLastMatchesStatistics(globalSettings.CurrentLanguage,b).then(function(d){if(d.success&&d.data.doc[0].data&&!_.isEmpty(d.data.doc[0].data.matches)){var f=d.data.doc;$(".divStatisticsWidget #left-tabs #lastMatches").css("display","flex"),B.hasSection=!0,$(".divStatisticsWidget #right-container #content_lastMatches .sectionNotFound").css("display","none"),$(".divStatisticsWidget #right-container #content_lastMatches .sectionFound").css("display","block"),e.TeamId=a,f.TeamId=b,B.lastMatchesData=B.parseLastMatchesData(e,f)}else $(".divStatisticsWidget #left-tabs #lastMatches").css("display","none"),$(".divStatisticsWidget #right-container #content_lastMatches .sectionNotFound").css("display","block"),$(".divStatisticsWidget #right-container #content_lastMatches .sectionFound").css("display","none");c.resolve()})}else $(".divStatisticsWidget #left-tabs #lastMatches").css("display","none"),$(".divStatisticsWidget #right-container #content_lastMatches").css("display","none"),$(".divStatisticsWidget #right-container #content_lastMatches .sectionNotFound").css("display","block"),$(".divStatisticsWidget #right-container #content_lastMatches .sectionFound").css("display","none"),c.resolve()}),c.promise},this.getNextMatches=function(a,b){var c=f.defer();return C.getNextMatchesStatistics(globalSettings.CurrentLanguage,a).then(function(d){if(d.success&&d.data.doc[0].data&&!_.isEmpty(d.data.doc[0].data.matches)){var e=d.data.doc;C.getNextMatchesStatistics(globalSettings.CurrentLanguage,b).then(function(d){if(d.success&&d.data.doc[0].data&&!_.isEmpty(d.data.doc[0].data.matches)){var f=d.data.doc;$(".divStatisticsWidget #left-tabs #nextMatches").css("display","flex"),B.hasSection=!0,$(".divStatisticsWidget #right-container #content_nextMatches .sectionNotFound").css("display","none"),$(".divStatisticsWidget #right-container #content_nextMatches .sectionFound").css("display","block"),e.TeamId=a,f.TeamId=b,B.nextMatchesData=B.parseNextMatchesData(e,f)}else $(".divStatisticsWidget #left-tabs #nextMatches").css("display","none"),$(".divStatisticsWidget #right-container #content_nextMatches").css("display","none"),$(".divStatisticsWidget #right-container #content_nextMatches .sectionNotFound").css("display","block"),$(".divStatisticsWidget #right-container #content_nextMatches .sectionFound").css("display","none");c.resolve()})}else $(".divStatisticsWidget #left-tabs #nextMatches").css("display","none"),$(".divStatisticsWidget #right-container #content_nextMatches").css("display","none"),$(".divStatisticsWidget #right-container #content_nextMatches .sectionNotFound").css("display","block"),$(".divStatisticsWidget #right-container #content_nextMatches .sectionFound").css("display","none"),c.resolve()}),c.promise},this.getOverUnder=function(a,b,c){var d=f.defer();return C.getOverUnderStatistics(globalSettings.CurrentLanguage,c).then(function(c){if(c.success&&c.data.doc[0].data.stats&&c.data.doc[0].data.stats[a]&&c.data.doc[0].data.stats[a].total&&c.data.doc[0].data.stats[b]&&c.data.doc[0].data.stats[b].total){var e=c.data.doc;$(".divStatisticsWidget #left-tabs #overUnder").css("display","flex"),B.hasSection=!0,$(".divStatisticsWidget #right-container #content_overUnder .sectionNotFound").css("display","none"),$(".divStatisticsWidget #right-container #content_overUnder .sectionFound").css("display","block"),e.HomeTeamId=a,e.AwayTeamId=b,B.overUnderData=B.parseOverUnderData(e)}else $(".divStatisticsWidget #left-tabs #overUnder").css("display","none"),$(".divStatisticsWidget #right-container #content_overUnder").css("display","none"),$(".divStatisticsWidget #right-container #content_overUnder .sectionNotFound").css("display","block"),$(".divStatisticsWidget #right-container #content_overUnder .sectionFound").css("display","none");d.resolve()}),d.promise},this.getGoalscorer=function(a,b,c){var d=f.defer();return C.getGoalscorerStatistics(globalSettings.CurrentLanguage,c).then(function(c){if(!c.success||!c.data.doc[0].data||_.isEmpty(c.data.doc[0].data.teams[a])||_.isEmpty(c.data.doc[0].data.teams[b]))$(".divStatisticsWidget #right-container #content_playerStats #container_goalscorer .sectionNotFound").css("display","block"),$(".divStatisticsWidget #right-container #content_playerStats #container_goalscorer .sectionFound").css("display","none");else{var e=c.data.doc;$(".divStatisticsWidget #left-tabs #playerStats").css("display","flex"),B.hasSection=!0,$(".divStatisticsWidget #right-container #content_playerStats #container_goalscorer .sectionNotFound").css("display","none"),$(".divStatisticsWidget #right-container #content_playerStats #container_goalscorer .sectionFound").css("display","flex"),e.HomeTeamId=a,e.AwayTeamId=b,B.goalscorerData=B.parseGoalscorerData(e)}d.resolve()}),d.promise},this.getAssists=function(a,b,c){var d=f.defer();return C.getAssistsStatistics(globalSettings.CurrentLanguage,c).then(function(c){if(!c.success||!c.data.doc[0].data||_.isEmpty(c.data.doc[0].data.teams[a])||_.isEmpty(c.data.doc[0].data.teams[b]))$(".divStatisticsWidget #right-container #content_playerStats #container_assists .sectionNotFound").css("display","block"),$(".divStatisticsWidget #right-container #content_playerStats #container_assists .sectionFound").css("display","none");else{var e=c.data.doc;$(".divStatisticsWidget #left-tabs #playerStats").css("display","flex"),B.hasSection=!0,$(".divStatisticsWidget #right-container #content_playerStats #container_assists .sectionNotFound").css("display","none"),$(".divStatisticsWidget #right-container #content_playerStats #container_assists .sectionFound").css("display","flex"),e.HomeTeamId=a,e.AwayTeamId=b,B.assistsData=B.parseAssistsData(e)}d.resolve()}),d.promise},this.getCards=function(a,b,c){var d=f.defer();return C.getCardsStatistics(globalSettings.CurrentLanguage,c).then(function(c){if(!c.success||!c.data.doc[0].data||_.isEmpty(c.data.doc[0].data.teams[a])||_.isEmpty(c.data.doc[0].data.teams[b]))$(".divStatisticsWidget #right-container #content_playerStats #container_cards .sectionNotFound").css("display","block"),$(".divStatisticsWidget #right-container #content_playerStats #container_cards .sectionFound").css("display","none");else{var e=c.data.doc;$(".divStatisticsWidget #left-tabs #playerStats").css("display","flex"),B.hasSection=!0,$(".divStatisticsWidget #right-container #content_playerStats #container_cards .sectionNotFound").css("display","none"),$(".divStatisticsWidget #right-container #content_playerStats #container_cards .sectionFound").css("display","flex"),e.HomeTeamId=a,e.AwayTeamId=b,B.cardsData=B.parseCardsData(e)}d.resolve()}),d.promise},this.getLeagueRanking=function(a,b,c){var d=f.defer();return C.getSeasonTableStatistics(globalSettings.CurrentLanguage,c).then(function(c){if(c.success&&c.data.doc[0].data&&!_.isEmpty(c.data.doc[0].data.tables)){var e=c.data.doc;$(".divStatisticsWidget #left-tabs #leagueRanking").css("display","flex"),B.hasSection=!0,$(".divStatisticsWidget #right-container #content_leagueRanking .sectionNotFound").css("display","none"),$(".divStatisticsWidget #right-container #content_leagueRanking .sectionFound").css("display","block"),e.HomeTeamId=a,e.AwayTeamId=b,B.leagueRankingData=B.parseLeagueRankingData(e)}else $(".divStatisticsWidget #left-tabs #leagueRanking").css("display","none"),$(".divStatisticsWidget #right-container #content_leagueRanking").css("display","none"),$(".divStatisticsWidget #right-container #content_leagueRanking .sectionNotFound").css("display","block"),$(".divStatisticsWidget #right-container #content_leagueRanking .sectionFound").css("display","none");d.resolve()}),d.promise},this.statisticsBetradarPopup=function(a,b){a.endsWith("/")&&(a=a.slice(0,-1)),r.open(a+"/"+globalSettings.CurrentLanguage+"/match/"+b,"_blank","Height=700,Width=950,statusbar=yes,left=25,top=25,scrollbars=yes");
},this.closeStatisticsBetradar=function(a){$("#divStatisticsContainer_"+a).css("display","none"),$("#divStatisticsWidget_"+a).css("display","none")},this.sportClicked=function(a,b){var c="outright"==a.data.type?"outrights":"matches",d=a.data.id;l.isPokerPage()?i.go("pokersharesEvents",{eventType:c,sportId:d}):"matches"==c?i.go("sportsEventsPrematchBySport",{sport:d}):i.go("sportsEventsOutrightBySport",{sport:d})},this.categoryBoxClicked=function(a,b){a.expanded=!0;var c=[],d=e.params.eventMarketIds,f=[];d&&(f=e.params.eventMarketIds.split(","));for(var g=!0,h=0;h<a.children.length;h++){var j=a.children[h];if(null!=j&&null!=j.data&&null!=j.data.id){var k=!1;if(_.forEach(f,function(a,b){if(a&&a.indexOf("-")!=-1){var c=[a.split("-")[0],a.split("-")[1],a.split("-")[2]].join("-");k||c!=j.data.id||(k=!0)}}),!k){g=!1;break}}}for(var h=0;h<a.children.length;h++){var j=a.children[h];if(null!=j&&null!=j.data&&null!=j.data.id){var k=!1;_.forEach(f,function(a,b){if(a&&a.indexOf("-")!=-1){var c=[a.split("-")[0],a.split("-")[1],a.split("-")[2]].join("-");k||c!=j.data.id||(f.splice(b,1),k=!0)}}),k?g&&(d=f.join(",")):c.push(j.data.id+"-"+j.data.areaId+"-"+j.data.regionId+",")}}d&&c.push(d.replace(/,$/,"")),l.isPokerPage()?i.go("pokersharesMultipleEvents",{eventMarketIds:c.join(",")+","}):i.go("sportsMultipleEvents",{eventMarketIds:c.join(",")+","}),b.stopPropagation()},this.tournamentClicked=function(a,b){var c=f.defer();switch(i.current.name){case"sportsSingleEvent":case"pokersharesSingleEvent":u.convertToIds({sport:e.params.sport,category:e.params.category,tournament:e.params.tournament,isOutright:"o"==e.params.eventType}).then(function(b){if(!b)return void c.resolve("");var d=b.sport+"-"+b.category+"-"+b.tournament+"-"+e.params.areaId+"-"+e.params.regionId;d.indexOf(a.data.id)==-1?c.resolve(a.data.id+"-"+a.data.areaId+"-"+a.data.regionId+","+d+","):c.resolve("")});break;case"sportsMultipleEvents":case"pokersharesMultipleEvents":var d=e.params.eventMarketIds,g=e.params.eventMarketIds.split(","),h=!1;_.forEach(g,function(b,c){if(b&&b.indexOf("-")!=-1){var d=[b.split("-")[0],b.split("-")[1],b.split("-")[2]].join("-");h||d!=a.data.id||(g.splice(c,1),h=!0)}}),h?c.resolve(g.join(",")):c.resolve(a.data.id+"-"+a.data.areaId+"-"+a.data.regionId+","+d);break;default:c.resolve(a.data.id+"-"+a.data.areaId+"-"+a.data.regionId+",")}c.promise.then(function(a){var b=a.split(",").filter(Boolean);if(0==b.length){var c=l.isPokerPage()?"pokershares":"sportsHome";i.go(c,{})}else if(1==b.length){var d=b[0].split("-"),e=d[0],f=d[1],g=d[2],h=d[3],j=d[4];u.convertToNames({sport:e,category:f,tournament:g}).then(function(a){if(!a){var b=l.isPokerPage()?"pokershares":"sportsHome";return void i.go(b,{})}var b=l.isPokerPage()?"pokersharesSingleEvent":"sportsSingleEvent";i.go(b,{eventType:a.isOutright?"o":"p",sport:a.sport,category:a.category,tournament:a.tournament,areaId:h,regionId:j})})}else{var c=l.isPokerPage()?"pokersharesMultipleEvents":"sportsMultipleEvents";i.go(c,{eventMarketIds:a})}})},this.closeTournament=function(a){if(null!=a&&null!=a.currentTarget){var b=f.defer();switch(i.current.name){case"sportsSingleEvent":case"pokersharesSingleEvent":b.resolve("");break;case"sportsMultipleEvents":case"pokersharesMultipleEvents":var c=e.params.eventMarketIds,d=$(a.currentTarget).data("menuid"),g=c.indexOf(d),h=c.indexOf(",",g);h<g?h=c.length:h++;var j=c.substring(g,h);c=c.replace(j,""),b.resolve(c);break;default:b.resolve("")}b.promise.then(function(a){l.isPokerPage()?i.go("pokersharesMultipleEvents",{eventMarketIds:a}):i.go("sportsMultipleEvents",{eventMarketIds:a})})}},this.toggleMarketsDescription=function(a){if(null!=a&&null!=a.currentTarget){var b=$(a.currentTarget);b.toggleClass("opened"),b.parent().parent().next().stop().toggle()}},this.closeMarketsDescription=function(a){if(null!=a&&null!=a.currentTarget){var b=$(a.currentTarget);b.parent().parent().prev().find(".infoIcon").removeClass("opened"),b.parent().parent().stop(),b.parent().parent().toggle()}},this.oddsFilterClicked=function(a){a.expandOddFilters=!a.expandOddFilters,z(a)},this.bettingHelpClicked=function(){r.location.href=globalSettings.Sports_OddsViewHelpUrl},b.formatInnerOddsById=function(a){$(window).width()<=1300?$(a).css("max-width","calc(100% - 188px)"):$(a).css("max-width","calc(100% - 173px)"),$(a).prev().css("width","calc(100% - "+$(a).width()+"px)")},this.oddsOneEventClicked=function(a){var b=$(a.currentTarget),c=b.parent().data("menuid");globalSettings.Sports_EnableExpandedOdds&&("block"==$("#area_"+c).css("display")?($("#area_"+c).toggle(),b.parent().toggleClass("opened"),b.toggleClass("opened")):(b.parent().toggleClass("opened"),b.toggleClass("opened"),$("#area_"+c).toggle()))},this.toggleTournament=function(a){var b=$(a);b.hasClass("active")?b.removeClass("active"):b.addClass("active")},this.addRemoveFavourite=function(a){var c=$(a.currentTarget),d=c.data("item-id").split("-")[2];if(c.hasClass("active"))g.eventsAddToFavourites=$.grep(g.eventsAddToFavourites,function(a){return a.itemId!=d});else{var e={itemId:d,itemName:c.parent().find(".tree-label").text(),linkId:c.data("item-id")+"-"+c.data("area-id")+"-"+c.data("region-id"),areaId:c.data("area-id"),regionId:c.data("region-id")};if(void 0!=g.eventsAddToFavourites)if(g.eventsAddToFavourites.length<globalSettings.DefaultNumOfFavouritesSelected)if(null==g.eventsAddToFavourites)g.eventsAddToFavourites.push(e);else{var f=g.eventsAddToFavourites.filter(function(a){return a.itemId==d})[0];void 0==f&&g.eventsAddToFavourites.push(e)}else q.showErrorMessage(locale.sports.events.maxAddedFavourites.replace("{0}",globalSettings.DefaultNumOfFavouritesSelected)).done();else g.eventsAddToFavourites=[],g.eventsAddToFavourites.push(e)}b.loadFavouritesTournaments()},this.oneEventClicked=function(a){},this.matchNameClicked=function(a,b){if(B.accessFromSports=!0,"true"==b){var c=$(a.currentTarget);i.go("sportsMatchView",{eventId:c.data("eventid"),matchId:c.data("matchid"),matchName:c.data("matchname").replace(/\s+/g,"").replace(/\./g,"")})}},this.eventPageClicked=function(a,b){if(b=b||"false","true"==b)return void this.matchNameClicked(a,b);var c=$(a.currentTarget),d=c.data("eventid"),e=c.data("smartbetcode");l.isPokerPage()?i.go("pokersharesMultipleEvents",{eventMarketIds:d+"-0-0",matchId:e}):i.go("sportsMultipleEvents",{eventMarketIds:d+"-0-0",matchId:e})},this.clearMoreOddsEventSelection=function(){B.moreEventOdds=[]},this.moreEventOddsClicked=function(a){var b=$(a.currentTarget),c=b.data("eventid"),e=b.data("areaid");$("#divStatisticsContainer_"+c).css("display","none"),d.$$search.matchId&&(delete d.$$search.matchId,d.$$compose()),s(function(){$("#moreOddsContainer_"+c).prev().find(".moreOdds").toggleClass("selected"),$("#moreOddsContainer_"+c).prev().find(".moreOdds i").toggleClass("rotateIcon");var a=!1;if($("#match_"+c).hasClass("is-sticky")||(a=!0),$(".is-sticky").removeClass("is-sticky stickied"),$(".is-sticky").removeClass("is-sticky stickied-table"),$(".is-sticky").removeClass("full-width"),$(".is-sticky").removeClass("fixed-width"),a&&$("#match_"+c).addClass("is-sticky"),"none"==$("#moreOddsContainer_"+c).css("display")){$(".moreOddsContainer").each(function(){$(this).find(".allMarkets").css("display","none"),$(this).css("display","none"),$(this).prev().removeClass("selected")});var b=globalSettings.CurrentLanguage,d=l.getTimeRange();m.feed.getEventOddFeedUngroupedLite(b,d,c,e).then(function(a){a.success||t.logError("Unable to get event odd feed ungrouped: "+JSON.stringify(a.error)),B.parseMoreEventData(a.data),x.initialiseOddsCollection(B.moreEventOdds.OddsCollection),$("#moreOddsContainer_"+c).slideToggle(function(){$(this).prev().addClass("selected"),$("#moreOddsContainer_"+c+" .allMarkets").slideToggle(B.flashMatchName(c)),A(c)})})}else B.moreEventOdds=[],$("#moreOddsContainer_"+c+" .allMarkets").slideToggle(function(){$("#moreOddsContainer_"+c).prev().removeClass("selected"),$("#moreOddsContainer_"+c).slideToggle(B.flashMatchName(c)),A(c)})}.bind(this),0,1)},this.flashMatchName=function(a){globalSettings.General_ContentScrollBars||$("body,html").stop().animate({scrollTop:$("#match_"+a).offset().top+5},"fast")},this.parseMoreEventData=function(a){return null!=a.noOddsEventId?void $("#moreOddsContainer_"+a.noOddsEventId).css("display","none"):void(B.moreEventOdds=l.parseMoreEventData(a))},this.parseHeadToHeadData=function(a){result=a[0].data;try{var b=[];b.EventId=a.EventId,b.TeamHomeID=a.HomeTeamId,b.TeamAwayID=a.AwayTeamId,b.TeamHomeName=result.teams[a.HomeTeamId].mediumname,b.TeamAwayName=result.teams[a.AwayTeamId].mediumname,b.HeadToHeadHistory=[],b.TeamHomeWins=0,b.TeamDraws=0,b.TeamAwayWins=0;var c=0;angular.forEach(result.matches,function(d){if(c++,"home"==d.result.winner?d.teams.home.uid==a.HomeTeamId?b.TeamHomeWins++:b.TeamAwayWins++:"away"==d.result.winner?d.teams.away.uid==a.AwayTeamId?b.TeamAwayWins++:b.TeamHomeWins++:b.TeamDraws++,c<=globalSettings.Sports_StatisticsWidgetNumberOfMaches){var e=[],f="";f=d.roundname&&void 0!=d.roundname.shortname&&null!=d.roundname.shortname&&""!=d.roundname.shortname?result.tournaments[d._tid].abbr+" "+d.roundname.shortname:d.roundname&&void 0!=d.roundname.name&&null!=d.roundname.name&&""!=d.roundname.name?result.tournaments[d._tid].abbr+" "+d.roundname.name:result.tournaments[d._tid].abbr,e={Date:d.time.date,TeamHomeId:d.teams.home.uid,TeamHomeName:d.teams.home.mediumname,TeamAwayId:d.teams.away.uid,TeamAwayName:d.teams.away.mediumname,Winner:d.result.winner||"draw",Score:d.result.home+" : "+d.result.away,Round:f},b.HeadToHeadHistory.push(e)}});var d=b.TeamHomeWins+b.TeamDraws+b.TeamAwayWins,e=b.TeamHomeWins/d*100,f=b.TeamDraws/d*100,g=b.TeamAwayWins/d*100;b.TeamHomeWinsPerc=e.toFixed(0),b.TeamDrawsPerc=f.toFixed(0),b.TeamAwayWinsPerc=g.toFixed(0),v(function(){$(".teamHomeWins .statusBar > div").width(0).animate({width:e+"%"},2e3),$(".teamDraws .statusBar > div").width(0).animate({width:f+"%"},2e3),$(".teamAwayWins .statusBar > div").width(0).animate({width:g+"%"},2e3)}.bind(this),10)}catch(a){console.log(a.message)}return b},this.parseLastMatchesData=function(a,b){var c=a[0].data,d=b[0].data;try{var e=[];e.TeamHomeID=c.team._id,e.TeamAwayID=d.team._id,e.TeamHomeName=c.team.mediumname,e.TeamAwayName=d.team.mediumname,e.HomeLastResults=[],e.AwayLastResults=[],e.HomeMatches=[],e.AwayMatches=[];var f=0;angular.forEach(c.matches,function(b){if(f++,f-1<=globalSettings.Sports_StatisticsWidgetNumberOfMaches){var d="home";if(a.TeamId==b.teams.away.uid&&(d="away"),null==b.result.winner?e.HomeLastResults.push("D_"+f):b.result.winner==d?e.HomeLastResults.push("W_"+f):e.HomeLastResults.push("L_"+f),f<=globalSettings.Sports_StatisticsWidgetNumberOfMaches){var g=[],h="";h=b.roundname&&void 0!=b.roundname.shortname&&null!=b.roundname.shortname&&""!=b.roundname.shortname?c.tournaments[b._tid].abbr+" "+b.roundname.shortname:b.roundname&&void 0!=b.roundname.name&&null!=b.roundname.name&&""!=b.roundname.name?c.tournaments[b._tid].abbr+" "+b.roundname.name:c.tournaments[b._tid].abbr,g={Date:b.time.date,TeamHomeId:b.teams.home.uid,TeamHomeName:b.teams.home.mediumname,TeamAwayId:b.teams.away.uid,TeamAwayName:b.teams.away.mediumname,Winner:b.result.winner||"draw",Score:(null!=b.result.home?b.result.home:"-")+" : "+(null!=b.result.away?b.result.away:"-"),Round:h},e.HomeMatches.push(g)}}}),f=0,angular.forEach(d.matches,function(a){if(f++,f-1<=globalSettings.Sports_StatisticsWidgetNumberOfMaches){var c="home";if(b.TeamId==a.teams.away.uid&&(c="away"),null==a.result.winner?e.AwayLastResults.push("D_"+f):a.result.winner==c?e.AwayLastResults.push("W_"+f):e.AwayLastResults.push("L_"+f),f<=globalSettings.Sports_StatisticsWidgetNumberOfMaches){var g=[],h="";h=a.roundname&&void 0!=a.roundname.shortname&&null!=a.roundname.shortname&&""!=a.roundname.shortname?d.tournaments[a._tid].abbr+" "+a.roundname.shortname:a.roundname&&void 0!=a.roundname.name&&null!=a.roundname.name&&""!=a.roundname.name?d.tournaments[a._tid].abbr+" "+a.roundname.name:d.tournaments[a._tid].abbr,g={Date:a.time.date,TeamHomeId:a.teams.home.uid,TeamHomeName:a.teams.home.mediumname,TeamAwayId:a.teams.away.uid,TeamAwayName:a.teams.away.mediumname,Winner:a.result.winner||"draw",Score:(null!=a.result.home?a.result.home:"-")+" : "+(null!=a.result.away?a.result.away:"-"),Round:h},e.AwayMatches.push(g)}}})}catch(a){console.log(a.message)}return e},this.parseNextMatchesData=function(a,b){var c=a[0].data,d=b[0].data;try{var e=[];e.TeamHomeID=c.team._id,e.TeamAwayID=d.team._id,e.TeamHomeName=c.team.mediumname,e.TeamAwayName=d.team.mediumname,e.HomeMatches=[],e.AwayMatches=[];var f=0;angular.forEach(c.matches,function(a){if(f++,f<=globalSettings.Sports_StatisticsWidgetNumberOfMaches){var b=[],d="";d=a.roundname&&void 0!=a.roundname.shortname&&null!=a.roundname.shortname&&""!=a.roundname.shortname?c.tournaments[a._tid].abbr+" "+a.roundname.shortname:a.roundname&&void 0!=a.roundname.name&&null!=a.roundname.name&&""!=a.roundname.name?c.tournaments[a._tid].abbr+" "+a.roundname.name:c.tournaments[a._tid].abbr,b={Date:a.time.date,TeamHomeId:a.teams.home.uid,TeamHomeName:a.teams.home.mediumname,TeamAwayId:a.teams.away.uid,TeamAwayName:a.teams.away.mediumname,Winner:a.result.winner||"draw",Score:"- : -",Round:d},e.HomeMatches.push(b)}}),f=0,angular.forEach(d.matches,function(a){if(f++,f<=globalSettings.Sports_StatisticsWidgetNumberOfMaches){var b=[],c="";a._tid;c=a.roundname&&void 0!=a.roundname.shortname&&null!=a.roundname.shortname&&""!=a.roundname.shortname?d.tournaments[a._tid].abbr+" "+a.roundname.shortname:a.roundname&&void 0!=a.roundname.name&&null!=a.roundname.name&&""!=a.roundname.name?d.tournaments[a._tid].abbr+" "+a.roundname.name:d.tournaments[a._tid].abbr,b={Date:a.time.date,TeamHomeId:a.teams.home.uid,TeamHomeName:a.teams.home.mediumname,TeamAwayId:a.teams.away.uid,TeamAwayName:a.teams.away.mediumname,Winner:a.result.winner||"draw",Score:"- : -",Round:c},e.AwayMatches.push(b)}})}catch(a){console.log(a.message)}return e},this.parseOverUnderData=function(a){var b=a[0].data;try{var c=b.stats[a.HomeTeamId],d=b.stats[a.AwayTeamId],e={allfulltime:[],all1sthalf:[],all2ndhalf:[],homefulltime:[],home1sthalf:[],home2ndhalf:[],awayfulltime:[],away1sthalf:[],away2ndhalf:[]};angular.forEach(Object.keys(c.total.ft),function(a){var b={spread:a,teams:[{teamId:c.team._id,teamName:c.team.mediumname,played:c.matches,over:c.total.ft[a].over,under:c.total.ft[a].under,averageGoalscored:c.goalsscored.ft.average,cleanSheet:c.conceded.ft.cleansheets,atLeastOneGoal:c.goalsscored.ft.atleastonegoal,order:1},{teamId:d.team._id,teamName:d.team.mediumname,played:d.matches,over:d.total.ft[a].over,under:d.total.ft[a].under,averageGoalscored:d.goalsscored.ft.average,cleanSheet:d.conceded.ft.cleansheets,atLeastOneGoal:d.goalsscored.ft.atleastonegoal,order:2}]};e.allfulltime.push(b)}),c.total.p1&&angular.forEach(Object.keys(c.total.p1),function(a){var b={spread:a,teams:[{teamId:c.team._id,teamName:c.team.mediumname,played:c.matches,over:c.total.p1[a].over,under:c.total.p1[a].under,averageGoalscored:c.goalsscored.p1.average,cleanSheet:c.conceded.p1.cleansheets,atLeastOneGoal:c.goalsscored.p1.atleastonegoal,order:1},{teamId:d.team._id,teamName:d.team.mediumname,played:d.matches,over:d.total.p1[a].over,under:d.total.p1[a].under,averageGoalscored:d.goalsscored.p1.average,cleanSheet:d.conceded.p1.cleansheets,atLeastOneGoal:d.goalsscored.p1.atleastonegoal,order:2}]};e.all1sthalf.push(b)}),c.total.p2&&angular.forEach(Object.keys(c.total.p2),function(a){var b={spread:a,teams:[{teamId:c.team._id,teamName:c.team.mediumname,played:c.matches,over:c.total.p2[a].over,under:c.total.p2[a].under,averageGoalscored:c.goalsscored.p2.average,cleanSheet:c.conceded.p2.cleansheets,atLeastOneGoal:c.goalsscored.p2.atleastonegoal,order:1},{teamId:d.team._id,teamName:d.team.mediumname,played:d.matches,over:d.total.p2[a].over,under:d.total.p2[a].under,averageGoalscored:d.goalsscored.p2.average,cleanSheet:d.conceded.p2.cleansheets,atLeastOneGoal:d.goalsscored.p2.atleastonegoal,order:2}]};e.all2ndhalf.push(b)}),angular.forEach(Object.keys(c.home.ft),function(a){var b={spread:a,teams:[{teamId:c.team._id,teamName:c.team.mediumname,played:c.homematches,over:c.home.ft[a].over,under:c.home.ft[a].under,averageGoalscored:c.goalsscored.fthome.average,cleanSheet:c.conceded.fthome.cleansheets,atLeastOneGoal:c.goalsscored.fthome.atleastonegoal,order:1},{teamId:d.team._id,teamName:d.team.mediumname,played:d.homematches,over:d.home.ft[a].over,under:d.home.ft[a].under,averageGoalscored:d.goalsscored.fthome.average,cleanSheet:d.conceded.fthome.cleansheets,atLeastOneGoal:d.goalsscored.fthome.atleastonegoal,order:2}]};e.homefulltime.push(b)}),c.home.p1&&angular.forEach(Object.keys(c.home.p1),function(a){var b={spread:a,teams:[{teamId:c.team._id,teamName:c.team.mediumname,played:c.homematches,over:c.home.p1[a].over,under:c.home.p1[a].under,averageGoalscored:c.goalsscored.p1home.average,cleanSheet:c.conceded.p1home.cleansheets,atLeastOneGoal:c.goalsscored.p1home.atleastonegoal,order:1},{teamId:d.team._id,teamName:d.team.mediumname,played:d.homematches,over:d.home.p1[a].over,under:d.home.p1[a].under,averageGoalscored:d.goalsscored.p1home.average,cleanSheet:d.conceded.p1home.cleansheets,atLeastOneGoal:d.goalsscored.p1home.atleastonegoal,order:2}]};e.home1sthalf.push(b)}),c.home.p2&&angular.forEach(Object.keys(c.home.p2),function(a){var b={spread:a,teams:[{teamId:c.team._id,teamName:c.team.mediumname,played:c.homematches,over:c.home.p2[a].over,under:c.home.p2[a].under,averageGoalscored:c.goalsscored.p2home.average,cleanSheet:c.conceded.p2home.cleansheets,atLeastOneGoal:c.goalsscored.p2home.atleastonegoal,order:1},{teamId:d.team._id,teamName:d.team.mediumname,played:d.homematches,over:d.home.p2[a].over,under:d.home.p2[a].under,averageGoalscored:d.goalsscored.p2home.average,cleanSheet:d.conceded.p2home.cleansheets,atLeastOneGoal:d.goalsscored.p2home.atleastonegoal,order:2}]};e.home2ndhalf.push(b)}),angular.forEach(Object.keys(c.away.ft),function(a){var b={spread:a,teams:[{teamId:c.team._id,teamName:c.team.mediumname,played:c.awaymatches,over:c.away.ft[a].over,under:c.away.ft[a].under,averageGoalscored:c.goalsscored.ftaway.average,cleanSheet:c.conceded.ftaway.cleansheets,atLeastOneGoal:c.goalsscored.ftaway.atleastonegoal,order:1},{teamId:d.team._id,teamName:d.team.mediumname,played:d.awaymatches,over:d.away.ft[a].over,under:d.away.ft[a].under,averageGoalscored:d.goalsscored.ftaway.average,cleanSheet:d.conceded.ftaway.cleansheets,atLeastOneGoal:d.goalsscored.ftaway.atleastonegoal,order:2}]};e.awayfulltime.push(b)}),c.away.p1&&angular.forEach(Object.keys(c.away.p1),function(a){var b={spread:a,teams:[{teamId:c.team._id,teamName:c.team.mediumname,played:c.awaymatches,over:c.away.p1[a].over,under:c.away.p1[a].under,averageGoalscored:c.goalsscored.p1away.average,cleanSheet:c.conceded.p1away.cleansheets,atLeastOneGoal:c.goalsscored.p1away.atleastonegoal,order:1},{teamId:d.team._id,teamName:d.team.mediumname,played:d.awaymatches,over:d.away.p1[a].over,under:d.away.p1[a].under,averageGoalscored:d.goalsscored.p1away.average,cleanSheet:d.conceded.p1away.cleansheets,atLeastOneGoal:d.goalsscored.p1away.atleastonegoal,order:2}]};e.away1sthalf.push(b)}),c.away.p2&&angular.forEach(Object.keys(c.away.p2),function(a){var b={spread:a,teams:[{teamId:c.team._id,teamName:c.team.mediumname,played:c.awaymatches,over:c.away.p2[a].over,under:c.away.p2[a].under,averageGoalscored:c.goalsscored.p2away.average,cleanSheet:c.conceded.p2away.cleansheets,atLeastOneGoal:c.goalsscored.p2away.atleastonegoal,order:1},{teamId:d.team._id,teamName:d.team.mediumname,played:d.awaymatches,over:d.away.p2[a].over,under:d.away.p2[a].under,averageGoalscored:d.goalsscored.p2away.average,cleanSheet:d.conceded.p2away.cleansheets,atLeastOneGoal:d.goalsscored.p2away.atleastonegoal,order:2}]};e.away2ndhalf.push(b)}),angular.forEach(e,function(a){angular.forEach(a,function(a){angular.forEach(a.teams,function(a){a.overPerc=Math.round(a.over/(a.over+a.under)*100*100)/100,a.underPerc=Math.round(a.under/(a.over+a.under)*100*100)/100,a.cleanSheetsPerc=Math.floor(a.cleanSheet/(a.over+a.under)*100),a.atLeastOneGoalPerc=Math.floor(a.atLeastOneGoal/(a.over+a.under)*100)})})})}catch(a){console.log(a.message)}return e},this.parseGoalscorerData=function(a){var b=a[0].data;try{var c=[];c.TeamHomeID=a.HomeTeamId,c.TeamAwayID=a.AwayTeamId,c.TeamHomeName=b.teams[a.HomeTeamId].mediumname,c.TeamAwayName=b.teams[a.AwayTeamId].mediumname,c.HomeGoalscorers=[],c.AwayGoalscorers=[];var d=0,e=0;angular.forEach(b.players,function(b){var f=[];f={position:b.player.position.shortname,name:b.player.name,nationality:b.player.nationality.a2,matches:b.total.matches,goals:b.total.goals},null!=b.teams[a.HomeTeamId]?(d++,d<=globalSettings.Sports_StatisticsWidgetNumberOfMaches&&c.HomeGoalscorers.push(f)):null!=b.teams[a.AwayTeamId]&&(e++,e<=globalSettings.Sports_StatisticsWidgetNumberOfMaches&&c.AwayGoalscorers.push(f))})}catch(a){console.log(a.message)}return c},this.parseAssistsData=function(a){var b=a[0].data;try{var c=[];c.TeamHomeID=a.HomeTeamId,c.TeamAwayID=a.AwayTeamId,c.TeamHomeName=b.teams[a.HomeTeamId].mediumname,c.TeamAwayName=b.teams[a.AwayTeamId].mediumname,c.HomeAssists=[],c.AwayAssists=[];var d=0,e=0;angular.forEach(b.players,function(b){var f=[];f={position:b.player.position.shortname,name:b.player.name,nationality:b.player.nationality.a2,matches:b.total.matches,assists:b.total.assists},null!=b.teams[a.HomeTeamId]?(d++,d<=globalSettings.Sports_StatisticsWidgetNumberOfMaches&&c.HomeAssists.push(f)):null!=b.teams[a.AwayTeamId]&&(e++,e<=globalSettings.Sports_StatisticsWidgetNumberOfMaches&&c.AwayAssists.push(f))})}catch(a){console.log(a.message)}return c},this.parseCardsData=function(a){var b=a[0].data;try{var c=[];c.TeamHomeID=a.HomeTeamId,c.TeamAwayID=a.AwayTeamId,c.TeamHomeName=b.teams[a.HomeTeamId].mediumname,c.TeamAwayName=b.teams[a.AwayTeamId].mediumname,c.HomeCards=[],c.AwayCards=[];var d=0,e=0;angular.forEach(b.players,function(b){var f=[];f={position:b.player.position.shortname,name:b.player.name,nationality:b.player.nationality.a2,matches:b.total.matches,yellowCards:b.total.yellow_cards||0,yellowRedCards:b.total.yellowred_cards||0,redCards:b.total.red_cards||0},null!=b.teams[a.HomeTeamId]?(d++,d<=globalSettings.Sports_StatisticsWidgetNumberOfMaches&&c.HomeCards.push(f)):null!=b.teams[a.AwayTeamId]&&(e++,e<=globalSettings.Sports_StatisticsWidgetNumberOfMaches&&c.AwayCards.push(f))})}catch(a){console.log(a.message)}return c},this.parseLeagueRankingData=function(a){var b=a[0].data;try{var c=a.HomeTeamId,d=a.AwayTeamId,e=[],f="",g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0;if(0!=b.length&&0!=b.tables.length){var p=b.tables;p.length>1&&(p=b.tables.filter(function(a){return a.tablerows.filter(function(a){return a.team.uid==c}).length>0}));var q=p[0].tablerows.filter(function(a){return a.team.uid==c})[0];void 0!=q&&(f=q.team.mediumname,g=q.pos,h=q.total,i=q.winTotal,j=q.drawTotal,k=q.lossTotal,l=q.goalsForTotal,m=q.goalsAgainstTotal,n=q.goalDiffTotal,o=q.pointsTotal)}var r={position:g,teamId:c,teamName:f,played:h,won:i,drawn:j,lost:k,goalsFor:l,goalsAgainst:m,goalsDifference:n,points:o};e.push(r);var s="",g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0;if(0!=b.length&&0!=b.tables.length){var p=b.tables;p.length>1&&(p=b.tables.filter(function(a){return a.tablerows.filter(function(a){return a.team.uid==c}).length>0}));var t=p[0].tablerows.filter(function(a){return a.team.uid==d})[0];void 0!=t&&(s=t.team.mediumname,g=t.pos,h=t.total,i=t.winTotal,j=t.drawTotal,k=t.lossTotal,l=t.goalsForTotal,m=t.goalsAgainstTotal,n=t.goalDiffTotal,o=t.pointsTotal)}var r={position:g,teamId:d,teamName:s,played:h,won:i,drawn:j,lost:k,goalsFor:l,goalsAgainst:m,goalsDifference:n,points:o};e.push(r)}catch(a){console.log(a.message)}return e},this.onMenuDataBound=function(a){if(null!=a&&null!=e.params){var b=[];"favouritesMenu"==a?(b.push(B.favouritesMenuCtrl),B.favouritesMenuCtrl.expand_all()):"prematchMenu"==a?b.push(B.prematchMenuCtrl):"outrightsMenu"==a?b.push(B.outrightsMenuCtrl):"pokersharesMenu"==a&&(b.push(B.pokersharesMenuCtrl),B.pokersharesMenuCtrl.expand_all()),B.setMenuSelections(b,i.current.name,e.params)}},this.setMenuSelections=function(a,b,c){var d=f.defer();switch(b){case"sportsSingleEvent":case"pokersharesSingleEvent":u.convertToIds({sport:c.sport,category:c.category,tournament:c.tournament,isOutright:"o"==c.eventType}).then(function(a){if(!a)return void d.reject();var b=a.sport+"-"+a.category+"-"+a.tournament+"-"+c.areaId;d.resolve({eventMarketIds:b})});break;case"sportsMultipleEvents":case"pokersharesMultipleEvents":d.resolve({eventMarketIds:c.eventMarketIds});break;case"sportsEventsPrematchBySport":u.getSportIdFromName(c.sport,!1).then(function(a){null==a?d.resolve({}):d.resolve({sportId:a})});break;case"sportsEventsOutrightBySport":u.getSportIdFromName(c.sport,!0).then(function(a){null==a?d.resolve({}):d.resolve({sportId:a})});break;case"sportsHome":case"sportsEventsPrematch":case"sportsEventsOutright":case"sportsLessThanTwo":case"predictorGroupStage":case"predictorKnockoutStage":case"pokersharesEvents":d.resolve({});break;default:d.reject()}d.promise.then(function(c){angular.forEach(a,function(a){var d=[];if(null!=c.eventMarketIds)$.each(c.eventMarketIds.split(",").filter(Boolean),function(a,b){var c=b.split("-").filter(Boolean);d.push([c[0],c[1],c[2]].join("-"))});else if(null!=c.sportId){var e="sportsEventsPrematchBySport"==b?"matches":"outrights";e==a.type&&d.push(c.sportId+"")}a.set_selected_branches(d)})})},this.changeNoOfChamps=function(){g.numOfChampionships=B.selectedChampOption,i.reload()},this.changeArrow=function(a){var b=$(a.currentTarget),c=$(b).find("i:first-child");return c.hasClass("fa-caret-right")?(c.removeClass("fa-caret-right"),c.addClass("fa-caret-down"),void b.addClass("expanded")):c.hasClass("fa-caret-down")?(c.removeClass("fa-caret-down"),c.addClass("fa-caret-right"),void b.removeClass("expanded")):void 0},this.positionGoalscorer=function(a){v(function(){$("body,html").stop().animate({scrollTop:$(a.currentTarget).offset().top},"fast")}.bind(this),100)},this.openEventPerc=function(a){var b=$(a.currentTarget),c=b.attr("data-tooltip"),d=b.attr("data-matchname");if(""!=c){for(var e=0,f=c.substring(0,c.length-1).split(","),g=0;g<f.length;g++){var h=f[g].split("|");e+=100/h[1]}strOut='<div class="oddsToolTip"><span>'+d+"</span><span>"+locale.sports.events.eventOdds.eventOddsTooltipMsg+'</span><div class="inner-odds">';for(var g=0;g<f.length;g++){var h=f[g].split("|"),i=1/h[1]*(100/e);strOut+="<div><span>"+h[0]+"</span><div class='graph-container'><div class='graphCnt graph_"+h[0]+"'><div class='graph' style='width:"+Math.round(100*i)+"%;'></div></div></div></div>"}strOut+="</div></div>",$(a.currentTarget).parent().append(strOut)}},this.cancelEventPerc=function(){$(".oddsToolTip").remove()},this.showExpandedNavbar=function(){b.$broadcast("SportsController:MenuToggled");var a=angular.element(window).width();a>1260||(this.overlayShown=!this.overlayShown)},this.showCollapsedNavbar=function(){this.overlayShown=!1},b.AddRemoveToCoupon=function(a,c){b.$emit("addRemoveToCoupon",a,c,!0)},this.goToPage=function(a){a=a.trim(),a.indexOf("http:/")==-1&&a.indexOf("https:/")==-1?d.url(a):window.location.href=a},this.statistics_click=function(a){var b=$(a.currentTarget);if(!b.hasClass("selected")){var c=b.attr("data-tabname");"moreStatistics"!=c&&($(".divStatisticsWidget #left-tabs > div").removeClass("selected"),$(".divStatisticsWidget #left-tabs #"+c).addClass("selected"),$(".divStatisticsWidget #right-container > div").removeClass("selected"),$(".divStatisticsWidget #right-container #content_"+c).addClass("selected"))}},this.lastAndNextMatchesTabs_click=function(a){var b=$(a.currentTarget);if(!b.hasClass("selected")){var c=b.attr("data-tabname"),d=b.attr("data-tabtype");$(".divStatisticsWidget #right-container #content_"+d+"Matches .teamNames > div").removeClass("selected"),$(".divStatisticsWidget #right-container #content_"+d+"Matches .teamNames .team"+c).addClass("selected"),$(".divStatisticsWidget #right-container #content_"+d+"Matches ."+d+"MatchesHistory").removeClass("selected"),$(".divStatisticsWidget #right-container #content_"+d+"Matches ."+d+"MatchesHistory.content_"+c).addClass("selected")}},this.overUnderMatchesTabs_click=function(a){var b=$(a.currentTarget);if(!b.hasClass("selected")){var c=b.attr("data-tabname"),d=b.parent().next().find(".selected").attr("data-tabname"),e=b.parents(".topSection").find("#tabContainer_"+c+d+" .selected").attr("id");$(".divStatisticsWidget #content_overUnder #leftSelection .top > div").removeClass("selected"),$(".divStatisticsWidget #content_overUnder #leftSelection .top #"+c+"matches").addClass("selected"),$(".divStatisticsWidget #content_overUnder #rightSelection .tabContainer").removeClass("selected"),$(".divStatisticsWidget #content_overUnder #rightSelection #tabContainer_"+c+d).addClass("selected"),B.showOverUnderTable(c,d,e)}},this.overUnderSegmentTabs_click=function(a){var b=$(a.currentTarget);if(!b.hasClass("selected")){var c=b.parent().prev().find(".selected").attr("data-tabname"),d=b.attr("data-tabname"),e=b.parents(".topSection").find("#tabContainer_"+c+d+" .selected").attr("id");$(".divStatisticsWidget #content_overUnder #leftSelection .bottom > div").removeClass("selected"),$(".divStatisticsWidget #content_overUnder #leftSelection .bottom #"+d).addClass("selected"),$(".divStatisticsWidget #content_overUnder #rightSelection .tabContainer").removeClass("selected"),$(".divStatisticsWidget #content_overUnder #rightSelection #tabContainer_"+c+d).addClass("selected"),B.showOverUnderTable(c,d,e)}},this.overUnderSpreadTabs_click=function(a){var b=$(a.currentTarget);if(!b.hasClass("selected")){var c=b.attr("id"),d=b.parents(".topSection").find("#leftSelection .top .selected").attr("data-tabname"),e=b.parents(".topSection").find("#leftSelection .bottom .selected").attr("data-tabname");$(".divStatisticsWidget #content_overUnder #rightSelection .tabContainer span").removeClass("selected"),$(".divStatisticsWidget #content_overUnder #rightSelection .tabContainer .tab_"+c.replace(".","")).addClass("selected"),B.showOverUnderTable(d,e,c)}},this.showOverUnderTable=function(a,b,c){$(".divStatisticsWidget #content_overUnder .overUnderContainer").removeClass("selected"),$(".divStatisticsWidget #content_overUnder #overUnderContainer_"+a+b).addClass("selected"),$(".divStatisticsWidget #content_overUnder .overUnderContainer .spreadTable").removeClass("selected"),$(".divStatisticsWidget #content_overUnder #overUnderContainer_"+a+b+" .table_"+c.replace(".","")).addClass("selected")},this.playerStatsTab_click=function(a){var b=$(a.currentTarget);if(!b.hasClass("selected")){var c=b.attr("data-tabname");$("#content_playerStats .playerStatsTab").removeClass("selected"),$("#content_playerStats .playerStatsTab#"+c).addClass("selected"),$("#content_playerStats .playerStatsContainer").removeClass("selected"),$("#content_playerStats .playerStatsContainer#container_"+c).addClass("selected")}},this.getWidgetConfig=function(a){return l.getWidgetConfig(B.widgetConfigList,a)},this.init=function(){l.getWidgetConfigs(function(a,b){B.widgetConfigList=a,B.widgetExtraDetails={mostPopularLeagueCount:b.mostPopularLeagueCount,mostPopularAllTabText:b.mostPopularAllTabText,mostPopularAllTabOrder:b.mostPopularAllTabOrder}})},B.init()}])}(),function(){angular.module("sportsEventOdds",[]).controller("SportsEventsOddsController",["$scope","$state","$location","$interval","$uiRouterGlobals","oddsData","sportsApiService","sportsService","$document","$timeout","stateService",function(a,b,c,d,e,f,g,h,j,k,l){var m=this;this.location=c,this.isEventDatePage="sportsDateEvent"==b.current.name,this.EventDateData={},this.mergeOddsFilters=globalSettings.Sports_MergeOddsFilters,this.isLazyLoadingNeeded=globalSettings.Sports_EnableLazyLoading,this.firstLoadRowNumber=15,this.lazyLoadTimer=66,this.lazyLoadBatchSize=15,this.lazyLoadLoopCounter=0,this.matchesLoadedInView=0,this.isMatchesFirstLoad=!0,this.rowsLoaded=0,
this.loadedTournamentCountCache,this.skips=0,this.matchesCache={},this.stickyObserver=void 0,this.isAllMatchLoaded=function(){var b=Object.keys(m.matchesCache).length<=Object.keys(a.events[0].matchesByDay).length;return b},this.loadMoreMatches=function(){m.lazyLoadLoopCounter=0;for(match in m.matchesCache){if(m.matchesCache.hasOwnProperty(match)){if(m.loadedTournamentCountCache+m.lazyLoadBatchSize<=m.lazyLoadLoopCounter){m.loadedTournamentCountCache+=m.lazyLoadBatchSize;break}m.matchesLoadedInView++,a.events[0].matchesByDay[match]=m.matchesCache[match]}m.lazyLoadLoopCounter++}m.isAllMatchLoaded()||k(function(){m.loadMoreMatches()},m.lazyLoadTimer)},this.digestMatchesCache=function(){for(match in m.matchesCache)if(m.matchesCache.hasOwnProperty(match)){if(m.rowsLoaded>=m.firstLoadRowNumber){m.matchesLoadedInView=Object.keys(a.events[0].matchesByDay).length;break}a.events[0].matchesByDay[match]=m.matchesCache[match],m.rowsLoaded+=1+m.matchesCache[match].matches.length}m.isMatchesFirstLoad=!1,m.loadedTournamentCountCache=Object.keys(a.events[0].matchesByDay).length,k(function(){m.loadMoreMatches()},m.lazyLoadTimer)},this.setEventDate=function(){if(m.isEventDatePage){var a=parseInt(e.params.day),c=parseInt(e.params.sportId),d={},g=[];for(i=0;i<5;i++)g.push({day:i,date:moment().startOf("day").add(i,"d")});d.SelectedDate=_.filter(g,function(b){return b.day==a})[0],d.DateData=g;var h=[];_.forEach(f[0].data.Sports,function(a){h.push({id:a.SportID,name:a.SportName})}),0==c&&h.length>0&&(c=h[0].id),d.SelectedSport=_.filter(h,function(a){return a.id==c})[0],d.SportData=h,void 0!=d.SelectedDate&&void 0!=d.SelectedSport||(d.SelectedDate=0,d.SelectedSport=0,b.go(b.current,{day:d.SelectedDate,sportId:d.SelectedSport,areaId:0,regionId:0})),m.EventDateData=d}},this.changeEventDate=function(a,c){b.go(b.current,{day:a,sportId:c})},this.changeRegion=function(a,b,c){var d=$(".areaContainer > div > .area.hasRegions.selected").length;$("#region_"+a+".areaContainer > div > .area").removeClass("selected"),$("#region_"+a+".areaContainer > div > #innerRegion_"+b).addClass("selected"),$("#region_"+a+" .regionAreaContainer").css("display","none").removeClass("ng-hide"),c.length>1?0==d?$("#region_"+a+" #regionArea_"+a+"_"+b).slideToggle():$("#region_"+a+" #regionArea_"+a+"_"+b).css("display","block"):this.changeArea(a,c[0].areaId,b)},this.changeArea=function(a,c,d){if("sportsMultipleEvents"==b.current.name||"pokersharesMultipleEvents"==b.current.name){var f=e.params.eventMarketIds,g=a.split("-").filter(Boolean),h=[g[0],g[1],g[2],c,d].join("-");b.go(b.current,{eventMarketIds:f.replace(a,h)})}else b.go(b.current,{areaId:c,regionId:d})},this.changeRegionBySport=function(a,b,c){var d=$(".areaContainer > div > .area.hasRegions.selected").length;$("#region_"+a+".areaContainer > div > .area").removeClass("selected"),$("#region_"+a+".areaContainer > div > #innerRegion_"+b).addClass("selected"),$("#region_"+a+" .regionAreaContainer").css("display","none").removeClass("ng-hide"),c.length>1?0==d?$("#region_"+a+" #regionArea_"+a+"_"+b).slideToggle():$("#region_"+a+" #regionArea_"+a+"_"+b).css("display","block"):this.changeAreaBySport(a,c[0].areaId,b)},this.changeAreaBySport=function(a,c,d){if("sportsMultipleEvents"==b.current.name||"pokersharesMultipleEvents"==b.current.name){var f=e.params.eventMarketIds,g=f.split(",").filter(Boolean);g.forEach(function(b){var e=b.split("-").filter(Boolean);if(e[0]==a){var g=[e[0],e[1],e[2],c,d].join("-");f=f.replace(b,g)}}),b.go(b.current,{eventMarketIds:f})}else b.go(b.current,{areaId:c,regionId:d})},this.updateCoupon=function(b,c){null!=c&&(globalSettings.UseServerSideCoupon?a.$emit("addRemoveToCoupon",b,null):void 0!=c&&c.isOddValue&&a.$emit("addRemoveToCoupon",b,c))},this.loadMore=function(){this.skips++;var a=e.params.day,b=e.params.areaId,c=e.params.regionId,d=e.params.sportId,f=globalSettings.CurrentLanguage,g=d+"-"+b+"-"+c,h=moment().add(a,"day").format("YYYY-MM-DD"),i=this.skips*globalSettings.Sports_TodayMatchesPageSize;l.getEventOddsByDate(g,f,h,i).then(function(a){m.handleOddsData([a])})},a.aCrossHover=1,this.refresh=function(a){a&&!m.isEventDatePage&&h.clearEventFromCache(a),b.reload()},a.$on("onRepeatLast",function(b,c,d){"eventsList"==d.onLastRepeat&&("es"==a.globalSettings.CurrentLanguage&&$(".area div").each(function(){$(this).height()<=20&&$(this).css("line-height","22px")}),a.$emit("selectExistingOdds"),a.aCrossHover=1==a.aCrossHover?2:1)}),this.initStickyListener=function(){if(m.isEventDatePage&&!m.stickyObserver){var b=document.querySelector(".eventContainer-0 .region-area-wrapper"),c=document.querySelector(".eventContainer-0 .oddsTable thead .selectionHeader"),d=document.querySelector(".eventContainer-0 .oddsTable thead .marketHeader");m.stickyObserver=new IntersectionObserver(function(a){a[0].isIntersecting?(c.classList.remove("stickied-table"),c.classList.remove("stickied"),c.classList.remove("full-width"),c.classList.remove("fixed-width"),d.classList.remove("stickied-table"),d.classList.remove("stickied"),d.classList.remove("full-width"),d.classList.remove("fixed-width")):(c.classList.add(globalSettings.General_ContentScrollBars?"stickied-table":"stickied"),c.classList.add(globalSettings.General_FullWidthLayout?globalSettings.General_FullWidthLayout:"fixed-width"),d.classList.add(globalSettings.General_ContentScrollBars?"stickied-table":"stickied"),d.classList.add(globalSettings.General_FullWidthLayout?globalSettings.General_FullWidthLayout:"fixed-width"))},{threshold:.07,trackVisibility:!0,delay:100}),m.stickyObserver.observe(b),a.$on("$destroy",function(){m.stickyObserver.unobserve(b)})}},this.handleOddsData=function(a){m.isThereMoreToLoad=a[0].isThereMoreToLoad,m.setEventDate();var b=h.parseEventData(a);if(m.mergeOddsFilters&&b.length>0){var c=[],d=0;b.forEach(function(a){if(0==c.length){var b={id:d,sportId:a.sportId,groupingType:a.groupingType,regions:a.regions,areas:a.areas,selectedArea:a.selectedArea,selectedRegion:a.selectedRegion,expandOddFilters:a.expandOddFilters,regionsTabs:a.regionsTabs,hasTotalOdds:a.hasTotalOdds,headers:a.headers,markets:a.markets,marketsDescription:a.marketsDescription,events:[]};b.events.push(a),c.push(b)}else{var e=!1;if(c.forEach(function(b){if(!e&&b.sportId==a.sportId&&b.groupingType==a.groupingType){e=!0;var c=[].concat.apply([],b.regions),d=[].concat.apply([],a.regions);c.forEach(function(a){d.forEach(function(b){a.regionId==b.regionId&&(a.regionAreas=_.uniqBy(a.regionAreas.concat(b.regionAreas),"areaId"))})});var f=_.uniqBy(c.concat(d),"regionId"),g=_.uniqBy(b.areas.concat(a.areas),"AreaID");b.regions=o(f,5),b.areas=g,b.hasTotalOdds||(b.hasTotalOdds=a.hasTotalOdds);var h=_.uniqBy(b.markets.concat(a.markets),"marketId"),i=_.uniqBy(b.headers.concat(a.headers),"uniqueKey");b.markets=h,b.headers=i,b.marketsDescription.length<a.marketsDescription.length&&(b.marketsDescription=a.marketsDescription),b.events.push(a)}}),!e){var b={id:d,sportId:a.sportId,groupingType:a.groupingType,regions:a.regions,areas:a.areas,selectedArea:a.selectedArea,selectedRegion:a.selectedRegion,expandOddFilters:a.expandOddFilters,regionsTabs:a.regionsTabs,hasTotalOdds:a.hasTotalOdds,headers:a.headers,markets:a.markets,marketsDescription:a.marketsDescription,events:[]};b.events.push(a),c.push(b)}}d++}),n(c)}else n(b)};var n=function(b){if(0!=b.length){var c=b;if(m.mergeOddsFilters&&(c=b[0].events),a.events[0])if(m.isLazyLoadingNeeded&&b.length){Object.keys(c[0].matchesByDay).forEach(function(b){m.matchesCache.hasOwnProperty(b)?m.matchesCache[b].matches=a.events[0].matchesByDay[b].matches.concat(c[0].matchesByDay[b].matches):m.matchesCache[b]=c[0].matchesByDay[b]});var d=a.events.slice();d[0].matchesByDay={},a.events=d,m.cachedMatchesCount=Object.keys(m.matchesCache).length,m.digestMatchesCache()}else a.events[0].matches=a.events[0].matches.concat(c[0].matches),Object.keys(c[0].matchesByDay).forEach(function(b){a.events[0].matchesByDay.hasOwnProperty(b)?a.events[0].matchesByDay[b].matches=a.events[0].matchesByDay[b].matches.concat(c[0].matchesByDay[b].matches):a.events[0].matchesByDay[b]=sevents[0].matchesByDay[b]});else if(b[0]){if(m.isLazyLoadingNeeded){m.matchesCache=Object.assign({},c[0].matchesByDay);var d=b.slice();d[0].matchesByDay={},a.events=d,m.cachedMatchesCount=Object.keys(m.matchesCache).length,m.digestMatchesCache()}else m.matchesCache=c[0].matchesByDay,a.events=b;k(function(){globalSettings.mergeOddsFilters||m.initStickyListener()})}}},o=function(a,b){for(var c=[],d=0;d<a.length;d+=b)c.push(a.slice(d,d+b));return c};if(!m.isEventDatePage||f&&f[0].data.TotalNoOfItems>0?m.handleOddsData(f):"0"===e.params.day&&b.go(b.current,{day:1,sportId:e.params.sportId,areaId:e.params.areaId,regionId:e.params.regionId}),h.isPokerPage()){var p=moment();m.intervals=[],_.forEach(a.events,function(a){_.forEach(a.matches,function(a){var b=moment(a.date),c=b.diff(p,"days"),e=c>0?c+"d":"",f=b.diff(moment());a.countdownText=e+" "+moment.utc(f).format("HH:mm:ss");var g=d(function(){var b=f-1e3;f=b>=0?b:0,a.countdownText=e+" "+moment.utc(f).format("HH:mm:ss"),0==f&&d.cancel(g)},1e3);m.intervals.push(g)})}),a.$on("$destroy",function(){_.forEach(m.intervals,function(a){d.cancel(a)})})}}])}(),function(){angular.module("sportsEvents",[]).controller("SportsEventsController",["$scope","$uiRouterGlobals","$location","$localStorage","$state","$sce","sportDataCall","helperService","loggingService","sportsService","umbracoApiService",function(a,b,c,d,e,f,g,h,i,j,k){var l=this;a.tournamentCount=0,this.timeRange=j.getTimeRange(),this.eventChecked=!1,this.sportData=null,g.success?null!=g.data.Sports&&g.data.Sports.length>0&&(this.sportData=g.data.Sports):i.logError("Unable to get event for sport: "+JSON.stringify(g.error)),this.selectAll=function(a){var b=$(a.currentTarget);b.hasClass("checked")?(b.parents(".panel").find("input[type='checkbox']").each(function(a,b){if($(this).parents(".inner-content:visible").length>0){var c=$(b);c.prop("checked",!1),c.parent().parent().removeClass("checked")}}),b.parents(".panel").find(".eventCategory .chkSelectCheckbox").each(function(a,b){if($(this).parents(".eventGroup:visible").length>0){var c=$(b);c.parent().removeClass("checked"),c.children("span").first().text(locale.common.selectAll)}}),b.removeClass("checked"),b.children("span").first().text(locale.common.selectAll)):(b.parents(".panel").find("input[type='checkbox']").each(function(a,b){if($(this).parents(".inner-content:visible").length>0){var c=$(b);c.prop("checked",!0),c.parent().parent().addClass("checked")}}),b.parents(".panel").find(".eventCategory .chkSelectCheckbox").each(function(a,b){if($(this).parents(".eventGroup:visible").length>0){var c=$(b);c.parent().addClass("checked"),c.children("span").first().text(locale.common.unSelectAll)}}),b.addClass("checked"),b.children("span").first().text(locale.common.unSelectAll))},this.selectFirst30=function(a){var b=$(a.currentTarget);b.hasClass("checked")?(b.parents(".panel").find("input[type='checkbox']").each(function(a,b){if(!(a>=30)&&$(this).parents(".inner-content:visible").length>0){var c=$(b);c.prop("checked",!1),c.parent().parent().removeClass("checked")}}),b.parents(".panel").find(".eventCategory .chkSelectCheckbox").each(function(a,b){if($(this).parents(".eventGroup:visible").length>0){var c=$(b);c.parent().removeClass("checked"),c.children("span").first().text(locale.common.selectFirst30)}}),b.removeClass("checked"),b.children("span").first().text(locale.common.selectFirst30)):(b.parents(".panel").find("input[type='checkbox']").each(function(a,b){if(!(a>=30)&&$(this).parents(".inner-content:visible").length>0){var c=$(b);c.prop("checked",!0),c.parent().parent().addClass("checked")}}),b.parents(".panel").find(".eventCategory .chkSelectCheckbox").each(function(a,b){var c=$(b),d=c.data("cbxgroup"),e=$("input[name='"+d+"']").length,f=$("input[name='"+d+"']:checked").length,g=$(".chkSelectCheckbox[name='"+d+"']");e===f?g.parent().addClass("checked"):g.parent().hasClass("checked")&&g.parent().removeClass("checked")}),b.addClass("checked"),b.children("span").first().text(locale.common.unSelectFirst30))},this.categorySelectAll=function(a){var b=$(a.currentTarget).find(".chkSelectCheckbox"),c=b.data("cbxgroup");b.parent().hasClass("checked")?($("input[name='"+c+"']").each(function(a,b){var c=$(b);c.prop("checked",!1),c.parent().parent().removeClass("checked")}),b.parent().removeClass("checked")):($("input[name='"+c+"']").each(function(a,b){var c=$(b);c.prop("checked",!0),c.parent().parent().addClass("checked")}),b.parent().addClass("checked"))},this.filterTournaments=function(a){var b=$(a.currentTarget),c=b.val();a.which=a.which||a.keyCode,8!=a.which&&37!=a.which&&39!=a.which&&c.length>=3&&$("html,body").stop().animate({scrollTop:0},"slow"),c=c.trim().toLowerCase(),$(".eventList .eventTournament .itemName").each(function(){if($(this).text(l.removeHighlight($(this).html())),$(this).html(l.setHighlight($(this).text(),c)),""!=c){var a=$(this).text().trim().toLowerCase();a.indexOf(c)==-1?$(this).parents(".inner-content").css("display","none"):$(this).parents(".inner-content").css("display","flex")}else $(this).parents(".inner-content").css("display","flex")}),$(".eventList .eventCategory .itemName").each(function(){if($(this).text(l.removeHighlight($(this).html())),$(this).html(l.setHighlight($(this).text(),c)),""!=c){var a=$(this).text().trim().toLowerCase();a.indexOf(c)==-1?0==$(this).parent().next().find(".inner-content:visible").length?$(this).parents(".eventGroup").css("display","none"):$(this).parents(".eventGroup").css("display","flex"):($(this).parents(".eventGroup").css("display","flex"),$(this).parents(".eventGroup").find(".inner-content").css("display","flex"))}else $(this).parents(".eventGroup").css("display","flex"),$(this).parents(".eventGroup").find(".inner-content").css("display","flex")}),$(".eventList > .row").each(function(){$(this).css("display","flex"),0==$(this).find(".eventGroup:visible").length&&$(this).css("display","none")});var d=!1;$(".eventList .eventGroup:visible").each(function(){$(this).removeClass("even"),1==d?($(this).addClass("even"),d=!1):d=!0})},this.removeHighlight=function(a){var b=new RegExp('<span class="highlight">',"gi"),c=new RegExp("</span>","gi");return a.replace(b,"").replace(c,"")},this.setHighlight=function(a,b){if(!b)return a;b=l.escapeRegExp(b);var c=new RegExp(b,"gi");return a.replace("&amp;","&").replace(c,function(a){return'<span class="highlight">'+a+"</span>"})},this.escapeRegExp=function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},this.showFavourites=function(){$("#divFiltersContainer #filter button").hasClass("selected")?($(".eventList > .row, .eventList .eventGroup, .eventList .inner-content").css("display","flex"),$("#divFiltersContainer #filter button").removeClass("selected")):void 0!=d.eventsAddToFavourites&&0!=d.eventsAddToFavourites.length?($(".eventList .inner-content").each(function(){for(var a=$(this).find("input[type='checkbox']"),b=0;b<d.eventsAddToFavourites.length;b++){var c=d.eventsAddToFavourites[b];if(c.itemId==a.val()){$(this).css("display","flex");break}$(this).css("display","none")}}),$(".eventList .eventGroup").each(function(){$(this).css("display","flex"),0==$(this).find(".inner-content:visible").length&&$(this).css("display","none")}),$(".eventList > .row").each(function(){$(this).css("display","flex"),0==$(this).find(".eventGroup:visible").length&&$(this).css("display","none")}),$("#divFiltersContainer #filter button").addClass("selected")):h.showErrorMessage(locale.sports.events.noFavouritesSelected).done();var a=!1;$(".eventList .eventGroup:visible").each(function(){$(this).removeClass("even"),1==a?($(this).addClass("even"),a=!1):a=!0})},this.addToFavourites=function(){var b=$(".eventList :checked");if(b.length>globalSettings.DefaultNumOfFavouritesSelected)return void h.showErrorMessage(locale.sports.events.maxAddedFavourites.replace("{0}",globalSettings.DefaultNumOfFavouritesSelected)).done();if(0===b.length)return void h.showErrorMessage(locale.sports.events.noSelectedEvents).done();for(var c=0,e=!1,f=0;f<b.length;f++){var g=$(b[f]),i={itemId:g.val(),itemName:g.parent().next().text(),linkId:g.data("linkid")};if(void 0!=d.eventsAddToFavourites){if(!(d.eventsAddToFavourites.length<globalSettings.DefaultNumOfFavouritesSelected)){e=!0,c>0?h.showSuccessMessage(locale.sports.events.addedFavouritesWithLimit.replace("{0}",c).replace("{1}",globalSettings.DefaultNumOfFavouritesSelected)).done():h.showErrorMessage(locale.sports.events.maxAddedFavourites.replace("{0}",globalSettings.DefaultNumOfFavouritesSelected)).done();break}var j=d.eventsAddToFavourites.filter(function(a){return a.itemId==g.val()})[0];void 0==j&&(d.eventsAddToFavourites.push(i),c+=1)}else d.eventsAddToFavourites=[],d.eventsAddToFavourites.push(i),c+=1;a.loadFavouritesTournaments()}e||(c>0?h.showSuccessMessage(locale.sports.events.addedFavourites.replace("{0}",c)).done():h.showErrorMessage(locale.sports.events.alreadyInFavourites).done())},this.categoryProceed=function(){var a=$(".eventList :checked");if(a.length>globalSettings.DefaultNumOfEventsSelected)return void h.showErrorMessage(locale.sports.events.maxSelectedEvents.replace("{0}",globalSettings.DefaultNumOfEventsSelected)).done();if(0===a.length)return void h.showErrorMessage(locale.sports.events.noSelectedEvents).done();for(var b=[],c=0;c<a.length;c++){var d=$(a[c]);b.push(d.data("linkid")+",")}j.isPokerPage()?e.go("pokersharesMultipleEvents",{timeRange:l.timeRange,eventMarketIds:b.join("")}):e.go("sportsMultipleEvents",{timeRange:l.timeRange,eventMarketIds:b.join("")})},this.viewTournament=function(a){var b=$(a.currentTarget),c=b.data("linkid");j.isPokerPage()?e.go("pokersharesMultipleEvents",{timeRange:l.timeRange,eventMarketIds:c+","}):e.go("sportsMultipleEvents",{timeRange:l.timeRange,eventMarketIds:c+","})},this.addChecked=function(a){var b=$(a.currentTarget).find(".chkSelectCheckbox"),c=b.data("cbxgroup");b.parent().hasClass("checked")?(b.find("input[name='"+c+"']").prop("checked",!1),b.parent().removeClass("checked")):(b.find("input[name='"+c+"']").prop("checked",!0),b.parent().addClass("checked"));var d=$("input[name='"+c+"']").length,e=$("input[name='"+c+"']:checked").length,f=$(".chkSelectCheckbox[name='"+c+"']");d===e?f.parent().addClass("checked"):f.parent().hasClass("checked")&&f.parent().removeClass("checked")},this.seoContentBlockData=null;var m="sportsMatchesTodayRange"===b.current.name?"today":b.params.sport;null!=m&&m.trim().length>0?k.desktop.getSportsSEOContentBlock(m).then(function(a){if(!a.success||null==a.data)return document.title=j.getMetaDataCache().metaTitle,void $('meta[name="description"]').attr("content",j.getMetaDataCache().metaDescription);var b=a.data;null!=b.Content&&b.Content.trim().length>0&&(l.seoContentBlockData=f.trustAsHtml(b.Content)),null!=b.MetaTitle&&b.MetaTitle.trim().length>0?document.title=b.MetaTitle:document.title=j.getMetaDataCache().metaTitle,null!=b.MetaDescription&&b.MetaDescription.trim().length>0?$('meta[name="description"]').attr("content",b.MetaDescription):$('meta[name="description"]').attr("content",j.getMetaDataCache().metaDescription),null!=b.MetaKeywords&&b.MetaKeywords.trim().length>0?$('meta[name="keywords"]').attr("content",b.MetaKeywords):$('meta[name="keywords"]').attr("content",j.getMetaDataCache().metaKeywords)}):"sportsMatchesTodayRange"===b.current.name,a.tournamentCounter=function(){a.tournamentCount+=1}}])}(),function(){angular.module("sportsLessThanTwo",[]).controller("LessThanTwoController",["$scope","$location","sportsApiService","sportsService",function(a,b,c,d){var e=this;a.$on("onRepeatLast",function(b,c,d){"lessThanTwoList"==d.onLastRepeat&&(a.$emit("selectExistingOdds"),a.aCrossHover=1==a.aCrossHover?2:1)}),this.prices=[1.25,1.5,1.75,2],this.ranges=[{title:locale.sports.lessThan2.timeRange[1],id:5},{title:locale.sports.lessThan2.timeRange[2],id:6},{title:locale.sports.lessThan2.timeRange[3],id:1},{title:locale.sports.lessThan2.timeRange[4],id:7}],this.selectedPrice,this.selectedRange,this.selectedSport,this.selectPrice=function(a){this.selectedPrice=a,this.trySubmitSelections()},this.selectRange=function(a){this.selectedRange=a,this.trySubmitSelections()},this.selectSport=function(a){this.selectedSport=a},this.isPriceSelected=function(a){return a==this.selectedPrice},this.isRangeSelected=function(a){return a==this.selectedRange},this.isSportSelected=function(a){return a==this.selectedSport},this.getOdd=function(a,b,c){if(a.specialBetValue){var d=b.uniqueKey.replace(a.specialBetValue,"***"),e=d.split("***"),f=_.findKey(c.odds,function(a){return a.uniqueKey.startsWith(e[0])&&a.uniqueKey.endsWith(e[1])});return c.odds[f]}return c.odds[b.uniqueKey]},this.updateCoupon=function(b,c){null!=c&&(globalSettings.UseServerSideCoupon?a.$emit("addRemoveToCoupon",b,null):void 0!=c&&c.isOddValue&&a.$emit("addRemoveToCoupon",b,c))},a.aCrossHover=1,this.trySubmitSelections=function(){this.selectedRange&&this.selectedPrice&&(e.events=null,c.feed.getMatchMaxOdds(globalSettings.CurrentLanguage,this.selectedPrice,this.selectedRange.id).then(function(a){a.success||console.log("error");var b=[];a.data.AreaMatches.map(function(a){var c={data:{AreaMatches:[a]}};b.push(c)}),e.events=d.parseEventData(b),e.sports=[],e.events.map(function(a){e.sports.push({id:a.sportId,title:a.sportName})}),e.selectedSport=e.sports[0]}))}}])}(),function(){angular.module("sportsMatch",["matchOdds.service"]).controller("SportsMatchController",["$scope","$window","$state","matchData","matchOddsService",function(a,b,c,d,e){function f(){e.initialiseOddsCollection(d.oddFeed.OddsCollection),g()}function g(){n.selectedRegion=n.regionData[0].regionID,e.setOddsFromAreas(n.regionData[0].regionAreas)}function h(a,b){if(!b)return a;if(!a)return"";b=b.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var c=new RegExp(b,"gi");return a.replace(c,function(a){return'<span class="highlight">'+a+"</span>"})}function i(a){var b=new RegExp('<span class="highlight">',"gi"),c=new RegExp("</span>","gi");return a.replace(b,"").replace(c,"")}function j(){$(".match-view-odds-collection .event-container .subHeader .headerText").each(function(){if($(this).html(i($(this).text())),$(this).html(h($(this).text(),n.searchTerm)),""!=n.searchTerm){var a=$(this).text().trim().toLowerCase();a.indexOf(n.searchTerm.toLowerCase())==-1?$(this).parent().parent().css("display","none"):$(this).parent().parent().css("display","block")}else $(this).parent().parent().css("display","block")})}function k(){d.oddFeed&&(l=d.oddFeed.SportId,m=l+"-"+d.oddFeed.CategoryId+"-"+d.oddFeed.TournamentId+"-0-0",n.regionData=d.regionData,n.selectedRegion=0,n.sportName=d.sportName,n.categoryName=d.oddFeed.OddsCollection[0].MatchOdds[0].categoryName,n.tournamentName=d.oddFeed.OddsCollection[0].MatchOdds[0].tournamentName,n.match={matchName:d.oddFeed.MatchName,matchDate:d.oddFeed.MatchDate,matchId:d.oddFeed.EventId,smartBetCode:d.oddFeed.SmartbetCode,extProvIdItem:d.oddFeed.ExtProvIdItem},n.searchTerm="",f())}var l,m,n=this;k(),this.changeRegion=function(a,b){n.selectedRegion!==a&&(n.selectedRegion=a,n.oddsData=[],e.setOddsFromAreas(b))},this.changeRegionToAll=function(){if(0!==n.selectedRegion){n.selectedRegion=0;var a=[];d.oddFeed.OddsCollection.forEach(function(b){a.push(b.Area.AI)}),e.setOddsFromAreas(a)}},this.searchMarkets=j,this.goBack=function(a){a?b.history.back():c.go("sportsHome")},this.sportClicked=function(){c.go("sportsEventsPrematchBySport",{sport:l})},this.categoryClicked=function(){c.go("sportsMultipleEvents",{eventMarketIds:m})},this.statsOpen=function(){return"none"!==$(".match-statistics").css("display")},a.$on("onRepeatLast",function(b,c,d){"eventsList"==d.onLastRepeat&&(a.$emit("selectExistingOdds"),j())})}])}(),function(){angular.module("sportsPredictor",[]).controller("PredictorController",["$scope","$rootScope","sportsApiService","sportsService","predictorData","$timeout","$state","helperService","couponService","$localStorage","$compile",function(a,b,c,d,e,f,g,h,i,j,k){var l=this;switch(this.formatGroups=function(a){var b=[],c=a[0],d=a[1];if(l.predictorTitle=d.predictorTitle,l.backgroundImage=d.backgroundImage,l.helpDescription=d.helpText,Object.keys(d.groupStage).length>0)for(var e=0;e<Object.keys(d.groupStage).length;e++){for(var f=Object.keys(d.groupStage)[e],g=f.substring(f.length-1,f.length),h=d.groupStage[f],i=[],j=0;j<h.length;j++){var k=h[j];""!=k.teamName&&i.push({teamLogo:k.teamLogo,teamId:k.teamId,teamName:k.teamName,teamStatus:k.teamStatus})}var m=[],n=[];if(n=c.filter(function(a){return a.data.AM.length>0&&a.data.AM[0].IT[0].II==parseInt(h[0].groupId)}),n.length>0){var o=n[0].data.AM[0],p=o.IT[0];angular.forEach(o.IT[0].OC,function(a){angular.forEach(a.MO,function(b){var c=b;m.push({OddName:c.OA.ON,SpecialValue:c.OA.SV,MatchOddsID:c.OI,OddOutcome:c.OT.OO,oddId:c.OI,marketId:a.OI,marketName:a.OT.ON,marketTypeId:a.OT.OI,selectionName:c.OA.ON,isOddValue:!0,smartBetCode:c.SB,spreadValue:a.SB,value:c.OT?c.OT.OO.toFixed(2):null,oddValue:c.OT?c.OT.OO:null,combinability:a.CB,sportId:o.SI,sportName:o.SN,matchId:p.II,matchName:p.IN,matchDate:p.ID,tournamentId:p.TI,tournamentName:p.TN,categoryId:p.CI,categoryName:p.CN,eventCategory:p.EC,groupNo:a.GR,incompatibleEvents:p.IE,compatibleMarkets:a.CM})})})}b.push({groupName:f,groupLetter:g,groupTeams:i,odds:m})}return b},this.formatKnockout=function(a){var b=[],c=a[0],d=a[1];if(l.predictorTitle=d.predictorTitle,l.backgroundImage=d.backgroundImage,l.helpDescription=d.helpText,l.jackpotDescription=d.jackpotText,d.Last16Matches.length>0){var e=[],f=[];f=c[0].data.Response.filter(function(a){return a.TournamentId==d.Last16Matches[0].stageId})[0];for(var g=0;g<d.Last16Matches.length;g++){var h=d.Last16Matches[g],i=[],j=null,k=null,m=[];if(void 0!=f&&(m=f.Events.filter(function(a){return a.Selections[0].TeamId==parseInt(h.teamHomeId)&&a.Selections[1].TeamId==parseInt(h.teamAwayId)})[0]),void 0!=m&&(j=m.EventExpired,k=m.WinningTeamId),g<d.Last16Matches.length&&g<8){if(""!=h.teamHomeId&&void 0!=m){var n=[];if(n=m.Selections.filter(function(a){return 1==a.TeamPosition})[0],void 0!=n){var o=null;m.EventExpired||(o={OddName:n.TeamPosition.toString(),SpecialValue:null,OddOutcome:n.OddValue,oddId:n.SelectionId,marketId:9692,marketName:"Predictor To Qualify",marketTypeId:9692,selectionName:n.TeamPosition.toString(),isOddValue:!0,smartBetCode:null,spreadValue:null,value:n.OddValue?n.OddValue.toFixed(2):"-",oddValue:n.OddValue,combinability:1,sportId:1,sportName:"Soccer",matchName:m.Selections[0].TeamName+" - "+m.Selections[1].TeamName,matchDate:h.matchDate}),i.push({unassigned:!1,teamId:n.TeamId,teamName:n.TeamName,score:m.EventExpired&&m.Selections[0].Score==m.Selections[1].Score&&m.WinningTeamId==n.TeamId?n.Score+" *":n.Score,odd:o})}else i.push({unassigned:!0})}else i.push({unassigned:!0});if(""!=h.teamAwayId&&void 0!=m){var n=[];if(n=m.Selections.filter(function(a){return 2==a.TeamPosition})[0],void 0!=n){var o=null;m.EventExpired||(o={OddName:n.TeamPosition.toString(),SpecialValue:null,OddOutcome:n.OddValue,oddId:n.SelectionId,marketId:9692,marketName:"Predictor To Qualify",marketTypeId:9692,selectionName:n.TeamPosition.toString(),isOddValue:!0,smartBetCode:null,spreadValue:null,value:n.OddValue?n.OddValue.toFixed(2):"-",oddValue:n.OddValue,combinability:1,sportId:1,sportName:"Soccer",matchName:m.Selections[0].TeamName+" - "+m.Selections[1].TeamName,matchDate:h.matchDate}),i.push({unassigned:!1,teamId:n.TeamId,teamName:n.TeamName,score:m.EventExpired&&m.Selections[0].Score==m.Selections[1].Score&&m.WinningTeamId==n.TeamId?n.Score+" *":n.Score,odd:o})}else i.push({unassigned:!0})}else i.push({unassigned:!0})}e.push({stageId:h.stageId,matchDate:h.matchDate,eventExpired:j,winningTeamId:k,teams:i})}b.last16Matches=e}if(d.QuarterFinalMatches.length>0){var e=[],f=[];f=c[0].data.Response.filter(function(a){return a.TournamentId==d.QuarterFinalMatches[0].stageId})[0];for(var g=0;g<d.QuarterFinalMatches.length;g++){var h=d.QuarterFinalMatches[g],i=[],j=null,k=null,m=[];if(void 0!=f&&(m=f.Events.filter(function(a){return a.Selections[0].TeamId==parseInt(h.teamHomeId)&&a.Selections[1].TeamId==parseInt(h.teamAwayId)})[0]),void 0!=m&&(j=m.EventExpired,k=m.WinningTeamId),g<d.QuarterFinalMatches.length&&g<4){if(""!=h.teamHomeId&&void 0!=m){var n=[];n=m.Selections.filter(function(a){return 1==a.TeamPosition})[0],void 0!=n?i.push({unassigned:!1,teamId:n.TeamId,teamName:n.TeamName,score:m.EventExpired&&m.Selections[0].Score==m.Selections[1].Score&&m.WinningTeamId==n.TeamId?n.Score+" *":n.Score,odd:{OddName:n.TeamPosition.toString(),SpecialValue:null,OddOutcome:n.OddValue,oddId:n.SelectionId,marketId:9692,marketName:"Predictor To Qualify",marketTypeId:9692,selectionName:n.TeamPosition.toString(),isOddValue:!0,smartBetCode:null,spreadValue:null,value:n.OddValue?n.OddValue.toFixed(2):"-",oddValue:n.OddValue,combinability:1,sportId:1,sportName:"Soccer",matchName:m.Selections[0].TeamName+" - "+m.Selections[1].TeamName,matchDate:h.matchDate}}):i.push({unassigned:!0})}else i.push({unassigned:!0});if(""!=h.teamAwayId&&void 0!=m){var n=[];n=m.Selections.filter(function(a){return 2==a.TeamPosition})[0],void 0!=n?i.push({unassigned:!1,teamId:n.TeamId,teamName:n.TeamName,score:m.EventExpired&&m.Selections[0].Score==m.Selections[1].Score&&m.WinningTeamId==n.TeamId?n.Score+" *":n.Score,odd:{OddName:n.TeamPosition.toString(),SpecialValue:null,OddOutcome:n.OddValue,oddId:n.SelectionId,marketId:9692,marketName:"Predictor To Qualify",marketTypeId:9692,selectionName:n.TeamPosition.toString(),isOddValue:!0,smartBetCode:null,spreadValue:null,value:n.OddValue?n.OddValue.toFixed(2):"-",oddValue:n.OddValue,combinability:1,sportId:1,sportName:"Soccer",matchName:m.Selections[0].TeamName+" - "+m.Selections[1].TeamName,matchDate:h.matchDate}}):i.push({unassigned:!0})}else i.push({unassigned:!0})}e.push({stageId:h.stageId,matchDate:h.matchDate,winningTeamId:k,eventExpired:j,teams:i})}b.quarterFinalMatches=e}if(d.SemiFinalMatches.length>0){var e=[],f=[];f=c[0].data.Response.filter(function(a){return a.TournamentId==d.SemiFinalMatches[0].stageId})[0];for(var g=0;g<d.SemiFinalMatches.length;g++){var h=d.SemiFinalMatches[g],i=[],j=null,k=null,m=[];if(void 0!=f&&(m=f.Events.filter(function(a){return a.Selections[0].TeamId==parseInt(h.teamHomeId)&&a.Selections[1].TeamId==parseInt(h.teamAwayId)})[0]),void 0!=m&&(j=m.EventExpired,k=m.WinningTeamId),g<d.SemiFinalMatches.length&&g<2){if(""!=h.teamHomeId&&void 0!=m){var n=[];n=m.Selections.filter(function(a){return 1==a.TeamPosition})[0],void 0!=n?i.push({unassigned:!1,teamId:n.TeamId,teamName:n.TeamName,score:m.EventExpired&&m.Selections[0].Score==m.Selections[1].Score&&m.WinningTeamId==n.TeamId?n.Score+" *":n.Score,odd:{OddName:n.TeamPosition.toString(),SpecialValue:null,OddOutcome:n.OddValue,oddId:n.SelectionId,marketId:9692,marketName:"Predictor To Qualify",marketTypeId:9692,selectionName:n.TeamPosition.toString(),isOddValue:!0,smartBetCode:null,spreadValue:null,value:n.OddValue?n.OddValue.toFixed(2):"-",oddValue:n.OddValue,combinability:1,sportId:1,sportName:"Soccer",matchName:m.Selections[0].TeamName+" - "+m.Selections[1].TeamName,matchDate:h.matchDate}}):i.push({unassigned:!0})}else i.push({unassigned:!0});if(""!=h.teamAwayId&&void 0!=m){var n=[];n=m.Selections.filter(function(a){return 2==a.TeamPosition})[0],void 0!=n?i.push({unassigned:!1,teamId:n.TeamId,teamName:n.TeamName,score:m.EventExpired&&m.Selections[0].Score==m.Selections[1].Score&&m.WinningTeamId==n.TeamId?n.Score+" *":n.Score,odd:{OddName:n.TeamPosition.toString(),SpecialValue:null,OddOutcome:n.OddValue,oddId:n.SelectionId,marketId:9692,marketName:"Predictor To Qualify",marketTypeId:9692,selectionName:n.TeamPosition.toString(),isOddValue:!0,smartBetCode:null,spreadValue:null,value:n.OddValue?n.OddValue.toFixed(2):"-",oddValue:n.OddValue,combinability:1,sportId:1,sportName:"Soccer",matchName:m.Selections[0].TeamName+" - "+m.Selections[1].TeamName,matchDate:h.matchDate}}):i.push({unassigned:!0})}else i.push({unassigned:!0
})}e.push({stageId:h.stageId,matchDate:h.matchDate,winningTeamId:k,eventExpired:j,teams:i})}b.semiFinalMatches=e}if(d.FinalMatch.length>0){var h=d.FinalMatch[0],e=[],f=[];f=c[0].data.Response.filter(function(a){return a.TournamentId==d.FinalMatch[0].stageId})[0];var h=d.FinalMatch[0],i=[],j=null,k=null,m=[];if(void 0!=f&&(m=f.Events.filter(function(a){return a.Selections[0].TeamId==parseInt(h.teamHomeId)&&a.Selections[1].TeamId==parseInt(h.teamAwayId)})[0]),void 0!=m&&(j=m.EventExpired,k=m.WinningTeamId),""!=h.teamHomeId&&void 0!=m){var n=[];n=m.Selections.filter(function(a){return 1==a.TeamPosition})[0],void 0!=n?i.push({unassigned:!1,teamId:n.TeamId,teamName:n.TeamName,score:m.EventExpired&&m.Selections[0].Score==m.Selections[1].Score&&m.WinningTeamId==n.TeamId?n.Score+" *":n.Score,odd:{OddName:n.TeamPosition.toString(),SpecialValue:null,OddOutcome:n.OddValue,oddId:n.SelectionId,marketId:9692,marketName:"Predictor To Qualify",marketTypeId:9692,selectionName:n.TeamPosition.toString(),isOddValue:!0,smartBetCode:null,spreadValue:null,value:n.OddValue?n.OddValue.toFixed(2):"-",oddValue:n.OddValue,combinability:1,sportId:1,sportName:"Soccer",matchId:h.II,matchName:m.Selections[0].TeamName+" - "+m.Selections[1].TeamName,matchDate:h.matchDate}}):i.push({unassigned:!0})}else i.push({unassigned:!0});if(""!=h.teamAwayId&&void 0!=m){var n=[];n=m.Selections.filter(function(a){return 2==a.TeamPosition})[0],void 0!=n?i.push({unassigned:!1,teamId:n.TeamId,teamName:n.TeamName,score:m.EventExpired&&m.Selections[0].Score==m.Selections[1].Score&&m.WinningTeamId==n.TeamId?n.Score+" *":n.Score,odd:{OddName:n.TeamPosition.toString(),SpecialValue:null,OddOutcome:n.OddValue,oddId:n.SelectionId,marketId:9692,marketName:"Predictor To Qualify",marketTypeId:9692,selectionName:n.TeamPosition.toString(),isOddValue:!0,smartBetCode:null,spreadValue:null,value:n.OddValue?n.OddValue.toFixed(2):"-",oddValue:n.OddValue,combinability:1,sportId:1,sportName:"Soccer",matchId:h.II,matchName:m.Selections[0].TeamName+" - "+m.Selections[1].TeamName,matchDate:h.matchDate}}):i.push({unassigned:!0})}else i.push({unassigned:!0});e.push({stageId:h.stageId,matchDate:h.matchDate,winningTeamId:k,eventExpired:j,teams:i}),b.finalMatch=e}return b},this.showPredictor=!1,this.predictorTitle="",this.backgroundImage="",this.helpDescription="",this.jackpotDescription="",this.groupsStage=[],this.knockoutStage=[],g.current.name){case"predictorGroupStage":l.groupsStage=l.formatGroups(e);break;case"predictorKnockoutStage":l.knockoutStage=l.formatKnockout(e),f(function(){a.$emit("selectExistingOdds"),$(".knockout-stage .knockout-match").each(function(){var b=$(this).find(".teamOdd .oddItem .selected");b.length>0&&(b=b[0],l.addSelectedTeam($(b).parents(".teamOdd")),f(function(){a.$emit("selectExistingOdds")},500));var c="true"==$(this).attr("data-expired");if(c){var d=$(this).attr("data-winningteamid");$(this).find(".knockout-team").each(function(){var a=$(this).find(".teamName").attr("data-teamid"),b=$(this);parseInt(d)==parseInt(a)&&f(function(){l.addSelectedTeam(b.find(".score"))},0)})}})},0)}this.groupStage_addItem=function(a){var b=$(a.currentTarget),c=b.parent().find(".teamName").attr("data-teamid"),d=b.parent().find(".teamName").attr("data-teamlogo"),e=b.parent().find(".text").text(),g=b.parents(".group-teams").attr("data-placed"),h=b.parents(".content."+g),i=b.parent().hasClass("knocked-out");if(!i)if(b.parent().hasClass("selected")){b.parent().removeClass("selected"),b.find("i").addClass("fa-plus-circle").removeClass("fa-times");var j=h.find('.chosenTeams .group-team .teamName[data-teamid="'+c+'"]');$(j).parent().find(".unassignedName").css("display","block"),$(j).css("display","none").removeAttr("data-teamid").removeAttr("data-teamlogo"),$(j).find(".logo-icon").css("background-image",""),$(j).find(".text").text("");var k=h.find("> .group-teams .group-team.selected").length>0;k||($(j).parents(".group-winners").find(".switch-teams").addClass("unselected"),$(j).parents(".chosenTeams").find(".chosen-title").text(locale.sports.groupStage.chooseWinners1+" "+g.substring(g.length-1,g.length)+" "+locale.sports.groupStage.chooseWinners2)),h.find("> .group-teams .group-team").not(".selected").removeClass("knocked-out"),h.find(".group-winners .group-odd .oddItem").css("display","none"),h.find(".group-winners .group-odd .notAvailable").css("display","flex")}else{b.parent().addClass("selected"),b.find("i").addClass("fa-times").removeClass("fa-plus-circle"),h.find(".chosenTeams .group-team").each(function(){if("none"!=$(this).find(".unassignedName").css("display"))return $(this).parents(".group-winners").find(".switch-teams").removeClass("unselected"),$(this).parents(".chosenTeams").find(".chosen-title").text(locale.sports.groupStage.yourPicks1+" "+g.substring(g.length-1,g.length)+" "+locale.sports.groupStage.yourPicks2),$(this).find(".unassignedName").css("display","none"),$(this).find(".teamName").css("display","flex").attr("data-teamid",c).attr("data-teamlogo",d),$(this).find(".logo-icon").css("background-image",'url("'+d+'")'),$(this).find(".text").text(e),!1});var l=2==h.find("> .group-teams .group-team.selected").length;if(l){h.find("> .group-teams .group-team").not(".selected").addClass("knocked-out");var m=h.find(".group-winners .group-team")[0],n=$(m).find(".teamName .text").text(),o=h.find(".group-winners .group-team")[1],p=$(o).find(".teamName .text").text(),q=h.find('.group-winners .group-odd .oddItem[data-type="'+n+" / "+p+'"]');q.length>0?(h.find(".group-winners .group-odd .notAvailable").css("display","none"),$(q).css("display","flex"),$(q).find("a").addClass("animated"),f(function(){$(q).find("a").removeClass("animated")},2e3)):(h.find(".group-winners .group-odd .oddItem").css("display","none"),h.find(".group-winners .group-odd .notAvailable").css("display","flex"))}}},this.switchTeams=function(a){var b=$(a.currentTarget),c=$(b.next().find(".group-team")[0]).find(".unassignedName"),d=$(b.next().find(".group-team")[0]).find(".teamName"),e=$(b.next().find(".group-team")[1]).find(".unassignedName"),f=$(b.next().find(".group-team")[1]).find(".teamName"),g=b.next().find(".group-team")[0],h=b.next().find(".group-team")[1];$(g).find(".unassignedName").replaceWith(e),$(g).find(".teamName").replaceWith(f),$(h).append(c).append(d);var i=2==b.parent().parent().parent().find("> .group-teams .group-team.selected").length;if(i){var j=b.parent().find(".group-teams .group-team")[0],k=$(j).find(".teamName .text").text(),l=b.parent().find(".group-teams .group-team")[1],m=$(l).find(".teamName .text").text(),n=b.parent().find('.group-odd .oddItem[data-type="'+k+" / "+m+'"]');n.length>0?(b.parent().find(".group-odd .oddItem").css("display","none"),b.parent().find(".group-odd .notAvailable").css("display","none"),$(n).css("display","flex")):(b.parent().find(".group-odd .oddItem").css("display","none"),b.parent().find(".group-odd .notAvailable").css("display","flex"))}},this.btnHelp_clicked=function(a){var b=$(a.currentTarget),c=b.next().html();swal({html:c,showCloseButton:!0,showConfirmButton:!1,allowEscapeKey:!0,allowOutsideClick:!0}).done()},this.updateCoupon=function(b,c){null!=c&&(globalSettings.UseServerSideCoupon?a.$emit("addRemoveToCoupon",b,null):void 0!=c&&c.isOddValue&&a.$emit("addRemoveToCoupon",b,c))},this.knockoutStage_addItem=function(a,b){a.stopPropagation();var c=$(a.currentTarget),d=c.attr("id").replace("menu_","").replace("favMenu_","").replace("lastMinMenu_","").replace("matchDayMenu_","").replace("upcomingMenu_","").replace("close_",""),e="POST",g=j.selectionIds;if(null!=g){var k=g.split(",").filter(function(a){return a==d})[0];void 0!=k&&(e="DELETE")}var m=c.parents(".teamOdd").parent().find(".teamName").attr("data-teamid"),n=c.parents(".teamOdd").parent().find(".text").text(),o=c.parents(".knockout-match").attr("data-placed"),p=$(".knockout-stage #"+o),q=0==c.parents(".knockout-teams").find(".knockout-team.selected").length,r=!1;c.parents(".knockout-teams").find(".unassignedName").each(function(){if("none"!=$(this).css("display"))return void(r=!0)}),(q&&!r||"DELETE"==e)&&(void 0==b&&(b={oddId:d}),i.updateCoupon(b,e,null,null,null,null,null,!1,!1).then(function(a){if(a.success&&a.apiResponse.success){l.couponSuccess=!1,l.couponBookedSuccess=!1,l.bookingCodeSection=!0,l.bookConfirmSection=!1,l.bookConfirmData=[],l.confirmedCoupon=!1;var b=a.apiResponse.data,d=b.ResponseStatus;if(0==d||24==d){if("DELETE"==e)f(function(){$(p).find(".teamOdd .oddItem a").trigger("click"),$(p).find(".teamName").removeAttr("data-teamid")},0),$(p).parents(".knockout-teams").find(".knockout-team.selected").each(function(){f(function(){$(this).find(".teamOdd .oddItem a").trigger("click"),$(this).find(".teamName").removeAttr("data-teamid")},0)}),c.parents(".teamOdd").parent().removeClass("selected"),c.parents(".knockout-match").find(".knockout-line").removeClass("selected"),$(p).find(".unassignedName").removeClass("ng-hide"),$(p).find(".teamName").addClass("ng-hide"),$(p).find(".wc-flag-icon").removeClass("icon_"+m),$(p).find(".text").text(""),$(p).parent().find(".teamOdd .oddItem").css("display","none"),$(p).parent().find(".teamOdd .notAvailable").css("display","flex"),$(p).parent().find(".teamOdd .notAvailable .oddBorder").text("-");else if(c.parents(".teamOdd").parent().addClass("selected"),c.parents(".knockout-match").find(".knockout-line").addClass("selected"),$(p).find(".unassignedName").addClass("ng-hide"),$(p).find(".teamName").removeClass("ng-hide").attr("data-teamid",m),$(p).find(".wc-flag-icon").addClass("icon_"+m),$(p).find(".text").text(n),l.addSelectedTeam(c.parents(".teamOdd")),c.parents(".knockout-match").parent().hasClass("final")){var g=$(".knockout-stage .jackpotText").html();swal({html:g,showCloseButton:!0,showConfirmButton:!1,allowEscapeKey:!0,allowOutsideClick:!0,customClass:"jackpot"}).done()}}else h.showErrorMessage(locale.sports.coupon.errorOddResult[d],l.showCouponMessage)}}))},this.addSelectedTeam=function(b){var d=b.parent().find(".teamName").attr("data-teamid"),e=b.parent().find(".text").text(),g=b.parents(".knockout-match").attr("data-placed"),h=$(".knockout-stage #"+g);b.parent().addClass("selected"),b.parents(".knockout-match").find(".knockout-line").addClass("selected"),$(h).find(".unassignedName").addClass("ng-hide"),$(h).find(".teamName").removeClass("ng-hide").attr("data-teamid",d),$(h).find(".wc-flag-icon").addClass("icon_"+d),$(h).find(".text").text(e);var i=!1;if($(h).parents(".knockout-teams").find(".unassignedName").each(function(){if("none"!=$(this).css("display"))return void(i=!0)}),!i){var m=$(h).parents(".knockout-teams").find(".knockout-team")[0],n=$(h).parents(".knockout-teams").find(".knockout-team")[1],o={Request:[{TournamentId:parseInt($(h).parents(".knockout-match").attr("data-stageid")),Events:[{Date:$(h).parents(".knockout-match").attr("data-matchdate"),HomeTeamId:parseInt($(m).find(".teamName").attr("data-teamid")),AwayTeamId:parseInt($(n).find(".teamName").attr("data-teamid"))}]}]};c.feed.getOddsForTeams(o).then(function(b){if(null!=b.data.Response&&b.data.Response[0].Events.length>0){var c=b.data.Response[0].Events[0],d=c.Selections.filter(function(a){return 1==a.TeamPosition})[0];if(void 0!=d)if($(m).find(".unassignedName").addClass("ng-hide"),$(m).find(".teamName").removeClass("ng-hide").attr("data-teamid",d.TeamId),$(m).find(".wc-flag-icon").addClass("icon_"+d.TeamId),$(m).find(".text").text(d.TeamName),c.EventExpired){var e=c.Selections[0].Score==c.Selections[1].Score&&c.WinningTeamId==d.TeamId?d.Score+" *":d.Score;$(m).find(".teamOdd").addClass("ng-hide"),$(m).find(".score").removeClass("ng-hide").text(e),c.WinningTeamId==d.TeamId&&f(function(){l.addSelectedTeam($(m).find(".score"))},0)}else{if(null!=j.selectionIds){var g=j.selectionIds.indexOf(d.SelectionId)>-1;g&&l.addSelectedTeam($(m).find(".teamOdd"))}var h={OddName:d.TeamPosition.toString(),SpecialValue:null,OddOutcome:d.OddValue,oddId:d.SelectionId,marketId:9692,marketName:"Predictor To Qualify",marketTypeId:9692,selectionName:d.TeamPosition.toString(),isOddValue:!0,smartBetCode:null,spreadValue:null,value:d.OddValue?d.OddValue.toFixed(2):"-",oddValue:d.OddValue,combinability:1,sportId:1,sportName:"Soccer",matchName:c.Selections[0].TeamName+" - "+c.Selections[1].TeamName,matchDate:c.matchDate},i='<div style="white-space:nowrap;" class="oddItem" data-type="'+h.selectionName+'"><a id="'+h.oddId+'" class="clickable combinability_1" ng-click="predictorCtrl.knockoutStage_addItem($event)"><div class="oddBorder">'+h.value+"</div></a></div>";$(m).find(".teamOdd .oddItem").remove(),$(m).find(".teamOdd").append(i),$(m).find(".teamOdd .notAvailable").css("display","none"),k($(m).find(".teamOdd"))(a)}var d=c.Selections.filter(function(a){return 2==a.TeamPosition})[0];if(void 0!=d)if($(n).find(".unassignedName").addClass("ng-hide"),$(n).find(".teamName").removeClass("ng-hide").attr("data-teamid",d.TeamId),$(n).find(".wc-flag-icon").addClass("icon_"+d.TeamId),$(n).find(".text").text(d.TeamName),c.EventExpired){var e=c.Selections[0].Score==c.Selections[1].Score&&c.WinningTeamId==d.TeamId?d.Score+" *":d.Score;$(n).find(".teamOdd").addClass("ng-hide"),$(n).find(".score").removeClass("ng-hide").text(e),c.WinningTeamId==d.TeamId&&f(function(){l.addSelectedTeam($(n).find(".score"))},0)}else{if(null!=j.selectionIds){var g=j.selectionIds.indexOf(d.SelectionId)>-1;g&&l.addSelectedTeam($(n).find(".teamOdd"))}var h={OddName:d.TeamPosition.toString(),SpecialValue:null,OddOutcome:d.OddValue,oddId:d.SelectionId,marketId:9692,marketName:"Predictor To Qualify",marketTypeId:9692,selectionName:d.TeamPosition.toString(),isOddValue:!0,smartBetCode:null,spreadValue:null,value:d.OddValue?d.OddValue.toFixed(2):"-",oddValue:d.OddValue,combinability:1,sportId:1,sportName:"Soccer",matchName:c.Selections[0].TeamName+" - "+c.Selections[1].TeamName,matchDate:c.matchDate},i='<div style="white-space:nowrap;" class="oddItem" data-type="'+h.selectionName+'"><a id="'+h.oddId+'" class="clickable combinability_1" ng-click="predictorCtrl.knockoutStage_addItem($event)"><div class="oddBorder">'+h.value+"</div></a></div>";$(n).find(".teamOdd .oddItem").remove(),$(n).find(".teamOdd").append(i),$(n).find(".teamOdd .notAvailable").css("display","none"),k($(n).find(".teamOdd"))(a)}}})}},a.$on("onRepeatLast",function(b,c,d){"predictorList"==d.onLastRepeat&&(a.$emit("selectExistingOdds"),$(".group-stage .content").each(function(){var a=$(this).find(".group-odd .oddItem .selected");if(a.length>0){a=a[0];for(var b=$(a).parent().attr("data-type").split(" / "),c=0;c<b.length;c+=1){var d=b[c];$(this).find(".group-team .teamName[data-teamname='"+d+"']").next().trigger("click")}}}))})}])}(),function(){angular.module("sportsResults",[]).controller("SportsResultsController",["$scope","$rootScope","thirdPartyApiService","umbracoApiService",function(a,b,c,d){var e=this,f=c.results;this.date=moment().format("DD/MM/YYYY"),this.minDate=moment().subtract(6,"month").toDate(),this.maxDate=moment().toDate(),this.sportsList=[],this.sport=null,this.countriesList=[],this.country=0,this.tournamentsList=[],this.tournament=0,this.resultsList=[],this.results=[],this.getSportsList=function(){var a=moment(e.date,"DD/MM/YYYY").format("YYYY-MM-DD");b.showLoader(),f.getSportsList(globalSettings.CurrentLanguage,a).then(function(a){if(b.hideLoader(),a.success){var c=a.data.doc[0].data.sports,d=[],f=3,g=!1;angular.forEach(c,function(a){d.push({value:a._id,description:a.name,order:1==a._id?1:5==a._id?2:f}),g||null==e.sport||a._id!=e.sport||(g=!0),f++}),e.sportsList=d,e.sportsList.length>0&&(g||(e.sport=e.sportsList[0].value),e.getCountriesList())}})},this.getCountriesList=function(){var a=moment(e.date,"DD/MM/YYYY").format("YYYY-MM-DD");b.showLoader(),f.getResultsList(globalSettings.CurrentLanguage,e.sport,a).then(function(a){if(b.hideLoader(),a.success){var c=a.data.doc[0].data.sport.realcategories,d=[];d.push({value:0,description:locale.common.all});var f=!1;angular.forEach(c,function(a){var b=!1;angular.forEach(a.tournaments,function(a){if(a.matches.length>0){var c=a.matches.filter(function(a){return 100==a.status._id||110==a.status._id||120==a.status._id});if(c.length>0)return void(b=!0)}}),b&&(d.push({value:a._id,description:a.name}),f||null==e.country||a._id!=e.country||(f=!0))}),1==d.length&&(d=[],d.push({value:-1,description:locale.sports.results.notAvailable})),e.countriesList=d,e.countriesList.length>0&&(f||(e.country=e.countriesList[0].value),e.resultsList=c,e.getTournamentsList())}})},this.getTournamentsList=function(){var a=[];if(0==e.country)a.push({value:0,description:locale.common.all});else{var b=!1;if(e.resultsList.length>0&&e.country!=-1){var c=e.resultsList.filter(function(a){return a._id==e.country})[0];void 0!=c&&angular.forEach(c.tournaments,function(c){var d=c.matches.filter(function(a){return 100==a.status._id||110==a.status._id||120==a.status._id});d.length>0&&(a.push({value:c._id,description:c.name}),b||null==e.tournament||c._id!=e.tournament||(b=!0))})}else a.push({value:-1,description:locale.sports.results.notAvailable})}e.tournamentsList=a,e.tournamentsList.length>0&&(b||(e.tournament=e.tournamentsList[0].value),e.getResults())},this.getResults=function(){var a=[];if(e.resultsList.length>0&&e.country!=-1){var b;b=0==e.country?e.resultsList:e.resultsList.filter(function(a){return a._id==e.country}),void 0!=b&&angular.forEach(b,function(b){var c;c=0==e.tournament?b.tournaments:b.tournaments.filter(function(a){return a._id==e.tournament}),void 0!=c&&angular.forEach(c,function(c){if(void 0!=c&&c.matches.length>0){var d={tournamentName:c.name,country:{logoUrl:""!=globalSettings.Sports_BetRadarTeamLogoURL?globalSettings.Sports_BetRadarTeamLogoURL+"crest/small/"+(null!=b.cc?b.cc.a2:"www")+".png":"",name:b.name},resultsHeader:{sets:0,halfTime:!1,fullTime:!1,extraTime:!1,penalties:!1},matches:[]},f=c.matches.filter(function(a){return 100==a.status._id||110==a.status._id||120==a.status._id});f.length>0&&angular.forEach(f,function(a){var b={home:a.result.home,away:a.result.away},c=e.filterSets(a.periods),f=null!=c&&1==Object.keys(c).length&&"p1"==Object.keys(c)?a.periods.p1:null,g=a.periods.ft||(null!=b.home?b:null),h=a.periods.ot,i=a.periods.ap,j={sets:c&&Object.keys(c).length>1&&d.resultsHeader.sets<Object.keys(c).length?Object.keys(c).length:d.resultsHeader.sets,halfTime:d.resultsHeader.halfTime||null!=f,fullTime:d.resultsHeader.fullTime||null!=g,extraTime:d.resultsHeader.extraTime||null!=h,penalties:d.resultsHeader.penalties||null!=i};d.resultsHeader=j;var k=globalSettings.Sports_BetRadarTeamLogoURL+"crest/medium/{0}.png",l="/images/sports/results/{0}.png";d.matches.push({time:a._dt.time+" "+a._dt.tz,teams:{home:{logoUrl:""!=globalSettings.Sports_BetRadarTeamLogoURL?a.teams.home.iscountry?null!=a.teams.home.cc?k.replace("{0}",a.teams.home.cc.a2):k.replace("{0}","www"):a.teams.home.haslogo?k.replace("{0}",a.teams.home.uid):1==e.sport?l.replace("{0}","default_home"):"":"",name:a.teams.home.mediumname,redCards:null!=a.cards?a.cards.home.red_count:0},away:{logoUrl:""!=globalSettings.Sports_BetRadarTeamLogoURL?a.teams.away.iscountry?null!=a.teams.away.cc?k.replace("{0}",a.teams.away.cc.a2):k.replace("{0}","www"):a.teams.away.haslogo?k.replace("{0}",a.teams.away.uid):1==e.sport?l.replace("{0}","default_away"):"":"",name:a.teams.away.mediumname,redCards:null!=a.cards?a.cards.away.red_count:0}},winner:a.result.winner,results:{sets:c,halfTime:f,fullTime:g,extraTime:h,penalties:i},status:a.status.name})}),a.push(d)}})})}e.results=a},this.filterSets=function(a){var b={};return Object.keys(a).forEach(function(c){"ft"!=c&&"ot"!=c&&"ap"!=c&&(b[c]=a[c])}),b},this.getSet=function(a,b){var c={},d=Object.keys(a)[b];return c=a[d]},this.numOfElements=function(a){return new Array(a)},this.init=function(){$(".go_back").attr("data-id","/sports"),e.getSportsList(),this.seoContentBlockData=null,d.desktop.getSportsSEOContentBlock("results").then(function(a){if(a.success&&null!=a.data){var b=a.data;null!=b.Content&&b.Content.trim().length>0&&(e.seoContentBlockData=$sce.trustAsHtml(b.Content)),null!=b.MetaTitle&&b.MetaTitle.trim().length>0&&(document.title=b.MetaTitle),null!=b.MetaDescription&&b.MetaDescription.trim().length>0&&$('meta[name="description"]').attr("content",b.MetaDescription),null!=b.MetaKeywords&&b.MetaKeywords.trim().length>0&&$('meta[name="keywords"]').attr("content",b.MetaKeywords)}})},this.init()}])}(),function(){angular.module("sportsSearch",[]).controller("SearchController",["$scope","$sce","$filter","$state","$timeout","sportsApiService","loggingService","$uiRouterGlobals",function(a,b,c,d,e,f,g,h){var i,j=this,k=h.params.searchQuery;this.isResultsPage=null!=k&&k.length>0,this.searchQuery=k||"",this.lastApiSearchQuery="",this.searchData=[],this.showResultsPopup=!1,this.isDataLoading=!1,this.searchTimeout=null;var l=new Bloodhound({datumTokenizer:function(a){return[a]},queryTokenizer:function(a){return[a]},local:[],initialize:!1});return this.typeaheadDataSet={source:l.ttAdapter()},this.typeaheadOptions={minLength:3,highlight:!0,hint:!0},this.positionPopupContainer=function(){},this.goToFullSearch=function(){j.hideResultsPopup(!1),d.go("sportsSearch",{searchQuery:j.searchQuery})},this.hideResultsPopup=function(a){j.showResultsPopup=!1,globalSettings.General_ContentScrollBars&&$("#leftContainer").mCustomScrollbar("update"),a&&(j.searchData=[])},this.updateTypeaheadEntries=function(a){if(l.clear(),!(null==a||a.length<=0)){var b=[];angular.forEach(a,function(a){a.TeamHome.toLowerCase().indexOf(j.searchQuery.toLowerCase())!=-1&&b.indexOf(a.TeamHome.trim())==-1&&b.push(a.TeamHome.trim()),a.TeamAway.toLowerCase().indexOf(j.searchQuery.toLowerCase())!=-1&&b.indexOf(a.TeamAway.trim())==-1&&b.push(a.TeamAway.trim()),a.TournamentName.toLowerCase().indexOf(j.searchQuery.toLowerCase())!=-1&&b.indexOf(a.TournamentName.trim())==-1&&b.push(a.TournamentName.trim()),a.CategoryName.toLowerCase().indexOf(j.searchQuery.toLowerCase())!=-1&&b.indexOf(a.CategoryName.trim())==-1&&b.push(a.CategoryName.trim())}),l.local=b,l.initialize(!0),$("#txtSearchQuery").focus()}},this.showOutrightEvent_Clicked=function(a){var b=$(a.currentTarget),c=b.attr("data-sportId"),e=b.attr("data-categoryId"),f=b.attr("data-tournamentId"),g=c+"-"+e+"-"+f+"-0-0,";j.hideResultsPopup(!1),d.go("sportsMultipleEvents",{timeRange:globalSettings.ScheduleTimeFrame,eventMarketIds:g})},this.parseSearchData=function(a){var b=[],c=j.isResultsPage?a.length:globalSettings.SearchNumberOfEvents;angular.forEach(a,function(a){if(!(b.length>=c)){var d=a.EventName.trim().toLowerCase(),e=a.TeamHome.trim().toLowerCase(),f=a.TeamAway.trim().toLowerCase(),g=a.CategoryName.trim().toLowerCase(),h=a.TournamentName.trim().toLowerCase();if(_.includes(d,j.searchQuery.toLowerCase())||_.includes(e,j.searchQuery.toLowerCase())||_.includes(f,j.searchQuery.toLowerCase())||_.includes(g,j.searchQuery.toLowerCase())||_.includes(h,j.searchQuery.toLowerCase())){var i=moment(a.EventDate),k=i.isSame(moment(),"day");k?a.EventDateFormat=locale.account.userAreaMenu.messageCenter.timePeriods.today+" "+i.format("HH:mm"):a.EventDateFormat=i.format("DD MMM HH:mm"),a.HasMarket=!1,1==a.IDEventType&&void 0!=a.Markets&&a.Markets.length>0&&(a.HasMarket=!0),b.push(a)}}});var d=_(b).groupBy("SportName").map(function(a,b){return{sportName:b,sportId:a[0].IDSport,eventsByTournament:_(a).filter(function(a){return 1==a.IDEventType}).groupBy("TournamentName").map(function(a,b){return{tournamentName:b,tournamentId:a[0].IDTournament,categoryId:a[0].IDCategory,categoryName:a[0].CategoryName,smartBetCode:a[0].SmartBetCode,events:a}}).value(),outrights:_(a).filter(function(a){return 1!=a.IDEventType}).groupBy("TournamentName").map(function(a,b){return{tournamentName:b,tournamentId:a[0].IDTournament,categoryId:a[0].IDCategory,categoryName:a[0].CategoryName,date:a[0].EventDateFormat}}).value()}}).value();return d.length>0?d:null},this.resultsPageSearch=function(){f.feed.searchEvents(globalSettings.CurrentLanguage,j.searchQuery).then(function(a){return a.success?void(j.searchData=j.parseSearchData(a.data)):void g.logError("Unable to search matches: "+JSON.stringify(a.error))})},this.sidebarSearch=function(){if((3==j.searchQuery.length||j.searchQuery.length>3&&j.searchQuery.substr(0,3)!=j.lastApiSearchQuery)&&(j.isDataLoading=!0,j.lastApiSearchQuery=j.searchQuery.substr(0,3),null!=j.searchTimeout&&e.cancel(j.searchTimeout),j.searchTimeout=e(function(){f.feed.searchEvents(globalSettings.CurrentLanguage,j.lastApiSearchQuery).then(function(a){return j.isDataLoading=!1,a.success?j.searchQuery.length<3?void j.hideResultsPopup(!0):(i=a.data,j.searchData=j.parseSearchData(a.data),null!=j.searchData&&j.searchData.length>0?(j.showResultsPopup=!0,globalSettings.General_ContentScrollBars&&$("#leftContainer").mCustomScrollbar("disable"),j.positionPopupContainer(),j.updateTypeaheadEntries(i)):(j.hideResultsPopup(!0),j.updateTypeaheadEntries()),void $("#txtSearchQuery").focus()):(j.hideResultsPopup(!0),void g.logError("Error occurred while searching for events: "+JSON.stringify(a.error)))})},200)),!j.isDataLoading)if(j.hideResultsPopup(!0),void 0!=i&&0!=i.length)if(void 0!=i[0].IDEvent){var a=!1;angular.forEach(i,function(b){if(b.EventName.toLowerCase().indexOf(j.searchQuery.toLowerCase())!=-1||b.CategoryName.toLowerCase().indexOf(j.searchQuery.toLowerCase())!=-1||b.TournamentName.toLowerCase().indexOf(j.searchQuery.toLowerCase())!=-1)return void(a=!0)}),a?(j.searchData=j.parseSearchData(i),null!=j.searchData&&j.searchData.length>0?(j.showResultsPopup=!0,globalSettings.General_ContentScrollBars&&$("#leftContainer").mCustomScrollbar("disable"),j.positionPopupContainer()):j.hideResultsPopup(!0),$("#txtSearchQuery").focus()):j.hideResultsPopup(!0)}else j.hideResultsPopup(!0);else j.hideResultsPopup(!0)},this.onSearchQueryChanged=function(){j.searchQuery.length<3?(j.hideResultsPopup(!0),null!=j.searchTimeout&&e.cancel(j.searchTimeout)):j.sidebarSearch(globalSettings.ScheduleTimeFrame),$("#txtSearchQuery").focus()},this.onSearchQueryKeyDown=function(a){var b=a.which||a.keyCode;27==b?j.hideResultsPopup(!1):13==b&&j.onSearchQueryChanged()},this.clearSearchText=function(){j.searchQuery="",l.clear(),j.hideResultsPopup(!0),$("#txtSearchQuery").focus()},a.$on("onRepeatLast",function(b,c,d){"searchList"==d.onLastRepeat&&a.$emit("selectExistingOdds")}),this.isResultsPage?void j.resultsPageSearch():void $(window).resize(function(){j.positionPopupContainer()})}])}(),function(){angular.module("bannerWidget",[]).controller("SportsBannerController",["$scope","$timeout","$filter","$sessionStorage","$q","sportsApiService","loggingService","authService","umbracoApiService","dataUpdateService","couponService",function(a,b,c,d,e,f,g,h,i,j,k){function l(){var a=$("#owl-sportsBannerRotator");a.owlCarousel("destroy"),a.find(".owl-item").remove(),$("#owl-sportsBannerRotator .sports-banner").length>0?(a.owlCarousel({animateOut:"slideOutLeft",animateIn:"slideInRight",responsive:!0,items:1,loop:!0,margin:10,autoplay:!0,autoplayTimeout:6e3,autoplayHoverPause:!0,dots:!0,touchDrag:!1,mouseDrag:!1}),$("#sportsBannerWrapper").css("display","block")):$("#sportsBannerWrapper").css("display","none")}var m=this;this.viewAll=function(a){a.trim().length>0&&(window.location.href=a)},this.resizeBannerRotator=function(){var a=$("#sportsBannerRotator").width(),b=parseFloat($("#sportsBannerRotator").css("max-width")),c=parseFloat($("#sportsBannerRotator").css("max-height")),d=c/b;$("#sportsBannerRotator").height(a*d)},this.bannerData=[],this.bannerLiveOddsData=[],this.marketTypes,this.getBannerOdds=function(a,b,d){var h=a.bannerGameId,i=m.marketTypes[a.bannerType];if(2==a.bannerType||3==a.bannerType){if(null==h||h.trim().length<=0)return void(b.showOddDetails=!1);f.feed.getQuickBetByMarketTypes(h,i,globalSettings.CurrentLanguage).then(function(d){if(!d.success)return void g.logError("Unable to get quick bet by MarketTypes: "+JSON.stringify(d.error));if(d.data.Markets.length<=0)return void(b.showOddDetails=!1);var e=d.data.Markets.filter(function(a){return a.OddsType.OddsTypeID==i})[0];if(null!=e){b.parsedData=k.formatMarkets(d.data),b.showOddDetails=!0;var f=b.parsedData.EventName.split(" - ")[0],h=b.parsedData.EventName.split(" - ")[1];b.teamHome=f,b.teamAway=h;var j=c("amDateFormat")(b.parsedData.EventDate,"DD-MMM | HH:mm");b.matchDate=j;var l,m,n,o,p,q,r=_.filter(e.Markets,function(a){return 1==a.OddAttribute.Order})[0];if(l=r?r.MatchOddsID:null,m=r?c("number")(r.OddOutcome,2):null,b.oddSelectionID_1=l,b.oddValue_1=m,2==a.bannerType){var s=_.filter(e.Markets,function(a){return 2==a.OddAttribute.Order})[0],t=_.filter(e.Markets,function(a){return 3==a.OddAttribute.Order})[0];n=s?s.MatchOddsID:null,o=s?c("number")(s.OddOutcome,2):null,p=t?t.MatchOddsID:null,q=t?c("number")(t.OddOutcome,2):null,b.oddSelectionID_X=n,b.oddValue_X=o}else if(3==a.bannerType){var t=_.filter(e.Markets,function(a){return 2==a.OddAttribute.Order})[0];p=t?t.MatchOddsID:null,q=t?c("number")(t.OddOutcome,2):null}b.oddSelectionID_2=p,b.oddValue_2=q}})}else if(4==a.bannerType||5==a.bannerType){var j=e.defer();if(null==h||h.trim().length<=0)return b.showOddDetails=!1,d.push(j.promise),void j.resolve();f.liveFeed.getLiveEventDetails(h,globalSettings.CurrentLanguage).then(function(d){if(!d.success)return g.logError("Unable to get live event details: "+JSON.stringify(d.error)),void j.resolve();if(null==d.data.Tournaments||d.data.Tournaments[0].Events[0].Markets.length<=0)return b.showOddDetails=!1,void j.resolve();var e=d.data.Tournaments[0].Events[0].Markets.filter(function(a){return a.TypeId==i})[0];if(null!=e){b.showOddDetails=!0;var f=d.data.Tournaments[0].Events[0].Name.split(" - ")[0],k=d.data.Tournaments[0].Events[0].Name.split(" - ")[1];b.teamHome=f,b.teamAway=k;var l=c("amDateFormat")(d.data.EventDate,"DD-MMM | HH:mm");b.matchDate=l;var n;n=0==e.Status,b.isLocked=n;var o,p,q,r,s,t;o=e.Selections?e.Selections[0].Id:null,p=e.Selections&&e.Selections[0].Odds?e.Selections[0].Odds[0].Value:null,m.bannerLiveOddsData.push({IsLive:!0,IsLocked:n,MatchId:h,MarketId:e.Id,SelectionID:o,SelectionValue:p}),b.oddSelectionID_1=o,b.oddValue_1=c("number")(p,2),b.isLive=!0,4==a.bannerType?(q=e.Selections?e.Selections[1].Id:null,r=e.Selections&&e.Selections[0].Odds?e.Selections[1].Odds[0].Value:null,s=e.Selections?e.Selections[2].Id:null,t=e.Selections&&e.Selections[0].Odds?e.Selections[2].Odds[0].Value:null,m.bannerLiveOddsData.push({IsLive:!0,IsLocked:n,MatchId:h,MarketId:e.Id,SelectionID:q,SelectionValue:r}),b.oddSelectionID_X=q,b.oddValue_X=c("number")(r,2)):5==a.bannerType&&(s=e.Selections?e.Selections[1].Id:null,t=e.Selections&&e.Selections[0].Odds?e.Selections[1].Odds[0].Value:null),m.bannerLiveOddsData.push({IsLive:!0,IsLocked:n,MatchId:h,MarketId:e.Id,SelectionID:s,SelectionValue:t}),b.oddSelectionID_2=s,b.oddValue_2=c("number")(t,2)}else b.isLocked=!0;j.resolve()}),d.push(j.promise)}},this.checkBannersExpiry=function(){if(m.bannerData.length>0)for(var a=0;a<m.bannerData.length;a+=1){var b=m.bannerData[a];if(b.showBanner&&null!=b.bannerEndDate&&""!=b.bannerEndDate){var c=moment(),d=moment(b.bannerEndDate);c>d&&(m.bannerData.splice(a,1),$("#owl-sportsBannerRotator").trigger("remove.owl.carousel",a).trigger("refresh.owl.carousel"))}}else $("#sportsBannerWrapper").css("display","none")},this.init=function(){i.desktop.getSportBannersSection(globalSettings.CurrentLanguage).then(function(c){if(c.success){var f=c.data,g=[],i=d.SportsbookMarketTypeIds?d.SportsbookMarketTypeIds.filter(function(a){return"1X2"===a.LookupCode}):[],k=d.SportsbookMarketTypeIds?d.SportsbookMarketTypeIds.filter(function(a){return"1-2"===a.LookupCode}):[],n=d.SportsbookMarketTypeIds?d.SportsbookMarketTypeIds.filter(function(a){return"3 Way"===a.LookupCode}):[],o=d.SportsbookMarketTypeIds?d.SportsbookMarketTypeIds.filter(function(a){return"1-2 Live"===a.LookupCode}):[];m.marketTypes={2:i.length?i[0].IDMarketType:10,3:k.length?k[0].IDMarketType:20,4:n.length?n[0].IDMarketType:110,5:o.length?o[0].IDMarketType:746};for(var p=0;p<f.length;p+=1){var q=f[p],r={};r.showBanner=!1,
""==q.bannerDisplay||"0"==q.bannerDisplay?r.showBanner=!0:"1"==q.bannerDisplay&&h.hasValidLogin()?r.showBanner=!0:"2"!=q.bannerDisplay||h.hasValidLogin()||(r.showBanner=!0),r.showBanner&&(r.bannerType=q.bannerType,r.gameId=q.bannerGameId,r.bannerImage=q.bannerImage,r.bannerUrl=q.bannerUrl,r.bannerTitle=q.bannerTitle,r.bannerStartDate=q.bannerStartDate,r.bannerEndDate=q.bannerEndDate,r.showOddDetails=!1,r.teamHome="",r.teamAway="",r.matchDate="",r.oddSelectionID_1="",r.oddValue_1="",r.oddSelectionID_X="",r.oddValue_X="",r.oddSelectionID_2="",r.oddValue_2="",r.isLocked=!1,r.isLive=!1,r.parsedData={},m.getBannerOdds(q,r,g)),m.bannerData.push(r)}e.all(g).then(function(){m.bannerLiveOddsData.length>0&&j.enableSportsLiveBannerUpdates(m.bannerLiveOddsData)}),b(function(){m.resizeBannerRotator(),l(),a.$emit("selectExistingOdds")}.bind(this),0)}})},m.init(),a.$on("$destroy",function(){j.disableSportsLiveBannerUpdates()}),a.$on("dataUpdateService:sportsLiveBannerOddsUpdated",function(a,b){for(var d=0;d<b.length;d+=1){var e=b[d],f=m.bannerLiveOddsData.filter(function(a){return a.SelectionID==e.SelectionID})[0];if(null!=f){f.SelectionValue=e.SelectionValue,f.IsLocked=e.IsLocked;var g=m.bannerData.filter(function(a){return a.oddSelectionID_1==e.SelectionID||a.oddSelectionID_X==e.SelectionID||a.oddSelectionID_2==e.SelectionID})[0];null!=g&&(g.isLocked=e.IsLocked,g.oddSelectionID_1==e.SelectionID?g.oddValue_1=c("number")(e.SelectionValue,2):g.oddSelectionID_X==e.SelectionID?g.oddValue_X=c("number")(e.SelectionValue,2):g.oddSelectionID_2==e.SelectionID&&(g.oddValue_2=c("number")(e.SelectionValue,2)))}}}),m.AddRemoveToCoupon=function(b){var c=$(b.currentTarget);if(c.hasClass("locked"))b.stopPropagation();else{var d=c.data("gameid"),e=c.data("selectionid"),f=m.bannerData.filter(function(a){return a.showBanner&&a.gameId==d})[0];if(null!=f&&(f.parsedData.SelectedMarkets=[],angular.forEach(f.parsedData.FormatMarkets,function(a){if(a.MatchOddsID==parseInt(e,10))return void f.parsedData.SelectedMarkets.push(a)}),f.parsedData.SelectedMarkets.length>0)){var g=k.formatCSCSelection(f.parsedData,f.parsedData.SelectedMarkets[0]);a.$emit("addRemoveToCoupon",b,g)}}},a.$watch(function(){return h.hasValidLogin()},function(a,c){c!=a&&b(l,0)}),a.$watch(function(){return $("#sportsBannerRotator").width()},function(a,b){b!=a&&m.resizeBannerRotator()}),a.$on("SportsController:MenuToggled",function(){b(function(){l()},200)}),a.$watch(function(){return m.checkBannersExpiry()})}])}(),function(){angular.module("bestSellersWidget",[]).controller("BestSellersController",["sportsApiService","loggingService","$filter",function(a,b,c){var d=this;this.bestSellers=[],this.parseRecord=function(a){return{id:a.IDBestSeller,stake:a.StakeGross,winnings:c("number")(a.PotWin,2),currencySymbol:locale.common.currencySymbols[a.IDCurrency]}};a.coupon.getBestSellers().then(function(a){if(!a.success)return void b.logError("Unable to get best sellers: "+JSON.stringify(a.error));if(null!=a.data.BestSellerCoupons){d.bestSellers=[];for(var c=0;c<a.data.BestSellerCoupons.length;c++)d.bestSellers.push(d.parseRecord(a.data.BestSellerCoupons[c]))}})}])}(),function(){function a(a){function b(a){setTimeout(function(){var b=Chartist[a.type]("#"+a.id,a.data,a.options,a.responsiveOptions);a.$watch("data",function(c,d){c!==d&&b.update(c,a.options,!0)},!0),a.$watch("options",function(c,d){c!==d&&b.update(a.data,c,!0)},!0)},0)}return{scope:{data:"=",options:"=",responsiveOptions:"@",type:"@",id:"@",tooltips:"@"},link:b,restrict:"EA"}}angular.module("hottestMarketsWidget",[]).controller("HottestOUController",["$interval","sportsApiService","loggingService","sportsService",function(a,b,c,d){var e=this,f={},g=0;$("#sportsBannerWrapper").css("display","block"),this.formatHottestOU=function(a){({series:{pie:{innerRadius:.6,show:!0,radius:pieGraphOptions.radius,label:{show:!0,radius:.5,formatter:e.labelFormatter,threshold:0},stroke:{width:pieGraphOptions.strokeWidth||0,color:pieGraphOptions.strokeColor}}},legend:{show:!1}}),pieGraphOptions.colorGradients;return angular.forEach(a.Events,function(a){var b=[];angular.forEach(a.Markets[0].Selections,function(a){b.push(a.SelectionPerc)}),a.pieChart={show:!1,data:{},options:{}},b.length<=0||(a.pieChart.show=!0,a.pieChart.data={series:b},a.pieChart.options={donut:!0,donutWidth:20,startAngle:0,showLabel:!1,plugins:[Chartist.plugins.fillDonut({items:[{content:"<span>Ov.</span>",position:"top",offsetY:45,offsetX:-2},{content:'<h3><span class="large">'+b[0]+'</span><span class="small">%</span></h3>'}]})]})}),a},this.init=function(a){f=a,g=isNaN(f.sport)?1:f.sport,b.feed.getHottestMarkets(globalSettings.CurrentLanguage,f.numberOfEvents,g).then(function(a){return a.success?void(a.data.Events.length<=0||(e.hottestOUData=e.formatHottestOU(a.data))):void c.logError("Unable to get hottest markets: "+JSON.stringify(a.error))})}}]).directive("ngChartistPieHelper",a);a.$inject=["$compile"]}(),function(){angular.module("lastMinuteWidget",[]).controller("LastMinuteWidgetController",["$scope","sportsApiService","loggingService",function(a,b,c){var d=this;this.formatLastMinuteWidget=function(a){if(!(null==a||null==a.AreaMatches||a.AreaMatches.length<=0)){var b={Events:[]};return angular.forEach(a.AreaMatches[0].Items,function(c){var d={Id:c.ItemID,ProviderId:c.ExtProvIDItem,SportId:a.AreaMatches[0].SportID,TournamentId:c.TournamentId,CategoryId:c.CategoryId,Date:c.ItemDate,HoursLeft:0,MinutesLeft:0,Name:c.ItemName,Markets:[]},e=moment(new Date(d.Date)),f=moment(new Date),g=e.diff(f,"hours"),h=e.diff(f,"minutes");g>0&&(h-=60*g),d.HoursLeft=g,d.MinutesLeft=h,angular.forEach(c.OddsCollection,function(a){var b={Id:a.OddCollectionID,TypeId:a.OddsType.OddsTypeID,Name:a.OddsType.OddsTypeName,SpecialValue:a.SpecialBetValue,Selections:[]};angular.forEach(a.MatchOdds,function(a){var c={Id:a.MatchOddsID,TypeId:a.OddAttribute.OddTypeID,Name:a.OddAttribute.OddName,OddValue:a.Outcome.OddOutcome};b.Selections.push(c)}),d.Markets.push(b)}),b.Events.push(d)}),angular.forEach(b.Events,function(a){a.FoundMarket=null,a.Markets.length>0&&(a.FoundMarket=a.Markets[0],null!=a.FoundMarket&&angular.forEach(a.FoundMarket.Selections,function(b){b.FoundSelection=null,b.FoundSelection=a.FoundMarket.Selections.filter(function(a){return a.TypeId==b.TypeId})[0],null==b.FoundSelection?b.FoundSelectionStatus="oddsNotFound":0!=b.FoundSelection.OddValue?b.FoundSelectionStatus="oddsAvailable":b.FoundSelectionStatus="oddsEmpty"}))}),b}};var e=function(a){var b=$(a),c=b.children("div").eq(1);$(a).children("div").eq(0).width(b.width()-c.width()-1)};this.showLastMinute=function(a){null==a&&(a="0"),b.feed.getLastMinute(globalSettings.CurrentLanguage,a,globalSettings.LastMinuteNumberOfEvents).then(function(a){return a.success?void(null!=a.data&&(d.data=d.formatLastMinuteWidget(a.data),$(window).resize(function(){e(".tblEventOdds_LastMinute")}))):void c.logError("Unable to get last minute: "+JSON.stringify(a.error))})},a.$on("onRepeatLast",function(b,c,d){"lastMinuteList"==d.onLastRepeat&&(a.$emit("selectExistingOdds"),e(".tblEventOdds_LastMinute"))}),$(window).resize(function(){e(".tblEventOdds_LastMinute")}),this.showLastMinute(1)}])}(),function(){angular.module("latestResultsWidget",[]).controller("LatestResultsController",["sportsApiService","loggingService",function(a,b){var c=this;this.formatLatestResults=function(a){return angular.forEach(a.LatestResults,function(a){var b="33.3%";null!=a.Selections&&2==a.Selections.length&&(b="50%"),a.SetOddsWidth=b}),a.LatestResults||[]},a.feed.getLatestResults(globalSettings.CurrentLanguage,globalSettings.NumberOfLatestResults).then(function(a){return a.success?void(c.latestResultsData=c.formatLatestResults(a.data)):void b.logError("Unable to get latest results: "+JSON.stringify(a.error))})}])}(),function(){angular.module("latestWinnersWidget",[]).controller("LatestWinnersController",["sportsApiService","loggingService",function(a,b){var c=this;a.coupon.getLatestWinnersByChannel(globalSettings.NumberOfLatestWinners).then(function(a){return a.success?void(c.latestWinnersData=a.data):void b.logError("Unable to get latest winners: "+JSON.stringify(a.error))}),this.CheckCoupon_Clicked=function(a){var b=$(a.currentTarget),c=b.attr("data-id"),d="/coupon-details-iframe/?couponCode="+c;return $.fancybox({modal:!1,showCloseButton:!0,hideOnContentClick:!1,hideOnOverlayClick:!0,width:925,height:530,type:"iframe",padding:2,margin:0,fitToView:!1,autoSize:!1,href:d}),!1}}])}(),function(){angular.module("liveBettingWidget",[]).controller("LiveBettingWidgetController",["$scope","sportsApiService","loggingService","$timeout","$interval","helperService","liveService",function(a,b,c,d,e,f,g){var h={};a.formatliveWidget=function(a){return angular.forEach(a.Events,function(a){a.FoundMarket=null,0!=a.Markets.length&&(a.FoundMarket=a.Markets[0],a.FoundMarket.SetWidth="25%",a.FoundMarket.SetInnerWidth="80%",2==a.FoundMarket.Selections.length?(a.FoundMarket.SetWidth="50%",a.FoundMarket.SetInnerWidth="40%"):3==a.FoundMarket.Selections.length&&(a.FoundMarket.SetWidth="33.3%",a.FoundMarket.SetInnerWidth="60%"),null!=a.FoundMarket&&angular.forEach(a.FoundMarket.Selections,function(b){b.FoundSelection=null,b.FoundSelection=a.FoundMarket.Selections.filter(function(a){return a.TypeId==b.TypeId})[0],null==b.FoundSelection?b.FoundSelectionStatus="oddsNotFound":0!=a.FoundMarket.Status&&0!=b.FoundSelection.Odds[0].Status?0!=b.FoundSelection.Odds[0].Value?b.FoundSelectionStatus="oddsAvailable":b.FoundSelectionStatus="oddsEmpty":b.FoundSelectionStatus="oddsLocked"}))}),a};var i=0,j=void 0;a.showLiveBetting=function(e){b.liveFeed.getLiveMostPopular(e,h.numberOfEvents).then(function(b){if(!b.success)return void c.logError("Unable to get live most popular events: "+JSON.stringify(b.error));if(d(function(){$("#owl-liveBetting").owlCarousel({items:6,itemsDesktop:[1920,6],itemsDesktopSmall:[1600,6],itemsTablet:[1366,6],itemsTabletSmall:[1280,6],itemsMobile:[1024,6],responsive:!0})},0),b.data.Sports.length>0){i=e;var f=[];f.SportId=e,f.AvailableSportIds=_(b.data.Sports).map(function(a){return a.Id}).take(5).value(),f.resultData=a.formatliveWidget(b.data),a.liveBettingData=f}})},a.openEvent=function(a,b,c){f.goToUmbracoPage("live","liveEventViewByMatchIds",{sportEventMatchIds:a+"-"+b+"-"+c})},a.eventTeam=function(a,b){var c="",d=a.filter(function(a){return a.ItemOrder==b})[0];return void 0!=d&&(c=d.Name.toLowerCase()),c},a.$on("onRepeatLast",function(b,c,d){"liveBettingWidgetList"==d.onLastRepeat&&a.$emit("selectExistingOdds")}),a.$on("$destroy",function(){j&&e.cancel(j),j=null}),this.getMatchStatusLabel=function(a,b){return g.getMatchStatusLabel(a,b)},this.init=function(b){h=b,a.showLiveBetting(i),j=e(function(){a.showLiveBetting(i)},1e3*h.refreshInterval)}}])}(),function(){function a(a){function b(a){var b=Chartist[a.type]("#"+a.id,a.data,a.options,a.responsiveOptions);a.$watch("data",function(c,d){c!==d&&b.update(a.data,!0)},!0),a.$watch("options",function(a,b){},!0)}return{scope:{data:"=",options:"=",responsiveOptions:"@",type:"@",id:"@",tooltips:"@"},link:b,restrict:"EA"}}angular.module("marketMoversWidget",[]).controller("MarketMoversController",["$interval","$sessionStorage","$filter","sportsApiService","loggingService",function(a,b,c,d,e){var f,g=this,h={};$("#sportsBannerWrapper").css("display","block"),this.showMarketMovers=function(b){var c=isNaN(h.sport)?1:h.sport,i=0;d.feed.getMarketMovers(c,h.numberOfEvents,globalSettings.CurrentLanguage,f,i).then(function(c){return c.success?void(c.data.OddsHistory.length<=0||(g.marketMoversData=g.formatMarketMovers(c.data,b),g.lineData={labels:[""],series:g.marketMoversData.DataGraph},g.lineOptions={showArea:!1,axisY:{onlyInteger:!0},plugins:[Chartist.plugins.ctPointLabels({textAnchor:"middle"})]},a(function(){var a=$("#owl-marketMovers");a.owlCarousel({items:4,itemsDesktop:[1920,4],itemsDesktopSmall:[1600,4],itemsTablet:[1366,4],itemsTabletSmall:[1280,4],itemsMobile:[1024,4],responsive:!0,afterAction:function(a){$("a.aItemEvent .item").textfill({maxFontPixels:13,innerTag:"div"})}})}.bind(this),10,1),$(window).resize(function(){$("a.aItemEvent .item").textfill({maxFontPixels:13,innerTag:"div"})}))):void e.logError("Unable to get market movers: "+JSON.stringify(c.error))})},this.formatMarketMovers=function(a,b){var d=!1,e="";angular.forEach(a.OddsHistory,function(a){b==a.IDEvent&&(d=!0),e=e+a.IDEvent+"|"+a.EventName+","}),d||(b=a.OddsHistory[0].IDEvent),""!=e&&(e=e.substring(0,e.length-1));var f=a.OddsHistory.filter(function(a){return a.IDEvent==b})[0];if(void 0!=f){var g=[],h=[],i=[];angular.forEach(f.Markets[0].Selections,function(a){var b=[],d=[],e=[];if(angular.forEach(a.Infos,function(b){d.push(b.Value),e.push([c("number")(b.Value,2),a.IDSelection])}),d.length>10){for(var f=d.length-10;f<d.length;f++)b.push(d[f]);h.push([a.SelectionName,e[e.length-10]])}else b=d,h.push([a.SelectionName,e[0]]);var j=h.filter(function(b){return b[0]==a.SelectionName})[0],k="up";parseFloat(j[1][0])>=parseFloat(e[e.length-1][0])&&(k="down"),i.push([a.SelectionName,e[e.length-1],k]),g.push(b)})}return a.IDEvent=b,a.AvailableEvents=e,a.StartingOdds=h,a.CurrentOdds=i,a.DataGraph=g,a},this.init=function(a){h=a;var c=b.SportsbookMarketTypeIds?b.SportsbookMarketTypeIds.filter(function(a){return"1X2"===a.LookupCode}):[];f=c.length?c[0].IDMarketType:10,this.showMarketMovers()}}]).directive("ngChartistHelper",a);a.$inject=["$compile"]}(),function(){angular.module("matchDayWidget",[]).controller("MatchDayController",["$interval","$sessionStorage","sportsApiService","loggingService",function(a,b,c,d){var e=this,f={};$("#sportsBannerWrapper").css("display","block"),this.ouLoadGraph=function(a,b,c){var d=0,e=0,f=0,g=1500,h=1500,i=1500,j=Math.max(a,b,c),k=Math.min(a,b,c);switch(j){case a:g=2e3;break;case b:i=2e3;break;case c:h=2e3}switch(k){case c:h=1e3;break;case a:g=1e3;break;case b:i=1e3}var l=$(".chart").width();d=l/100*a,f=l/100*b,e=l/100*c,0!=d&&(d+=5),0!=f&&(f+=5),0!=e&&(e+=5),$(".chart1").animate({width:d},g),$(".chartX").animate({width:f},i),$(".chart2").animate({width:e},h)},this.showMatchDay=function(b){c.feed.getMatchOfTheDay(globalSettings.CurrentLanguage,b).then(function(b){return b.success?void(b.data.Events.length<=0||(e.data=e.formatMatchDay(b.data),a(function(){if(void 0!=e.data.Percentage1){var a=e.data.Percentage1,b=e.data.PercentageX,c=e.data.Percentage2;e.ouLoadGraph(a,b,c),$(".md_TeamName").textfill({maxFontPixels:16})}}.bind(this),10,1))):void d.logError("Unable to get match of the day: "+JSON.stringify(b.error))})},this.formatMatchDay=function(a){var c=b.SportsbookMarketTypeIds?b.SportsbookMarketTypeIds.filter(function(a){return"1X2"===a.LookupCode}):[],d=c.length?c[0].IDMarketType:10;if(a.Events[0].Markets[0].IDMarketType==d){a.Events[0].ShowMatchDay=!0,3==a.Events[0].Markets[0].Selections.length&&(a.Events[0].Percentage1=a.Events[0].Markets[0].Selections[0].SelectionPerc,a.Events[0].PercentageX=a.Events[0].Markets[0].Selections[1].SelectionPerc,a.Events[0].Percentage2=a.Events[0].Markets[0].Selections[2].SelectionPerc);for(var e=0;e<a.Events[0].Markets.length;e++){var f=a.Events[0].Markets[e];if(10!=f.IDMarketType&&f.Selections.length>1){var g=Math.max(f.Selections[0].SelectionPerc,f.Selections[1].SelectionPerc),h=Math.min(f.Selections[0].SelectionPerc,f.Selections[1].SelectionPerc);switch(g){case f.Selections[0].SelectionPerc:f.Selections[0].PercType="max";break;case f.Selections[1].SelectionPerc:f.Selections[1].PercType="min"}switch(h){case f.Selections[0].SelectionPerc:f.Selections[0].PercType="min";break;case f.Selections[1].SelectionPerc:f.Selections[1].PercType="min"}}}}else a.Events[0].ShowMatchDay=!1;return a.Events[0]},this.init=function(a){f=a,this.showMatchDay(isNaN(f.sport)?1:f.sport)}}])}(),function(){angular.module("mostPopularWidget",[]).controller("MostPopularController",["$scope","$timeout","$interval","sportsService","sportsApiService","loggingService","helperService","$filter",function(a,b,c,d,e,f,g,h){var j=this,k={},l=0;this.events=[],this.data={},this.dateSelected=null,this.mostPopularLoader=!1,this.sportMenuTabs=[],this.sportMenuTabSelected=0,this.leagueMenuTabs=[],this.leagueMenuTabSelected=0,this.changeTournament=function(a){j.leagueMenuTabSelected!==a&&("all"===j.leagueMenuTabSelected||"all"===a?j.showMostPopular(j.sportMenuTabSelected,a,j.dateSelected):j.leagueMenuTabSelected=a)},this.showMostPopular=function(c,m,n){null==n?n=j.dateSelected?j.dateSelected:moment().startOf("day"):j.dateSelected=n;var o="";"all"!=n&&(o=n.format("YYYY-MM-DD"));var p;p="all"===m&&0!==l?h("number")(k.numberOfEvents/l,0):k.numberOfEvents,e.feed.getMostPopularByLeague(globalSettings.CurrentLanguage,c,l,p,o).then(function(e){if(!e.success)return f.logError("Unable to get most popular: "+JSON.stringify(e.error)),void(j.mostPopularLoader=!0);if(0!=e.data.length){var k={};j.sportMenuTabSelected=c,k.Date=n;var l=[];for(i=0;i<5;i++)l.push(moment().startOf("day").add(i,"d"));k.DateData=l;var o=[{data:e.data[0]}];o[0].data.AreaMatches&&o[0].data.AreaMatches.length&&(o[0].data.AreaMatches[0].AreaMarkets=h("limitTo")(o[0].data.AreaMatches[0].AreaMarkets,3));var p=d.parseEventData(o);if(j.oldData){var q=g.generateHashCode(j.oldData),r=g.generateHashCode(p);q!==r&&(j.events=angular.copy(p))}else j.events=angular.copy(p);j.oldData=angular.copy(p),j.data=k,j.leagueMenuTabs=o[0].data.AreaMatches[0].Items.map(function(a){var b={leagueId:a.TournamentId,leagueName:a.CategoryName+" - "+a.TournamentName};return b}),j.leagueMenuTabs=j.leagueMenuTabs.filter(function(a){return j.leagueMenuTabs.indexOf(a.leagueId)===-1&&(j.leagueMenuTabs.push(a.leagueId),!0)}),0!=m?j.leagueMenuTabSelected=m:j.leagueMenuTabSelected=j.leagueMenuTabs[0].leagueId,b(function(){a.$emit("selectExistingOdds"),$("#owl-mostPopular").owlCarousel({items:7,itemsDesktop:[1920,7],itemsDesktopSmall:[1600,7],itemsTablet:[1366,7],itemsTabletSmall:[1280,7],itemsMobile:[1024,5],responsive:!0}),a.aCrossHover=1==a.aCrossHover?2:1}.bind(this),0),j.mostPopularLoader=!0}})},this.updateCoupon=function(b,c){null!=c&&(globalSettings.UseServerSideCoupon?a.$emit("addRemoveToCoupon",b,null):void 0!=c&&c.isOddValue&&a.$emit("addRemoveToCoupon",b,c))},a.aCrossHover=1,this.timerCall,this.startShowMostPopularTimer=function(){j.timerCall=c(function(){j.showMostPopular(j.sportMenuTabSelected,j.leagueMenuTabSelected)},1e3*k.refreshInterval)},this.handleVisibilityChange=function(){g.pageVisibilityApi().isPageHidden?(c.cancel(j.timerCall),j.timerCall=void 0):j.startShowMostPopularTimer()},void 0!==g.pageVisibilityApi().hiddenVariableName&&"undefined"!=typeof document.addEventListener&&globalSettings.Sports_PauseTimersWhenInactive&&document.addEventListener(g.pageVisibilityApi().eventName,j.handleVisibilityChange,!1),a.$on("$destroy",function(){j.timerCall&&c.cancel(j.timerCall),j.timerCall=void 0}),this.init=function(a,b,c){k=a,l=b,j.sportMenuTabs=_.filter(k.sport.split(",").map(function(a){return isNaN(a)?void 0:parseInt(a)}),function(a){return a}),j.sportMenuTabs.length>0&&(j.sportMenuTabSelected=j.sportMenuTabs[0],j.leagueMenuTabSelected=1===c?"all":0,j.showMostPopular(j.sportMenuTabSelected,j.leagueMenuTabSelected,"all")),j.startShowMostPopularTimer()}}])}(),function(){angular.module("screensaverWidget",[]).controller("ScreensaverController",["$scope","$state","umbracoApiService",function(a,b,c){function d(){var b=0,c=0,d=new Date;for(i=0;i<a.bannerData.length;i++)if(i==a.bannerData.length-1||new Date(a.bannerData[i].firstLoopFlip)>=d&&d<new Date(a.bannerData[i+1].firstLoopFlip)){c=i,b=moment(a.bannerData[i].firstLoopFlip).add(a.bannerData[i].bannerDuration,"s").diff(moment());break}g(c,b)}function e(){a.currentDisplayedBanner=a.bannerData[0]}function f(){function c(){a.showScreenSaver=!0,$(".screen-saver").fadeIn(g)}function d(){void 0!==a.currentDisplayedBanner.bannerAction&&1!=a.currentDisplayedBanner.bannerAction||f()}function e(){0==a.currentDisplayedBanner.bannerAction&&window.location.replace(a.currentDisplayedBanner.bannerClickLink)}function f(){clearTimeout(h),h=setTimeout(c,l),a.showScreenSaver===!0&&($(document).scrollTop(0),b.go("sportsHome",{createSIDs:void 0}),$(".screen-saver").fadeOut(g/2),a.showScreenSaver=!1)}$(".screen-saver").hide();var g=3e3;window.onload=d,document.onload=d,document.onmousemove=d,document.onmousedown=d,document.ontouchstart=d,document.onclick=d,document.onscroll=d,document.onkeypress=d,$(".screen-saver-image").click(e),$(".screen-saver-close").click(f),f()}function g(b,c){c||(c=0),a.currentDisplayedBanner=a.bannerData[b?b:k],b&&(k=b),k<a.bannerData.length-1?k++:k=0;var d=0==c?1e3*a.currentDisplayedBanner.bannerDuration:c;d-=moment(new Date).diff(moment(m)),m=new Date((new Date).getTime()+d),loadBannerTimeout=setTimeout(function(){g()},d)}var h,j=this,k=0,l=10,m=void 0;a.bannerData=[],a.currentDisplayedBanner={},a.showScreenSaver=!1,this.init=function(){$(".screen-saver").hide(),c.desktop.getSportScreenSaverBanners(globalSettings.CurrentLanguage).then(function(b){b.success&&(l=1e3*b.data.IdleSeconds,a.bannerData=b.data.Content,void 0!==b.data.Content&&(1==b.data.Content.length?(e(),f()):b.data.Content.length>0&&(d(),f())))})},j.init()}])}(),function(){angular.module("upcomingEventsWidget",[]).controller("UpcomingEventsController",["$scope","$timeout","$interval","sportsService","sportsApiService","$filter","loggingService","helperService",function(a,b,c,d,e,f,g,h){var i=this,j={};this.events=[],this.data={},this.upcomingEventsLoader=!1,this.sportMenuTabs=[],this.sportMenuTabSelected=0,this.showUpcomingEvents=function(c){e.feed.getUpcomingEvents(globalSettings.CurrentLanguage,c,j.numberOfEvents).then(function(e){if(!e.success)return g.logError("Unable to get upcoming events: "+JSON.stringify(e.error)),void(i.upcomingEventsLoader=!0);var j={};i.sportMenuTabSelected=c;var k=[{data:e.data}];k[0].data.AreaMatches&&k[0].data.AreaMatches.length&&(k[0].data.AreaMatches[0].AreaMarkets=f("limitTo")(k[0].data.AreaMatches[0].AreaMarkets,3));var l=d.parseEventData(k);if(i.oldData){var m=h.generateHashCode(i.oldData),n=h.generateHashCode(l);m!==n&&(i.events=angular.copy(l))}else i.events=angular.copy(l);i.oldData=angular.copy(l),i.data=j,b(function(){a.$emit("selectExistingOdds"),$("#owl-upcomingEvents").owlCarousel({items:7,itemsDesktop:[1920,7],itemsDesktopSmall:[1600,7],itemsTablet:[1366,7],itemsTabletSmall:[1280,7],itemsMobile:[1024,5],responsive:!0}),a.aCrossHover=1==a.aCrossHover?2:1}.bind(this),0),i.upcomingEventsLoader=!0})},this.updateCoupon=function(b,c){null!=c&&(globalSettings.UseServerSideCoupon?a.$emit("addRemoveToCoupon",b,null):void 0!=c&&c.isOddValue&&a.$emit("addRemoveToCoupon",b,c))},a.aCrossHover=1;var k=void 0;a.$on("$destroy",function(){k&&c.cancel(k),k=void 0}),this.init=function(a){j=a,i.sportMenuTabs=_.filter(j.sport.split(",").map(function(a){return isNaN(a)?void 0:parseInt(a)}),function(a){return a}),i.sportMenuTabs.length>0&&(i.sportMenuTabSelected=i.sportMenuTabs[0],i.showUpcomingEvents(i.sportMenuTabSelected)),k=c(function(){i.showUpcomingEvents(i.sportMenuTabSelected)},1e3*j.refreshInterval)}}])}(),function(){angular.module("state.service",[]).service("stateService",["$rootScope","$state","$stateRegistry","$location","$urlRouter","$transitions","$q","$injector","eventsCacheService","sportsService","sportsApiService","platformApiService","authService","helperService","ReportsService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(a){o.dataTableCache[a]&&(o.dataTableCache[a].success=!1,o.dataTableCache[a].data.Data.length=0)}var q=l.security,r=function(a,b,c,d){var e=j.getOddsDataFromCache(a);if(e)return e.promise;var f,g=a.split("-").filter(Boolean),h=(g[0],g[2]),i=g[3],l=g[4],m={eventId:a,data:[]};return f=d?k.feed.getEventsByRange(b,c,h,i,l,"poker").then(function(a){return a.success&&(m.data=a.data),m}):k.feed.getEventsByRange(b,c,h,i,l).then(function(a){return a.success&&(m.data=a.data),m}),j.addOddsDataToCache(a,f),f},s=function(a,b){for(var c=0;c<a.length;c++)if(b(a[c]))return c;return-1},t={sports:"sports",pokershares:"pokershares",live:"live",casino:"casino",liveCasino:"liveCasino",account:"account",agents:"agents",shop:"shop",virtuals:"virtuals",virtualLeagues:"virtualLeagues"},u=function(a){var b=null,c=window.location.hostname;return globalSettings.IsMultiLanguage&&(c+="/"+globalSettings.CurrentLanguage),a.indexOf(c+"/sports")>-1?b=t.sports:a.indexOf(c+"/pokershares")>-1?b=t.pokershares:a.indexOf(c+"/live")>-1?b=t.live:a.indexOf(c+"/casino")>-1?b=t.casino:a.indexOf(c+"/livecasino")>-1?b=t.liveCasino:a.indexOf(c+"/account")>-1?b=t.account:a.indexOf(c+"/agents")>-1?b=t.agents:a.indexOf(c+"/shop")>-1?b=t.shop:a.indexOf(c+"/virtuals")>-1?b=t.virtuals:a.indexOf(c+"/virtual-leagues")>-1&&(b=t.virtualLeagues),b},v=function(a){var c=null;return a==t.sports?c=b.target("sportsHome",{}):a==t.pokershares?c=b.target("pokershares",{}):a==t.live?c=b.target("liveOverview",{}):a==t.casino?c=b.target("casinoHome",{}):a==t.liveCasino?c=b.target("liveCasinoHome",{}):a==t.account&&m.hasValidLogin()?c=b.target("accountHome",{}):a==t.agents&&m.hasValidLogin()&&m.isAgent()?c=b.target("agents",{}):a==t.shop?c=b.target("shop",{}):a==t.virtuals?c=b.target("virtuals",{}):a==t.virtualLeagues&&(c=b.target("virtualLeagues",{})),c};return{siteSections:t,getSiteSectionFromUrl:u,getEventOdds:r,getEventOddsByDate:function(a,b,c,d){d=d||0;var e,f=a.split("-").filter(Boolean),g=f[0],h=f[1],i=f[2],j={eventId:a,data:[],isThereMoreToLoad:!1},l=!!globalSettings.Sports_TodayMatchesPageSize;if(l){var m=globalSettings.Sports_TodayMatchesPageSize+1;return e=k.feed.getPagedEvents(b,c,g,h,i,d,m).then(function(a){if(a.success&&a.data.AreaMatches.length>0){var b=0;a.data.AreaMatches.forEach(function(a){b+=a.Items.length}),a.data.AreaMatches&&a.data.AreaMatches.length&&a.data.AreaMatches[0].Items&&a.data.AreaMatches[0].Items.length>globalSettings.Sports_TodayMatchesPageSize&&a.data.AreaMatches[0].Items.pop(),j.data=a.data,j.isThereMoreToLoad=b>globalSettings.Sports_TodayMatchesPageSize}return j})}return e=k.feed.getPagedEvents(b,c,g,h,i).then(function(a){if(a.success&&a.data.AreaMatches.length>0){var b=0;a.data.AreaMatches.forEach(function(a){b+=a.Items.length}),j.data=a.data}return j})},getEventOddsByTimeFrame:function(a,b,c,d,e){e=e||0;var f,g=a.split("-").filter(Boolean),h=g[0],i=g[1],j=g[2],l={eventId:a,data:[],isThereMoreToLoad:!1},m=!!globalSettings.Sports_TodayMatchesPageSize;if(m){var n=globalSettings.Sports_TodayMatchesPageSize+1;return f=k.feed.getPagedEventsTimeFrameWithSort(b,c,d,h,i,j,e,n).then(function(a){if(a.success){var b=0;a.data.AreaMatches.forEach(function(a){b+=a.Items.length}),a.data.AreaMatches&&a.data.AreaMatches.length&&a.data.AreaMatches[0].Items&&a.data.AreaMatches[0].Items.length>globalSettings.Sports_TodayMatchesPageSize&&a.data.AreaMatches[0].Items.pop(),l.data=a.data,l.isThereMoreToLoad=b>globalSettings.Sports_TodayMatchesPageSize}return l})}return f=k.feed.getPagedEventsTimeFrameWithSort(b,c,d,h,i,j).then(function(a){if(a.success){var b=0;a.data.AreaMatches.forEach(function(a){b+=a.Items.length}),l.data=a.data}return l})},registerStates:function(){var a=h.get("stateConfigService"),b=a.stateDefinitions,f="undefined"!=typeof f?f:[];if(f.length>0)for(var g=0;g<f.length;g++){var i=s(b,function(a){return f[g].url===a.url});i>-1?b[i].config=f[g].config:b.push(f[g])}angular.forEach(b,function(a){c.register(a)}),e.otherwise(function(){var a=u(d.absUrl()),b=v(a);b?d.url(b.state().url.split("?")[0]+window.location.search):d.url("/"+window.location.search)})},setupTransitions:function(){f.onStart({},function(c){a.showLoader();var e=c.$to().name;c.promise.finally(function(){var b=["shopCashiersReports","shopCashDesk"];_.includes(b,e)||a.hideLoader()});var f=m.getUserStatus();switch(f){case"PCHANG":var h;if(h=globalSettings.ShopEnabled&&m.isAgent()?"shopChangePassword":"accountChangePassword",e!=h)return void(globalSettings.ShopEnabled&&m.isAgent()?n.goToUmbracoPage("shop","shopChangePassword"):n.goToUmbracoPage("account","accountChangePassword"));break;case"UNCONF":a.$broadcast("hideUnverifiedAccountPopupRequest"),globalSettings.General_AllowUnconfirmedUsers||(globalSettings.General_EnableOTPbySms?"/phone-verification-iframe/"!==window.location.pathname&&q.getActivationOption().then(function(b){"ByEmail"==b.data?(n.showMessageWithTitle(locale.account.register.confirmRegistration.confirmAccountTitle,locale.account.register.confirmRegistration.confirmEmailSent,!1,null,!1,null).done(),m.clearUserData()):"BySms"==b.data&&a.$broadcast("verifyPhoneNumberRequest")}):(n.showMessageWithTitle(locale.account.register.confirmRegistration.confirmAccountTitle,locale.account.register.confirmRegistration.confirmEmailSent,!1,null,!1,null).done(),m.clearUserData()))}if(globalSettings.Account_MobileEditability&&(e.startsWith("shop")||e.startsWith("account"))&&m.getVerifyAccountData()&&"Locked"==m.getVerifyAccountData().type&&void 0==globalSettings.General_RouteWhiteListForLockedUsers.split(",").filter(function(a){return a==e})[0])return void(globalSettings.ShopEnabled&&m.isAgent()?n.goToUmbracoPage("shop","shopChangePhoneNumber"):n.goToUmbracoPage("account","accountChangePhoneNumber"));var l=u(d.absUrl());if(null!=c.$to().data&&c.$to().data.siteSection!=l){console.warn("Access to the state "+e+" has been denied");var o=v(l);return!!o&&o}switch(e){case"sportsSingleEvent":case"pokersharesSingleEvent":var r=g.defer();return i.convertToIds({sport:c.params().sport,category:c.params().category,tournament:c.params().tournament,isOutright:"o"==c.params().eventType}).then(function(a){if(!a){var d="pokersharesSingleEvent"==e?"pokershares":"sportsHome";return void r.resolve(b.target(d,c.params()))}r.resolve(!0)}),r.promise;case"sportsMultipleEvents":case"pokersharesMultipleEvents":var s=c.params().eventMarketIds.split(",").filter(Boolean);if(0==s.length){var t="pokersharesMultipleEvents"==e?"pokershares":"sportsHome";return b.target(t,c.params())}if(s.length>1)return!0;var r=g.defer(),w=s[0].split("-"),x=w[0],y=w[1],z=w[2],A=w[3],B=w[4],C=c.params().matchId;return i.convertToNames({sport:x,category:y,tournament:z}).then(function(a){if(!a){var d="pokersharesMultipleEvents"==e?"pokershares":"sportsHome";return void r.resolve(b.target(d,c.params()))}var d="pokersharesMultipleEvents"==e?"pokersharesSingleEvent":"sportsSingleEvent";r.resolve(b.target(d,{eventType:a.isOutright?"o":"p",sport:a.sport,category:a.category,tournament:a.tournament,areaId:A,regionId:B,matchId:C}))}),r.promise;case"sportsMatchView":var r=g.defer(),t="sportsHome";if(!c.params().matchId||!c.params().eventId)return void r.resolve(b.target(t));var w=c.params().eventId.split("-"),x=w[0],y=w[1],z=w[2];return i.convertToNames({sport:x,category:y,tournament:z}).then(function(a){if(!a)return void r.resolve(b.target(t));var d=angular.extend({},c.params(),{sportName:a.sport,categoryName:a.category,tournamentName:a.tournament});t="sportsMatchViewNamed",r.resolve(b.target(t,d))}),r.promise;case"sportsEventsPrematchBySport":case"sportsEventsOutrightBySport":var r=g.defer(),D=c.params().sport;if(isNaN(D.split("_")[0])){var E="sportsEventsOutrightBySport"==e;i.getSportIdFromName(D,E).then(function(a){return null==a?void r.resolve(b.target("sportsHome")):void r.resolve()})}else i.getSportNameFromId(D).then(function(a){return null==a?void r.resolve(b.target("sportsHome")):void r.resolve(b.target(e,{sport:a}))});return r.promise;case"sportsMatchesTodayRange":var F=1;j.setTimeRange(F),j.clearOddsDataCache();break;case"sportsMatchesWeekRange":var F=3;j.setTimeRange(F),j.clearOddsDataCache();break;case"sportsMatchesAllRange":var F=4;j.setTimeRange(F),j.clearOddsDataCache();break;case"pokersharesTournament":var r=g.defer(),G=c.params().seriesIds.split("-");return k.feed.getPokerTournaments(globalSettings.CurrentLanguage,4).then(function(a){var c="pokershares",d={};if(a.success){var e=a.data.Sports[0],f=[];if(_.forEach(G,function(a){var b=_.find(e.Category,function(b){return a==b.ItemID});b&&f.push(b)}),f){var g="";_.forEach(f,function(a){var b=_(a.Tournaments).map(function(b){
return e.SportID+"-"+a.ItemID+"-"+b.ItemID+"-0-0"});g+=b+","}),c="pokersharesMultipleEvents",d={eventMarketIds:g}}}r.resolve(b.target(c,d))}),r.promise;case"liveEventView":var r=g.defer();return k.liveFeed.getLiveAreaOddsByLayout(globalSettings.CurrentLanguage,0,3,0,!1,!1,!1,!1).then(function(a){if(!a.success)return loggingService.logError("Unable to get live events: "+JSON.stringify(a.error)),void r.resolve(b.target("liveDiary",{}));if(0==a.data.Sports.length)return void r.resolve(b.target("liveDiary",{}));var c=a.data.Sports[0],d=c.Id+"-"+c.Tournaments[0].Events[0].Id+"-"+c.Tournaments[0].Events[0].ProviderId;r.resolve(b.target("liveEventViewByMatchIds",{sportEventMatchIds:d}))}),r.promise;case"shop":return m.hasValidLogin()&&m.isAgent()?b.target("shopAccountStatement",{},{reload:!0}):b.target("shopHome",{},{reload:!0});case"shopHome":if(m.hasValidLogin()&&m.isAgent())return b.target("shopAccountStatement",{},{reload:!0});break;case"shopCashiers":"shopCashiersReports"!==c.$from().name&&p("cashierSummary")}return!0}),f.onSuccess({},function(a){if(globalSettings.CanonicalURL.length>0){var b=d.absUrl().replace(window.location.origin,""),c=globalSettings.CanonicalURL.replace(/\/$/,"")+b;$('link[rel="canonical"]').attr("href",c)}})}}}])}(),function(){angular.module("stateConfig.service",[]).service("stateConfigService",["$state","$q","stateService","eventsCacheService","sportsService","sportsApiService",function(a,b,c,d,e,f){var g,h=c.siteSections;return{stateDefinitions:[{name:"sportsHome",url:"/s",templateUrl:"/partials/sports/home.html",data:{siteSection:h.sports}},{name:"sportsLessThanTwo",url:"/s/less-than-two",templateUrl:"/partials/sports/less-than-two.html",controller:"LessThanTwoController as lessThanTwoCtrl",data:{siteSection:h.sports}},{name:"sportsSearch",url:"/s/search/:searchQuery",templateUrl:"/partials/sports/search.html",data:{siteSection:h.sports}},{name:"sportsEventsPrematch",url:"/s/prematch",templateUrl:"/partials/sports/events.html",controller:"SportsEventsController as eventsCtrl",resolve:{sportDataCall:["$transition$","sportsApiService","sportsService",function(a,b,c){var d=globalSettings.CurrentLanguage,e=c.getTimeRange();return b.feed.getPrematchTournaments(d,e)}]},data:{siteSection:h.sports}},{name:"sportsEventsOutright",url:"/s/outright",templateUrl:"/partials/sports/events.html",controller:"SportsEventsController as eventsCtrl",resolve:{sportDataCall:["$transition$","sportsApiService","sportsService",function(a,b,c){var d=globalSettings.CurrentLanguage,e=c.getTimeRange();return b.feed.getOutrightTournaments(d,e)}]},data:{siteSection:h.sports}},{name:"sportsEventsPrematchBySport",url:"/s/prematch/:sport",templateUrl:"/partials/sports/events.html",controller:"SportsEventsController as eventsCtrl",resolve:{sportDataCall:["$transition$","sportsApiService","sportsService",function(a,c,e){var f=b.defer(),g=a.params().sport;return d.getSportIdFromName(g,!1).then(function(a){var b=globalSettings.CurrentLanguage,d=e.getTimeRange();c.feed.getPrematchTournamentsBySport(b,d,a).then(function(a){f.resolve(a)})}),f.promise}]},data:{siteSection:h.sports}},{name:"sportsEventsOutrightBySport",url:"/s/outright/:sport",templateUrl:"/partials/sports/events.html",controller:"SportsEventsController as eventsCtrl",resolve:{sportDataCall:["$transition$","sportsApiService","sportsService",function(a,c,e){var f=b.defer(),g=a.params().sport;return d.getSportIdFromName(g,!0).then(function(a){var b=globalSettings.CurrentLanguage,d=e.getTimeRange();c.feed.getOutrightTournamentsBySport(b,d,a).then(function(a){f.resolve(a)})}),f.promise}]},data:{siteSection:h.sports}},{name:"sportsSingleEvent",url:"/s/event/:eventType/:sport/:category/:tournament/:areaId/:regionId?matchId",templateUrl:"/partials/sports/eventOdds.html",controller:"SportsEventsOddsController as oddsCtrl",resolve:{oddsData:["$q","$transition$","$injector","sportsService","eventsCacheService",function(a,b,c,d,e){var f=a.defer();return e.convertToIds({sport:b.params().sport,category:b.params().category,tournament:b.params().tournament,isOutright:"o"==b.params().eventType}).then(function(a){var e=b.params().areaId,g=b.params().regionId,i=a.sport+"-"+a.category+"-"+a.tournament+"-"+e+"-"+g,j=globalSettings.CurrentLanguage,k=d.getTimeRange(),l=b.to().data.siteSection,m=l==h.pokershares;d.clearOldEventData([i]);var n=c.get("stateService");n.getEventOdds(i,j,k,m).then(function(a){f.resolve([a])})}),f.promise}]},data:{siteSection:h.sports}},{name:"sportsMultipleEvents",url:"/s/eventOdds/:eventMarketIds?matchId",templateUrl:"/partials/sports/eventOdds.html",controller:"SportsEventsOddsController as oddsCtrl",resolve:{oddsData:["$q","$transition$","$injector","sportsApiService","sportsService","eventsCacheService",function(a,b,c,d,e,f){var g=b.params().eventMarketIds.split(",").filter(Boolean);if(e.validateNoOfChamps(b.params())){var i=globalSettings.CurrentLanguage,j=e.getTimeRange(),k=b.to().data.siteSection,l=k==h.pokershares;e.clearOldEventData(g);var m=g.map(function(a){var b=c.get("stateService");return b.getEventOdds(a,i,j,l)});return a.all(m)}}]},data:{siteSection:h.sports}},{name:"sportsMatchView",url:"/s/?eventId&matchId&matchName",templateUrl:"/partials/sports/matchView.html",data:{siteSection:h.sports}},{name:"sportsMatchViewNamed",url:"/s/:sportName/:categoryName/:tournamentName/:matchName?matchId",params:{sportName:null,categoryName:null,tournamentName:null,matchName:null,matchId:null},templateUrl:"/partials/sports/matchView.html",controller:"SportsMatchController as matchCtrl",resolve:{matchData:["$q","$transition$","sportsApiService","sportsService","loggingService",function(a,b,c,d,e){var f=a.defer();return c.feed.getEventOddFeedLite(globalSettings.CurrentLanguage,d.getTimeRange(),b.params().matchId).then(function(a){a.success||e.logError("Unable to get event odd feed ungrouped: "+JSON.stringify(a.error));var c=d.parseMoreEventData(a.data,!0),g=angular.extend({},b.params(),{oddFeed:c,regionData:d.parseRegionGroupingData(a.data)});f.resolve(g)}),f.promise}]},data:{siteSection:h.sports}},{name:"sportsDateEvent",url:"/s/event/date/:day/:sportId/:areaId/:regionId",templateUrl:"/partials/sports/eventOdds.html",controller:"SportsEventsOddsController as oddsCtrl",resolve:{oddsData:["$q","$transition$","$injector",function(a,b,c){var d=a.defer(),e=b.params().day,f=b.params().sportId,g=b.params().areaId,h=b.params().regionId,i=moment().add(e,"day").format("YYYY-MM-DD"),j=f+"-"+g+"-"+h,k=globalSettings.CurrentLanguage,l=c.get("stateService");return l.getEventOddsByDate(j,k,i).then(function(a){a.CurrentDate=i,d.resolve([a])}),d.promise}]},data:{siteSection:h.sports}},{name:"predictorGroupStage",url:"/s/group-stage",templateUrl:"/partials/sports/group-stage.html",controller:"PredictorController as predictorCtrl",resolve:{predictorData:["$q","sportsApiService","umbracoApiService",function(a,b,c){var d=a.defer();return c.desktop.getGroupStageSections().then(function(c){if(c.success){for(var e=c.data,f=[],g=[],h=globalSettings.CurrentLanguage,i=0;i<Object.keys(e.groupStage).length;i+=1){var j=Object.keys(e.groupStage)[i],k=e.groupStage[j];f.push(b.feed.getEventOddFeedUngroupedLite(h,"4",k[0].groupId,0).then(function(a){g.push(a)}))}a.all(f).then(function(){d.resolve([g,e])})}}),d.promise}]},data:{siteSection:h.sports}},{name:"predictorKnockoutStage",url:"/s/knockout-stage",templateUrl:"/partials/sports/knockout-stage.html",controller:"PredictorController as predictorCtrl",resolve:{predictorData:["$q","sportsApiService","umbracoApiService",function(a,b,c){var d=a.defer();return c.desktop.getKnockoutSections().then(function(c){if(c.success){var e=c.data,f=[],g=[],h=(globalSettings.CurrentLanguage,{Request:[]});if(e.Last16Matches.length>0){for(var i={TournamentId:parseInt(e.Last16Matches[0].stageId),Events:[]},j=!1,k=0;k<e.Last16Matches.length;k+=1){var l=e.Last16Matches[k];if(""!=l.teamHomeId&&""!=l.teamAwayId){j||(j=!0);var m={Date:l.matchDate,HomeTeamId:parseInt(l.teamHomeId),AwayTeamId:parseInt(l.teamAwayId)};i.Events.push(m)}}j&&h.Request.push(i)}if(e.QuarterFinalMatches.length>0){for(var i={TournamentId:parseInt(e.QuarterFinalMatches[0].stageId),Events:[]},j=!1,k=0;k<e.QuarterFinalMatches.length;k+=1){var l=e.QuarterFinalMatches[k];if(""!=l.teamHomeId&&""!=l.teamAwayId){j||(j=!0);var m={Date:l.matchDate,HomeTeamId:parseInt(l.teamHomeId),AwayTeamId:parseInt(l.teamAwayId)};i.Events.push(m)}}j&&h.Request.push(i)}if(e.SemiFinalMatches.length>0){for(var i={TournamentId:parseInt(e.SemiFinalMatches[0].stageId),Events:[]},j=!1,k=0;k<e.SemiFinalMatches.length;k+=1){var l=e.SemiFinalMatches[k];if(""!=l.teamHomeId&&""!=l.teamAwayId){j||(j=!0);var m={Date:l.matchDate,HomeTeamId:parseInt(l.teamHomeId),AwayTeamId:parseInt(l.teamAwayId)};i.Events.push(m)}}j&&h.Request.push(i)}if(e.FinalMatch.length>0){var i={TournamentId:parseInt(e.FinalMatch[0].stageId),Events:[]},n=!1,l=e.SemiFinalMatches[0];if(""!=l.teamHomeId&&""!=l.teamAwayId){n=!0;var m={Date:l.matchDate,HomeTeamId:parseInt(l.teamHomeId),AwayTeamId:parseInt(l.teamAwayId)};i.Events.push(m)}n&&h.Request.push(i)}f.push(b.feed.getOddsForTeams(h).then(function(a){g.push(a)})),a.all(f).then(function(){d.resolve([g,e])})}}),d.promise}]},data:{siteSection:h.sports}},{name:"sportsMatchesTodayRange",url:"/s/eventsToday",templateUrl:"/partials/sports/events.html",controller:"SportsEventsController as eventsCtrl",resolve:{sportDataCall:["$transition$","sportsApiService","sportsService",function(a,b,c){var d=globalSettings.CurrentLanguage,e=c.getTimeRange();return b.feed.getPrematchTournaments(d,e)}]},data:{siteSection:h.sports}},{name:"sportsMatchesWeekRange",url:"/s/eventsWeek",templateUrl:"/partials/sports/events.html",controller:"SportsEventsController as eventsCtrl",resolve:{sportDataCall:["$transition$","sportsApiService","sportsService",function(a,b,c){var d=globalSettings.CurrentLanguage,e=c.getTimeRange();return b.feed.getPrematchTournaments(d,e)}]},data:{siteSection:h.sports}},{name:"sportsMatchesAllRange",url:"/s/eventsAll",templateUrl:"/partials/sports/events.html",controller:"SportsEventsController as eventsCtrl",resolve:{sportDataCall:["$transition$","sportsApiService","sportsService",function(a,b,c){var d=globalSettings.CurrentLanguage,e=c.getTimeRange();return b.feed.getPrematchTournaments(d,e)}]},data:{siteSection:h.sports}},{name:"sportsResults",url:"/s/results",templateUrl:"/partials/sports/results.html",controller:"SportsResultsController as sportsResultsCtrl",data:{siteSection:h.sports}},{name:"liveOverview",url:"/l",templateUrl:"/partials/live/overview.html",controller:"LiveBettingOverviewController as liveBettingOverviewCtrl",resolve:{dataOverviewCall:["sportsApiService","liveService","$interval",function(a,b,c){c.cancel(g),g=c(function(){var a=$(".timeFlash");"hidden"==a.css("visibility")?a.css("visibility","visible"):a.css("visibility","hidden")},700);var d=b.getLiveMenuSettings(),e=d.selectedSport?d.selectedSport:0;return"all"!=e&&"favourites"!=e||(e=0),a.liveFeed.getLiveAreaOddsByLayout(globalSettings.CurrentLanguage,e,3,0,!1,!1,!0,!0)}]},data:{siteSection:h.live}},{name:"liveEventView",url:"/l/eventview",data:{siteSection:h.live}},{name:"liveEventViewByMatchIds",url:"/l/eventview/:sportEventMatchIds",templateUrl:"/partials/live/eventView.html",controller:"LiveBettingEventViewController as liveEventViewCtrl",resolve:{dataMenuCall:["sportsApiService","liveService","$interval",function(a,b,c){c.cancel(g),g=c(function(){var a=$(".timeFlash");"hidden"==a.css("visibility")?a.css("visibility","visible"):a.css("visibility","hidden")},700);var d=b.getLiveMenuSettings(),e=d.selectedSport?d.selectedSport:0;return"all"!=e&&"favourites"!=e||(e=0),a.liveFeed.getLiveAreaOddsByLayout(globalSettings.CurrentLanguage,e,3,0,!1,!1,!1,!1)}],dataOddsCall:["$transition$","sportsApiService",function(a,b){var c=a.params().sportEventMatchIds.split("-")[1];return b.liveFeed.getLiveEventDetails(c,globalSettings.CurrentLanguage)}]},data:{siteSection:h.live}},{name:"liveMultiView",url:"/l/multiview",templateUrl:"/partials/live/multiView.html",controller:"LiveBettingMultiViewController as liveBettingMultiViewCtrl",resolve:{dataMultiViewCall:["sportsApiService","$interval",function(a,b){return b.cancel(g),g=b(function(){var a=$(".timeFlash");"hidden"==a.css("visibility")?a.css("visibility","visible"):a.css("visibility","hidden")},700),a.liveFeed.getLiveMultiview(globalSettings.CurrentLanguage)}]},data:{siteSection:h.live}},{name:"liveDiary",url:"/l/livediary",templateUrl:"/partials/live/liveDiary.html",controller:"LiveBettingLiveDiaryController as liveBettingLiveDiaryCtrl",resolve:{dataDiaryCall:["sportsApiService",function(a){return a.liveFeed.getLiveUpcomingEvents()}]},data:{siteSection:h.live}},{name:"casinoHome",url:"/c",templateUrl:"/partials/casino/home.html",data:{siteSection:h.casino}},{name:"liveCasinoHome",url:"/lc",templateUrl:"/partials/livecasino/home.html",data:{siteSection:h.liveCasino}},{name:"accountHome",url:"/ac",redirectTo:{state:"accountBalance",params:{}},data:{siteSection:h.account}},{name:"accountBalance",url:"/ac/balance",templateUrl:"/partials/authenticated/account/balance/balance.html",data:{siteSection:h.account}},{name:"accountBonus",url:"/ac/bonus",templateUrl:"/partials/authenticated/account/bonus/bonus.html",controller:"AccountBonusController as bonusCtrl",data:{siteSection:h.account}},{name:"accountEditProfile",url:"/ac/editprofile",templateUrl:"/partials/authenticated/shared/editProfile/editProfile.html",data:{siteSection:h.account}},{name:"accountChangePassword",url:"/ac/changepassword",templateUrl:"/partials/authenticated/shared/changePassword/changePassword.html",data:{siteSection:h.account}},{name:"accountChangePhoneNumber",url:"/ac/changephonenumber",templateUrl:"/partials/authenticated/shared/changePhoneNumber/changePhoneNumber.html",data:{siteSection:h.account}},{name:"accountPhoneVerification",url:"/ac/phoneverification",templateUrl:"/partials/authenticated/shared/phoneVerification/phoneVerification.html",data:{siteSection:h.account}},{name:"accountDeposit",url:"/ac/deposit",params:{disableLastDepositAutoRedirect:!1},templateUrl:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"/partials/authenticated/shared/deposit/userPaymentJourney/deposit.html";case"regular":default:return"/partials/authenticated/shared/deposit/regularPaymentFlow/deposit.html"}},controllerProvider:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"userJourneyMoneyTransferController as usrJrnyMnyTransCtrl";case"regular":default:return"moneyTransferController as moneyTransferCtrl"}},resolve:{transferType:[function(){return"Deposit"}]},data:{siteSection:h.account}},{name:"accountDepositPaymentMethod",url:"/ac/deposit/:paymentMethod",templateUrl:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"/partials/authenticated/shared/deposit/userPaymentJourney/deposit.html";case"regular":default:return"/partials/authenticated/shared/deposit/regularPaymentFlow/deposit.html"}},controllerProvider:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"userJourneyMoneyTransferController as usrJrnyMnyTransCtrl";case"regular":default:return"moneyTransferController as moneyTransferCtrl"}},resolve:{transferType:[function(){return"Deposit"}]},data:{siteSection:h.account}},{name:"accountWithdraw",url:"/ac/withdraw",params:{checkForRedirect:!0},templateUrl:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"/partials/authenticated/shared/withdraw/userPaymentJourney/withdraw.html";case"regular":default:return"/partials/authenticated/shared/withdraw/regularPaymentFlow/withdraw.html"}},controllerProvider:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"userJourneyMoneyTransferController as usrJrnyMnyTransCtrl";case"regular":default:return"moneyTransferController as moneyTransferCtrl"}},resolve:{transferType:[function(){return"Withdraw"}]},data:{siteSection:h.account}},{name:"accountWithdrawPaymentMethod",url:"/ac/withdraw/:paymentMethod",params:{checkForRedirect:!1},templateUrl:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"/partials/authenticated/shared/withdraw/userPaymentJourney/withdraw.html";case"regular":default:return"/partials/authenticated/shared/withdraw/regularPaymentFlow/withdraw.html"}},controllerProvider:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"userJourneyMoneyTransferController as usrJrnyMnyTransCtrl";case"regular":default:return"moneyTransferController as moneyTransferCtrl"}},resolve:{transferType:[function(){return"Withdraw"}]},data:{siteSection:h.account}},{name:"accountBetSearch",url:"/ac/betsearch",templateUrl:"/partials/authenticated/shared/betsearch/search.html",controller:"BetSearchController as betSearchCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}],getDescendantsList:["platformApiService",function(a){return{}}]},data:{siteSection:h.account}},{name:"accountBetSearchCouponDetails",url:"/ac/betsearch/:couponCode",templateUrl:"/partials/authenticated/shared/betsearch/couponDetails.html",controller:"CouponDetailsController as couponDetailsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.account}},{name:"accountBetSearchVirtuals",url:"/ac/betlistvirtuals",templateUrl:"/partials/authenticated/shared/betsearch/search.html",controller:"BetSearchVirtualsController as betSearchCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}],getDescendantsList:["platformApiService",function(a){return{}}]},data:{siteSection:h.account}},{name:"accountBetSearchVirtualsCouponDetails",url:"/ac/betlistvirtuals/:couponCode",templateUrl:"/partials/authenticated/shared/betsearch/couponDetails.html",controller:"CouponDetailsVirtualsController as couponDetailsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.account}},{name:"accountBetSearchLottery",url:"/ac/betlistlottery",templateUrl:"/partials/authenticated/shared/betsearchLottery/search.html",controller:"BetSearchLotteryController as betSearchCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}],getDescendantsList:["platformApiService",function(a){return{}}]},data:{siteSection:h.account}},{name:"accountBetSearchLotteryCouponDetails",url:"/ac/betlistlottery/:ticketCode",templateUrl:"/partials/authenticated/shared/betsearchLottery/couponDetails.html",controller:"CouponDetailsLotteryController as couponDetailsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.account}},{name:"accountOpenBets",url:"/ac/open-bets",templateUrl:"/partials/authenticated/shared/openBets/openBets.html",controller:"OpenBetsPageController as openBetsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}],getDescendantsList:["platformApiService",function(a){return{}}]},data:{siteSection:h.account}},{name:"accountStatementSearch",url:"/ac/statementsearch",templateUrl:"/partials/authenticated/shared/statementSearch/search.html",controller:"StatementSearchController as statementSearchCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.account}},{name:"accountStatementSearchCouponDetails",url:"/ac/statementsearch/:couponCode?pokerpool",templateUrl:"/partials/authenticated/shared/betsearch/couponDetails.html",controller:"CouponDetailsController as couponDetailsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.account}},{name:"accountMessages",url:"/ac/messages",templateUrl:"/partials/authenticated/shared/messageCentre/messageCentre.html",controller:"MessageController as messageCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.account}},{name:"accountMessageDetails",url:"/ac/messages/:messageId?ret",templateUrl:"/partials/authenticated/shared/messageCentre/messageDetails.html",controller:"MessageDetailsController as messageDetailsCtrl",data:{siteSection:h.account}},{name:"accountMessagesOverview",url:"/ac/messages/overview",templateUrl:"/partials/authenticated/shared/messageCentre/messageOverview.html",controller:"MessageOverviewController as messageOverviewCtrl",data:{siteSection:h.account}},{name:"accountNewMessage",url:"/ac/messages/newmessage",templateUrl:"/partials/authenticated/shared/messageCentre/sendNewMessage.html",controller:"SendNewMessageController as sendNewMessageCtrl",data:{siteSection:h.account}},{name:"accountFastPrint",url:"/ac/fastprint",templateUrl:"/partials/authenticated/shared/printodds/fastPrint.html",controller:"PrintOddsFastController as printOddsFastCtrl",data:{siteSection:h.account}},{name:"accountStandardPrint",url:"/ac/standardprint",templateUrl:"/partials/authenticated/shared/printodds/standardPrint.html",controller:"PrintOddsStandardController as printOddsStandardCtrl",data:{siteSection:h.account}},{name:"agents",url:"/ag",redirectTo:{state:globalSettings.DefaultAgentsStateName,params:{}},data:{siteSection:h.agents}},{name:"agentsManageUsers",url:"/ag/manageusers",templateUrl:"/partials/authenticated/shared/manageUsers/manageUsers.html",controller:"ManageUsersController as manageUsersCtrl",resolve:{slickGrid:["$ocLazyLoad",function(a){return a.load([globalSettings.SiteContentURL+"/dist/libs/jquery.event.drag/jquery.event.drag.js",globalSettings.SiteContentURL+"/dist/libs/jquery.event.drag/jquery.event.drag.live.js",globalSettings.SiteContentURL+"/dist/libs/jquery.event.drag/jquery.event.drop.js",globalSettings.SiteContentURL+"/dist/libs/jquery.event.drag/jquery.event.drop.live.js",globalSettings.SiteContentURL+"/dist/libs/slickgrid/slick.core.js",globalSettings.SiteContentURL+"/dist/libs/slickgrid/slick.grid.js",globalSettings.SiteContentURL+"/dist/libs/slickgrid/slick.formatters.js",globalSettings.SiteContentURL+"/dist/libs/slickgrid/slick.editors.js",globalSettings.SiteContentURL+"/dist/libs/slickgrid/slick.dataview.js",globalSettings.SiteContentURL+"/dist/libs/slickgrid/slick.grid.css"],{serie:!0})}]},data:{siteSection:h.agents}},{name:"agentsTransfer",url:"/ag/transfer",templateUrl:"/partials/authenticated/shared/fundTransfer/fundTransfer.html",controller:"FundTransferController as fundTransferCtrl",data:{siteSection:h.agents}},{name:"agentsBetSearch",url:"/ag/betsearch",templateUrl:"/partials/authenticated/shared/betsearch/search.html",controller:"BetSearchController as betSearchCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}],getDescendantsList:["platformApiService",function(a){return a.user.getUserList({DirectDescendantsOnly:"true",Recursive:"false",AgentsOnly:"false",UserStatusesFilterBy:["CLSD","ACT","INACT","CONF","PCHANG","BLOCK","AWAITDEP"]})}]},data:{siteSection:h.agents}},{name:"agentsBetSearchCouponDetails",url:"/ag/betsearch/:couponCode",templateUrl:"/partials/authenticated/shared/betsearch/couponDetails.html",controller:"CouponDetailsController as couponDetailsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.agents}},{name:"agentsBetSearchVirtuals",url:"/ag/betlistvirtuals",templateUrl:"/partials/authenticated/shared/betsearch/search.html",controller:"BetSearchVirtualsController as betSearchCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}],getDescendantsList:["platformApiService",function(a){return a.user.getUserList({DirectDescendantsOnly:"true",Recursive:"false",AgentsOnly:"false",UserStatusesFilterBy:["CLSD","ACT","INACT","CONF","PCHANG","BLOCK","AWAITDEP"]})}]},data:{siteSection:h.agents}},{name:"agentsBetSearchVirtualsCouponDetails",url:"/ag/betlistvirtuals/:couponCode",templateUrl:"/partials/authenticated/shared/betsearch/couponDetails.html",controller:"CouponDetailsVirtualsController as couponDetailsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.agents}},{name:"agentsBetSearchLottery",url:"/ag/betlistlottery",templateUrl:"/partials/authenticated/shared/betsearchLottery/search.html",controller:"BetSearchLotteryController as betSearchCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{
serie:!0})}],getDescendantsList:["platformApiService",function(a){return a.user.getUserList({DirectDescendantsOnly:"true",Recursive:"false",AgentsOnly:"false",UserStatusesFilterBy:["CLSD","ACT","INACT","CONF","PCHANG","BLOCK","AWAITDEP"]})}]},data:{siteSection:h.agents}},{name:"agentsBetSearchLotteryCouponDetails",url:"/ag/betlistlottery/:ticketCode",templateUrl:"/partials/authenticated/shared/betsearchLottery/couponDetails.html",controller:"CouponDetailsLotteryController as couponDetailsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.agents}},{name:"agentsFastPrint",url:"/ag/fastprint",templateUrl:"/partials/authenticated/shared/printodds/fastPrint.html",controller:"PrintOddsFastController as printOddsFastCtrl",data:{siteSection:h.agents}},{name:"agentsStandardPrint",url:"/ag/standardprint",templateUrl:"/partials/authenticated/shared/printodds/standardPrint.html",controller:"PrintOddsStandardController as printOddsStandardCtrl",data:{siteSection:h.agents}},{name:"shop",url:"/sh",template:"",data:{siteSection:h.shop}},{name:"shopHome",url:"/sh/home",templateUrl:"/partials/authenticated/shop/home/home.html",data:{siteSection:h.shop}},{name:"shopAccountStatement",url:"/sh/accountstatement",templateUrl:"/partials/authenticated/shop/accountStatement/accountStatement.html",controller:"AccountStatementController as accountStatementCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopBetSearch",url:"/sh/betsearch",templateUrl:"/partials/authenticated/shared/betsearch/search.html",controller:"BetSearchController as betSearchCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}],getDescendantsList:["platformApiService","authService",function(a,b){return b.isAgent()&&b.getAgentType(b.getUserData().userType)!=b.agentTypes.cashier?a.user.getUserList({DirectDescendantsOnly:"true",Recursive:"false",AgentsOnly:"false",UserStatusesFilterBy:["CLSD","ACT","INACT","CONF","PCHANG","BLOCK","AWAITDEP"]}):{}}]},data:{siteSection:h.shop}},{name:"shopBetSearchCouponDetails",url:"/sh/betsearch/:couponCode",templateUrl:"/partials/authenticated/shared/betsearch/couponDetails.html",controller:"CouponDetailsController as couponDetailsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopBetSearchVirtuals",url:"/sh/betlistvirtuals",templateUrl:"/partials/authenticated/shared/betsearch/search.html",controller:"BetSearchVirtualsController as betSearchCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}],getDescendantsList:["platformApiService","authService",function(a,b){return b.isAgent()&&b.getAgentType(b.getUserData().userType)!=b.agentTypes.cashier?a.user.getUserList({DirectDescendantsOnly:"true",Recursive:"false",AgentsOnly:"false",UserStatusesFilterBy:["CLSD","ACT","INACT","CONF","PCHANG","BLOCK","AWAITDEP"]}):{}}]},data:{siteSection:h.shop}},{name:"shopBetSearchVirtualsCouponDetails",url:"/sh/betlistvirtuals/:couponCode",templateUrl:"/partials/authenticated/shared/betsearch/couponDetails.html",controller:"CouponDetailsVirtualsController as couponDetailsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopBetSearchLottery",url:"/sh/betlistlottery",templateUrl:"/partials/authenticated/shared/betsearchLottery/search.html",controller:"BetSearchLotteryController as betSearchCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}],getDescendantsList:["platformApiService","authService",function(a,b){return b.isAgent()&&b.getAgentType(b.getUserData().userType)!=b.agentTypes.cashier?a.user.getUserList({DirectDescendantsOnly:"true",Recursive:"false",AgentsOnly:"false",UserStatusesFilterBy:["CLSD","ACT","INACT","CONF","PCHANG","BLOCK","AWAITDEP"]}):{}}]},data:{siteSection:h.shop}},{name:"shopBetSearchLotteryCouponDetails",url:"/sh/betlistlottery/:ticketCode",templateUrl:"/partials/authenticated/shared/betsearchLottery/couponDetails.html",controller:"CouponDetailsLotteryController as couponDetailsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopStatementSearch",url:"/sh/statementsearch",templateUrl:"/partials/authenticated/shared/statementSearch/search.html",controller:"StatementSearchController as statementSearchCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopStatementSearchCouponDetails",url:"/sh/statementsearch/:couponCode",templateUrl:"/partials/authenticated/shared/betsearch/couponDetails.html",controller:"CouponDetailsController as couponDetailsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopDeposit",url:"/sh/deposit",params:{disableLastDepositAutoRedirect:!1},templateUrl:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"/partials/authenticated/shared/deposit/userPaymentJourney/deposit.html";case"regular":default:return"/partials/authenticated/shared/deposit/regularPaymentFlow/deposit.html"}},controllerProvider:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"userJourneyMoneyTransferController as usrJrnyMnyTransCtrl";case"regular":default:return"moneyTransferController as moneyTransferCtrl"}},resolve:{transferType:[function(){return"Deposit"}]},data:{siteSection:h.shop}},{name:"shopDepositPaymentMethod",url:"/sh/deposit/:paymentMethod",templateUrl:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"/partials/authenticated/shared/deposit/userPaymentJourney/deposit.html";case"regular":default:return"/partials/authenticated/shared/deposit/regularPaymentFlow/deposit.html"}},controllerProvider:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"userJourneyMoneyTransferController as usrJrnyMnyTransCtrl";case"regular":default:return"moneyTransferController as moneyTransferCtrl"}},resolve:{transferType:[function(){return"Deposit"}]},data:{siteSection:h.shop}},{name:"shopWithdraw",url:"/sh/withdraw",params:{checkForRedirect:!1},templateUrl:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"/partials/authenticated/shared/withdraw/userPaymentJourney/withdraw.html";case"regular":default:return"/partials/authenticated/shared/withdraw/regularPaymentFlow/withdraw.html"}},controllerProvider:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"userJourneyMoneyTransferController as usrJrnyMnyTransCtrl";case"regular":default:return"moneyTransferController as moneyTransferCtrl"}},resolve:{transferType:[function(){return"Withdraw"}]},data:{siteSection:h.shop}},{name:"shopWithdrawPaymentMethod",url:"/sh/withdraw/:paymentMethod",params:{checkForRedirect:!1},templateUrl:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"/partials/authenticated/shared/withdraw/userPaymentJourney/withdraw.html";case"regular":default:return"/partials/authenticated/shared/withdraw/regularPaymentFlow/withdraw.html"}},controllerProvider:function(){switch(globalSettings.Account_PaymentsType.toLowerCase()){case"userjourney":return"userJourneyMoneyTransferController as usrJrnyMnyTransCtrl";case"regular":default:return"moneyTransferController as moneyTransferCtrl"}},resolve:{transferType:[function(){return"Withdraw"}]},data:{siteSection:h.shop}},{name:"shopTransfer",url:"/sh/transfer",templateUrl:"/partials/authenticated/shared/fundTransfer/fundTransfer.html",controller:"FundTransferController as fundTransferCtrl",data:{siteSection:h.shop}},{name:"shopTransferType",url:"/sh/transfer/:transferType",templateUrl:"/partials/authenticated/shared/fundTransfer/fundTransfer.html",controller:"FundTransferController as FundTransferController",data:{siteSection:h.shop}},{name:"shopMessages",url:"/sh/messages",templateUrl:"/partials/authenticated/shared/messageCentre/messageCentre.html",controller:"MessageController as messageCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopMessageDetails",url:"/sh/messages/:messageId?ret",templateUrl:"/partials/authenticated/shared/messageCentre/messageDetails.html",controller:"MessageDetailsController as messageDetailsCtrl",data:{siteSection:h.shop}},{name:"shopMessagesOverview",url:"/sh/messages/overview",templateUrl:"/partials/authenticated/shared/messageCentre/messageOverview.html",controller:"MessageOverviewController as messageOverviewCtrl",data:{siteSection:h.shop}},{name:"shopNewMessage",url:"/sh/messages/newmessage",templateUrl:"/partials/authenticated/shared/messageCentre/sendNewMessage.html",controller:"SendNewMessageController as sendNewMessageCtrl",data:{siteSection:h.shop}},{name:"shopNewUser",url:"/sh/newuser",templateUrl:"/partials/authenticated/shared/register/register.html",controller:"RegisterController as registerCtrl",data:{siteSection:h.shop}},{name:"shopStandardPrint",url:"/sh/standardprint",templateUrl:"/partials/authenticated/shared/printodds/standardPrint.html",controller:"PrintOddsStandardController as printOddsStandardCtrl",data:{siteSection:h.shop}},{name:"shopFastPrint",url:"/sh/fastprint",templateUrl:"/partials/authenticated/shared/printodds/fastPrint.html",controller:"PrintOddsFastController as printOddsFastCtrl",data:{siteSection:h.shop}},{name:"shopEditProfile",url:"/sh/editprofile",templateUrl:"/partials/authenticated/shared/editProfile/editProfile.html",data:{siteSection:h.shop}},{name:"shopChangePassword",url:"/sh/changepassword",templateUrl:"/partials/authenticated/shared/changePassword/changePassword.html",data:{siteSection:h.shop}},{name:"shopChangePhoneNumber",url:"/sh/changephonenumber",templateUrl:"/partials/authenticated/shared/changePhoneNumber/changePhoneNumber.html",data:{siteSection:h.shop}},{name:"shopPhoneVerification",url:"/sh/phoneverification",templateUrl:"/partials/authenticated/shared/phoneVerification/phoneVerification.html",data:{siteSection:h.shop}},{name:"shopViewSession",url:"/sh/viewsession",templateUrl:"/partials/authenticated/shop/viewSession/viewSession.html",controller:"ViewSessionController as viewSessionCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopCashiers",url:"/sh/shopcashiers",templateUrl:"/partials/authenticated/shop/cashier/cashiers.html",controller:"CashierController as cashierCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopCashiersReports",url:"/sh/shopcashiersreports/:reportIdentifier/:userId",templateUrl:"/partials/authenticated/shop/cashier/cashiers-reports.html",controller:"CashierReportController as cashierReportCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopUserManagement",url:"/sh/shopUserManagement",templateUrl:"/partials/authenticated/shop/userManagement/userManagement.html",controller:"UserManagementController as userManagementCtrl",resolve:{slickGrid:["$ocLazyLoad",function(a){return a.load([globalSettings.SiteContentURL+"/dist/libs/jquery.event.drag/jquery.event.drag.js",globalSettings.SiteContentURL+"/dist/libs/jquery.event.drag/jquery.event.drag.live.js",globalSettings.SiteContentURL+"/dist/libs/jquery.event.drag/jquery.event.drop.js",globalSettings.SiteContentURL+"/dist/libs/jquery.event.drag/jquery.event.drop.live.js",globalSettings.SiteContentURL+"/dist/libs/slickgrid/slick.core.js",globalSettings.SiteContentURL+"/dist/libs/slickgrid/slick.grid.js",globalSettings.SiteContentURL+"/dist/libs/slickgrid/slick.formatters.js",globalSettings.SiteContentURL+"/dist/libs/slickgrid/slick.editors.js",globalSettings.SiteContentURL+"/dist/libs/slickgrid/slick.dataview.js",globalSettings.SiteContentURL+"/dist/libs/slickgrid/slick.grid.css"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopUserDetails",url:"/sh/shopUserDetails",templateUrl:"/partials/authenticated/shop/userManagement/userDetails.html",controller:"UserDetailsController as userDetailsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopReports",url:"/sh/reports/:reportType/:reportTab",templateUrl:"/partials/authenticated/shop/reports/reports.html",controller:"ReportsController as reportsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/jszip/jszip.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js",globalSettings.SiteContentURL+"/dist/libs/datatables-buttons/dataTables.buttons.js",globalSettings.SiteContentURL+"/dist/libs/datatables-buttons/buttons.html5.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/jszip/jszip.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js",globalSettings.SiteContentURL+"/dist/libs/datatables-buttons/dataTables.buttons.js",globalSettings.SiteContentURL+"/dist/libs/datatables-buttons/buttons.html5.js"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopCommissionsReports",url:"/sh/shopCommissionsReports",redirectTo:{state:"shopReports",params:{reportType:1,reportTab:0}}},{name:"shopSalesReports",url:"/sh/shopSalesReports",redirectTo:{state:"shopReports",params:{reportType:2,reportTab:0}}},{name:"shopCreditReports",url:"/sh/shopCreditReports",redirectTo:{state:"shopReports",params:{reportType:3,reportTab:0}}},{name:"shopReportDetails",url:"/sh/reportDetails/:reportId/:reportTab",templateUrl:"/partials/authenticated/shop/reports/reportDetails.html",controller:"ReportDetailsController as reportDetailsCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/jszip/jszip.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js",globalSettings.SiteContentURL+"/dist/libs/datatables-buttons/dataTables.buttons.js",globalSettings.SiteContentURL+"/dist/libs/datatables-buttons/buttons.html5.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/jszip/jszip.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js",globalSettings.SiteContentURL+"/dist/libs/datatables-buttons/dataTables.buttons.js",globalSettings.SiteContentURL+"/dist/libs/datatables-buttons/buttons.html5.js"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopBonusDashboardReport",url:"/sh/reports/bonusDashboard",templateUrl:"/partials/authenticated/shop/reportBonus/bonusDashboardReport.html",controller:"BonusDashboardController as bonusDashboardCtrl",resolve:{dataTable:["$ocLazyLoad",function(a){return globalSettings.DebugMode?a.load([globalSettings.SiteContentURL+"/dist/libs/jszip/jszip.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js",globalSettings.SiteContentURL+"/dist/libs/datatables-buttons/dataTables.buttons.js",globalSettings.SiteContentURL+"/dist/libs/datatables-buttons/buttons.html5.js"],{serie:!0}):a.load([globalSettings.SiteContentURL+"/dist/libs/jszip/jszip.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.js",globalSettings.SiteContentURL+"/dist/libs/datatables/jquery.dataTables.min.css",globalSettings.SiteContentURL+"/dist/libs/datatables-plugins/datetime-moment.js",globalSettings.SiteContentURL+"/dist/libs/datatables-buttons/dataTables.buttons.js",globalSettings.SiteContentURL+"/dist/libs/datatables-buttons/buttons.html5.js"],{serie:!0})}]},data:{siteSection:h.shop}},{name:"shopNewAgentRegistration",url:"/sh/newagentregistration",templateUrl:"/partials/authenticated/shop/agentRegistration/newAgentRegistration.html",controller:"AgentRegisterController as agentRegisterCtrl",data:{siteSection:h.shop}},{name:"shopNewCashierRegistration",url:"/sh/newcashierregistration",templateUrl:"/partials/authenticated/shop/cashierRegistration/cashierRegistration.html",controller:"CashierRegistrationController as cashierRegisterCtrl",data:{siteSection:h.shop}},{name:"shopMarketingPage",url:"/sh/marketing/:pageId",templateUrl:"/partials/authenticated/shop/marketingDetails/marketingDetails.html",controller:"ShopMarketingDetailsController as marketingDetailsCtrl",data:{siteSection:h.shop}},{name:"shopAgentContentPage",url:"/sh/agentcontent/:pageId",templateUrl:"/partials/authenticated/shop/agentContent/agentContentDetails.html",controller:"ShopAgentContentController as agentContentCtrl",resolve:{pageData:["$q","$transition$","umbracoApiService","loggingService",function(a,b,c,d){var e=a.defer();return c.desktop.getAgentContentPage(b.params().pageId,globalSettings.CurrentLanguage).then(function(a){a.success?e.resolve(a.data):(d.logError("Unable to get agent content page details: "+JSON.stringify(a.error)),e.reject())}),e.promise}]},data:{siteSection:h.shop}},{name:"shopAgentDigitalAcceptance",url:"/sh/digitalacceptance",templateUrl:"/partials/authenticated/shop/digitalAcceptance/digitalAcceptance.html",controller:"DigitalAcceptanceController as daCtrl",resolve:{acceptedAgreements:["$q","digitalAcceptanceService","loggingService",function(a,b,c){var d=a.defer();return b.getAcceptedAgreements().then(function(a){d.resolve(a)}),d.promise}]},data:{siteSection:h.shop}},{name:"shopCashDesk",url:"/sh/cashdesk",templateUrl:"/partials/authenticated/shop/cashDesk/cashDesk.html",controller:"CashDeskController as cashDeskCtrl",data:{siteSection:h.shop}},{name:"standardPrintEvents",url:"/standardPrintEvents/:eventIds",templateUrl:"/partials/authenticated/shared/printodds/standardPrint.html",controller:"PrintOddsStandardController as printOddsStandardCtrl"},{name:"htmlPrint",url:"/html?printType&categoryType&areaMarkets&eventIds&areaMarketIds&orderByDate&pageLayout&fontSize&printLogo&dateRange",templateUrl:"/partials/authenticated/shared/printodds/printOddsHTML.html",controller:"PrintOddsController as printOddsCtrl",resolve:{dataPrintOdds:["PrintDataResolver","$transition$",function(a,b){var c=b.params(),d=c.areaMarketIds.split("_").join("|");return d=d.split("@").join("."),a.listPrintOdds(c.printType,c.categoryType,c.areaMarkets,c.eventIds,d,c.orderByDate,c.pageLayout,c.fontSize,c.printLogo,c.dateRange)}]}},{name:"pdfPrint",url:"/pdf/:printType/:categoryType/:areaMarkets/:eventIds/:areaMarketIds/:orderByDate/:pageLayout/:fontSize/:printLogo/:dateRange",templateUrl:"/partials/authenticated/shared/printodds/printOddsPDF.html",controller:"PrintOddsController as printOddsCtrl",resolve:{dataPrintOdds:["PrintDataResolver","$transition$",function(a,b){var c=b.params(),d=c.areaMarketIds.split("-").join("|");return d=d.split("@").join("."),a.listPrintOdds(c.printType,c.categoryType,c.areaMarkets,c.eventIds,d,c.orderByDate,c.pageLayout,c.fontSize,c.printLogo,c.dateRange)}]}},{name:"virtuals",url:"/v",template:"",data:{siteSection:h.virtuals}},{name:"virtualsGame",url:"/v/:gameCode",templateUrl:"/partials/virtuals/gameLoader.html",controller:"VirtualsGameLoaderController as gameLoaderCtrl",resolve:{gameDetails:["$transition$","virtualsService",function(a,b){var c=a.params().gameCode;return b.getGameDetails(c)}]},data:{siteSection:h.virtuals}},{name:"virtualLeagues",url:"/vl",template:"",data:{siteSection:h.virtualLeagues}},{name:"virtualLeaguesGame",url:"/vl/:gameCode",templateUrl:"/partials/virtuals/gameLoader.html",controller:"VirtualsGameLoaderController as gameLoaderCtrl",resolve:{gameDetails:["$transition$","virtualsService",function(a,b){var c=a.params().gameCode;return b.getGameDetails(c)}]},data:{siteSection:h.virtualLeagues}}]}}])}(),function(){angular.module("terms",[]).controller("TermsController",["$scope","$location",function(a,b){var c=this;this.menuStructure=[{sectionTitle:locale.common.footer.menuTermsAndConditions.termsAndConditions,sectionItems:[{itemTitle:locale.common.footer.menuTermsAndConditions.introduction,url:"/terms-conditions/introduction/",selected:!0},{itemTitle:locale.common.footer.menuTermsAndConditions.obligations,url:"/terms-conditions/obligations/"},{itemTitle:locale.common.footer.menuTermsAndConditions.registration,url:"/terms-conditions/registration/"},{itemTitle:locale.common.footer.menuTermsAndConditions.restrictedUse,url:"/terms-conditions/restricted-use/"},{itemTitle:locale.common.footer.menuTermsAndConditions.privacy,url:"/terms-conditions/privacy/"},{itemTitle:locale.common.footer.menuTermsAndConditions.yourAccount,url:"/terms-conditions/your-account/"},{itemTitle:locale.common.footer.menuTermsAndConditions.inactiveAccounts,url:"/terms-conditions/inactive-accounts/"},{itemTitle:locale.common.footer.menuTermsAndConditions.depositOfFunds,url:"/terms-conditions/deposit-of-funds/"},{itemTitle:locale.common.footer.menuTermsAndConditions.withdrawals,url:"/terms-conditions/withdrawals/"},{itemTitle:locale.common.footer.menuTermsAndConditions.paymentTransactionsAndProcessors,url:"/terms-conditions/payment-transactions-and-processors/"},{itemTitle:locale.common.footer.menuTermsAndConditions.errors,url:"/terms-conditions/errors/"},{itemTitle:locale.common.footer.menuTermsAndConditions.generalRules,url:"/terms-conditions/general-rules/"},{itemTitle:locale.common.footer.menuTermsAndConditions.communicationsAndNotices,url:"/terms-conditions/communications-and-notices/"},{itemTitle:locale.common.footer.menuTermsAndConditions.mattersBeyondOurControl,url:"/terms-conditions/matters-beyond-our-control/"},{itemTitle:locale.common.footer.menuTermsAndConditions.liability,url:"/terms-conditions/liability/"},{itemTitle:locale.common.footer.menuTermsAndConditions.underAgeUseOfTheServices,url:"/terms-conditions/under-age-use-of-the-services/"},{itemTitle:locale.common.footer.menuTermsAndConditions.fraud,url:"/terms-conditions/fraud/"},{itemTitle:locale.common.footer.menuTermsAndConditions.intellectualProperty,url:"/terms-conditions/intellectual-property/"},{itemTitle:locale.common.footer.menuTermsAndConditions.yourLicense,url:"/terms-conditions/your-license/"},{itemTitle:locale.common.footer.menuTermsAndConditions.prohibitedConduct,url:"/terms-conditions/prohibited-conduct/"},{itemTitle:locale.common.footer.menuTermsAndConditions.linksToOtherWebsites,url:"/terms-conditions/links-to-other-websites/"},{itemTitle:locale.common.footer.menuTermsAndConditions.complaints,url:"/terms-conditions/complaints/"},{itemTitle:locale.common.footer.menuTermsAndConditions.registrationAndInformation,url:"/terms-conditions/registration-and-information/"},{itemTitle:locale.common.footer.menuTermsAndConditions.assignment,url:"/terms-conditions/assignment/"},{itemTitle:locale.common.footer.menuTermsAndConditions.severability,url:"/terms-conditions/severability/"},{itemTitle:locale.common.footer.menuTermsAndConditions.breachOfTheseTerms,url:"/terms-conditions/breach-of-these-terms/"},{itemTitle:locale.common.footer.menuTermsAndConditions.governingLaw,url:"/terms-conditions/governing-law/"},{itemTitle:locale.common.footer.menuTermsAndConditions.generalProvisions,url:"/terms-conditions/general-provisions/"}]}],this.sourceUrl=this.menuStructure[0].sectionItems[0].url,this.updateMenuSelection=function(){for(var a=0;a<c.menuStructure.length;a++)for(var b=0;b<c.menuStructure[a].sectionItems.length;b++){var d=c.menuStructure[a].sectionItems[b];
d.selected=c.sourceUrl===d.url}},this.changePage=function(a){c.sourceUrl=a,c.updateMenuSelection()}}])}(),function(){angular.module("ui-bootstrap-custom",["ui.bootstrap.dropdown","ui.bootstrap.popover"]),angular.module("ui.bootstrap.position",[]).factory("$uibPosition",["$document","$window",function(a,b){var c,d,e={normal:/(auto|scroll)/,hidden:/(auto|scroll|hidden)/},f={auto:/\s?auto?\s?/i,primary:/^(top|bottom|left|right)$/,secondary:/^(top|bottom|left|right|center)$/,vertical:/^(top|bottom)$/},g=/(HTML|BODY)/;return{getRawNode:function(a){return a.nodeName?a:a[0]||a},parseStyle:function(a){return a=parseFloat(a),isFinite(a)?a:0},offsetParent:function(c){function d(a){return"static"===(b.getComputedStyle(a).position||"static")}c=this.getRawNode(c);for(var e=c.offsetParent||a[0].documentElement;e&&e!==a[0].documentElement&&d(e);)e=e.offsetParent;return e||a[0].documentElement},scrollbarWidth:function(e){if(e){if(angular.isUndefined(d)){var f=a.find("body");f.addClass("uib-position-body-scrollbar-measure"),d=b.innerWidth-f[0].clientWidth,d=isFinite(d)?d:0,f.removeClass("uib-position-body-scrollbar-measure")}return d}if(angular.isUndefined(c)){var g=angular.element('<div class="uib-position-scrollbar-measure"></div>');a.find("body").append(g),c=g[0].offsetWidth-g[0].clientWidth,c=isFinite(c)?c:0,g.remove()}return c},scrollbarPadding:function(a){a=this.getRawNode(a);var c=b.getComputedStyle(a),d=this.parseStyle(c.paddingRight),e=this.parseStyle(c.paddingBottom),f=this.scrollParent(a,!1,!0),h=this.scrollbarWidth(f,g.test(f.tagName));return{scrollbarWidth:h,widthOverflow:f.scrollWidth>f.clientWidth,right:d+h,originalRight:d,heightOverflow:f.scrollHeight>f.clientHeight,bottom:e+h,originalBottom:e}},isScrollable:function(a,c){a=this.getRawNode(a);var d=c?e.hidden:e.normal,f=b.getComputedStyle(a);return d.test(f.overflow+f.overflowY+f.overflowX)},scrollParent:function(c,d,f){c=this.getRawNode(c);var g=d?e.hidden:e.normal,h=a[0].documentElement,i=b.getComputedStyle(c);if(f&&g.test(i.overflow+i.overflowY+i.overflowX))return c;var j="absolute"===i.position,k=c.parentElement||h;if(k===h||"fixed"===i.position)return h;for(;k.parentElement&&k!==h;){var l=b.getComputedStyle(k);if(j&&"static"!==l.position&&(j=!1),!j&&g.test(l.overflow+l.overflowY+l.overflowX))break;k=k.parentElement}return k},position:function(c,d){c=this.getRawNode(c);var e=this.offset(c);if(d){var f=b.getComputedStyle(c);e.top-=this.parseStyle(f.marginTop),e.left-=this.parseStyle(f.marginLeft)}var g=this.offsetParent(c),h={top:0,left:0};return g!==a[0].documentElement&&(h=this.offset(g),h.top+=g.clientTop-g.scrollTop,h.left+=g.clientLeft-g.scrollLeft),{width:Math.round(angular.isNumber(e.width)?e.width:c.offsetWidth),height:Math.round(angular.isNumber(e.height)?e.height:c.offsetHeight),top:Math.round(e.top-h.top),left:Math.round(e.left-h.left)}},offset:function(c){c=this.getRawNode(c);var d=c.getBoundingClientRect();return{width:Math.round(angular.isNumber(d.width)?d.width:c.offsetWidth),height:Math.round(angular.isNumber(d.height)?d.height:c.offsetHeight),top:Math.round(d.top+(b.pageYOffset||a[0].documentElement.scrollTop)),left:Math.round(d.left+(b.pageXOffset||a[0].documentElement.scrollLeft))}},viewportOffset:function(c,d,e){c=this.getRawNode(c),e=e!==!1;var f=c.getBoundingClientRect(),g={top:0,left:0,bottom:0,right:0},h=d?a[0].documentElement:this.scrollParent(c),i=h.getBoundingClientRect();if(g.top=i.top+h.clientTop,g.left=i.left+h.clientLeft,h===a[0].documentElement&&(g.top+=b.pageYOffset,g.left+=b.pageXOffset),g.bottom=g.top+h.clientHeight,g.right=g.left+h.clientWidth,e){var j=b.getComputedStyle(h);g.top+=this.parseStyle(j.paddingTop),g.bottom-=this.parseStyle(j.paddingBottom),g.left+=this.parseStyle(j.paddingLeft),g.right-=this.parseStyle(j.paddingRight)}return{top:Math.round(f.top-g.top),bottom:Math.round(g.bottom-f.bottom),left:Math.round(f.left-g.left),right:Math.round(g.right-f.right)}},parsePlacement:function(a){var b=f.auto.test(a);return b&&(a=a.replace(f.auto,"")),a=a.split("-"),a[0]=a[0]||"top",f.primary.test(a[0])||(a[0]="top"),a[1]=a[1]||"center",f.secondary.test(a[1])||(a[1]="center"),b?a[2]=!0:a[2]=!1,a},positionElements:function(a,c,d,e){a=this.getRawNode(a),c=this.getRawNode(c);var g=angular.isDefined(c.offsetWidth)?c.offsetWidth:c.prop("offsetWidth"),h=angular.isDefined(c.offsetHeight)?c.offsetHeight:c.prop("offsetHeight");d=this.parsePlacement(d);var i=e?this.offset(a):this.position(a),j={top:0,left:0,placement:""};if(d[2]){var k=this.viewportOffset(a,e),l=b.getComputedStyle(c),m={width:g+Math.round(Math.abs(this.parseStyle(l.marginLeft)+this.parseStyle(l.marginRight))),height:h+Math.round(Math.abs(this.parseStyle(l.marginTop)+this.parseStyle(l.marginBottom)))};if(d[0]="top"===d[0]&&m.height>k.top&&m.height<=k.bottom?"bottom":"bottom"===d[0]&&m.height>k.bottom&&m.height<=k.top?"top":"left"===d[0]&&m.width>k.left&&m.width<=k.right?"right":"right"===d[0]&&m.width>k.right&&m.width<=k.left?"left":d[0],d[1]="top"===d[1]&&m.height-i.height>k.bottom&&m.height-i.height<=k.top?"bottom":"bottom"===d[1]&&m.height-i.height>k.top&&m.height-i.height<=k.bottom?"top":"left"===d[1]&&m.width-i.width>k.right&&m.width-i.width<=k.left?"right":"right"===d[1]&&m.width-i.width>k.left&&m.width-i.width<=k.right?"left":d[1],"center"===d[1])if(f.vertical.test(d[0])){var n=i.width/2-g/2;k.left+n<0&&m.width-i.width<=k.right?d[1]="left":k.right+n<0&&m.width-i.width<=k.left&&(d[1]="right")}else{var o=i.height/2-m.height/2;k.top+o<0&&m.height-i.height<=k.bottom?d[1]="top":k.bottom+o<0&&m.height-i.height<=k.top&&(d[1]="bottom")}}switch(d[0]){case"top":j.top=i.top-h;break;case"bottom":j.top=i.top+i.height;break;case"left":j.left=i.left-g;break;case"right":j.left=i.left+i.width}switch(d[1]){case"top":j.top=i.top;break;case"bottom":j.top=i.top+i.height-h;break;case"left":j.left=i.left;break;case"right":j.left=i.left+i.width-g;break;case"center":f.vertical.test(d[0])?j.left=i.left+i.width/2-g/2:j.top=i.top+i.height/2-h/2}return j.top=Math.round(j.top),j.left=Math.round(j.left),j.placement="center"===d[1]?d[0]:d[0]+"-"+d[1],j},positionArrow:function(a,c){a=this.getRawNode(a);var d=a.querySelector(".tooltip-inner, .popover-inner");if(d){var e=angular.element(d).hasClass("tooltip-inner"),g=e?a.querySelector(".tooltip-arrow"):a.querySelector(".arrow");if(g){var h={top:"",bottom:"",left:"",right:""};if(c=this.parsePlacement(c),"center"===c[1])return void angular.element(g).css(h);var i="border-"+c[0]+"-width",j=b.getComputedStyle(g)[i],k="border-";k+=f.vertical.test(c[0])?c[0]+"-"+c[1]:c[1]+"-"+c[0],k+="-radius";var l=b.getComputedStyle(e?d:a)[k];switch(c[0]){case"top":h.bottom=e?"0":"-"+j;break;case"bottom":h.top=e?"0":"-"+j;break;case"left":h.right=e?"0":"-"+j;break;case"right":h.left=e?"0":"-"+j}h[c[1]]=l,angular.element(g).css(h)}}}}}]),angular.module("ui.bootstrap.stackedMap",[]).factory("$$stackedMap",function(){return{createNew:function(){var a=[];return{add:function(b,c){a.push({key:b,value:c})},get:function(b){for(var c=0;c<a.length;c++)if(b===a[c].key)return a[c]},keys:function(){for(var b=[],c=0;c<a.length;c++)b.push(a[c].key);return b},top:function(){return a[a.length-1]},remove:function(b){for(var c=-1,d=0;d<a.length;d++)if(b===a[d].key){c=d;break}return a.splice(c,1)[0]},removeTop:function(){return a.splice(a.length-1,1)[0]},length:function(){return a.length}}}}}),angular.module("uib/template/tooltip/tooltip-html-popup.html",[]).run(["$templateCache",function(a){a.put("uib/template/tooltip/tooltip-html-popup.html",'<div class="tooltip"\n  tooltip-animation-class="fade"\n  uib-tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind-html="contentExp()"></div>\n</div>\n')}]),angular.module("uib/template/tooltip/tooltip-template-popup.html",[]).run(["$templateCache",function(a){a.put("uib/template/tooltip/tooltip-template-popup.html",'<div class="tooltip"\n  tooltip-animation-class="fade"\n  uib-tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner"\n    uib-tooltip-template-transclude="contentExp()"\n    tooltip-template-transclude-scope="originScope()"></div>\n</div>\n')}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.stackedMap"]).provider("$uibTooltip",function(){function a(a){var b=/[A-Z]/g,c="-";return a.replace(b,function(a,b){return(b?c:"")+a.toLowerCase()})}var b={placement:"top",placementClassPrefix:"",animation:!0,popupDelay:0,popupCloseDelay:0,useContentExp:!1},c={mouseenter:"mouseleave",click:"click",outsideClick:"outsideClick",focus:"blur",none:""},d={};this.options=function(a){angular.extend(d,a)},this.setTriggers=function(a){angular.extend(c,a)},this.$get=["$window","$compile","$timeout","$document","$uibPosition","$interpolate","$rootScope","$parse","$$stackedMap",function(e,f,g,h,i,j,k,l,m){function n(a){if(27===a.which){var b=o.top();b&&(b.value.close(),o.removeTop(),b=null)}}var o=m.createNew();return h.on("keypress",n),k.$on("$destroy",function(){h.off("keypress",n)}),function(e,k,m,n){function p(a){var b=(a||n.trigger||m).split(" "),d=b.map(function(a){return c[a]||a});return{show:b,hide:d}}n=angular.extend({},b,d,n);var q=a(e),r=j.startSymbol(),s=j.endSymbol(),t="<div "+q+'-popup uib-title="'+r+"title"+s+'" '+(n.useContentExp?'content-exp="contentExp()" ':'content="'+r+"content"+s+'" ')+'placement="'+r+"placement"+s+'" popup-class="'+r+"popupClass"+s+'" animation="animation" is-open="isOpen" origin-scope="origScope" class="uib-position-measure"></div>';return{compile:function(a,b){var c=f(t);return function(a,b,d,f){function j(){N.isOpen?q():m()}function m(){M&&!a.$eval(d[k+"Enable"])||(u(),x(),N.popupDelay?G||(G=g(r,N.popupDelay,!1)):r())}function q(){s(),N.popupCloseDelay?H||(H=g(t,N.popupCloseDelay,!1)):t()}function r(){return s(),u(),N.content?(v(),void N.$evalAsync(function(){N.isOpen=!0,y(!0),S()})):angular.noop}function s(){G&&(g.cancel(G),G=null),I&&(g.cancel(I),I=null)}function t(){N&&N.$evalAsync(function(){N&&(N.isOpen=!1,y(!1),N.animation?F||(F=g(w,150,!1)):w())})}function u(){H&&(g.cancel(H),H=null),F&&(g.cancel(F),F=null)}function v(){D||(E=N.$new(),D=c(E,function(a){K?h.find("body").append(a):b.after(a)}),z())}function w(){s(),u(),A(),D&&(D.remove(),D=null),E&&(E.$destroy(),E=null)}function x(){N.title=d[k+"Title"],Q?N.content=Q(a):N.content=d[e],N.popupClass=d[k+"Class"],N.placement=angular.isDefined(d[k+"Placement"])?d[k+"Placement"]:n.placement;var b=i.parsePlacement(N.placement);J=b[1]?b[0]+"-"+b[1]:b[0];var c=parseInt(d[k+"PopupDelay"],10),f=parseInt(d[k+"PopupCloseDelay"],10);N.popupDelay=isNaN(c)?n.popupDelay:c,N.popupCloseDelay=isNaN(f)?n.popupCloseDelay:f}function y(b){P&&angular.isFunction(P.assign)&&P.assign(a,b)}function z(){R.length=0,Q?(R.push(a.$watch(Q,function(a){N.content=a,!a&&N.isOpen&&t()})),R.push(E.$watch(function(){O||(O=!0,E.$$postDigest(function(){O=!1,N&&N.isOpen&&S()}))}))):R.push(d.$observe(e,function(a){N.content=a,!a&&N.isOpen?t():S()})),R.push(d.$observe(k+"Title",function(a){N.title=a,N.isOpen&&S()})),R.push(d.$observe(k+"Placement",function(a){N.placement=a?a:n.placement,N.isOpen&&S()}))}function A(){R.length&&(angular.forEach(R,function(a){a()}),R.length=0)}function B(a){N&&N.isOpen&&D&&(b[0].contains(a.target)||D[0].contains(a.target)||q())}function C(){var a=d[k+"Trigger"];T(),L=p(a),"none"!==L.show&&L.show.forEach(function(a,c){"outsideClick"===a?(b.on("click",j),h.on("click",B)):a===L.hide[c]?b.on(a,j):a&&(b.on(a,m),b.on(L.hide[c],q)),b.on("keypress",function(a){27===a.which&&q()})})}var D,E,F,G,H,I,J,K=!!angular.isDefined(n.appendToBody)&&n.appendToBody,L=p(void 0),M=angular.isDefined(d[k+"Enable"]),N=a.$new(!0),O=!1,P=!!angular.isDefined(d[k+"IsOpen"])&&l(d[k+"IsOpen"]),Q=!!n.useContentExp&&l(d[e]),R=[],S=function(){D&&D.html()&&(I||(I=g(function(){var a=i.positionElements(b,D,N.placement,K);D.css({top:a.top+"px",left:a.left+"px"}),D.hasClass(a.placement.split("-")[0])||(D.removeClass(J.split("-")[0]),D.addClass(a.placement.split("-")[0])),D.hasClass(n.placementClassPrefix+a.placement)||(D.removeClass(n.placementClassPrefix+J),D.addClass(n.placementClassPrefix+a.placement)),D.hasClass("uib-position-measure")?(i.positionArrow(D,a.placement),D.removeClass("uib-position-measure")):J!==a.placement&&i.positionArrow(D,a.placement),J=a.placement,I=null},0,!1)))};N.origScope=a,N.isOpen=!1,o.add(N,{close:t}),N.contentExp=function(){return N.content},d.$observe("disabled",function(a){a&&s(),a&&N.isOpen&&t()}),P&&a.$watch(P,function(a){N&&!a===N.isOpen&&j()});var T=function(){L.show.forEach(function(a){"outsideClick"===a?b.off("click",j):(b.off(a,m),b.off(a,j))}),L.hide.forEach(function(a){"outsideClick"===a?h.off("click",B):b.off(a,q)})};C();var U=a.$eval(d[k+"Animation"]);N.animation=angular.isDefined(U)?!!U:n.animation;var V,W=k+"AppendToBody";V=W in d&&void 0===d[W]||a.$eval(d[W]),K=angular.isDefined(V)?V:K,a.$on("$destroy",function(){T(),w(),o.remove(N),N=null})}}}}}]}).directive("uibTooltipTemplateTransclude",["$animate","$sce","$compile","$templateRequest",function(a,b,c,d){return{link:function(e,f,g){var h,i,j,k=e.$eval(g.tooltipTemplateTranscludeScope),l=0,m=function(){i&&(i.remove(),i=null),h&&(h.$destroy(),h=null),j&&(a.leave(j).then(function(){i=null}),i=j,j=null)};e.$watch(b.parseAsResourceUrl(g.uibTooltipTemplateTransclude),function(b){var g=++l;b?(d(b,!0).then(function(d){if(g===l){var e=k.$new(),i=d,n=c(i)(e,function(b){m(),a.enter(b,f)});h=e,j=n,h.$emit("$includeContentLoaded",b)}},function(){g===l&&(m(),e.$emit("$includeContentError",b))}),e.$emit("$includeContentRequested",b)):m()}),e.$on("$destroy",m)}}}]).directive("uibTooltipClasses",["$uibPosition",function(a){return{restrict:"A",link:function(b,c,d){if(b.placement){var e=a.parsePlacement(b.placement);c.addClass(e[0])}b.popupClass&&c.addClass(b.popupClass),b.animation()&&c.addClass(d.tooltipAnimationClass)}}}]).directive("uibTooltipPopup",function(){return{replace:!0,scope:{content:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},template:'<div class="tooltip"\n  tooltip-animation-class="fade"\n  uib-tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n'}}).directive("uibTooltip",["$uibTooltip",function(a){return a("uibTooltip","tooltip","mouseenter")}]).directive("uibTooltipTemplatePopup",function(){return{replace:!0,scope:{contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&",originScope:"&"},templateUrl:"uib/template/tooltip/tooltip-template-popup.html"}}).directive("uibTooltipTemplate",["$uibTooltip",function(a){return a("uibTooltipTemplate","tooltip","mouseenter",{useContentExp:!0})}]).directive("uibTooltipHtmlPopup",function(){return{replace:!0,scope:{contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"uib/template/tooltip/tooltip-html-popup.html"}}).directive("uibTooltipHtml",["$uibTooltip",function(a){return a("uibTooltipHtml","tooltip","mouseenter",{useContentExp:!0})}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("uibPopoverTemplatePopup",function(){return{replace:!0,scope:{uibTitle:"@",contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&",originScope:"&"},template:'<div class="popover"\n  tooltip-animation-class="fade"\n  uib-tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="uibTitle" ng-if="uibTitle"></h3>\n      <div class="popover-content"\n        uib-tooltip-template-transclude="contentExp()"\n        tooltip-template-transclude-scope="originScope()"></div>\n  </div>\n</div>\n'}}).directive("uibPopoverTemplate",["$uibTooltip",function(a){return a("uibPopoverTemplate","popover","click",{useContentExp:!0})}]).directive("uibPopoverHtmlPopup",function(){return{replace:!0,scope:{contentExp:"&",uibTitle:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"uib/template/popover/popover-html.html"}}).directive("uibPopoverHtml",["$uibTooltip",function(a){return a("uibPopoverHtml","popover","click",{useContentExp:!0})}]).directive("uibPopoverPopup",function(){return{replace:!0,scope:{uibTitle:"@",content:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"uib/template/popover/popover.html"}}).directive("uibPopover",["$uibTooltip",function(a){return a("uibPopover","popover","click")}]),angular.module("ui.bootstrap.dropdown",["ui.bootstrap.position"]).constant("uibDropdownConfig",{appendToOpenClass:"uib-dropdown-open",openClass:"open"}).service("uibDropdownService",["$document","$rootScope",function(a,b){var c=null;this.open=function(b,f){c||(a.on("click",d),f.on("keydown",e)),c&&c!==b&&(c.isOpen=!1),c=b},this.close=function(b,f){c===b&&(c=null,a.off("click",d),f.off("keydown",e))};var d=function(a){if(c&&!(a&&"disabled"===c.getAutoClose()||a&&3===a.which)){var d=c.getToggleElement();if(!(a&&d&&d[0].contains(a.target))){var e=c.getDropdownElement();a&&"outsideClick"===c.getAutoClose()&&e&&e[0].contains(a.target)||(c.isOpen=!1,b.$$phase||c.$apply())}}},e=function(a){27===a.which?(a.stopPropagation(),c.focusToggleElement(),d()):c.isKeynavEnabled()&&[38,40].indexOf(a.which)!==-1&&c.isOpen&&(a.preventDefault(),a.stopPropagation(),c.focusDropdownEntry(a.which))}}]).controller("UibDropdownController",["$scope","$element","$attrs","$parse","uibDropdownConfig","uibDropdownService","$animate","$uibPosition","$document","$compile","$templateRequest",function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n=this,o=a.$new(),p=e.appendToOpenClass,q=e.openClass,r=angular.noop,s=c.onToggle?d(c.onToggle):angular.noop,t=!1,u=null,v=!1,w=i.find("body");b.addClass("dropdown"),this.init=function(){if(c.isOpen&&(m=d(c.isOpen),r=m.assign,a.$watch(m,function(a){o.isOpen=!!a})),angular.isDefined(c.dropdownAppendTo)){var e=d(c.dropdownAppendTo)(o);e&&(u=angular.element(e))}t=angular.isDefined(c.dropdownAppendToBody),v=angular.isDefined(c.keyboardNav),t&&!u&&(u=w),u&&n.dropdownMenu&&(u.append(n.dropdownMenu),b.on("$destroy",function(){n.dropdownMenu.remove()}))},this.toggle=function(a){return o.isOpen=arguments.length?!!a:!o.isOpen,angular.isFunction(r)&&r(o,o.isOpen),o.isOpen},this.isOpen=function(){return o.isOpen},o.getToggleElement=function(){return n.toggleElement},o.getAutoClose=function(){return c.autoClose||"always"},o.getElement=function(){return b},o.isKeynavEnabled=function(){return v},o.focusDropdownEntry=function(a){var c=n.dropdownMenu?angular.element(n.dropdownMenu).find("a"):b.find("ul").eq(0).find("a");switch(a){case 40:angular.isNumber(n.selectedOption)?n.selectedOption=n.selectedOption===c.length-1?n.selectedOption:n.selectedOption+1:n.selectedOption=0;break;case 38:angular.isNumber(n.selectedOption)?n.selectedOption=0===n.selectedOption?0:n.selectedOption-1:n.selectedOption=c.length-1}c[n.selectedOption].focus()},o.getDropdownElement=function(){return n.dropdownMenu},o.focusToggleElement=function(){n.toggleElement&&n.toggleElement[0].focus()},o.$watch("isOpen",function(c,d){if(u&&n.dropdownMenu){var e,i,m,v=h.positionElements(b,n.dropdownMenu,"bottom-left",!0);if(e={top:v.top+"px",display:c?"block":"none"},i=n.dropdownMenu.hasClass("dropdown-menu-right"),i?(e.left="auto",m=h.scrollbarWidth(!0),e.right=window.innerWidth-m-(v.left+b.prop("offsetWidth"))+"px"):(e.left=v.left+"px",e.right="auto"),!t){var w=h.offset(u);e.top=v.top-w.top+"px",i?e.right=window.innerWidth-(v.left-w.left+b.prop("offsetWidth"))+"px":e.left=v.left-w.left+"px"}n.dropdownMenu.css(e)}var x=u?u:b,y=x.hasClass(u?p:q);if(y===!c&&g[c?"addClass":"removeClass"](x,u?p:q).then(function(){angular.isDefined(c)&&c!==d&&s(a,{open:!!c})}),c)n.dropdownMenuTemplateUrl&&k(n.dropdownMenuTemplateUrl).then(function(a){l=o.$new(),j(a.trim())(l,function(a){var b=a;n.dropdownMenu.replaceWith(b),n.dropdownMenu=b})}),o.focusToggleElement(),f.open(o,b);else{if(n.dropdownMenuTemplateUrl){l&&l.$destroy();var z=angular.element('<ul class="dropdown-menu"></ul>');n.dropdownMenu.replaceWith(z),n.dropdownMenu=z}f.close(o,b),n.selectedOption=null}angular.isFunction(r)&&r(a,c)})}]).directive("uibDropdown",function(){return{controller:"UibDropdownController",link:function(a,b,c,d){d.init()}}}).directive("uibDropdownMenu",function(){return{restrict:"A",require:"?^uibDropdown",link:function(a,b,c,d){if(d&&!angular.isDefined(c.dropdownNested)){b.addClass("dropdown-menu");var e=c.templateUrl;e&&(d.dropdownMenuTemplateUrl=e),d.dropdownMenu||(d.dropdownMenu=b)}}}}).directive("uibDropdownToggle",function(){return{require:"?^uibDropdown",link:function(a,b,c,d){if(d){b.addClass("dropdown-toggle"),d.toggleElement=b;var e=function(e){e.preventDefault(),b.hasClass("disabled")||c.disabled||a.$apply(function(){d.toggle()})};b.bind("click",e),b.attr({"aria-haspopup":!0,"aria-expanded":!1}),a.$watch(d.isOpen,function(a){b.attr("aria-expanded",!!a)}),a.$on("$destroy",function(){b.unbind("click",e)})}}}}),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("uibPopoverTemplatePopup",function(){return{replace:!0,scope:{uibTitle:"@",contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&",originScope:"&"},template:'<div class="popover"\n  tooltip-animation-class="fade"\n  uib-tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="uibTitle" ng-if="uibTitle"></h3>\n      <div class="popover-content"\n        uib-tooltip-template-transclude="contentExp()"\n        tooltip-template-transclude-scope="originScope()"></div>\n  </div>\n</div>\n'}}).directive("uibPopoverTemplate",["$uibTooltip",function(a){return a("uibPopoverTemplate","popover","click",{useContentExp:!0})}]).directive("uibPopoverHtmlPopup",function(){return{replace:!0,scope:{contentExp:"&",uibTitle:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"uib/template/popover/popover-html.html"}}).directive("uibPopoverHtml",["$uibTooltip",function(a){return a("uibPopoverHtml","popover","click",{useContentExp:!0})}]).directive("uibPopoverPopup",function(){return{replace:!0,scope:{uibTitle:"@",content:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"uib/template/popover/popover.html"}}).directive("uibPopover",["$uibTooltip",function(a){return a("uibPopover","popover","click")}]),angular.module("uib/template/popover/popover-html.html",[]).run(["$templateCache",function(a){a.put("uib/template/popover/popover-html.html",'<div class="popover"\n  tooltip-animation-class="fade"\n  uib-tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="uibTitle" ng-if="uibTitle"></h3>\n      <div class="popover-content" ng-bind-html="contentExp()"></div>\n  </div>\n</div>\n')}]),angular.module("uib/template/popover/popover.html",[]).run(["$templateCache",function(a){a.put("uib/template/popover/popover.html",'<div class="popover"\n  tooltip-animation-class="fade"\n  uib-tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="uibTitle" ng-if="uibTitle"></h3>\n      <div class="popover-content" ng-bind="content"></div>\n  </div>\n</div>\n')}]),angular.module("ui.bootstrap.position").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibPositionCss&&angular.element(document).find("head").prepend('<style type="text/css">.uib-position-measure{display:block !important;visibility:hidden !important;position:absolute !important;top:-9999px !important;left:-9999px !important;}.uib-position-scrollbar-measure{position:absolute !important;top:-9999px !important;width:50px !important;height:50px !important;overflow:scroll !important;}.uib-position-body-scrollbar-measure{overflow:scroll !important;}</style>'),angular.$$uibPositionCss=!0}),angular.module("ui.bootstrap.tooltip").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibTooltipCss&&angular.element(document).find("head").prepend('<style type="text/css">[uib-tooltip-popup].tooltip.top-left > .tooltip-arrow,[uib-tooltip-popup].tooltip.top-right > .tooltip-arrow,[uib-tooltip-popup].tooltip.bottom-left > .tooltip-arrow,[uib-tooltip-popup].tooltip.bottom-right > .tooltip-arrow,[uib-tooltip-popup].tooltip.left-top > .tooltip-arrow,[uib-tooltip-popup].tooltip.left-bottom > .tooltip-arrow,[uib-tooltip-popup].tooltip.right-top > .tooltip-arrow,[uib-tooltip-popup].tooltip.right-bottom > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.top-left > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.top-right > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.bottom-left > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.bottom-right > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.left-top > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.left-bottom > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.right-top > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.right-bottom > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.top-left > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.top-right > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.bottom-left > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.bottom-right > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.left-top > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.left-bottom > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.right-top > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.right-bottom > .tooltip-arrow,[uib-popover-popup].popover.top-left > .arrow,[uib-popover-popup].popover.top-right > .arrow,[uib-popover-popup].popover.bottom-left > .arrow,[uib-popover-popup].popover.bottom-right > .arrow,[uib-popover-popup].popover.left-top > .arrow,[uib-popover-popup].popover.left-bottom > .arrow,[uib-popover-popup].popover.right-top > .arrow,[uib-popover-popup].popover.right-bottom > .arrow,[uib-popover-html-popup].popover.top-left > .arrow,[uib-popover-html-popup].popover.top-right > .arrow,[uib-popover-html-popup].popover.bottom-left > .arrow,[uib-popover-html-popup].popover.bottom-right > .arrow,[uib-popover-html-popup].popover.left-top > .arrow,[uib-popover-html-popup].popover.left-bottom > .arrow,[uib-popover-html-popup].popover.right-top > .arrow,[uib-popover-html-popup].popover.right-bottom > .arrow,[uib-popover-template-popup].popover.top-left > .arrow,[uib-popover-template-popup].popover.top-right > .arrow,[uib-popover-template-popup].popover.bottom-left > .arrow,[uib-popover-template-popup].popover.bottom-right > .arrow,[uib-popover-template-popup].popover.left-top > .arrow,[uib-popover-template-popup].popover.left-bottom > .arrow,[uib-popover-template-popup].popover.right-top > .arrow,[uib-popover-template-popup].popover.right-bottom > .arrow{top:auto;bottom:auto;left:auto;right:auto;margin:0;}[uib-popover-popup].popover,[uib-popover-html-popup].popover,[uib-popover-template-popup].popover{display:block !important;}</style>'),angular.$$uibTooltipCss=!0})}(),function(){angular.module("virtuals",["virtualsGameLoader","virtuals.service"]).controller("VirtualsController",["$scope","$location","$state","$transitions","$timeout","stateService","virtualsService","authService",function(a,b,c,d,e,f,g,h){var i=this;this.gameLoaderState=null,this.menuIcon=null,this.menuTitle="",this.menuSections=null,this.menuBanners=null,this.overlayShown=!1,this.selectedGameCode=null,this.onlyOneGameIsAvailable=null,a.collapseLeftSection=!1,a.toggleLeftSection=function(){return window.innerWidth>1365?void(i.overlayShown&&(i.overlayShown=!1)):void(i.overlayShown=!i.overlayShown)},this.showCollapsedNavbar=function(){i.overlayShown=!1},this.getFirstAvailableGame=function(){if(i.menuSections)for(var a=0;a<i.menuSections.length;a++){var b=i.menuSections[a],c=_.find(b.games,function(a){return null!=a.gameCode&&a.gameCode.trim().length>0});if(c)return c}},this.loadGame=function(a){i.overlayShown=!1,a&&c.go(i.gameLoaderState,{gameCode:a})},d.onSuccess({},function(a){if("virtualsGame"==a.targetState().name()||"virtualLeaguesGame"==a.targetState().name()){var b=a.params().gameCode;if(0==b.trim().length){var d=i.getFirstAvailableGame();d&&c.transitionTo(a.targetState().name(),{gameCode:d.gameCode})}else i.selectedGameCode=a.params().gameCode}}),this.initMenuBanners=function(){e(function(){var a=$("#menuBannerRotator");a.owlCarousel("destroy"),a.find(".owl-item").remove(),$("#menuBannerRotator .menu-banner").length>0?(a.owlCarousel({animateOut:"slideOutLeft",animateIn:"slideInRight",items:1,loop:!0,autoplay:!0,autoplayTimeout:6e3,autoplayHoverPause:!0,touchDrag:!1,mouseDrag:!1}),a.css("display","block")):a.css("display","none")},0)},this.onMenuBannerClicked=function(a){a.clickUrl&&a.clickUrl.trim().length>0&&(window.location.href=a.clickUrl)},this.setGameDisabled=function(a){a.disabled=this.checkIsGameDisabled(a)},this.checkIsGameDisabled=function(a){var b=h.getUserData()?h.getUserData().userType:"",c=h.getAgentType(b),d=globalSettings.Virtuals_DisabledGoldenRaceGamesForSubAccounts?globalSettings.Virtuals_DisabledGoldenRaceGamesForSubAccounts.split(","):[],e="subAccountPlayer"===c;return!!d.includes(a.gameCode)&&e};(function(){var a=f.getSiteSectionFromUrl(b.absUrl());a==f.siteSections.virtualLeagues?(i.gameLoaderState="virtualLeaguesGame",i.menuIcon="virtual-leagues",i.menuTitle=locale.virtuals.virtualLeagues,g.getVirtualLeaguesMenu().then(function(a){if(i.menuSections=a,"virtualLeagues"==c.current.name&&i.menuSections.length>0){var b=i.getFirstAvailableGame();b&&c.go("virtualLeaguesGame",{gameCode:b.gameCode})}}),g.getVirtualLeaguesMenuBanners().then(function(a){i.menuBanners=a})):(i.gameLoaderState="virtualsGame",i.menuIcon="virtuals",i.menuTitle=locale.virtuals.virtuals,g.getVirtualsMenu().then(function(a){console.log("menu section");var b=0;if(a.forEach(function(a){a.games.forEach(function(){b++})}),i.onlyOneGameIsAvailable=1===b,i.menuSections=a,"virtuals"==c.current.name&&i.menuSections.length>0){var d=i.getFirstAvailableGame();d&&c.go("virtualsGame",{gameCode:d.gameCode})}}),g.getVirtualsMenuBanners().then(function(a){i.menuBanners=a}))})()}]).controller("globalBetCashierController",["platformApiService","helperService","loggingService","$sce",function(a,b,c,d){var e=this;this.iFramePath={},this.loadGlobalBetCashier=function(f){a.gamingVendors.globalBet.getGameFrameUrl("SHOP").then(function(a){if(!a.success){c.logError("Unable to load Global Bet Cashier: "+a.error,a.userMsg);var f=b.handlePlatformError(a);return void(f||b.showErrorMessage(a.userMsg).done())}var g=a.data;e.iFramePath={src:d.trustAsResourceUrl(encodeURI(g))}})},e.loadGlobalBetCashier()}])}(),function(){angular.module("virtuals.service",[]).factory("virtualsService",["$q","$location","$sce","umbracoApiService","platformApiService","loggingService","authService","guardianApiService","stateService","helperService",function(a,b,c,d,e,f,g,h,i,j){function k(a){var b=[];if(!a||!a.MenuSections)return b;if(a.FlattenGamesList){var c=[];a.MenuSections.forEach(function(a){a&&a.SectionGames&&a.SectionGames.forEach(function(a){var b=m(a);b&&c.push(b)})}),b.push({showSectionHeader:!1,collapsed:!1,games:c})}else a.MenuSections.forEach(function(a){var c=l(a);c&&b.push(c)});return b}function l(a){var b=[];if(a&&a.SectionGames&&a.SectionGames.forEach(function(a){var c=m(a);c&&b.push(c)}),0!==b.length)return{showSectionHeader:!0,collapsed:!1,title:a.SectionName||"",games:b}}function m(a){if(a)return{gameCode:a.Game,title:a.Title,isNew:a.IsNew}}function n(a){var b=[];return a&&a.length?(a.forEach(function(a){var c=!0,d=a.visibility?a.visibility.toLowerCase():"always";"loggedin"!=d||g.hasValidLogin()?"loggedout"==d&&g.hasValidLogin()&&(c=!1):c=!1,c&&b.push(a)}),b):b}function o(a){if(a)switch(a){case"kings-league":case"color-color":case"super-6":case"greyhounds-6":return u.globalBet;case"keno":case"spin-2-win":case"dog-racing":return u.goldenRace;default:return}}function p(b){
var c=a.defer();b=b.toLowerCase();var d=o(b);if(d){if(d==u.globalBet){if(!globalSettings.Virtuals_GlobalBetEnabledGames)return void c.resolve();var e=globalSettings.Virtuals_GlobalBetEnabledGames.toLowerCase().split(",");if(e.indexOf(b)==-1)return void c.resolve();q(b).then(function(a){c.resolve(a)})}else if(d==u.goldenRace){if(!globalSettings.Virtuals_GoldenRaceEnabledGames)return void c.resolve();var f=globalSettings.Virtuals_GoldenRaceEnabledGames.toLowerCase().split(",");if(f.indexOf(b)==-1)return void c.resolve();r(b).then(function(a){c.resolve(a)})}}else c.resolve();return c.promise}function q(b){var c=a.defer(),d=e.gamingVendors.globalBet;return d.getGameFrameUrl("WEB").then(function(a){if(!a.success)return f.logError("Unable to get GB game url: "+a.error),void c.resolve();var d="";switch(b){case"kings-league":d="#/games/FOOTBALL_LEAGUE";break;case"color-color":d="#/games/COLOR_COLOR";break;case"super-6":d="#/games/SUPER_SIX";break;case"greyhounds-6":d="#/games/GREYHOUNDS"}var e=a.data.replace("vspro.jsp","vspro-headless.jsp")+d;c.resolve({gameCode:b,provider:u.globalBet,gameUrl:e})}),c.promise}function r(b){var d=a.defer();if(g.hasValidLogin()){var h=e.gamingVendors.goldenRace;h.getGroupEntityID(g.getUserData().userID).then(function(a){var e=null;a.success?e=a.data:f.logError("Unable to get groupEntityID: "+a.error);var g=s(b,e);d.resolve({gameCode:b,provider:u.goldenRace,gameUrl:c.trustAsResourceUrl(g)})})}else{var i=s(b,null);d.resolve({gameCode:b,provider:u.goldenRace,gameUrl:c.trustAsResourceUrl(i)})}return d.promise}function s(a,c){var d=-1;switch(a){case"keno":d=10173;break;case"spin-2-win":d=10198;break;case"dog-racing":d=10174;break;default:f.logError("No GR game id specified for game: "+a)}var e=window.location.origin,h=i.getSiteSectionFromUrl(b.absUrl());h==i.siteSections.virtuals?e+="/virtuals":h==i.siteSections.virtualLeagues&&(e+="/virtual-leagues");var k={token:g.hasValidLogin()?g.getAccessToken():"",game:d,backurl:e,mode:g.hasValidLogin()?1:0,group:void 0,clientPlatform:"desktop"};null!=c?k.group=c:delete k.group;const l=Object.values(k).join("").concat(globalSettings.Virtuals_GoldenRaceHashKey),m=j.toMD5Hash(l);k.h=m;var n=globalSettings.Virtuals_GoldenRaceLauncherUrl+"?"+new URLSearchParams(k).toString();return n}function t(a,b){var c={token:g.getAccessToken(),game:a,backurl:window.location.href,mode:1,group:void 0,clientPlatform:"retail"};null!=b?c.group=b:delete c.group;const d=Object.values(c).join("").concat(globalSettings.Virtuals_GoldenRaceHashKey),e=j.toMD5Hash(d);c.h=e;var f=globalSettings.Virtuals_GoldenRaceLauncherUrl+"?"+new URLSearchParams(c).toString();return f}var u={globalBet:"globalBet",goldenRace:"goldenRace"};return{getVirtualsMenu:function(){var b=a.defer();return d.desktop.getVirtualsMenu(globalSettings.CurrentLanguage).then(function(a){var c=[];a.success?c=k(a.data):f.logError("Unable to get virtuals menu sections: "+JSON.stringify(a.error)),b.resolve(c)}),b.promise},getVirtualLeaguesMenu:function(){var b=a.defer();return d.desktop.getVirtualLeaguesMenu(globalSettings.CurrentLanguage).then(function(a){var c=[];a.success?c=k(a.data):f.logError("Unable to get virtual leagues menu sections: "+JSON.stringify(a.error)),b.resolve(c)}),b.promise},getVirtualsMenuBanners:function(){var b=a.defer();return d.desktop.getVirtualsMenuBanners(globalSettings.CurrentLanguage).then(function(a){var c=[];a.success?c=n(a.data):f.logError("Unable to get virtuals menu banners: "+JSON.stringify(a.error)),b.resolve(c)}),b.promise},getVirtualLeaguesMenuBanners:function(){var b=a.defer();return d.desktop.getVirtualLeaguesMenuBanners(globalSettings.CurrentLanguage).then(function(a){var c=[];a.success?c=n(a.data):f.logError("Unable to get virtual leagues menu banners: "+JSON.stringify(a.error)),b.resolve(c)}),b.promise},gameProviders:u,getGameDetails:function(b){if(!g.hasValidLogin())return p(b);var c=a.defer();return h.auth.validateToken(g.getAccessToken()).then(function(a){a.success&&a.data&&!a.data.isValidated&&g.clearUserData(),p(b).then(function(a){c.resolve(a)})}),c.promise},getGoldenRaceCashierUrl:function(){var b=a.defer();if(g.hasValidLogin()&&g.isGoldenRaceEnabled()&&globalSettings.Shop_GRVirtual.visible&&globalSettings.Shop_GRVirtual.gameId){var c=e.gamingVendors.goldenRace;c.getGroupEntityID(g.getUserData().userID).then(function(a){var c=null;a.success?c=a.data:f.logError("Unable to get groupEntityID: "+a.error),b.resolve(t(globalSettings.Shop_GRVirtual.gameId,c))})}else b.resolve();return b.promise}}}])}(),function(){angular.module("virtualsGameLoader",[]).controller("VirtualsGameLoaderController",["$rootScope","$scope","$state","gameDetails","virtualsService","authService","loggingService",function(a,b,c,d,e,f,g){var h=this;this.gameDetails=d,this.gameProviders=e.gameProviders,this.isGoldenRaceEnabled=f.isGoldenRaceEnabled();var i=function(a){var b=window.addEventListener?"addEventListener":"attachEvent",c=window[b],d="attachEvent"===b?"onmessage":"message";c(d,function(b){switch(b.data.action){case"game.loaded":break;case"game.balance.changed":break;case"game.cycle.started":break;case"game.cycle.end":break;case"game.goto.home":break;case"game.goto.history":break;case"game.resize.height":var c=b.data.value;(!c||Number(c.replace("px",""))<500)&&(c="500px"),document.getElementById(a).style.height=c;break;case"game.get.clientrect":b.source.postMessage({action:"game.clientrect",value:document.getElementById(a).getBoundingClientRect()},"*");break;case"game.get.clientheight":b.source.postMessage({action:"game.clientheight",value:document.getElementById(a).offsetHeight},"*");break;case"game.get.innerheight":b.source.postMessage({action:"game.innerheight",value:window.innerHeight},"*")}})},j=function(a){$("#globalBet").empty();var b=globalSettings.Virtuals_GlobalBetScriptUrl;return b&&0!=b.trim().length?void $.getScript(b,function(){var b=document.getElementById(a);widgetAdapter.registerVirtualSports(b,encodeURI(h.gameDetails.gameUrl))}):(h.gameDetails=null,void g.logError("GB script URL is undefined"))};b.$watch(function(){return f.hasValidLogin()},function(a,b){void 0!=b&&b!=a&&c.reload()});(function(){if(h.gameDetails)switch(h.gameDetails.provider){case h.gameProviders.globalBet:j("globalBet");break;case h.gameProviders.goldenRace:i("goldenRace")}})()}])}();
//# sourceMappingURL=site.min.js.map